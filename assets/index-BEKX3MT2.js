(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const I of document.querySelectorAll('link[rel="modulepreload"]'))M(I);new MutationObserver(I=>{for(const F of I)if(F.type==="childList")for(const P of F.addedNodes)P.tagName==="LINK"&&P.rel==="modulepreload"&&M(P)}).observe(document,{childList:!0,subtree:!0});function w(I){const F={};return I.integrity&&(F.integrity=I.integrity),I.referrerPolicy&&(F.referrerPolicy=I.referrerPolicy),I.crossOrigin==="use-credentials"?F.credentials="include":I.crossOrigin==="anonymous"?F.credentials="omit":F.credentials="same-origin",F}function M(I){if(I.ep)return;I.ep=!0;const F=w(I);fetch(I.href,F)}})();function ig(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var s_={exports:{}},pp={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zg;function _3(){if(Zg)return pp;Zg=1;var p=Symbol.for("react.transitional.element"),m=Symbol.for("react.fragment");function w(M,I,F){var P=null;if(F!==void 0&&(P=""+F),I.key!==void 0&&(P=""+I.key),"key"in I){F={};for(var u in I)u!=="key"&&(F[u]=I[u])}else F=I;return I=F.ref,{$$typeof:p,type:M,key:P,ref:I!==void 0?I:null,props:F}}return pp.Fragment=m,pp.jsx=w,pp.jsxs=w,pp}var Gg;function g3(){return Gg||(Gg=1,s_.exports=_3()),s_.exports}var Tt=g3(),a_={exports:{}},mp={},o_={exports:{}},l_={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hg;function y3(){return Hg||(Hg=1,function(p){function m(Qt,me){var fe=Qt.length;Qt.push(me);t:for(;0<fe;){var Ze=fe-1>>>1,yt=Qt[Ze];if(0<I(yt,me))Qt[Ze]=me,Qt[fe]=yt,fe=Ze;else break t}}function w(Qt){return Qt.length===0?null:Qt[0]}function M(Qt){if(Qt.length===0)return null;var me=Qt[0],fe=Qt.pop();if(fe!==me){Qt[0]=fe;t:for(var Ze=0,yt=Qt.length,Wt=yt>>>1;Ze<Wt;){var Ce=2*(Ze+1)-1,xe=Qt[Ce],ze=Ce+1,Fe=Qt[ze];if(0>I(xe,fe))ze<yt&&0>I(Fe,xe)?(Qt[Ze]=Fe,Qt[ze]=fe,Ze=ze):(Qt[Ze]=xe,Qt[Ce]=fe,Ze=Ce);else if(ze<yt&&0>I(Fe,fe))Qt[Ze]=Fe,Qt[ze]=fe,Ze=ze;else break t}}return me}function I(Qt,me){var fe=Qt.sortIndex-me.sortIndex;return fe!==0?fe:Qt.id-me.id}if(p.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var F=performance;p.unstable_now=function(){return F.now()}}else{var P=Date,u=P.now();p.unstable_now=function(){return P.now()-u}}var H=[],X=[],Q=1,dt=null,ht=3,lt=!1,Yt=!1,Jt=!1,pe=!1,ge=typeof setTimeout=="function"?setTimeout:null,de=typeof clearTimeout=="function"?clearTimeout:null,ne=typeof setImmediate<"u"?setImmediate:null;function Ne(Qt){for(var me=w(X);me!==null;){if(me.callback===null)M(X);else if(me.startTime<=Qt)M(X),me.sortIndex=me.expirationTime,m(H,me);else break;me=w(X)}}function we(Qt){if(Jt=!1,Ne(Qt),!Yt)if(w(H)!==null)Yt=!0,Ve||(Ve=!0,Pi());else{var me=w(X);me!==null&&dn(we,me.startTime-Qt)}}var Ve=!1,Je=-1,Ue=5,Ei=-1;function Ti(){return pe?!0:!(p.unstable_now()-Ei<Ue)}function zi(){if(pe=!1,Ve){var Qt=p.unstable_now();Ei=Qt;var me=!0;try{t:{Yt=!1,Jt&&(Jt=!1,de(Je),Je=-1),lt=!0;var fe=ht;try{e:{for(Ne(Qt),dt=w(H);dt!==null&&!(dt.expirationTime>Qt&&Ti());){var Ze=dt.callback;if(typeof Ze=="function"){dt.callback=null,ht=dt.priorityLevel;var yt=Ze(dt.expirationTime<=Qt);if(Qt=p.unstable_now(),typeof yt=="function"){dt.callback=yt,Ne(Qt),me=!0;break e}dt===w(H)&&M(H),Ne(Qt)}else M(H);dt=w(H)}if(dt!==null)me=!0;else{var Wt=w(X);Wt!==null&&dn(we,Wt.startTime-Qt),me=!1}}break t}finally{dt=null,ht=fe,lt=!1}me=void 0}}finally{me?Pi():Ve=!1}}}var Pi;if(typeof ne=="function")Pi=function(){ne(zi)};else if(typeof MessageChannel<"u"){var Ir=new MessageChannel,Rn=Ir.port2;Ir.port1.onmessage=zi,Pi=function(){Rn.postMessage(null)}}else Pi=function(){ge(zi,0)};function dn(Qt,me){Je=ge(function(){Qt(p.unstable_now())},me)}p.unstable_IdlePriority=5,p.unstable_ImmediatePriority=1,p.unstable_LowPriority=4,p.unstable_NormalPriority=3,p.unstable_Profiling=null,p.unstable_UserBlockingPriority=2,p.unstable_cancelCallback=function(Qt){Qt.callback=null},p.unstable_forceFrameRate=function(Qt){0>Qt||125<Qt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ue=0<Qt?Math.floor(1e3/Qt):5},p.unstable_getCurrentPriorityLevel=function(){return ht},p.unstable_next=function(Qt){switch(ht){case 1:case 2:case 3:var me=3;break;default:me=ht}var fe=ht;ht=me;try{return Qt()}finally{ht=fe}},p.unstable_requestPaint=function(){pe=!0},p.unstable_runWithPriority=function(Qt,me){switch(Qt){case 1:case 2:case 3:case 4:case 5:break;default:Qt=3}var fe=ht;ht=Qt;try{return me()}finally{ht=fe}},p.unstable_scheduleCallback=function(Qt,me,fe){var Ze=p.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?Ze+fe:Ze):fe=Ze,Qt){case 1:var yt=-1;break;case 2:yt=250;break;case 5:yt=1073741823;break;case 4:yt=1e4;break;default:yt=5e3}return yt=fe+yt,Qt={id:Q++,callback:me,priorityLevel:Qt,startTime:fe,expirationTime:yt,sortIndex:-1},fe>Ze?(Qt.sortIndex=fe,m(X,Qt),w(H)===null&&Qt===w(X)&&(Jt?(de(Je),Je=-1):Jt=!0,dn(we,fe-Ze))):(Qt.sortIndex=yt,m(H,Qt),Yt||lt||(Yt=!0,Ve||(Ve=!0,Pi()))),Qt},p.unstable_shouldYield=Ti,p.unstable_wrapCallback=function(Qt){var me=ht;return function(){var fe=ht;ht=me;try{return Qt.apply(this,arguments)}finally{ht=fe}}}}(l_)),l_}var qg;function v3(){return qg||(qg=1,o_.exports=y3()),o_.exports}var c_={exports:{}},Ii={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $g;function x3(){if($g)return Ii;$g=1;var p=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),P=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),X=Symbol.for("react.memo"),Q=Symbol.for("react.lazy"),dt=Symbol.iterator;function ht(yt){return yt===null||typeof yt!="object"?null:(yt=dt&&yt[dt]||yt["@@iterator"],typeof yt=="function"?yt:null)}var lt={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Yt=Object.assign,Jt={};function pe(yt,Wt,Ce){this.props=yt,this.context=Wt,this.refs=Jt,this.updater=Ce||lt}pe.prototype.isReactComponent={},pe.prototype.setState=function(yt,Wt){if(typeof yt!="object"&&typeof yt!="function"&&yt!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,yt,Wt,"setState")},pe.prototype.forceUpdate=function(yt){this.updater.enqueueForceUpdate(this,yt,"forceUpdate")};function ge(){}ge.prototype=pe.prototype;function de(yt,Wt,Ce){this.props=yt,this.context=Wt,this.refs=Jt,this.updater=Ce||lt}var ne=de.prototype=new ge;ne.constructor=de,Yt(ne,pe.prototype),ne.isPureReactComponent=!0;var Ne=Array.isArray,we={H:null,A:null,T:null,S:null,V:null},Ve=Object.prototype.hasOwnProperty;function Je(yt,Wt,Ce,xe,ze,Fe){return Ce=Fe.ref,{$$typeof:p,type:yt,key:Wt,ref:Ce!==void 0?Ce:null,props:Fe}}function Ue(yt,Wt){return Je(yt.type,Wt,void 0,void 0,void 0,yt.props)}function Ei(yt){return typeof yt=="object"&&yt!==null&&yt.$$typeof===p}function Ti(yt){var Wt={"=":"=0",":":"=2"};return"$"+yt.replace(/[=:]/g,function(Ce){return Wt[Ce]})}var zi=/\/+/g;function Pi(yt,Wt){return typeof yt=="object"&&yt!==null&&yt.key!=null?Ti(""+yt.key):Wt.toString(36)}function Ir(){}function Rn(yt){switch(yt.status){case"fulfilled":return yt.value;case"rejected":throw yt.reason;default:switch(typeof yt.status=="string"?yt.then(Ir,Ir):(yt.status="pending",yt.then(function(Wt){yt.status==="pending"&&(yt.status="fulfilled",yt.value=Wt)},function(Wt){yt.status==="pending"&&(yt.status="rejected",yt.reason=Wt)})),yt.status){case"fulfilled":return yt.value;case"rejected":throw yt.reason}}throw yt}function dn(yt,Wt,Ce,xe,ze){var Fe=typeof yt;(Fe==="undefined"||Fe==="boolean")&&(yt=null);var Se=!1;if(yt===null)Se=!0;else switch(Fe){case"bigint":case"string":case"number":Se=!0;break;case"object":switch(yt.$$typeof){case p:case m:Se=!0;break;case Q:return Se=yt._init,dn(Se(yt._payload),Wt,Ce,xe,ze)}}if(Se)return ze=ze(yt),Se=xe===""?"."+Pi(yt,0):xe,Ne(ze)?(Ce="",Se!=null&&(Ce=Se.replace(zi,"$&/")+"/"),dn(ze,Wt,Ce,"",function(rr){return rr})):ze!=null&&(Ei(ze)&&(ze=Ue(ze,Ce+(ze.key==null||yt&&yt.key===ze.key?"":(""+ze.key).replace(zi,"$&/")+"/")+Se)),Wt.push(ze)),1;Se=0;var rn=xe===""?".":xe+":";if(Ne(yt))for(var xi=0;xi<yt.length;xi++)xe=yt[xi],Fe=rn+Pi(xe,xi),Se+=dn(xe,Wt,Ce,Fe,ze);else if(xi=ht(yt),typeof xi=="function")for(yt=xi.call(yt),xi=0;!(xe=yt.next()).done;)xe=xe.value,Fe=rn+Pi(xe,xi++),Se+=dn(xe,Wt,Ce,Fe,ze);else if(Fe==="object"){if(typeof yt.then=="function")return dn(Rn(yt),Wt,Ce,xe,ze);throw Wt=String(yt),Error("Objects are not valid as a React child (found: "+(Wt==="[object Object]"?"object with keys {"+Object.keys(yt).join(", ")+"}":Wt)+"). If you meant to render a collection of children, use an array instead.")}return Se}function Qt(yt,Wt,Ce){if(yt==null)return yt;var xe=[],ze=0;return dn(yt,xe,"","",function(Fe){return Wt.call(Ce,Fe,ze++)}),xe}function me(yt){if(yt._status===-1){var Wt=yt._result;Wt=Wt(),Wt.then(function(Ce){(yt._status===0||yt._status===-1)&&(yt._status=1,yt._result=Ce)},function(Ce){(yt._status===0||yt._status===-1)&&(yt._status=2,yt._result=Ce)}),yt._status===-1&&(yt._status=0,yt._result=Wt)}if(yt._status===1)return yt._result.default;throw yt._result}var fe=typeof reportError=="function"?reportError:function(yt){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Wt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof yt=="object"&&yt!==null&&typeof yt.message=="string"?String(yt.message):String(yt),error:yt});if(!window.dispatchEvent(Wt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",yt);return}console.error(yt)};function Ze(){}return Ii.Children={map:Qt,forEach:function(yt,Wt,Ce){Qt(yt,function(){Wt.apply(this,arguments)},Ce)},count:function(yt){var Wt=0;return Qt(yt,function(){Wt++}),Wt},toArray:function(yt){return Qt(yt,function(Wt){return Wt})||[]},only:function(yt){if(!Ei(yt))throw Error("React.Children.only expected to receive a single React element child.");return yt}},Ii.Component=pe,Ii.Fragment=w,Ii.Profiler=I,Ii.PureComponent=de,Ii.StrictMode=M,Ii.Suspense=H,Ii.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=we,Ii.__COMPILER_RUNTIME={__proto__:null,c:function(yt){return we.H.useMemoCache(yt)}},Ii.cache=function(yt){return function(){return yt.apply(null,arguments)}},Ii.cloneElement=function(yt,Wt,Ce){if(yt==null)throw Error("The argument must be a React element, but you passed "+yt+".");var xe=Yt({},yt.props),ze=yt.key,Fe=void 0;if(Wt!=null)for(Se in Wt.ref!==void 0&&(Fe=void 0),Wt.key!==void 0&&(ze=""+Wt.key),Wt)!Ve.call(Wt,Se)||Se==="key"||Se==="__self"||Se==="__source"||Se==="ref"&&Wt.ref===void 0||(xe[Se]=Wt[Se]);var Se=arguments.length-2;if(Se===1)xe.children=Ce;else if(1<Se){for(var rn=Array(Se),xi=0;xi<Se;xi++)rn[xi]=arguments[xi+2];xe.children=rn}return Je(yt.type,ze,void 0,void 0,Fe,xe)},Ii.createContext=function(yt){return yt={$$typeof:P,_currentValue:yt,_currentValue2:yt,_threadCount:0,Provider:null,Consumer:null},yt.Provider=yt,yt.Consumer={$$typeof:F,_context:yt},yt},Ii.createElement=function(yt,Wt,Ce){var xe,ze={},Fe=null;if(Wt!=null)for(xe in Wt.key!==void 0&&(Fe=""+Wt.key),Wt)Ve.call(Wt,xe)&&xe!=="key"&&xe!=="__self"&&xe!=="__source"&&(ze[xe]=Wt[xe]);var Se=arguments.length-2;if(Se===1)ze.children=Ce;else if(1<Se){for(var rn=Array(Se),xi=0;xi<Se;xi++)rn[xi]=arguments[xi+2];ze.children=rn}if(yt&&yt.defaultProps)for(xe in Se=yt.defaultProps,Se)ze[xe]===void 0&&(ze[xe]=Se[xe]);return Je(yt,Fe,void 0,void 0,null,ze)},Ii.createRef=function(){return{current:null}},Ii.forwardRef=function(yt){return{$$typeof:u,render:yt}},Ii.isValidElement=Ei,Ii.lazy=function(yt){return{$$typeof:Q,_payload:{_status:-1,_result:yt},_init:me}},Ii.memo=function(yt,Wt){return{$$typeof:X,type:yt,compare:Wt===void 0?null:Wt}},Ii.startTransition=function(yt){var Wt=we.T,Ce={};we.T=Ce;try{var xe=yt(),ze=we.S;ze!==null&&ze(Ce,xe),typeof xe=="object"&&xe!==null&&typeof xe.then=="function"&&xe.then(Ze,fe)}catch(Fe){fe(Fe)}finally{we.T=Wt}},Ii.unstable_useCacheRefresh=function(){return we.H.useCacheRefresh()},Ii.use=function(yt){return we.H.use(yt)},Ii.useActionState=function(yt,Wt,Ce){return we.H.useActionState(yt,Wt,Ce)},Ii.useCallback=function(yt,Wt){return we.H.useCallback(yt,Wt)},Ii.useContext=function(yt){return we.H.useContext(yt)},Ii.useDebugValue=function(){},Ii.useDeferredValue=function(yt,Wt){return we.H.useDeferredValue(yt,Wt)},Ii.useEffect=function(yt,Wt,Ce){var xe=we.H;if(typeof Ce=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return xe.useEffect(yt,Wt)},Ii.useId=function(){return we.H.useId()},Ii.useImperativeHandle=function(yt,Wt,Ce){return we.H.useImperativeHandle(yt,Wt,Ce)},Ii.useInsertionEffect=function(yt,Wt){return we.H.useInsertionEffect(yt,Wt)},Ii.useLayoutEffect=function(yt,Wt){return we.H.useLayoutEffect(yt,Wt)},Ii.useMemo=function(yt,Wt){return we.H.useMemo(yt,Wt)},Ii.useOptimistic=function(yt,Wt){return we.H.useOptimistic(yt,Wt)},Ii.useReducer=function(yt,Wt,Ce){return we.H.useReducer(yt,Wt,Ce)},Ii.useRef=function(yt){return we.H.useRef(yt)},Ii.useState=function(yt){return we.H.useState(yt)},Ii.useSyncExternalStore=function(yt,Wt,Ce){return we.H.useSyncExternalStore(yt,Wt,Ce)},Ii.useTransition=function(){return we.H.useTransition()},Ii.version="19.1.1",Ii}var Xg;function ng(){return Xg||(Xg=1,c_.exports=x3()),c_.exports}var u_={exports:{}},Za={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yg;function b3(){if(Yg)return Za;Yg=1;var p=ng();function m(H){var X="https://react.dev/errors/"+H;if(1<arguments.length){X+="?args[]="+encodeURIComponent(arguments[1]);for(var Q=2;Q<arguments.length;Q++)X+="&args[]="+encodeURIComponent(arguments[Q])}return"Minified React error #"+H+"; visit "+X+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function w(){}var M={d:{f:w,r:function(){throw Error(m(522))},D:w,C:w,L:w,m:w,X:w,S:w,M:w},p:0,findDOMNode:null},I=Symbol.for("react.portal");function F(H,X,Q){var dt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:I,key:dt==null?null:""+dt,children:H,containerInfo:X,implementation:Q}}var P=p.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(H,X){if(H==="font")return"";if(typeof X=="string")return X==="use-credentials"?X:""}return Za.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,Za.createPortal=function(H,X){var Q=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!X||X.nodeType!==1&&X.nodeType!==9&&X.nodeType!==11)throw Error(m(299));return F(H,X,null,Q)},Za.flushSync=function(H){var X=P.T,Q=M.p;try{if(P.T=null,M.p=2,H)return H()}finally{P.T=X,M.p=Q,M.d.f()}},Za.preconnect=function(H,X){typeof H=="string"&&(X?(X=X.crossOrigin,X=typeof X=="string"?X==="use-credentials"?X:"":void 0):X=null,M.d.C(H,X))},Za.prefetchDNS=function(H){typeof H=="string"&&M.d.D(H)},Za.preinit=function(H,X){if(typeof H=="string"&&X&&typeof X.as=="string"){var Q=X.as,dt=u(Q,X.crossOrigin),ht=typeof X.integrity=="string"?X.integrity:void 0,lt=typeof X.fetchPriority=="string"?X.fetchPriority:void 0;Q==="style"?M.d.S(H,typeof X.precedence=="string"?X.precedence:void 0,{crossOrigin:dt,integrity:ht,fetchPriority:lt}):Q==="script"&&M.d.X(H,{crossOrigin:dt,integrity:ht,fetchPriority:lt,nonce:typeof X.nonce=="string"?X.nonce:void 0})}},Za.preinitModule=function(H,X){if(typeof H=="string")if(typeof X=="object"&&X!==null){if(X.as==null||X.as==="script"){var Q=u(X.as,X.crossOrigin);M.d.M(H,{crossOrigin:Q,integrity:typeof X.integrity=="string"?X.integrity:void 0,nonce:typeof X.nonce=="string"?X.nonce:void 0})}}else X==null&&M.d.M(H)},Za.preload=function(H,X){if(typeof H=="string"&&typeof X=="object"&&X!==null&&typeof X.as=="string"){var Q=X.as,dt=u(Q,X.crossOrigin);M.d.L(H,Q,{crossOrigin:dt,integrity:typeof X.integrity=="string"?X.integrity:void 0,nonce:typeof X.nonce=="string"?X.nonce:void 0,type:typeof X.type=="string"?X.type:void 0,fetchPriority:typeof X.fetchPriority=="string"?X.fetchPriority:void 0,referrerPolicy:typeof X.referrerPolicy=="string"?X.referrerPolicy:void 0,imageSrcSet:typeof X.imageSrcSet=="string"?X.imageSrcSet:void 0,imageSizes:typeof X.imageSizes=="string"?X.imageSizes:void 0,media:typeof X.media=="string"?X.media:void 0})}},Za.preloadModule=function(H,X){if(typeof H=="string")if(X){var Q=u(X.as,X.crossOrigin);M.d.m(H,{as:typeof X.as=="string"&&X.as!=="script"?X.as:void 0,crossOrigin:Q,integrity:typeof X.integrity=="string"?X.integrity:void 0})}else M.d.m(H)},Za.requestFormReset=function(H){M.d.r(H)},Za.unstable_batchedUpdates=function(H,X){return H(X)},Za.useFormState=function(H,X,Q){return P.H.useFormState(H,X,Q)},Za.useFormStatus=function(){return P.H.useHostTransitionStatus()},Za.version="19.1.1",Za}var Wg;function S0(){if(Wg)return u_.exports;Wg=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(m){console.error(m)}}return p(),u_.exports=b3(),u_.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kg;function w3(){if(Kg)return mp;Kg=1;var p=v3(),m=ng(),w=S0();function M(i){var a="https://react.dev/errors/"+i;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)a+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+i+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function I(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function F(i){var a=i,h=i;if(i.alternate)for(;a.return;)a=a.return;else{i=a;do a=i,(a.flags&4098)!==0&&(h=a.return),i=a.return;while(i)}return a.tag===3?h:null}function P(i){if(i.tag===13){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function u(i){if(F(i)!==i)throw Error(M(188))}function H(i){var a=i.alternate;if(!a){if(a=F(i),a===null)throw Error(M(188));return a!==i?null:i}for(var h=i,v=a;;){var C=h.return;if(C===null)break;var R=C.alternate;if(R===null){if(v=C.return,v!==null){h=v;continue}break}if(C.child===R.child){for(R=C.child;R;){if(R===h)return u(C),i;if(R===v)return u(C),a;R=R.sibling}throw Error(M(188))}if(h.return!==v.return)h=C,v=R;else{for(var Y=!1,rt=C.child;rt;){if(rt===h){Y=!0,h=C,v=R;break}if(rt===v){Y=!0,v=C,h=R;break}rt=rt.sibling}if(!Y){for(rt=R.child;rt;){if(rt===h){Y=!0,h=R,v=C;break}if(rt===v){Y=!0,v=R,h=C;break}rt=rt.sibling}if(!Y)throw Error(M(189))}}if(h.alternate!==v)throw Error(M(190))}if(h.tag!==3)throw Error(M(188));return h.stateNode.current===h?i:a}function X(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i;for(i=i.child;i!==null;){if(a=X(i),a!==null)return a;i=i.sibling}return null}var Q=Object.assign,dt=Symbol.for("react.element"),ht=Symbol.for("react.transitional.element"),lt=Symbol.for("react.portal"),Yt=Symbol.for("react.fragment"),Jt=Symbol.for("react.strict_mode"),pe=Symbol.for("react.profiler"),ge=Symbol.for("react.provider"),de=Symbol.for("react.consumer"),ne=Symbol.for("react.context"),Ne=Symbol.for("react.forward_ref"),we=Symbol.for("react.suspense"),Ve=Symbol.for("react.suspense_list"),Je=Symbol.for("react.memo"),Ue=Symbol.for("react.lazy"),Ei=Symbol.for("react.activity"),Ti=Symbol.for("react.memo_cache_sentinel"),zi=Symbol.iterator;function Pi(i){return i===null||typeof i!="object"?null:(i=zi&&i[zi]||i["@@iterator"],typeof i=="function"?i:null)}var Ir=Symbol.for("react.client.reference");function Rn(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Ir?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Yt:return"Fragment";case pe:return"Profiler";case Jt:return"StrictMode";case we:return"Suspense";case Ve:return"SuspenseList";case Ei:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case lt:return"Portal";case ne:return(i.displayName||"Context")+".Provider";case de:return(i._context.displayName||"Context")+".Consumer";case Ne:var a=i.render;return i=i.displayName,i||(i=a.displayName||a.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Je:return a=i.displayName||null,a!==null?a:Rn(i.type)||"Memo";case Ue:a=i._payload,i=i._init;try{return Rn(i(a))}catch{}}return null}var dn=Array.isArray,Qt=m.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me=w.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe={pending:!1,data:null,method:null,action:null},Ze=[],yt=-1;function Wt(i){return{current:i}}function Ce(i){0>yt||(i.current=Ze[yt],Ze[yt]=null,yt--)}function xe(i,a){yt++,Ze[yt]=i.current,i.current=a}var ze=Wt(null),Fe=Wt(null),Se=Wt(null),rn=Wt(null);function xi(i,a){switch(xe(Se,a),xe(Fe,i),xe(ze,null),a.nodeType){case 9:case 11:i=(i=a.documentElement)&&(i=i.namespaceURI)?gm(i):0;break;default:if(i=a.tagName,a=a.namespaceURI)a=gm(a),i=rp(a,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}Ce(ze),xe(ze,i)}function rr(){Ce(ze),Ce(Fe),Ce(Se)}function da(i){i.memoizedState!==null&&xe(rn,i);var a=ze.current,h=rp(a,i.type);a!==h&&(xe(Fe,i),xe(ze,h))}function Ws(i){Fe.current===i&&(Ce(ze),Ce(Fe)),rn.current===i&&(Ce(rn),Dt._currentValue=fe)}var sr=Object.prototype.hasOwnProperty,sn=p.unstable_scheduleCallback,An=p.unstable_cancelCallback,Os=p.unstable_shouldYield,Ks=p.unstable_requestPaint,dr=p.unstable_now,ys=p.unstable_getCurrentPriorityLevel,Qs=p.unstable_ImmediatePriority,vo=p.unstable_UserBlockingPriority,vs=p.unstable_NormalPriority,Ha=p.unstable_LowPriority,fa=p.unstable_IdlePriority,Go=p.log,xo=p.unstable_setDisableYieldValue,ts=null,Vn=null;function es(i){if(typeof Go=="function"&&xo(i),Vn&&typeof Vn.setStrictMode=="function")try{Vn.setStrictMode(ts,i)}catch{}}var Ct=Math.clz32?Math.clz32:st,tt=Math.log,it=Math.LN2;function st(i){return i>>>=0,i===0?32:31-(tt(i)/it|0)|0}var _t=256,Pt=4194304;function Et(i){var a=i&42;if(a!==0)return a;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Ft(i,a,h){var v=i.pendingLanes;if(v===0)return 0;var C=0,R=i.suspendedLanes,Y=i.pingedLanes;i=i.warmLanes;var rt=v&134217727;return rt!==0?(v=rt&~R,v!==0?C=Et(v):(Y&=rt,Y!==0?C=Et(Y):h||(h=rt&~i,h!==0&&(C=Et(h))))):(rt=v&~R,rt!==0?C=Et(rt):Y!==0?C=Et(Y):h||(h=v&~i,h!==0&&(C=Et(h)))),C===0?0:a!==0&&a!==C&&(a&R)===0&&(R=C&-C,h=a&-a,R>=h||R===32&&(h&4194048)!==0)?a:C}function zt(i,a){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&a)===0}function Kt(i,a){switch(i){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oe(){var i=_t;return _t<<=1,(_t&4194048)===0&&(_t=256),i}function ee(){var i=Pt;return Pt<<=1,(Pt&62914560)===0&&(Pt=4194304),i}function Le(i){for(var a=[],h=0;31>h;h++)a.push(i);return a}function It(i,a){i.pendingLanes|=a,a!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function ri(i,a,h,v,C,R){var Y=i.pendingLanes;i.pendingLanes=h,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=h,i.entangledLanes&=h,i.errorRecoveryDisabledLanes&=h,i.shellSuspendCounter=0;var rt=i.entanglements,St=i.expirationTimes,Zt=i.hiddenUpdates;for(h=Y&~h;0<h;){var ie=31-Ct(h),le=1<<ie;rt[ie]=0,St[ie]=-1;var Ht=Zt[ie];if(Ht!==null)for(Zt[ie]=null,ie=0;ie<Ht.length;ie++){var Xt=Ht[ie];Xt!==null&&(Xt.lane&=-536870913)}h&=~le}v!==0&&bi(i,v,0),R!==0&&C===0&&i.tag!==0&&(i.suspendedLanes|=R&~(Y&~a))}function bi(i,a,h){i.pendingLanes|=a,i.suspendedLanes&=~a;var v=31-Ct(a);i.entangledLanes|=a,i.entanglements[v]=i.entanglements[v]|1073741824|h&4194090}function Ge(i,a){var h=i.entangledLanes|=a;for(i=i.entanglements;h;){var v=31-Ct(h),C=1<<v;C&a|i[v]&a&&(i[v]|=a),h&=~C}}function li(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Zi(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function qn(){var i=me.p;return i!==0?i:(i=window.event,i===void 0?32:We(i.type))}function Un(i,a){var h=me.p;try{return me.p=i,a()}finally{me.p=h}}var $i=Math.random().toString(36).slice(2),ii="__reactFiber$"+$i,si="__reactProps$"+$i,fn="__reactContainer$"+$i,ue="__reactEvents$"+$i,Ie="__reactListeners$"+$i,vn="__reactHandles$"+$i,pa="__reactResources$"+$i,Js="__reactMarker$"+$i;function Me(i){delete i[ii],delete i[si],delete i[ue],delete i[Ie],delete i[vn]}function ci(i){var a=i[ii];if(a)return a;for(var h=i.parentNode;h;){if(a=h[fn]||h[ii]){if(h=a.alternate,a.child!==null||h!==null&&h.child!==null)for(i=Zu(i);i!==null;){if(h=i[ii])return h;i=Zu(i)}return a}i=h,h=i.parentNode}return null}function ai(i){if(i=i[ii]||i[fn]){var a=i.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return i}return null}function an(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i.stateNode;throw Error(M(33))}function xs(i){var a=i[pa];return a||(a=i[pa]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function pn(i){i[Js]=!0}var hi=new Set,Jl={};function is(i,a){ma(i,a),ma(i+"Capture",a)}function ma(i,a){for(Jl[i]=a,i=0;i<a.length;i++)hi.add(a[i])}var _a=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ga={},Cn={};function Rc(i){return sr.call(Cn,i)?!0:sr.call(ga,i)?!1:_a.test(i)?Cn[i]=!0:(ga[i]=!0,!1)}function wr(i,a,h){if(Rc(a))if(h===null)i.removeAttribute(a);else{switch(typeof h){case"undefined":case"function":case"symbol":i.removeAttribute(a);return;case"boolean":var v=a.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){i.removeAttribute(a);return}}i.setAttribute(a,""+h)}}function Vi(i,a,h){if(h===null)i.removeAttribute(a);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(a);return}i.setAttribute(a,""+h)}}function ya(i,a,h,v){if(v===null)i.removeAttribute(h);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(h);return}i.setAttributeNS(a,h,""+v)}}var qa,bo;function ns(i){if(qa===void 0)try{throw Error()}catch(h){var a=h.stack.trim().match(/\n( *(at )?)/);qa=a&&a[1]||"",bo=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+qa+i+bo}var ta=!1;function $a(i,a){if(!i||ta)return"";ta=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(a){var le=function(){throw Error()};if(Object.defineProperty(le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(le,[])}catch(Xt){var Ht=Xt}Reflect.construct(i,[],le)}else{try{le.call()}catch(Xt){Ht=Xt}i.call(le.prototype)}}else{try{throw Error()}catch(Xt){Ht=Xt}(le=i())&&typeof le.catch=="function"&&le.catch(function(){})}}catch(Xt){if(Xt&&Ht&&typeof Xt.stack=="string")return[Xt.stack,Ht.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var C=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");C&&C.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var R=v.DetermineComponentFrameRoot(),Y=R[0],rt=R[1];if(Y&&rt){var St=Y.split(`
`),Zt=rt.split(`
`);for(C=v=0;v<St.length&&!St[v].includes("DetermineComponentFrameRoot");)v++;for(;C<Zt.length&&!Zt[C].includes("DetermineComponentFrameRoot");)C++;if(v===St.length||C===Zt.length)for(v=St.length-1,C=Zt.length-1;1<=v&&0<=C&&St[v]!==Zt[C];)C--;for(;1<=v&&0<=C;v--,C--)if(St[v]!==Zt[C]){if(v!==1||C!==1)do if(v--,C--,0>C||St[v]!==Zt[C]){var ie=`
`+St[v].replace(" at new "," at ");return i.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",i.displayName)),ie}while(1<=v&&0<=C);break}}}finally{ta=!1,Error.prepareStackTrace=h}return(h=i?i.displayName||i.name:"")?ns(h):""}function Oi(i){switch(i.tag){case 26:case 27:case 5:return ns(i.type);case 16:return ns("Lazy");case 13:return ns("Suspense");case 19:return ns("SuspenseList");case 0:case 15:return $a(i.type,!1);case 11:return $a(i.type.render,!1);case 1:return $a(i.type,!0);case 31:return ns("Activity");default:return""}}function mn(i){try{var a="";do a+=Oi(i),i=i.return;while(i);return a}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function $n(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function wo(i){var a=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function _l(i){var a=wo(i)?"checked":"value",h=Object.getOwnPropertyDescriptor(i.constructor.prototype,a),v=""+i[a];if(!i.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var C=h.get,R=h.set;return Object.defineProperty(i,a,{configurable:!0,get:function(){return C.call(this)},set:function(Y){v=""+Y,R.call(this,Y)}}),Object.defineProperty(i,a,{enumerable:h.enumerable}),{getValue:function(){return v},setValue:function(Y){v=""+Y},stopTracking:function(){i._valueTracker=null,delete i[a]}}}}function gl(i){i._valueTracker||(i._valueTracker=_l(i))}function Si(i){if(!i)return!1;var a=i._valueTracker;if(!a)return!0;var h=a.getValue(),v="";return i&&(v=wo(i)?i.checked?"true":"false":i.value),i=v,i!==h?(a.setValue(i),!0):!1}function on(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var To=/[\n"\\]/g;function Tr(i){return i.replace(To,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Rr(i,a,h,v,C,R,Y,rt){i.name="",Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"?i.type=Y:i.removeAttribute("type"),a!=null?Y==="number"?(a===0&&i.value===""||i.value!=a)&&(i.value=""+$n(a)):i.value!==""+$n(a)&&(i.value=""+$n(a)):Y!=="submit"&&Y!=="reset"||i.removeAttribute("value"),a!=null?So(i,Y,$n(a)):h!=null?So(i,Y,$n(h)):v!=null&&i.removeAttribute("value"),C==null&&R!=null&&(i.defaultChecked=!!R),C!=null&&(i.checked=C&&typeof C!="function"&&typeof C!="symbol"),rt!=null&&typeof rt!="function"&&typeof rt!="symbol"&&typeof rt!="boolean"?i.name=""+$n(rt):i.removeAttribute("name")}function Ho(i,a,h,v,C,R,Y,rt){if(R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(i.type=R),a!=null||h!=null){if(!(R!=="submit"&&R!=="reset"||a!=null))return;h=h!=null?""+$n(h):"",a=a!=null?""+$n(a):h,rt||a===i.value||(i.value=a),i.defaultValue=a}v=v??C,v=typeof v!="function"&&typeof v!="symbol"&&!!v,i.checked=rt?i.checked:!!v,i.defaultChecked=!!v,Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"&&(i.name=Y)}function So(i,a,h){a==="number"&&on(i.ownerDocument)===i||i.defaultValue===""+h||(i.defaultValue=""+h)}function rs(i,a,h,v){if(i=i.options,a){a={};for(var C=0;C<h.length;C++)a["$"+h[C]]=!0;for(h=0;h<i.length;h++)C=a.hasOwnProperty("$"+i[h].value),i[h].selected!==C&&(i[h].selected=C),C&&v&&(i[h].defaultSelected=!0)}else{for(h=""+$n(h),a=null,C=0;C<i.length;C++){if(i[C].value===h){i[C].selected=!0,v&&(i[C].defaultSelected=!0);return}a!==null||i[C].disabled||(a=i[C])}a!==null&&(a.selected=!0)}}function Zn(i,a,h){if(a!=null&&(a=""+$n(a),a!==i.value&&(i.value=a),h==null)){i.defaultValue!==a&&(i.defaultValue=a);return}i.defaultValue=h!=null?""+$n(h):""}function bs(i,a,h,v){if(a==null){if(v!=null){if(h!=null)throw Error(M(92));if(dn(v)){if(1<v.length)throw Error(M(93));v=v[0]}h=v}h==null&&(h=""),a=h}h=$n(a),i.defaultValue=h,v=i.textContent,v===h&&v!==""&&v!==null&&(i.value=v)}function ss(i,a){if(a){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=a;return}}i.textContent=a}var Ur=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function gi(i,a,h){var v=a.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?v?i.setProperty(a,""):a==="float"?i.cssFloat="":i[a]="":v?i.setProperty(a,h):typeof h!="number"||h===0||Ur.has(a)?a==="float"?i.cssFloat=h:i[a]=(""+h).trim():i[a]=h+"px"}function Ns(i,a,h){if(a!=null&&typeof a!="object")throw Error(M(62));if(i=i.style,h!=null){for(var v in h)!h.hasOwnProperty(v)||a!=null&&a.hasOwnProperty(v)||(v.indexOf("--")===0?i.setProperty(v,""):v==="float"?i.cssFloat="":i[v]="");for(var C in a)v=a[C],a.hasOwnProperty(C)&&h[C]!==v&&gi(i,C,v)}else for(var R in a)a.hasOwnProperty(R)&&gi(i,R,a[R])}function js(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ea=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),va=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function di(i){return va.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var ia=null;function Xa(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var xa=null,kn=null;function ar(i){var a=ai(i);if(a&&(i=a.stateNode)){var h=i[si]||null;t:switch(i=a.stateNode,a.type){case"input":if(Rr(i,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),a=h.name,h.type==="radio"&&a!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Tr(""+a)+'"][type="radio"]'),a=0;a<h.length;a++){var v=h[a];if(v!==i&&v.form===i.form){var C=v[si]||null;if(!C)throw Error(M(90));Rr(v,C.value,C.defaultValue,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name)}}for(a=0;a<h.length;a++)v=h[a],v.form===i.form&&Si(v)}break t;case"textarea":Zn(i,h.value,h.defaultValue);break t;case"select":a=h.value,a!=null&&rs(i,!!h.multiple,a,!1)}}}var Qe=!1;function Ui(i,a,h){if(Qe)return i(a,h);Qe=!0;try{var v=i(a);return v}finally{if(Qe=!1,(xa!==null||kn!==null)&&($d(),xa&&(a=xa,i=kn,kn=xa=null,ar(a),i)))for(a=0;a<i.length;a++)ar(i[a])}}function ti(i,a){var h=i.stateNode;if(h===null)return null;var v=h[si]||null;if(v===null)return null;h=v[a];t:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(i=i.type,v=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!v;break t;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(M(231,a,typeof h));return h}var na=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),or=!1;if(na)try{var lr={};Object.defineProperty(lr,"passive",{get:function(){or=!0}}),window.addEventListener("test",lr,lr),window.removeEventListener("test",lr,lr)}catch{or=!1}var _n=null,Ri=null,Fs=null;function Ye(){if(Fs)return Fs;var i,a=Ri,h=a.length,v,C="value"in _n?_n.value:_n.textContent,R=C.length;for(i=0;i<h&&a[i]===C[i];i++);var Y=h-i;for(v=1;v<=Y&&a[h-v]===C[R-v];v++);return Fs=C.slice(i,1<v?1-v:void 0)}function je(i){var a=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&a===13&&(i=13)):i=a,i===10&&(i=13),32<=i||i===13?i:0}function fr(){return!0}function Ai(){return!1}function Ji(i){function a(h,v,C,R,Y){this._reactName=h,this._targetInst=C,this.type=v,this.nativeEvent=R,this.target=Y,this.currentTarget=null;for(var rt in i)i.hasOwnProperty(rt)&&(h=i[rt],this[rt]=h?h(R):R[rt]);return this.isDefaultPrevented=(R.defaultPrevented!=null?R.defaultPrevented:R.returnValue===!1)?fr:Ai,this.isPropagationStopped=Ai,this}return Q(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=fr)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=fr)},persist:function(){},isPersistent:fr}),a}var kr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},as=Ji(kr),ba=Q({},kr,{view:0,detail:0}),pu=Ji(ba),Ya,Mi,Mo,Sr=Q({},ba,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Co,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Mo&&(Mo&&i.type==="mousemove"?(Ya=i.screenX-Mo.screenX,Mi=i.screenY-Mo.screenY):Mi=Ya=0,Mo=i),Ya)},movementY:function(i){return"movementY"in i?i.movementY:Mi}}),Wa=Ji(Sr),Vs=Q({},Sr,{dataTransfer:0}),pr=Ji(Vs),Po=Q({},ba,{relatedTarget:0}),qo=Ji(Po),Ao=Q({},kr,{animationName:0,elapsedTime:0,pseudoElement:0}),Bn=Ji(Ao),Xu=Q({},kr,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),$o=Ji(Xu),mu=Q({},kr,{data:0}),ra=Ji(mu),yl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Us={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sa(i){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(i):(i=Us[i])?!!a[i]:!1}function Co(){return sa}var Xo=Q({},ba,{key:function(i){if(i.key){var a=yl[i.key]||i.key;if(a!=="Unidentified")return a}return i.type==="keypress"?(i=je(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?mr[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Co,charCode:function(i){return i.type==="keypress"?je(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?je(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),tc=Ji(Xo),Mr=Q({},Sr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kc=Ji(Mr),Bc=Q({},ba,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Co}),Ih=Ji(Bc),ec=Q({},kr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rh=Ji(ec),Yu=Q({},Sr,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),ic=Ji(Yu),vl=Q({},kr,{newState:0,oldState:0}),ws=Ji(vl),_u=[9,13,27,32],wa=na&&"CompositionEvent"in window,ln=null;na&&"documentMode"in document&&(ln=document.documentMode);var Wu=na&&"TextEvent"in window&&!ln,xl=na&&(!wa||ln&&8<ln&&11>=ln),bl=" ",Eo=!1;function Oc(i,a){switch(i){case"keyup":return _u.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nc(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var wl=!1;function zo(i,a){switch(i){case"compositionend":return nc(a);case"keypress":return a.which!==32?null:(Eo=!0,bl);case"textInput":return i=a.data,i===bl&&Eo?null:i;default:return null}}function Ku(i,a){if(wl)return i==="compositionend"||!wa&&Oc(i,a)?(i=Ye(),Fs=Ri=_n=null,wl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return xl&&a.locale!=="ko"?null:a.data;default:return null}}var Ts={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yo(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a==="input"?!!Ts[i.type]:a==="textarea"}function gu(i,a,h,v){xa?kn?kn.push(v):kn=[v]:xa=v,a=ld(a,"onChange"),0<a.length&&(h=new as("onChange","change",null,h,v),i.push({event:h,listeners:a}))}var Zr=null,Tl=null;function Ka(i){pm(i,0)}function rc(i){var a=an(i);if(Si(a))return i}function Wo(i,a){if(i==="change")return a}var Qa=!1;if(na){var Do;if(na){var sc="oninput"in document;if(!sc){var Ss=document.createElement("div");Ss.setAttribute("oninput","return;"),sc=typeof Ss.oninput=="function"}Do=sc}else Do=!1;Qa=Do&&(!document.documentMode||9<document.documentMode)}function ac(){Zr&&(Zr.detachEvent("onpropertychange",Sl),Tl=Zr=null)}function Sl(i){if(i.propertyName==="value"&&rc(Tl)){var a=[];gu(a,Tl,i,Xa(i)),Ui(Ka,a)}}function Nc(i,a,h){i==="focusin"?(ac(),Zr=a,Tl=h,Zr.attachEvent("onpropertychange",Sl)):i==="focusout"&&ac()}function kh(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return rc(Tl)}function Ta(i,a){if(i==="click")return rc(a)}function Qu(i,a){if(i==="input"||i==="change")return rc(a)}function Lo(i,a){return i===a&&(i!==0||1/i===1/a)||i!==i&&a!==a}var Gr=typeof Object.is=="function"?Object.is:Lo;function os(i,a){if(Gr(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;var h=Object.keys(i),v=Object.keys(a);if(h.length!==v.length)return!1;for(v=0;v<h.length;v++){var C=h[v];if(!sr.call(a,C)||!Gr(i[C],a[C]))return!1}return!0}function Io(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function aa(i,a){var h=Io(i);i=0;for(var v;h;){if(h.nodeType===3){if(v=i+h.textContent.length,i<=a&&v>=a)return{node:h,offset:a-i};i=v}t:{for(;h;){if(h.nextSibling){h=h.nextSibling;break t}h=h.parentNode}h=void 0}h=Io(h)}}function Li(i,a){return i&&a?i===a?!0:i&&i.nodeType===3?!1:a&&a.nodeType===3?Li(i,a.parentNode):"contains"in i?i.contains(a):i.compareDocumentPosition?!!(i.compareDocumentPosition(a)&16):!1:!1}function Ko(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var a=on(i.document);a instanceof i.HTMLIFrameElement;){try{var h=typeof a.contentWindow.location.href=="string"}catch{h=!1}if(h)i=a.contentWindow;else break;a=on(i.document)}return a}function Qo(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a&&(a==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||a==="textarea"||i.contentEditable==="true")}var oc=na&&"documentMode"in document&&11>=document.documentMode,Ms=null,Zs=null,Ja=null,jc=!1;function Ju(i,a,h){var v=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;jc||Ms==null||Ms!==on(v)||(v=Ms,"selectionStart"in v&&Qo(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),Ja&&os(Ja,v)||(Ja=v,v=ld(Zs,"onSelect"),0<v.length&&(a=new as("onSelect","select",null,a,h),i.push({event:a,listeners:v}),a.target=Ms)))}function Sa(i,a){var h={};return h[i.toLowerCase()]=a.toLowerCase(),h["Webkit"+i]="webkit"+a,h["Moz"+i]="moz"+a,h}var Ml={animationend:Sa("Animation","AnimationEnd"),animationiteration:Sa("Animation","AnimationIteration"),animationstart:Sa("Animation","AnimationStart"),transitionrun:Sa("Transition","TransitionRun"),transitionstart:Sa("Transition","TransitionStart"),transitioncancel:Sa("Transition","TransitionCancel"),transitionend:Sa("Transition","TransitionEnd")},lc={},th={};na&&(th=document.createElement("div").style,"AnimationEvent"in window||(delete Ml.animationend.animation,delete Ml.animationiteration.animation,delete Ml.animationstart.animation),"TransitionEvent"in window||delete Ml.transitionend.transition);function to(i){if(lc[i])return lc[i];if(!Ml[i])return i;var a=Ml[i],h;for(h in a)if(a.hasOwnProperty(h)&&h in th)return lc[i]=a[h];return i}var cc=to("animationend"),ls=to("animationiteration"),Ro=to("animationstart"),yu=to("transitionrun"),Ma=to("transitionstart"),uc=to("transitioncancel"),ko=to("transitionend"),Ps=new Map,Bo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Bo.push("scrollEnd");function Gs(i,a){Ps.set(i,a),is(a,[i])}var eo=new WeakMap;function cr(i,a){if(typeof i=="object"&&i!==null){var h=eo.get(i);return h!==void 0?h:(a={value:i,source:a,stack:mn(a)},eo.set(i,a),a)}return{value:i,source:a,stack:mn(a)}}var Br=[],io=0,Hr=0;function Oo(){for(var i=io,a=Hr=io=0;a<i;){var h=Br[a];Br[a++]=null;var v=Br[a];Br[a++]=null;var C=Br[a];Br[a++]=null;var R=Br[a];if(Br[a++]=null,v!==null&&C!==null){var Y=v.pending;Y===null?C.next=C:(C.next=Y.next,Y.next=C),v.pending=C}R!==0&&Al(h,C,R)}}function Pl(i,a,h,v){Br[io++]=i,Br[io++]=a,Br[io++]=h,Br[io++]=v,Hr|=v,i.lanes|=v,i=i.alternate,i!==null&&(i.lanes|=v)}function Hs(i,a,h,v){return Pl(i,a,h,v),Pa(i)}function As(i,a){return Pl(i,null,null,a),Pa(i)}function Al(i,a,h){i.lanes|=h;var v=i.alternate;v!==null&&(v.lanes|=h);for(var C=!1,R=i.return;R!==null;)R.childLanes|=h,v=R.alternate,v!==null&&(v.childLanes|=h),R.tag===22&&(i=R.stateNode,i===null||i._visibility&1||(C=!0)),i=R,R=R.return;return i.tag===3?(R=i.stateNode,C&&a!==null&&(C=31-Ct(h),i=R.hiddenUpdates,v=i[C],v===null?i[C]=[a]:v.push(a),a.lane=h|536870912),R):null}function Pa(i){if(50<Ou)throw Ou=0,su=null,Error(M(185));for(var a=i.return;a!==null;)i=a,a=i.return;return i.tag===3?i.stateNode:null}var fi={};function Cl(i,a,h,v){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cs(i,a,h,v){return new Cl(i,a,h,v)}function hc(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Pr(i,a){var h=i.alternate;return h===null?(h=Cs(i.tag,a,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=a,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&65011712,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,a=i.dependencies,h.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h.refCleanup=i.refCleanup,h}function Fc(i,a){i.flags&=65011714;var h=i.alternate;return h===null?(i.childLanes=0,i.lanes=a,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=h.childLanes,i.lanes=h.lanes,i.child=h.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=h.memoizedProps,i.memoizedState=h.memoizedState,i.updateQueue=h.updateQueue,i.type=h.type,a=h.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),i}function dc(i,a,h,v,C,R){var Y=0;if(v=i,typeof i=="function")hc(i)&&(Y=1);else if(typeof i=="string")Y=E(i,h,ze.current)?26:i==="html"||i==="head"||i==="body"?27:5;else t:switch(i){case Ei:return i=Cs(31,h,a,C),i.elementType=Ei,i.lanes=R,i;case Yt:return no(h.children,C,R,a);case Jt:Y=8,C|=24;break;case pe:return i=Cs(12,h,a,C|2),i.elementType=pe,i.lanes=R,i;case we:return i=Cs(13,h,a,C),i.elementType=we,i.lanes=R,i;case Ve:return i=Cs(19,h,a,C),i.elementType=Ve,i.lanes=R,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case ge:case ne:Y=10;break t;case de:Y=9;break t;case Ne:Y=11;break t;case Je:Y=14;break t;case Ue:Y=16,v=null;break t}Y=29,h=Error(M(130,i===null?"null":typeof i,"")),v=null}return a=Cs(Y,h,a,C),a.elementType=i,a.type=v,a.lanes=R,a}function no(i,a,h,v){return i=Cs(7,i,v,a),i.lanes=h,i}function vu(i,a,h){return i=Cs(6,i,null,a),i.lanes=h,i}function El(i,a,h){return a=Cs(4,i.children!==null?i.children:[],i.key,a),a.lanes=h,a.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},a}var Aa=[],Ca=0,o=null,_=0,A=[],B=0,G=null,nt=1,wt="";function Bt(i,a){Aa[Ca++]=_,Aa[Ca++]=o,o=i,_=a}function qt(i,a,h){A[B++]=nt,A[B++]=wt,A[B++]=G,G=i;var v=nt;i=wt;var C=32-Ct(v)-1;v&=~(1<<C),h+=1;var R=32-Ct(a)+C;if(30<R){var Y=C-C%5;R=(v&(1<<Y)-1).toString(32),v>>=Y,C-=Y,nt=1<<32-Ct(a)+C|h<<C|v,wt=R+i}else nt=1<<R|h<<C|v,wt=i}function he(i){i.return!==null&&(Bt(i,1),qt(i,1,0))}function De(i){for(;i===o;)o=Aa[--Ca],Aa[Ca]=null,_=Aa[--Ca],Aa[Ca]=null;for(;i===G;)G=A[--B],A[B]=null,wt=A[--B],A[B]=null,nt=A[--B],A[B]=null}var ke=null,$e=null,pi=!1,gn=null,xn=!1,_r=Error(M(519));function qs(i){var a=Error(M(418,""));throw Ea(cr(a,i)),_r}function Vc(i){var a=i.stateNode,h=i.type,v=i.memoizedProps;switch(a[ii]=i,a[si]=v,h){case"dialog":Fi("cancel",a),Fi("close",a);break;case"iframe":case"object":case"embed":Fi("load",a);break;case"video":case"audio":for(h=0;h<ad.length;h++)Fi(ad[h],a);break;case"source":Fi("error",a);break;case"img":case"image":case"link":Fi("error",a),Fi("load",a);break;case"details":Fi("toggle",a);break;case"input":Fi("invalid",a),Ho(a,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0),gl(a);break;case"select":Fi("invalid",a);break;case"textarea":Fi("invalid",a),bs(a,v.value,v.defaultValue,v.children),gl(a)}h=v.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||a.textContent===""+h||v.suppressHydrationWarning===!0||np(a.textContent,h)?(v.popover!=null&&(Fi("beforetoggle",a),Fi("toggle",a)),v.onScroll!=null&&Fi("scroll",a),v.onScrollEnd!=null&&Fi("scrollend",a),v.onClick!=null&&(a.onclick=Ys),a=!0):a=!1,a||qs(i)}function bn(i){for(ke=i.return;ke;)switch(ke.tag){case 5:case 13:xn=!1;return;case 27:case 3:xn=!0;return;default:ke=ke.return}}function cs(i){if(i!==ke)return!1;if(!pi)return bn(i),pi=!0,!1;var a=i.tag,h;if((h=a!==3&&a!==27)&&((h=a===5)&&(h=i.type,h=!(h!=="form"&&h!=="button")||Xl(i.type,i.memoizedProps)),h=!h),h&&$e&&qs(i),bn(i),a===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(M(317));t:{for(i=i.nextSibling,a=0;i;){if(i.nodeType===8)if(h=i.data,h==="/$"){if(a===0){$e=dl(i.nextSibling);break t}a--}else h!=="$"&&h!=="$!"&&h!=="$?"||a++;i=i.nextSibling}$e=null}}else a===27?(a=$e,zc(i.type)?(i=ap,ap=null,$e=i):$e=a):$e=ke?dl(i.stateNode.nextSibling):null;return!0}function Ar(){$e=ke=null,pi=!1}function fc(){var i=gn;return i!==null&&(Na===null?Na=i:Na.push.apply(Na,i),gn=null),i}function Ea(i){gn===null?gn=[i]:gn.push(i)}var En=Wt(null),Or=null,$s=null;function Nr(i,a,h){xe(En,a._currentValue),a._currentValue=h}function oa(i){i._currentValue=En.current,Ce(En)}function zl(i,a,h){for(;i!==null;){var v=i.alternate;if((i.childLanes&a)!==a?(i.childLanes|=a,v!==null&&(v.childLanes|=a)):v!==null&&(v.childLanes&a)!==a&&(v.childLanes|=a),i===h)break;i=i.return}}function pc(i,a,h,v){var C=i.child;for(C!==null&&(C.return=i);C!==null;){var R=C.dependencies;if(R!==null){var Y=C.child;R=R.firstContext;t:for(;R!==null;){var rt=R;R=C;for(var St=0;St<a.length;St++)if(rt.context===a[St]){R.lanes|=h,rt=R.alternate,rt!==null&&(rt.lanes|=h),zl(R.return,h,i),v||(Y=null);break t}R=rt.next}}else if(C.tag===18){if(Y=C.return,Y===null)throw Error(M(341));Y.lanes|=h,R=Y.alternate,R!==null&&(R.lanes|=h),zl(Y,h,i),Y=null}else Y=C.child;if(Y!==null)Y.return=C;else for(Y=C;Y!==null;){if(Y===i){Y=null;break}if(C=Y.sibling,C!==null){C.return=Y.return,Y=C;break}Y=Y.return}C=Y}}function Dl(i,a,h,v){i=null;for(var C=a,R=!1;C!==null;){if(!R){if((C.flags&524288)!==0)R=!0;else if((C.flags&262144)!==0)break}if(C.tag===10){var Y=C.alternate;if(Y===null)throw Error(M(387));if(Y=Y.memoizedProps,Y!==null){var rt=C.type;Gr(C.pendingProps.value,Y.value)||(i!==null?i.push(rt):i=[rt])}}else if(C===rn.current){if(Y=C.alternate,Y===null)throw Error(M(387));Y.memoizedState.memoizedState!==C.memoizedState.memoizedState&&(i!==null?i.push(Dt):i=[Dt])}C=C.return}i!==null&&pc(a,i,h,v),a.flags|=262144}function xu(i){for(i=i.firstContext;i!==null;){if(!Gr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Ll(i){Or=i,$s=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function wn(i){return Es(Or,i)}function Jo(i,a){return Or===null&&Ll(i),Es(i,a)}function Es(i,a){var h=a._currentValue;if(a={context:a,memoizedValue:h,next:null},$s===null){if(i===null)throw Error(M(308));$s=a,i.dependencies={lanes:0,firstContext:a},i.flags|=524288}else $s=$s.next=a;return h}var Uc=typeof AbortController<"u"?AbortController:function(){var i=[],a=this.signal={aborted:!1,addEventListener:function(h,v){i.push(v)}};this.abort=function(){a.aborted=!0,i.forEach(function(h){return h()})}},Bh=p.unstable_scheduleCallback,Cd=p.unstable_NormalPriority,gr={$$typeof:ne,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Il(){return{controller:new Uc,data:new Map,refCount:0}}function mc(i){i.refCount--,i.refCount===0&&Bh(Cd,function(){i.controller.abort()})}var No=null,eh=0,Cr=0,us=null;function Zc(i,a){if(No===null){var h=No=[];eh=0,Cr=rd(),us={status:"pending",value:void 0,then:function(v){h.push(v)}}}return eh++,a.then(za,za),a}function za(){if(--eh===0&&No!==null){us!==null&&(us.status="fulfilled");var i=No;No=null,Cr=0,us=null;for(var a=0;a<i.length;a++)(0,i[a])()}}function Gc(i,a){var h=[],v={status:"pending",value:null,reason:null,then:function(C){h.push(C)}};return i.then(function(){v.status="fulfilled",v.value=a;for(var C=0;C<h.length;C++)(0,h[C])(a)},function(C){for(v.status="rejected",v.reason=C,C=0;C<h.length;C++)(0,h[C])(void 0)}),v}var Ed=Qt.S;Qt.S=function(i,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&Zc(i,a),Ed!==null&&Ed(i,a)};var ro=Wt(null);function Oh(){var i=ro.current;return i!==null?i:Fn.pooledCache}function ih(i,a){a===null?xe(ro,ro.current):xe(ro,a.pool)}function Hc(){var i=Oh();return i===null?null:{parent:gr._currentValue,pool:i}}var tl=Error(M(460)),Da=Error(M(474)),Ee=Error(M(542)),bu={then:function(){}};function wu(i){return i=i.status,i==="fulfilled"||i==="rejected"}function qc(){}function _c(i,a,h){switch(h=i[h],h===void 0?i.push(a):h!==a&&(a.then(qc,qc),a=h),a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,Di(i),i;default:if(typeof a.status=="string")a.then(qc,qc);else{if(i=Fn,i!==null&&100<i.shellSuspendCounter)throw Error(M(482));i=a,i.status="pending",i.then(function(v){if(a.status==="pending"){var C=a;C.status="fulfilled",C.value=v}},function(v){if(a.status==="pending"){var C=a;C.status="rejected",C.reason=v}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,Di(i),i}throw so=a,tl}}var so=null;function Tu(){if(so===null)throw Error(M(459));var i=so;return so=null,i}function Di(i){if(i===tl||i===Ee)throw Error(M(483))}var ao=!1;function Nh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $c(i,a){i=i.updateQueue,a.updateQueue===i&&(a.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Rl(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function el(i,a,h){var v=i.updateQueue;if(v===null)return null;if(v=v.shared,(un&2)!==0){var C=v.pending;return C===null?a.next=a:(a.next=C.next,C.next=a),v.pending=a,a=Pa(i),Al(i,null,h),a}return Pl(i,v,a,h),Pa(i)}function gc(i,a,h){if(a=a.updateQueue,a!==null&&(a=a.shared,(h&4194048)!==0)){var v=a.lanes;v&=i.pendingLanes,h|=v,a.lanes=h,Ge(i,h)}}function Su(i,a){var h=i.updateQueue,v=i.alternate;if(v!==null&&(v=v.updateQueue,h===v)){var C=null,R=null;if(h=h.firstBaseUpdate,h!==null){do{var Y={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};R===null?C=R=Y:R=R.next=Y,h=h.next}while(h!==null);R===null?C=R=a:R=R.next=a}else C=R=a;h={baseState:v.baseState,firstBaseUpdate:C,lastBaseUpdate:R,shared:v.shared,callbacks:v.callbacks},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=a:i.next=a,h.lastBaseUpdate=a}var nh=!1;function Xc(){if(nh){var i=us;if(i!==null)throw i}}function yc(i,a,h,v){nh=!1;var C=i.updateQueue;ao=!1;var R=C.firstBaseUpdate,Y=C.lastBaseUpdate,rt=C.shared.pending;if(rt!==null){C.shared.pending=null;var St=rt,Zt=St.next;St.next=null,Y===null?R=Zt:Y.next=Zt,Y=St;var ie=i.alternate;ie!==null&&(ie=ie.updateQueue,rt=ie.lastBaseUpdate,rt!==Y&&(rt===null?ie.firstBaseUpdate=Zt:rt.next=Zt,ie.lastBaseUpdate=St))}if(R!==null){var le=C.baseState;Y=0,ie=Zt=St=null,rt=R;do{var Ht=rt.lane&-536870913,Xt=Ht!==rt.lane;if(Xt?(ki&Ht)===Ht:(v&Ht)===Ht){Ht!==0&&Ht===Cr&&(nh=!0),ie!==null&&(ie=ie.next={lane:0,tag:rt.tag,payload:rt.payload,callback:null,next:null});t:{var _i=i,ui=rt;Ht=a;var Pn=h;switch(ui.tag){case 1:if(_i=ui.payload,typeof _i=="function"){le=_i.call(Pn,le,Ht);break t}le=_i;break t;case 3:_i.flags=_i.flags&-65537|128;case 0:if(_i=ui.payload,Ht=typeof _i=="function"?_i.call(Pn,le,Ht):_i,Ht==null)break t;le=Q({},le,Ht);break t;case 2:ao=!0}}Ht=rt.callback,Ht!==null&&(i.flags|=64,Xt&&(i.flags|=8192),Xt=C.callbacks,Xt===null?C.callbacks=[Ht]:Xt.push(Ht))}else Xt={lane:Ht,tag:rt.tag,payload:rt.payload,callback:rt.callback,next:null},ie===null?(Zt=ie=Xt,St=le):ie=ie.next=Xt,Y|=Ht;if(rt=rt.next,rt===null){if(rt=C.shared.pending,rt===null)break;Xt=rt,rt=Xt.next,Xt.next=null,C.lastBaseUpdate=Xt,C.shared.pending=null}}while(!0);ie===null&&(St=le),C.baseState=St,C.firstBaseUpdate=Zt,C.lastBaseUpdate=ie,R===null&&(C.shared.lanes=0),Hl|=Y,i.lanes=Y,i.memoizedState=le}}function jh(i,a){if(typeof i!="function")throw Error(M(191,i));i.call(a)}function Fh(i,a){var h=i.callbacks;if(h!==null)for(i.callbacks=null,i=0;i<h.length;i++)jh(h[i],a)}var hs=Wt(null),cn=Wt(0);function vc(i,a){i=Ac,xe(cn,i),xe(hs,a),Ac=i|a.baseLanes}function Mu(){xe(cn,Ac),xe(hs,hs.current)}function rh(){Ac=cn.current,Ce(hs),Ce(cn)}var jo=0,Ci=null,tn=null,en=null,xc=!1,Re=!1,Xe=!1,bc=0,La=0,il=null,zs=0;function Xn(){throw Error(M(321))}function Xs(i,a){if(a===null)return!1;for(var h=0;h<a.length&&h<i.length;h++)if(!Gr(i[h],a[h]))return!1;return!0}function Vh(i,a,h,v,C,R){return jo=R,Ci=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Qt.H=i===null||i.memoizedState===null?Ra:fs,Xe=!1,R=h(v,C),Xe=!1,Re&&(R=Xi(a,h,v,C)),Yc(i),R}function Yc(i){Qt.H=qr;var a=tn!==null&&tn.next!==null;if(jo=0,en=tn=Ci=null,xc=!1,La=0,il=null,a)throw Error(M(300));i===null||zr||(i=i.dependencies,i!==null&&xu(i)&&(zr=!0))}function Xi(i,a,h,v){Ci=i;var C=0;do{if(Re&&(il=null),La=0,Re=!1,25<=C)throw Error(M(301));if(C+=1,en=tn=null,i.updateQueue!=null){var R=i.updateQueue;R.lastEffect=null,R.events=null,R.stores=null,R.memoCache!=null&&(R.memoCache.index=0)}Qt.H=Fl,R=a(h,v)}while(Re);return R}function Yn(){var i=Qt.H,a=i.useState()[0];return a=typeof a.then=="function"?rl(a):a,i=i.useState()[0],(tn!==null?tn.memoizedState:null)!==i&&(Ci.flags|=1024),a}function Wc(){var i=bc!==0;return bc=0,i}function kl(i,a,h){a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~h}function Bl(i){if(xc){for(i=i.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}xc=!1}jo=0,en=tn=Ci=null,Re=!1,La=bc=0,il=null}function ds(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return en===null?Ci.memoizedState=en=i:en=en.next=i,en}function zn(){if(tn===null){var i=Ci.alternate;i=i!==null?i.memoizedState:null}else i=tn.next;var a=en===null?Ci.memoizedState:en.next;if(a!==null)en=a,tn=i;else{if(i===null)throw Ci.alternate===null?Error(M(467)):Error(M(310));tn=i,i={memoizedState:tn.memoizedState,baseState:tn.baseState,baseQueue:tn.baseQueue,queue:tn.queue,next:null},en===null?Ci.memoizedState=en=i:en=en.next=i}return en}function nl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function rl(i){var a=La;return La+=1,il===null&&(il=[]),i=_c(il,i,a),a=Ci,(en===null?a.memoizedState:en.next)===null&&(a=a.alternate,Qt.H=a===null||a.memoizedState===null?Ra:fs),i}function wc(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return rl(i);if(i.$$typeof===ne)return wn(i)}throw Error(M(438,String(i)))}function sl(i){var a=null,h=Ci.updateQueue;if(h!==null&&(a=h.memoCache),a==null){var v=Ci.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(a={data:v.data.map(function(C){return C.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),h===null&&(h=nl(),Ci.updateQueue=h),h.memoCache=a,h=a.data[a.index],h===void 0)for(h=a.data[a.index]=Array(i),v=0;v<i;v++)h[v]=Ti;return a.index++,h}function oo(i,a){return typeof a=="function"?a(i):a}function Kc(i){var a=zn();return Qc(a,tn,i)}function Qc(i,a,h){var v=i.queue;if(v===null)throw Error(M(311));v.lastRenderedReducer=h;var C=i.baseQueue,R=v.pending;if(R!==null){if(C!==null){var Y=C.next;C.next=R.next,R.next=Y}a.baseQueue=C=R,v.pending=null}if(R=i.baseState,C===null)i.memoizedState=R;else{a=C.next;var rt=Y=null,St=null,Zt=a,ie=!1;do{var le=Zt.lane&-536870913;if(le!==Zt.lane?(ki&le)===le:(jo&le)===le){var Ht=Zt.revertLane;if(Ht===0)St!==null&&(St=St.next={lane:0,revertLane:0,action:Zt.action,hasEagerState:Zt.hasEagerState,eagerState:Zt.eagerState,next:null}),le===Cr&&(ie=!0);else if((jo&Ht)===Ht){Zt=Zt.next,Ht===Cr&&(ie=!0);continue}else le={lane:0,revertLane:Zt.revertLane,action:Zt.action,hasEagerState:Zt.hasEagerState,eagerState:Zt.eagerState,next:null},St===null?(rt=St=le,Y=R):St=St.next=le,Ci.lanes|=Ht,Hl|=Ht;le=Zt.action,Xe&&h(R,le),R=Zt.hasEagerState?Zt.eagerState:h(R,le)}else Ht={lane:le,revertLane:Zt.revertLane,action:Zt.action,hasEagerState:Zt.hasEagerState,eagerState:Zt.eagerState,next:null},St===null?(rt=St=Ht,Y=R):St=St.next=Ht,Ci.lanes|=le,Hl|=le;Zt=Zt.next}while(Zt!==null&&Zt!==a);if(St===null?Y=R:St.next=rt,!Gr(R,i.memoizedState)&&(zr=!0,ie&&(h=us,h!==null)))throw h;i.memoizedState=R,i.baseState=Y,i.baseQueue=St,v.lastRenderedState=R}return C===null&&(v.lanes=0),[i.memoizedState,v.dispatch]}function Pu(i){var a=zn(),h=a.queue;if(h===null)throw Error(M(311));h.lastRenderedReducer=i;var v=h.dispatch,C=h.pending,R=a.memoizedState;if(C!==null){h.pending=null;var Y=C=C.next;do R=i(R,Y.action),Y=Y.next;while(Y!==C);Gr(R,a.memoizedState)||(zr=!0),a.memoizedState=R,a.baseQueue===null&&(a.baseState=R),h.lastRenderedState=R}return[R,v]}function g(i,a,h){var v=Ci,C=zn(),R=pi;if(R){if(h===void 0)throw Error(M(407));h=h()}else h=a();var Y=!Gr((tn||C).memoizedState,h);Y&&(C.memoizedState=h,zr=!0),C=C.queue;var rt=c.bind(null,v,C,i);if(Lt(2048,8,rt,[i]),C.getSnapshot!==a||Y||en!==null&&en.memoizedState.tag&1){if(v.flags|=2048,mt(9,bt(),s.bind(null,v,C,h,a),null),Fn===null)throw Error(M(349));R||(jo&124)!==0||t(v,a,h)}return h}function t(i,a,h){i.flags|=16384,i={getSnapshot:a,value:h},a=Ci.updateQueue,a===null?(a=nl(),Ci.updateQueue=a,a.stores=[i]):(h=a.stores,h===null?a.stores=[i]:h.push(i))}function s(i,a,h,v){a.value=h,a.getSnapshot=v,f(a)&&y(i)}function c(i,a,h){return h(function(){f(a)&&y(i)})}function f(i){var a=i.getSnapshot;i=i.value;try{var h=a();return!Gr(i,h)}catch{return!0}}function y(i){var a=As(i,2);a!==null&&po(a,i,2)}function T(i){var a=ds();if(typeof i=="function"){var h=i;if(i=h(),Xe){es(!0);try{h()}finally{es(!1)}}}return a.memoizedState=a.baseState=i,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:oo,lastRenderedState:i},a}function z(i,a,h,v){return i.baseState=h,Qc(i,tn,typeof v=="function"?v:oo)}function D(i,a,h,v,C){if(ol(i))throw Error(M(485));if(i=a.action,i!==null){var R={payload:C,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Y){R.listeners.push(Y)}};Qt.T!==null?h(!0):R.isTransition=!1,v(R),h=a.pending,h===null?(R.next=a.pending=R,O(a,R)):(R.next=h.next,a.pending=h.next=R)}}function O(i,a){var h=a.action,v=a.payload,C=i.state;if(a.isTransition){var R=Qt.T,Y={};Qt.T=Y;try{var rt=h(C,v),St=Qt.S;St!==null&&St(Y,rt),j(i,a,rt)}catch(Zt){U(i,a,Zt)}finally{Qt.T=R}}else try{R=h(C,v),j(i,a,R)}catch(Zt){U(i,a,Zt)}}function j(i,a,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(v){Z(i,a,v)},function(v){return U(i,a,v)}):Z(i,a,h)}function Z(i,a,h){a.status="fulfilled",a.value=h,$(a),i.state=h,a=i.pending,a!==null&&(h=a.next,h===a?i.pending=null:(h=h.next,a.next=h,O(i,h)))}function U(i,a,h){var v=i.pending;if(i.pending=null,v!==null){v=v.next;do a.status="rejected",a.reason=h,$(a),a=a.next;while(a!==v)}i.action=null}function $(i){i=i.listeners;for(var a=0;a<i.length;a++)(0,i[a])()}function J(i,a){return a}function ct(i,a){if(pi){var h=Fn.formState;if(h!==null){t:{var v=Ci;if(pi){if($e){e:{for(var C=$e,R=xn;C.nodeType!==8;){if(!R){C=null;break e}if(C=dl(C.nextSibling),C===null){C=null;break e}}R=C.data,C=R==="F!"||R==="F"?C:null}if(C){$e=dl(C.nextSibling),v=C.data==="F!";break t}}qs(v)}v=!1}v&&(a=h[0])}}return h=ds(),h.memoizedState=h.baseState=a,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:J,lastRenderedState:a},h.queue=v,h=al.bind(null,Ci,v),v.dispatch=h,v=T(!1),R=Ol.bind(null,Ci,!1,v.queue),v=ds(),C={state:a,dispatch:null,action:i,pending:null},v.queue=C,h=D.bind(null,Ci,C,R,h),C.dispatch=h,v.memoizedState=i,[a,h,!1]}function ot(i){var a=zn();return ut(a,tn,i)}function ut(i,a,h){if(a=Qc(i,a,J)[0],i=Kc(oo)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var v=rl(a)}catch(Y){throw Y===tl?Ee:Y}else v=a;a=zn();var C=a.queue,R=C.dispatch;return h!==a.memoizedState&&(Ci.flags|=2048,mt(9,bt(),pt.bind(null,C,h),null)),[v,R,i]}function pt(i,a){i.action=a}function vt(i){var a=zn(),h=tn;if(h!==null)return ut(a,h,i);zn(),a=a.memoizedState,h=zn();var v=h.queue.dispatch;return h.memoizedState=i,[a,v,!1]}function mt(i,a,h,v){return i={tag:i,create:h,deps:v,inst:a,next:null},a=Ci.updateQueue,a===null&&(a=nl(),Ci.updateQueue=a),h=a.lastEffect,h===null?a.lastEffect=i.next=i:(v=h.next,h.next=i,i.next=v,a.lastEffect=i),i}function bt(){return{destroy:void 0,resource:void 0}}function At(){return zn().memoizedState}function gt(i,a,h,v){var C=ds();v=v===void 0?null:v,Ci.flags|=i,C.memoizedState=mt(1|a,bt(),h,v)}function Lt(i,a,h,v){var C=zn();v=v===void 0?null:v;var R=C.memoizedState.inst;tn!==null&&v!==null&&Xs(v,tn.memoizedState.deps)?C.memoizedState=mt(a,R,h,v):(Ci.flags|=i,C.memoizedState=mt(1|a,R,h,v))}function Gt(i,a){gt(8390656,8,i,a)}function Ot(i,a){Lt(2048,8,i,a)}function Nt(i,a){return Lt(4,2,i,a)}function Ut(i,a){return Lt(4,4,i,a)}function _e(i,a){if(typeof a=="function"){i=i();var h=a(i);return function(){typeof h=="function"?h():a(null)}}if(a!=null)return i=i(),a.current=i,function(){a.current=null}}function ve(i,a,h){h=h!=null?h.concat([i]):null,Lt(4,4,_e.bind(null,a,i),h)}function re(){}function Oe(i,a){var h=zn();a=a===void 0?null:a;var v=h.memoizedState;return a!==null&&Xs(a,v[1])?v[0]:(h.memoizedState=[i,a],i)}function yi(i,a){var h=zn();a=a===void 0?null:a;var v=h.memoizedState;if(a!==null&&Xs(a,v[1]))return v[0];if(v=i(),Xe){es(!0);try{i()}finally{es(!1)}}return h.memoizedState=[v,a],v}function Ni(i,a,h){return h===void 0||(jo&1073741824)!==0?i.memoizedState=a:(i.memoizedState=h,i=Jp(),Ci.lanes|=i,Hl|=i,h)}function Yi(i,a,h,v){return Gr(h,a)?h:hs.current!==null?(i=Ni(i,h,v),Gr(i,a)||(zr=!0),i):(jo&42)===0?(zr=!0,i.memoizedState=h):(i=Jp(),Ci.lanes|=i,Hl|=i,a)}function Gi(i,a,h,v,C){var R=me.p;me.p=R!==0&&8>R?R:8;var Y=Qt.T,rt={};Qt.T=rt,Ol(i,!1,a,h);try{var St=C(),Zt=Qt.S;if(Zt!==null&&Zt(rt,St),St!==null&&typeof St=="object"&&typeof St.then=="function"){var ie=Gc(St,v);Ia(i,a,ie,ja(i))}else Ia(i,a,v,ja(i))}catch(le){Ia(i,a,{then:function(){},status:"rejected",reason:le},ja())}finally{me.p=R,Qt.T=Y}}function On(){}function Dn(i,a,h,v){if(i.tag!==5)throw Error(M(476));var C=mi(i).queue;Gi(i,C,a,fe,h===null?On:function(){return Wi(i),h(v)})}function mi(i){var a=i.memoizedState;if(a!==null)return a;a={memoizedState:fe,baseState:fe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oo,lastRenderedState:fe},next:null};var h={};return a.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:oo,lastRenderedState:h},next:null},i.memoizedState=a,i=i.alternate,i!==null&&(i.memoizedState=a),a}function Wi(i){var a=mi(i).next.queue;Ia(i,a,{},ja())}function Wn(){return wn(Dt)}function yr(){return zn().memoizedState}function Er(){return zn().memoizedState}function Ds(i){for(var a=i.return;a!==null;){switch(a.tag){case 24:case 3:var h=ja();i=Rl(h);var v=el(a,i,h);v!==null&&(po(v,a,h),gc(v,a,h)),a={cache:Il()},i.payload=a;return}a=a.return}}function lo(i,a,h){var v=ja();h={lane:v,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},ol(i)?Nl(a,h):(h=Hs(i,a,h,v),h!==null&&(po(h,i,v),jl(h,a,v)))}function al(i,a,h){var v=ja();Ia(i,a,h,v)}function Ia(i,a,h,v){var C={lane:v,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(ol(i))Nl(a,C);else{var R=i.alternate;if(i.lanes===0&&(R===null||R.lanes===0)&&(R=a.lastRenderedReducer,R!==null))try{var Y=a.lastRenderedState,rt=R(Y,h);if(C.hasEagerState=!0,C.eagerState=rt,Gr(rt,Y))return Pl(i,a,C,0),Fn===null&&Oo(),!1}catch{}finally{}if(h=Hs(i,a,C,v),h!==null)return po(h,i,v),jl(h,a,v),!0}return!1}function Ol(i,a,h,v){if(v={lane:2,revertLane:rd(),action:v,hasEagerState:!1,eagerState:null,next:null},ol(i)){if(a)throw Error(M(479))}else a=Hs(i,h,v,2),a!==null&&po(a,i,2)}function ol(i){var a=i.alternate;return i===Ci||a!==null&&a===Ci}function Nl(i,a){Re=xc=!0;var h=i.pending;h===null?a.next=a:(a.next=h.next,h.next=a),i.pending=a}function jl(i,a,h){if((h&4194048)!==0){var v=a.lanes;v&=i.pendingLanes,h|=v,a.lanes=h,Ge(i,h)}}var qr={readContext:wn,use:wc,useCallback:Xn,useContext:Xn,useEffect:Xn,useImperativeHandle:Xn,useLayoutEffect:Xn,useInsertionEffect:Xn,useMemo:Xn,useReducer:Xn,useRef:Xn,useState:Xn,useDebugValue:Xn,useDeferredValue:Xn,useTransition:Xn,useSyncExternalStore:Xn,useId:Xn,useHostTransitionStatus:Xn,useFormState:Xn,useActionState:Xn,useOptimistic:Xn,useMemoCache:Xn,useCacheRefresh:Xn},Ra={readContext:wn,use:wc,useCallback:function(i,a){return ds().memoizedState=[i,a===void 0?null:a],i},useContext:wn,useEffect:Gt,useImperativeHandle:function(i,a,h){h=h!=null?h.concat([i]):null,gt(4194308,4,_e.bind(null,a,i),h)},useLayoutEffect:function(i,a){return gt(4194308,4,i,a)},useInsertionEffect:function(i,a){gt(4,2,i,a)},useMemo:function(i,a){var h=ds();a=a===void 0?null:a;var v=i();if(Xe){es(!0);try{i()}finally{es(!1)}}return h.memoizedState=[v,a],v},useReducer:function(i,a,h){var v=ds();if(h!==void 0){var C=h(a);if(Xe){es(!0);try{h(a)}finally{es(!1)}}}else C=a;return v.memoizedState=v.baseState=C,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:C},v.queue=i,i=i.dispatch=lo.bind(null,Ci,i),[v.memoizedState,i]},useRef:function(i){var a=ds();return i={current:i},a.memoizedState=i},useState:function(i){i=T(i);var a=i.queue,h=al.bind(null,Ci,a);return a.dispatch=h,[i.memoizedState,h]},useDebugValue:re,useDeferredValue:function(i,a){var h=ds();return Ni(h,i,a)},useTransition:function(){var i=T(!1);return i=Gi.bind(null,Ci,i.queue,!0,!1),ds().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,a,h){var v=Ci,C=ds();if(pi){if(h===void 0)throw Error(M(407));h=h()}else{if(h=a(),Fn===null)throw Error(M(349));(ki&124)!==0||t(v,a,h)}C.memoizedState=h;var R={value:h,getSnapshot:a};return C.queue=R,Gt(c.bind(null,v,R,i),[i]),v.flags|=2048,mt(9,bt(),s.bind(null,v,R,h,a),null),h},useId:function(){var i=ds(),a=Fn.identifierPrefix;if(pi){var h=wt,v=nt;h=(v&~(1<<32-Ct(v)-1)).toString(32)+h,a=""+a+"R"+h,h=bc++,0<h&&(a+="H"+h.toString(32)),a+=""}else h=zs++,a=""+a+"r"+h.toString(32)+"";return i.memoizedState=a},useHostTransitionStatus:Wn,useFormState:ct,useActionState:ct,useOptimistic:function(i){var a=ds();a.memoizedState=a.baseState=i;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=h,a=Ol.bind(null,Ci,!0,h),h.dispatch=a,[i,a]},useMemoCache:sl,useCacheRefresh:function(){return ds().memoizedState=Ds.bind(null,Ci)}},fs={readContext:wn,use:wc,useCallback:Oe,useContext:wn,useEffect:Ot,useImperativeHandle:ve,useInsertionEffect:Nt,useLayoutEffect:Ut,useMemo:yi,useReducer:Kc,useRef:At,useState:function(){return Kc(oo)},useDebugValue:re,useDeferredValue:function(i,a){var h=zn();return Yi(h,tn.memoizedState,i,a)},useTransition:function(){var i=Kc(oo)[0],a=zn().memoizedState;return[typeof i=="boolean"?i:rl(i),a]},useSyncExternalStore:g,useId:yr,useHostTransitionStatus:Wn,useFormState:ot,useActionState:ot,useOptimistic:function(i,a){var h=zn();return z(h,tn,i,a)},useMemoCache:sl,useCacheRefresh:Er},Fl={readContext:wn,use:wc,useCallback:Oe,useContext:wn,useEffect:Ot,useImperativeHandle:ve,useInsertionEffect:Nt,useLayoutEffect:Ut,useMemo:yi,useReducer:Pu,useRef:At,useState:function(){return Pu(oo)},useDebugValue:re,useDeferredValue:function(i,a){var h=zn();return tn===null?Ni(h,i,a):Yi(h,tn.memoizedState,i,a)},useTransition:function(){var i=Pu(oo)[0],a=zn().memoizedState;return[typeof i=="boolean"?i:rl(i),a]},useSyncExternalStore:g,useId:yr,useHostTransitionStatus:Wn,useFormState:vt,useActionState:vt,useOptimistic:function(i,a){var h=zn();return tn!==null?z(h,tn,i,a):(h.baseState=i,[i,h.queue.dispatch])},useMemoCache:sl,useCacheRefresh:Er},Ln=null,Gn=0;function Ls(i){var a=Gn;return Gn+=1,Ln===null&&(Ln=[]),_c(Ln,i,a)}function Nn(i,a){a=a.props.ref,i.ref=a!==void 0?a:null}function Vl(i,a){throw a.$$typeof===dt?Error(M(525)):(i=Object.prototype.toString.call(a),Error(M(31,i==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":i)))}function Tc(i){var a=i._init;return a(i._payload)}function Fo(i){function a(kt,Rt){if(i){var Vt=kt.deletions;Vt===null?(kt.deletions=[Rt],kt.flags|=16):Vt.push(Rt)}}function h(kt,Rt){if(!i)return null;for(;Rt!==null;)a(kt,Rt),Rt=Rt.sibling;return null}function v(kt){for(var Rt=new Map;kt!==null;)kt.key!==null?Rt.set(kt.key,kt):Rt.set(kt.index,kt),kt=kt.sibling;return Rt}function C(kt,Rt){return kt=Pr(kt,Rt),kt.index=0,kt.sibling=null,kt}function R(kt,Rt,Vt){return kt.index=Vt,i?(Vt=kt.alternate,Vt!==null?(Vt=Vt.index,Vt<Rt?(kt.flags|=67108866,Rt):Vt):(kt.flags|=67108866,Rt)):(kt.flags|=1048576,Rt)}function Y(kt){return i&&kt.alternate===null&&(kt.flags|=67108866),kt}function rt(kt,Rt,Vt,ae){return Rt===null||Rt.tag!==6?(Rt=vu(Vt,kt.mode,ae),Rt.return=kt,Rt):(Rt=C(Rt,Vt),Rt.return=kt,Rt)}function St(kt,Rt,Vt,ae){var Ke=Vt.type;return Ke===Yt?ie(kt,Rt,Vt.props.children,ae,Vt.key):Rt!==null&&(Rt.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Ue&&Tc(Ke)===Rt.type)?(Rt=C(Rt,Vt.props),Nn(Rt,Vt),Rt.return=kt,Rt):(Rt=dc(Vt.type,Vt.key,Vt.props,null,kt.mode,ae),Nn(Rt,Vt),Rt.return=kt,Rt)}function Zt(kt,Rt,Vt,ae){return Rt===null||Rt.tag!==4||Rt.stateNode.containerInfo!==Vt.containerInfo||Rt.stateNode.implementation!==Vt.implementation?(Rt=El(Vt,kt.mode,ae),Rt.return=kt,Rt):(Rt=C(Rt,Vt.children||[]),Rt.return=kt,Rt)}function ie(kt,Rt,Vt,ae,Ke){return Rt===null||Rt.tag!==7?(Rt=no(Vt,kt.mode,ae,Ke),Rt.return=kt,Rt):(Rt=C(Rt,Vt),Rt.return=kt,Rt)}function le(kt,Rt,Vt){if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number"||typeof Rt=="bigint")return Rt=vu(""+Rt,kt.mode,Vt),Rt.return=kt,Rt;if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case ht:return Vt=dc(Rt.type,Rt.key,Rt.props,null,kt.mode,Vt),Nn(Vt,Rt),Vt.return=kt,Vt;case lt:return Rt=El(Rt,kt.mode,Vt),Rt.return=kt,Rt;case Ue:var ae=Rt._init;return Rt=ae(Rt._payload),le(kt,Rt,Vt)}if(dn(Rt)||Pi(Rt))return Rt=no(Rt,kt.mode,Vt,null),Rt.return=kt,Rt;if(typeof Rt.then=="function")return le(kt,Ls(Rt),Vt);if(Rt.$$typeof===ne)return le(kt,Jo(kt,Rt),Vt);Vl(kt,Rt)}return null}function Ht(kt,Rt,Vt,ae){var Ke=Rt!==null?Rt.key:null;if(typeof Vt=="string"&&Vt!==""||typeof Vt=="number"||typeof Vt=="bigint")return Ke!==null?null:rt(kt,Rt,""+Vt,ae);if(typeof Vt=="object"&&Vt!==null){switch(Vt.$$typeof){case ht:return Vt.key===Ke?St(kt,Rt,Vt,ae):null;case lt:return Vt.key===Ke?Zt(kt,Rt,Vt,ae):null;case Ue:return Ke=Vt._init,Vt=Ke(Vt._payload),Ht(kt,Rt,Vt,ae)}if(dn(Vt)||Pi(Vt))return Ke!==null?null:ie(kt,Rt,Vt,ae,null);if(typeof Vt.then=="function")return Ht(kt,Rt,Ls(Vt),ae);if(Vt.$$typeof===ne)return Ht(kt,Rt,Jo(kt,Vt),ae);Vl(kt,Vt)}return null}function Xt(kt,Rt,Vt,ae,Ke){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return kt=kt.get(Vt)||null,rt(Rt,kt,""+ae,Ke);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case ht:return kt=kt.get(ae.key===null?Vt:ae.key)||null,St(Rt,kt,ae,Ke);case lt:return kt=kt.get(ae.key===null?Vt:ae.key)||null,Zt(Rt,kt,ae,Ke);case Ue:var Bi=ae._init;return ae=Bi(ae._payload),Xt(kt,Rt,Vt,ae,Ke)}if(dn(ae)||Pi(ae))return kt=kt.get(Vt)||null,ie(Rt,kt,ae,Ke,null);if(typeof ae.then=="function")return Xt(kt,Rt,Vt,Ls(ae),Ke);if(ae.$$typeof===ne)return Xt(kt,Rt,Vt,Jo(Rt,ae),Ke);Vl(Rt,ae)}return null}function _i(kt,Rt,Vt,ae){for(var Ke=null,Bi=null,qe=Rt,oi=Rt=0,Qr=null;qe!==null&&oi<Vt.length;oi++){qe.index>oi?(Qr=qe,qe=null):Qr=qe.sibling;var Qi=Ht(kt,qe,Vt[oi],ae);if(Qi===null){qe===null&&(qe=Qr);break}i&&qe&&Qi.alternate===null&&a(kt,qe),Rt=R(Qi,Rt,oi),Bi===null?Ke=Qi:Bi.sibling=Qi,Bi=Qi,qe=Qr}if(oi===Vt.length)return h(kt,qe),pi&&Bt(kt,oi),Ke;if(qe===null){for(;oi<Vt.length;oi++)qe=le(kt,Vt[oi],ae),qe!==null&&(Rt=R(qe,Rt,oi),Bi===null?Ke=qe:Bi.sibling=qe,Bi=qe);return pi&&Bt(kt,oi),Ke}for(qe=v(qe);oi<Vt.length;oi++)Qr=Xt(qe,kt,oi,Vt[oi],ae),Qr!==null&&(i&&Qr.alternate!==null&&qe.delete(Qr.key===null?oi:Qr.key),Rt=R(Qr,Rt,oi),Bi===null?Ke=Qr:Bi.sibling=Qr,Bi=Qr);return i&&qe.forEach(function(cu){return a(kt,cu)}),pi&&Bt(kt,oi),Ke}function ui(kt,Rt,Vt,ae){if(Vt==null)throw Error(M(151));for(var Ke=null,Bi=null,qe=Rt,oi=Rt=0,Qr=null,Qi=Vt.next();qe!==null&&!Qi.done;oi++,Qi=Vt.next()){qe.index>oi?(Qr=qe,qe=null):Qr=qe.sibling;var cu=Ht(kt,qe,Qi.value,ae);if(cu===null){qe===null&&(qe=Qr);break}i&&qe&&cu.alternate===null&&a(kt,qe),Rt=R(cu,Rt,oi),Bi===null?Ke=cu:Bi.sibling=cu,Bi=cu,qe=Qr}if(Qi.done)return h(kt,qe),pi&&Bt(kt,oi),Ke;if(qe===null){for(;!Qi.done;oi++,Qi=Vt.next())Qi=le(kt,Qi.value,ae),Qi!==null&&(Rt=R(Qi,Rt,oi),Bi===null?Ke=Qi:Bi.sibling=Qi,Bi=Qi);return pi&&Bt(kt,oi),Ke}for(qe=v(qe);!Qi.done;oi++,Qi=Vt.next())Qi=Xt(qe,kt,oi,Qi.value,ae),Qi!==null&&(i&&Qi.alternate!==null&&qe.delete(Qi.key===null?oi:Qi.key),Rt=R(Qi,Rt,oi),Bi===null?Ke=Qi:Bi.sibling=Qi,Bi=Qi);return i&&qe.forEach(function(r_){return a(kt,r_)}),pi&&Bt(kt,oi),Ke}function Pn(kt,Rt,Vt,ae){if(typeof Vt=="object"&&Vt!==null&&Vt.type===Yt&&Vt.key===null&&(Vt=Vt.props.children),typeof Vt=="object"&&Vt!==null){switch(Vt.$$typeof){case ht:t:{for(var Ke=Vt.key;Rt!==null;){if(Rt.key===Ke){if(Ke=Vt.type,Ke===Yt){if(Rt.tag===7){h(kt,Rt.sibling),ae=C(Rt,Vt.props.children),ae.return=kt,kt=ae;break t}}else if(Rt.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Ue&&Tc(Ke)===Rt.type){h(kt,Rt.sibling),ae=C(Rt,Vt.props),Nn(ae,Vt),ae.return=kt,kt=ae;break t}h(kt,Rt);break}else a(kt,Rt);Rt=Rt.sibling}Vt.type===Yt?(ae=no(Vt.props.children,kt.mode,ae,Vt.key),ae.return=kt,kt=ae):(ae=dc(Vt.type,Vt.key,Vt.props,null,kt.mode,ae),Nn(ae,Vt),ae.return=kt,kt=ae)}return Y(kt);case lt:t:{for(Ke=Vt.key;Rt!==null;){if(Rt.key===Ke)if(Rt.tag===4&&Rt.stateNode.containerInfo===Vt.containerInfo&&Rt.stateNode.implementation===Vt.implementation){h(kt,Rt.sibling),ae=C(Rt,Vt.children||[]),ae.return=kt,kt=ae;break t}else{h(kt,Rt);break}else a(kt,Rt);Rt=Rt.sibling}ae=El(Vt,kt.mode,ae),ae.return=kt,kt=ae}return Y(kt);case Ue:return Ke=Vt._init,Vt=Ke(Vt._payload),Pn(kt,Rt,Vt,ae)}if(dn(Vt))return _i(kt,Rt,Vt,ae);if(Pi(Vt)){if(Ke=Pi(Vt),typeof Ke!="function")throw Error(M(150));return Vt=Ke.call(Vt),ui(kt,Rt,Vt,ae)}if(typeof Vt.then=="function")return Pn(kt,Rt,Ls(Vt),ae);if(Vt.$$typeof===ne)return Pn(kt,Rt,Jo(kt,Vt),ae);Vl(kt,Vt)}return typeof Vt=="string"&&Vt!==""||typeof Vt=="number"||typeof Vt=="bigint"?(Vt=""+Vt,Rt!==null&&Rt.tag===6?(h(kt,Rt.sibling),ae=C(Rt,Vt),ae.return=kt,kt=ae):(h(kt,Rt),ae=vu(Vt,kt.mode,ae),ae.return=kt,kt=ae),Y(kt)):h(kt,Rt)}return function(kt,Rt,Vt,ae){try{Gn=0;var Ke=Pn(kt,Rt,Vt,ae);return Ln=null,Ke}catch(qe){if(qe===tl||qe===Ee)throw qe;var Bi=Cs(29,qe,null,kt.mode);return Bi.lanes=ae,Bi.return=kt,Bi}finally{}}}var ps=Fo(!0),ll=Fo(!1),la=Wt(null),Kn=null;function cl(i){var a=i.alternate;xe(Tn,Tn.current&1),xe(la,i),Kn===null&&(a===null||hs.current!==null||a.memoizedState!==null)&&(Kn=i)}function sh(i){if(i.tag===22){if(xe(Tn,Tn.current),xe(la,i),Kn===null){var a=i.alternate;a!==null&&a.memoizedState!==null&&(Kn=i)}}else co()}function co(){xe(Tn,Tn.current),xe(la,la.current)}function ka(i){Ce(la),Kn===i&&(Kn=null),Ce(Tn)}var Tn=Wt(0);function Ba(i){for(var a=i;a!==null;){if(a.tag===13){var h=a.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||Th(h)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function zd(i,a,h,v){a=i.memoizedState,h=h(v,a),h=h==null?a:Q({},a,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var Mf={enqueueSetState:function(i,a,h){i=i._reactInternals;var v=ja(),C=Rl(v);C.payload=a,h!=null&&(C.callback=h),a=el(i,C,v),a!==null&&(po(a,i,v),gc(a,i,v))},enqueueReplaceState:function(i,a,h){i=i._reactInternals;var v=ja(),C=Rl(v);C.tag=1,C.payload=a,h!=null&&(C.callback=h),a=el(i,C,v),a!==null&&(po(a,i,v),gc(a,i,v))},enqueueForceUpdate:function(i,a){i=i._reactInternals;var h=ja(),v=Rl(h);v.tag=2,a!=null&&(v.callback=a),a=el(i,v,h),a!==null&&(po(a,i,h),gc(a,i,h))}};function Dd(i,a,h,v,C,R,Y){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(v,R,Y):a.prototype&&a.prototype.isPureReactComponent?!os(h,v)||!os(C,R):!0}function Pf(i,a,h,v){i=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(h,v),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(h,v),a.state!==i&&Mf.enqueueReplaceState(a,a.state,null)}function Au(i,a){var h=a;if("ref"in a){h={};for(var v in a)v!=="ref"&&(h[v]=a[v])}if(i=i.defaultProps){h===a&&(h=Q({},h));for(var C in i)h[C]===void 0&&(h[C]=i[C])}return h}var Uh=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function Rp(i){Uh(i)}function Ld(i){console.error(i)}function kp(i){Uh(i)}function ah(i,a){try{var h=i.onUncaughtError;h(a.value,{componentStack:a.stack})}catch(v){setTimeout(function(){throw v})}}function Af(i,a,h){try{var v=i.onCaughtError;v(h.value,{componentStack:h.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(C){setTimeout(function(){throw C})}}function Id(i,a,h){return h=Rl(h),h.tag=3,h.payload={element:null},h.callback=function(){ah(i,a)},h}function Cu(i){return i=Rl(i),i.tag=3,i}function Bp(i,a,h,v){var C=h.type.getDerivedStateFromError;if(typeof C=="function"){var R=v.value;i.payload=function(){return C(R)},i.callback=function(){Af(a,h,v)}}var Y=h.stateNode;Y!==null&&typeof Y.componentDidCatch=="function"&&(i.callback=function(){Af(a,h,v),typeof C!="function"&&(Cc===null?Cc=new Set([this]):Cc.add(this));var rt=v.stack;this.componentDidCatch(v.value,{componentStack:rt!==null?rt:""})})}function Zh(i,a,h,v,C){if(h.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(a=h.alternate,a!==null&&Dl(a,h,C,!0),h=la.current,h!==null){switch(h.tag){case 13:return Kn===null?Xd():h.alternate===null&&ur===0&&(ur=3),h.flags&=-257,h.flags|=65536,h.lanes=C,v===bu?h.flags|=16384:(a=h.updateQueue,a===null?h.updateQueue=new Set([v]):a.add(v),Wf(i,v,C)),!1;case 22:return h.flags|=65536,v===bu?h.flags|=16384:(a=h.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([v])},h.updateQueue=a):(h=a.retryQueue,h===null?a.retryQueue=new Set([v]):h.add(v)),Wf(i,v,C)),!1}throw Error(M(435,h.tag))}return Wf(i,v,C),Xd(),!1}if(pi)return a=la.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=C,v!==_r&&(i=Error(M(422),{cause:v}),Ea(cr(i,h)))):(v!==_r&&(a=Error(M(423),{cause:v}),Ea(cr(a,h))),i=i.current.alternate,i.flags|=65536,C&=-C,i.lanes|=C,v=cr(v,h),C=Id(i.stateNode,v,C),Su(i,C),ur!==4&&(ur=2)),!1;var R=Error(M(520),{cause:v});if(R=cr(R,h),nu===null?nu=[R]:nu.push(R),ur!==4&&(ur=2),a===null)return!0;v=cr(v,h),h=a;do{switch(h.tag){case 3:return h.flags|=65536,i=C&-C,h.lanes|=i,i=Id(h.stateNode,v,i),Su(h,i),!1;case 1:if(a=h.type,R=h.stateNode,(h.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(Cc===null||!Cc.has(R))))return h.flags|=65536,C&=-C,h.lanes|=C,C=Cu(C),Bp(C,i,h,v),Su(h,C),!1}h=h.return}while(h!==null);return!1}var Gh=Error(M(461)),zr=!1;function ms(i,a,h,v){a.child=i===null?ll(a,null,h,v):ps(a,i.child,h,v)}function Cf(i,a,h,v,C){h=h.render;var R=a.ref;if("ref"in v){var Y={};for(var rt in v)rt!=="ref"&&(Y[rt]=v[rt])}else Y=v;return Ll(a),v=Vh(i,a,h,Y,R,C),rt=Wc(),i!==null&&!zr?(kl(i,a,C),ul(i,a,C)):(pi&&rt&&he(a),a.flags|=1,ms(i,a,v,C),a.child)}function Op(i,a,h,v,C){if(i===null){var R=h.type;return typeof R=="function"&&!hc(R)&&R.defaultProps===void 0&&h.compare===null?(a.tag=15,a.type=R,Np(i,a,R,v,C)):(i=dc(h.type,null,v,a,a.mode,C),i.ref=a.ref,i.return=a,a.child=i)}if(R=i.child,!jd(i,C)){var Y=R.memoizedProps;if(h=h.compare,h=h!==null?h:os,h(Y,v)&&i.ref===a.ref)return ul(i,a,C)}return a.flags|=1,i=Pr(R,v),i.ref=a.ref,i.return=a,a.child=i}function Np(i,a,h,v,C){if(i!==null){var R=i.memoizedProps;if(os(R,v)&&i.ref===a.ref)if(zr=!1,a.pendingProps=v=R,jd(i,C))(i.flags&131072)!==0&&(zr=!0);else return a.lanes=i.lanes,ul(i,a,C)}return Df(i,a,h,v,C)}function Ef(i,a,h){var v=a.pendingProps,C=v.children,R=i!==null?i.memoizedState:null;if(v.mode==="hidden"){if((a.flags&128)!==0){if(v=R!==null?R.baseLanes|h:h,i!==null){for(C=a.child=i.child,R=0;C!==null;)R=R|C.lanes|C.childLanes,C=C.sibling;a.childLanes=R&~v}else a.childLanes=0,a.child=null;return zf(i,a,v,h)}if((h&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},i!==null&&ih(a,R!==null?R.cachePool:null),R!==null?vc(a,R):Mu(),sh(a);else return a.lanes=a.childLanes=536870912,zf(i,a,R!==null?R.baseLanes|h:h,h)}else R!==null?(ih(a,R.cachePool),vc(a,R),co(),a.memoizedState=null):(i!==null&&ih(a,null),Mu(),co());return ms(i,a,C,h),a.child}function zf(i,a,h,v){var C=Oh();return C=C===null?null:{parent:gr._currentValue,pool:C},a.memoizedState={baseLanes:h,cachePool:C},i!==null&&ih(a,null),Mu(),sh(a),i!==null&&Dl(i,a,v,!0),null}function Hh(i,a){var h=a.ref;if(h===null)i!==null&&i.ref!==null&&(a.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(M(284));(i===null||i.ref!==h)&&(a.flags|=4194816)}}function Df(i,a,h,v,C){return Ll(a),h=Vh(i,a,h,v,void 0,C),v=Wc(),i!==null&&!zr?(kl(i,a,C),ul(i,a,C)):(pi&&v&&he(a),a.flags|=1,ms(i,a,h,C),a.child)}function Rd(i,a,h,v,C,R){return Ll(a),a.updateQueue=null,h=Xi(a,v,h,C),Yc(i),v=Wc(),i!==null&&!zr?(kl(i,a,R),ul(i,a,R)):(pi&&v&&he(a),a.flags|=1,ms(i,a,h,R),a.child)}function Lf(i,a,h,v,C){if(Ll(a),a.stateNode===null){var R=fi,Y=h.contextType;typeof Y=="object"&&Y!==null&&(R=wn(Y)),R=new h(v,R),a.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,R.updater=Mf,a.stateNode=R,R._reactInternals=a,R=a.stateNode,R.props=v,R.state=a.memoizedState,R.refs={},Nh(a),Y=h.contextType,R.context=typeof Y=="object"&&Y!==null?wn(Y):fi,R.state=a.memoizedState,Y=h.getDerivedStateFromProps,typeof Y=="function"&&(zd(a,h,Y,v),R.state=a.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(Y=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),Y!==R.state&&Mf.enqueueReplaceState(R,R.state,null),yc(a,v,R,C),Xc(),R.state=a.memoizedState),typeof R.componentDidMount=="function"&&(a.flags|=4194308),v=!0}else if(i===null){R=a.stateNode;var rt=a.memoizedProps,St=Au(h,rt);R.props=St;var Zt=R.context,ie=h.contextType;Y=fi,typeof ie=="object"&&ie!==null&&(Y=wn(ie));var le=h.getDerivedStateFromProps;ie=typeof le=="function"||typeof R.getSnapshotBeforeUpdate=="function",rt=a.pendingProps!==rt,ie||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(rt||Zt!==Y)&&Pf(a,R,v,Y),ao=!1;var Ht=a.memoizedState;R.state=Ht,yc(a,v,R,C),Xc(),Zt=a.memoizedState,rt||Ht!==Zt||ao?(typeof le=="function"&&(zd(a,h,le,v),Zt=a.memoizedState),(St=ao||Dd(a,h,St,v,Ht,Zt,Y))?(ie||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(a.flags|=4194308)):(typeof R.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=v,a.memoizedState=Zt),R.props=v,R.state=Zt,R.context=Y,v=St):(typeof R.componentDidMount=="function"&&(a.flags|=4194308),v=!1)}else{R=a.stateNode,$c(i,a),Y=a.memoizedProps,ie=Au(h,Y),R.props=ie,le=a.pendingProps,Ht=R.context,Zt=h.contextType,St=fi,typeof Zt=="object"&&Zt!==null&&(St=wn(Zt)),rt=h.getDerivedStateFromProps,(Zt=typeof rt=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(Y!==le||Ht!==St)&&Pf(a,R,v,St),ao=!1,Ht=a.memoizedState,R.state=Ht,yc(a,v,R,C),Xc();var Xt=a.memoizedState;Y!==le||Ht!==Xt||ao||i!==null&&i.dependencies!==null&&xu(i.dependencies)?(typeof rt=="function"&&(zd(a,h,rt,v),Xt=a.memoizedState),(ie=ao||Dd(a,h,ie,v,Ht,Xt,St)||i!==null&&i.dependencies!==null&&xu(i.dependencies))?(Zt||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(v,Xt,St),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(v,Xt,St)),typeof R.componentDidUpdate=="function"&&(a.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof R.componentDidUpdate!="function"||Y===i.memoizedProps&&Ht===i.memoizedState||(a.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||Y===i.memoizedProps&&Ht===i.memoizedState||(a.flags|=1024),a.memoizedProps=v,a.memoizedState=Xt),R.props=v,R.state=Xt,R.context=St,v=ie):(typeof R.componentDidUpdate!="function"||Y===i.memoizedProps&&Ht===i.memoizedState||(a.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||Y===i.memoizedProps&&Ht===i.memoizedState||(a.flags|=1024),v=!1)}return R=v,Hh(i,a),v=(a.flags&128)!==0,R||v?(R=a.stateNode,h=v&&typeof h.getDerivedStateFromError!="function"?null:R.render(),a.flags|=1,i!==null&&v?(a.child=ps(a,i.child,null,C),a.child=ps(a,null,h,C)):ms(i,a,h,C),a.memoizedState=R.state,i=a.child):i=ul(i,a,C),i}function kd(i,a,h,v){return Ar(),a.flags|=256,ms(i,a,h,v),a.child}var Eu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Is(i){return{baseLanes:i,cachePool:Hc()}}function Bd(i,a,h){return i=i!==null?i.childLanes&~h:0,a&&(i|=fo),i}function Od(i,a,h){var v=a.pendingProps,C=!1,R=(a.flags&128)!==0,Y;if((Y=R)||(Y=i!==null&&i.memoizedState===null?!1:(Tn.current&2)!==0),Y&&(C=!0,a.flags&=-129),Y=(a.flags&32)!==0,a.flags&=-33,i===null){if(pi){if(C?cl(a):co(),pi){var rt=$e,St;if(St=rt){t:{for(St=rt,rt=xn;St.nodeType!==8;){if(!rt){rt=null;break t}if(St=dl(St.nextSibling),St===null){rt=null;break t}}rt=St}rt!==null?(a.memoizedState={dehydrated:rt,treeContext:G!==null?{id:nt,overflow:wt}:null,retryLane:536870912,hydrationErrors:null},St=Cs(18,null,null,0),St.stateNode=rt,St.return=a,a.child=St,ke=a,$e=null,St=!0):St=!1}St||qs(a)}if(rt=a.memoizedState,rt!==null&&(rt=rt.dehydrated,rt!==null))return Th(rt)?a.lanes=32:a.lanes=536870912,null;ka(a)}return rt=v.children,v=v.fallback,C?(co(),C=a.mode,rt=qh({mode:"hidden",children:rt},C),v=no(v,C,h,null),rt.return=a,v.return=a,rt.sibling=v,a.child=rt,C=a.child,C.memoizedState=Is(h),C.childLanes=Bd(i,Y,h),a.memoizedState=Eu,v):(cl(a),If(a,rt))}if(St=i.memoizedState,St!==null&&(rt=St.dehydrated,rt!==null)){if(R)a.flags&256?(cl(a),a.flags&=-257,a=Rf(i,a,h)):a.memoizedState!==null?(co(),a.child=i.child,a.flags|=128,a=null):(co(),C=v.fallback,rt=a.mode,v=qh({mode:"visible",children:v.children},rt),C=no(C,rt,h,null),C.flags|=2,v.return=a,C.return=a,v.sibling=C,a.child=v,ps(a,i.child,null,h),v=a.child,v.memoizedState=Is(h),v.childLanes=Bd(i,Y,h),a.memoizedState=Eu,a=C);else if(cl(a),Th(rt)){if(Y=rt.nextSibling&&rt.nextSibling.dataset,Y)var Zt=Y.dgst;Y=Zt,v=Error(M(419)),v.stack="",v.digest=Y,Ea({value:v,source:null,stack:null}),a=Rf(i,a,h)}else if(zr||Dl(i,a,h,!1),Y=(h&i.childLanes)!==0,zr||Y){if(Y=Fn,Y!==null&&(v=h&-h,v=(v&42)!==0?1:li(v),v=(v&(Y.suspendedLanes|h))!==0?0:v,v!==0&&v!==St.retryLane))throw St.retryLane=v,As(i,v),po(Y,i,v),Gh;rt.data==="$?"||Xd(),a=Rf(i,a,h)}else rt.data==="$?"?(a.flags|=192,a.child=i.child,a=null):(i=St.treeContext,$e=dl(rt.nextSibling),ke=a,pi=!0,gn=null,xn=!1,i!==null&&(A[B++]=nt,A[B++]=wt,A[B++]=G,nt=i.id,wt=i.overflow,G=a),a=If(a,v.children),a.flags|=4096);return a}return C?(co(),C=v.fallback,rt=a.mode,St=i.child,Zt=St.sibling,v=Pr(St,{mode:"hidden",children:v.children}),v.subtreeFlags=St.subtreeFlags&65011712,Zt!==null?C=Pr(Zt,C):(C=no(C,rt,h,null),C.flags|=2),C.return=a,v.return=a,v.sibling=C,a.child=v,v=C,C=a.child,rt=i.child.memoizedState,rt===null?rt=Is(h):(St=rt.cachePool,St!==null?(Zt=gr._currentValue,St=St.parent!==Zt?{parent:Zt,pool:Zt}:St):St=Hc(),rt={baseLanes:rt.baseLanes|h,cachePool:St}),C.memoizedState=rt,C.childLanes=Bd(i,Y,h),a.memoizedState=Eu,v):(cl(a),h=i.child,i=h.sibling,h=Pr(h,{mode:"visible",children:v.children}),h.return=a,h.sibling=null,i!==null&&(Y=a.deletions,Y===null?(a.deletions=[i],a.flags|=16):Y.push(i)),a.child=h,a.memoizedState=null,h)}function If(i,a){return a=qh({mode:"visible",children:a},i.mode),a.return=i,i.child=a}function qh(i,a){return i=Cs(22,i,null,a),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function Rf(i,a,h){return ps(a,i.child,null,h),i=If(a,a.pendingProps.children),i.flags|=2,a.memoizedState=null,i}function jp(i,a,h){i.lanes|=a;var v=i.alternate;v!==null&&(v.lanes|=a),zl(i.return,a,h)}function Nd(i,a,h,v,C){var R=i.memoizedState;R===null?i.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:v,tail:h,tailMode:C}:(R.isBackwards=a,R.rendering=null,R.renderingStartTime=0,R.last=v,R.tail=h,R.tailMode=C)}function Fp(i,a,h){var v=a.pendingProps,C=v.revealOrder,R=v.tail;if(ms(i,a,v.children,h),v=Tn.current,(v&2)!==0)v=v&1|2,a.flags|=128;else{if(i!==null&&(i.flags&128)!==0)t:for(i=a.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&jp(i,h,a);else if(i.tag===19)jp(i,h,a);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break t;for(;i.sibling===null;){if(i.return===null||i.return===a)break t;i=i.return}i.sibling.return=i.return,i=i.sibling}v&=1}switch(xe(Tn,v),C){case"forwards":for(h=a.child,C=null;h!==null;)i=h.alternate,i!==null&&Ba(i)===null&&(C=h),h=h.sibling;h=C,h===null?(C=a.child,a.child=null):(C=h.sibling,h.sibling=null),Nd(a,!1,C,h,R);break;case"backwards":for(h=null,C=a.child,a.child=null;C!==null;){if(i=C.alternate,i!==null&&Ba(i)===null){a.child=C;break}i=C.sibling,C.sibling=h,h=C,C=i}Nd(a,!0,h,null,R);break;case"together":Nd(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function ul(i,a,h){if(i!==null&&(a.dependencies=i.dependencies),Hl|=a.lanes,(h&a.childLanes)===0)if(i!==null){if(Dl(i,a,h,!1),(h&a.childLanes)===0)return null}else return null;if(i!==null&&a.child!==i.child)throw Error(M(153));if(a.child!==null){for(i=a.child,h=Pr(i,i.pendingProps),a.child=h,h.return=a;i.sibling!==null;)i=i.sibling,h=h.sibling=Pr(i,i.pendingProps),h.return=a;h.sibling=null}return a.child}function jd(i,a){return(i.lanes&a)!==0?!0:(i=i.dependencies,!!(i!==null&&xu(i)))}function Vp(i,a,h){switch(a.tag){case 3:xi(a,a.stateNode.containerInfo),Nr(a,gr,i.memoizedState.cache),Ar();break;case 27:case 5:da(a);break;case 4:xi(a,a.stateNode.containerInfo);break;case 10:Nr(a,a.type,a.memoizedProps.value);break;case 13:var v=a.memoizedState;if(v!==null)return v.dehydrated!==null?(cl(a),a.flags|=128,null):(h&a.child.childLanes)!==0?Od(i,a,h):(cl(a),i=ul(i,a,h),i!==null?i.sibling:null);cl(a);break;case 19:var C=(i.flags&128)!==0;if(v=(h&a.childLanes)!==0,v||(Dl(i,a,h,!1),v=(h&a.childLanes)!==0),C){if(v)return Fp(i,a,h);a.flags|=128}if(C=a.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),xe(Tn,Tn.current),v)break;return null;case 22:case 23:return a.lanes=0,Ef(i,a,h);case 24:Nr(a,gr,i.memoizedState.cache)}return ul(i,a,h)}function Up(i,a,h){if(i!==null)if(i.memoizedProps!==a.pendingProps)zr=!0;else{if(!jd(i,h)&&(a.flags&128)===0)return zr=!1,Vp(i,a,h);zr=(i.flags&131072)!==0}else zr=!1,pi&&(a.flags&1048576)!==0&&qt(a,_,a.index);switch(a.lanes=0,a.tag){case 16:t:{i=a.pendingProps;var v=a.elementType,C=v._init;if(v=C(v._payload),a.type=v,typeof v=="function")hc(v)?(i=Au(v,i),a.tag=1,a=Lf(null,a,v,i,h)):(a.tag=0,a=Df(null,a,v,i,h));else{if(v!=null){if(C=v.$$typeof,C===Ne){a.tag=11,a=Cf(null,a,v,i,h);break t}else if(C===Je){a.tag=14,a=Op(null,a,v,i,h);break t}}throw a=Rn(v)||v,Error(M(306,a,""))}}return a;case 0:return Df(i,a,a.type,a.pendingProps,h);case 1:return v=a.type,C=Au(v,a.pendingProps),Lf(i,a,v,C,h);case 3:t:{if(xi(a,a.stateNode.containerInfo),i===null)throw Error(M(387));v=a.pendingProps;var R=a.memoizedState;C=R.element,$c(i,a),yc(a,v,null,h);var Y=a.memoizedState;if(v=Y.cache,Nr(a,gr,v),v!==R.cache&&pc(a,[gr],h,!0),Xc(),v=Y.element,R.isDehydrated)if(R={element:v,isDehydrated:!1,cache:Y.cache},a.updateQueue.baseState=R,a.memoizedState=R,a.flags&256){a=kd(i,a,v,h);break t}else if(v!==C){C=cr(Error(M(424)),a),Ea(C),a=kd(i,a,v,h);break t}else{switch(i=a.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for($e=dl(i.firstChild),ke=a,pi=!0,gn=null,xn=!0,h=ll(a,null,v,h),a.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Ar(),v===C){a=ul(i,a,h);break t}ms(i,a,v,h)}a=a.child}return a;case 26:return Hh(i,a),i===null?(h=fd(a.type,null,a.pendingProps,null))?a.memoizedState=h:pi||(h=a.type,i=a.pendingProps,v=ud(Se.current).createElement(h),v[ii]=a,v[si]=i,hr(v,h,i),pn(v),a.stateNode=v):a.memoizedState=fd(a.type,i.memoizedProps,a.pendingProps,i.memoizedState),null;case 27:return da(a),i===null&&pi&&(v=a.stateNode=Xr(a.type,a.pendingProps,Se.current),ke=a,xn=!0,C=$e,zc(a.type)?(ap=C,$e=dl(v.firstChild)):$e=C),ms(i,a,a.pendingProps.children,h),Hh(i,a),i===null&&(a.flags|=4194304),a.child;case 5:return i===null&&pi&&((C=v=$e)&&(v=of(v,a.type,a.pendingProps,xn),v!==null?(a.stateNode=v,ke=a,$e=dl(v.firstChild),xn=!1,C=!0):C=!1),C||qs(a)),da(a),C=a.type,R=a.pendingProps,Y=i!==null?i.memoizedProps:null,v=R.children,Xl(C,R)?v=null:Y!==null&&Xl(C,Y)&&(a.flags|=32),a.memoizedState!==null&&(C=Vh(i,a,Yn,null,null,h),Dt._currentValue=C),Hh(i,a),ms(i,a,v,h),a.child;case 6:return i===null&&pi&&((i=h=$e)&&(h=lf(h,a.pendingProps,xn),h!==null?(a.stateNode=h,ke=a,$e=null,i=!0):i=!1),i||qs(a)),null;case 13:return Od(i,a,h);case 4:return xi(a,a.stateNode.containerInfo),v=a.pendingProps,i===null?a.child=ps(a,null,v,h):ms(i,a,v,h),a.child;case 11:return Cf(i,a,a.type,a.pendingProps,h);case 7:return ms(i,a,a.pendingProps,h),a.child;case 8:return ms(i,a,a.pendingProps.children,h),a.child;case 12:return ms(i,a,a.pendingProps.children,h),a.child;case 10:return v=a.pendingProps,Nr(a,a.type,v.value),ms(i,a,v.children,h),a.child;case 9:return C=a.type._context,v=a.pendingProps.children,Ll(a),C=wn(C),v=v(C),a.flags|=1,ms(i,a,v,h),a.child;case 14:return Op(i,a,a.type,a.pendingProps,h);case 15:return Np(i,a,a.type,a.pendingProps,h);case 19:return Fp(i,a,h);case 31:return v=a.pendingProps,h=a.mode,v={mode:v.mode,children:v.children},i===null?(h=qh(v,h),h.ref=a.ref,a.child=h,h.return=a,a=h):(h=Pr(i.child,v),h.ref=a.ref,a.child=h,h.return=a,a=h),a;case 22:return Ef(i,a,h);case 24:return Ll(a),v=wn(gr),i===null?(C=Oh(),C===null&&(C=Fn,R=Il(),C.pooledCache=R,R.refCount++,R!==null&&(C.pooledCacheLanes|=h),C=R),a.memoizedState={parent:v,cache:C},Nh(a),Nr(a,gr,C)):((i.lanes&h)!==0&&($c(i,a),yc(a,null,null,h),Xc()),C=i.memoizedState,R=a.memoizedState,C.parent!==v?(C={parent:v,cache:v},a.memoizedState=C,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=C),Nr(a,gr,v)):(v=R.cache,Nr(a,gr,v),v!==C.cache&&pc(a,[gr],h,!0))),ms(i,a,a.pendingProps.children,h),a.child;case 29:throw a.pendingProps}throw Error(M(156,a.tag))}function Sc(i){i.flags|=4}function Zp(i,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!k(a)){if(a=la.current,a!==null&&((ki&4194048)===ki?Kn!==null:(ki&62914560)!==ki&&(ki&536870912)===0||a!==Kn))throw so=bu,Da;i.flags|=8192}}function oh(i,a){a!==null&&(i.flags|=4),i.flags&16384&&(a=i.tag!==22?ee():536870912,i.lanes|=a,vh|=a)}function zu(i,a){if(!pi)switch(i.tailMode){case"hidden":a=i.tail;for(var h=null;a!==null;)a.alternate!==null&&(h=a),a=a.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?a||i.tail===null?i.tail=null:i.tail.sibling=null:v.sibling=null}}function Qn(i){var a=i.alternate!==null&&i.alternate.child===i.child,h=0,v=0;if(a)for(var C=i.child;C!==null;)h|=C.lanes|C.childLanes,v|=C.subtreeFlags&65011712,v|=C.flags&65011712,C.return=i,C=C.sibling;else for(C=i.child;C!==null;)h|=C.lanes|C.childLanes,v|=C.subtreeFlags,v|=C.flags,C.return=i,C=C.sibling;return i.subtreeFlags|=v,i.childLanes=h,a}function Du(i,a,h){var v=a.pendingProps;switch(De(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qn(a),null;case 1:return Qn(a),null;case 3:return h=a.stateNode,v=null,i!==null&&(v=i.memoizedState.cache),a.memoizedState.cache!==v&&(a.flags|=2048),oa(gr),rr(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(i===null||i.child===null)&&(cs(a)?Sc(a):i===null||i.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,fc())),Qn(a),null;case 26:return h=a.memoizedState,i===null?(Sc(a),h!==null?(Qn(a),Zp(a,h)):(Qn(a),a.flags&=-16777217)):h?h!==i.memoizedState?(Sc(a),Qn(a),Zp(a,h)):(Qn(a),a.flags&=-16777217):(i.memoizedProps!==v&&Sc(a),Qn(a),a.flags&=-16777217),null;case 27:Ws(a),h=Se.current;var C=a.type;if(i!==null&&a.stateNode!=null)i.memoizedProps!==v&&Sc(a);else{if(!v){if(a.stateNode===null)throw Error(M(166));return Qn(a),null}i=ze.current,cs(a)?Vc(a):(i=Xr(C,v,h),a.stateNode=i,Sc(a))}return Qn(a),null;case 5:if(Ws(a),h=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==v&&Sc(a);else{if(!v){if(a.stateNode===null)throw Error(M(166));return Qn(a),null}if(i=ze.current,cs(a))Vc(a);else{switch(C=ud(Se.current),i){case 1:i=C.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:i=C.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":i=C.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":i=C.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":i=C.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof v.is=="string"?C.createElement("select",{is:v.is}):C.createElement("select"),v.multiple?i.multiple=!0:v.size&&(i.size=v.size);break;default:i=typeof v.is=="string"?C.createElement(h,{is:v.is}):C.createElement(h)}}i[ii]=a,i[si]=v;t:for(C=a.child;C!==null;){if(C.tag===5||C.tag===6)i.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===a)break t;for(;C.sibling===null;){if(C.return===null||C.return===a)break t;C=C.return}C.sibling.return=C.return,C=C.sibling}a.stateNode=i;t:switch(hr(i,h,v),h){case"button":case"input":case"select":case"textarea":i=!!v.autoFocus;break t;case"img":i=!0;break t;default:i=!1}i&&Sc(a)}}return Qn(a),a.flags&=-16777217,null;case 6:if(i&&a.stateNode!=null)i.memoizedProps!==v&&Sc(a);else{if(typeof v!="string"&&a.stateNode===null)throw Error(M(166));if(i=Se.current,cs(a)){if(i=a.stateNode,h=a.memoizedProps,v=null,C=ke,C!==null)switch(C.tag){case 27:case 5:v=C.memoizedProps}i[ii]=a,i=!!(i.nodeValue===h||v!==null&&v.suppressHydrationWarning===!0||np(i.nodeValue,h)),i||qs(a)}else i=ud(i).createTextNode(v),i[ii]=a,a.stateNode=i}return Qn(a),null;case 13:if(v=a.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(C=cs(a),v!==null&&v.dehydrated!==null){if(i===null){if(!C)throw Error(M(318));if(C=a.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(M(317));C[ii]=a}else Ar(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Qn(a),C=!1}else C=fc(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=C),C=!0;if(!C)return a.flags&256?(ka(a),a):(ka(a),null)}if(ka(a),(a.flags&128)!==0)return a.lanes=h,a;if(h=v!==null,i=i!==null&&i.memoizedState!==null,h){v=a.child,C=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(C=v.alternate.memoizedState.cachePool.pool);var R=null;v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(R=v.memoizedState.cachePool.pool),R!==C&&(v.flags|=2048)}return h!==i&&h&&(a.child.flags|=8192),oh(a,a.updateQueue),Qn(a),null;case 4:return rr(),i===null&&Jd(a.stateNode.containerInfo),Qn(a),null;case 10:return oa(a.type),Qn(a),null;case 19:if(Ce(Tn),C=a.memoizedState,C===null)return Qn(a),null;if(v=(a.flags&128)!==0,R=C.rendering,R===null)if(v)zu(C,!1);else{if(ur!==0||i!==null&&(i.flags&128)!==0)for(i=a.child;i!==null;){if(R=Ba(i),R!==null){for(a.flags|=128,zu(C,!1),i=R.updateQueue,a.updateQueue=i,oh(a,i),a.subtreeFlags=0,i=h,h=a.child;h!==null;)Fc(h,i),h=h.sibling;return xe(Tn,Tn.current&1|2),a.child}i=i.sibling}C.tail!==null&&dr()>Gd&&(a.flags|=128,v=!0,zu(C,!1),a.lanes=4194304)}else{if(!v)if(i=Ba(R),i!==null){if(a.flags|=128,v=!0,i=i.updateQueue,a.updateQueue=i,oh(a,i),zu(C,!0),C.tail===null&&C.tailMode==="hidden"&&!R.alternate&&!pi)return Qn(a),null}else 2*dr()-C.renderingStartTime>Gd&&h!==536870912&&(a.flags|=128,v=!0,zu(C,!1),a.lanes=4194304);C.isBackwards?(R.sibling=a.child,a.child=R):(i=C.last,i!==null?i.sibling=R:a.child=R,C.last=R)}return C.tail!==null?(a=C.tail,C.rendering=a,C.tail=a.sibling,C.renderingStartTime=dr(),a.sibling=null,i=Tn.current,xe(Tn,v?i&1|2:i&1),a):(Qn(a),null);case 22:case 23:return ka(a),rh(),v=a.memoizedState!==null,i!==null?i.memoizedState!==null!==v&&(a.flags|=8192):v&&(a.flags|=8192),v?(h&536870912)!==0&&(a.flags&128)===0&&(Qn(a),a.subtreeFlags&6&&(a.flags|=8192)):Qn(a),h=a.updateQueue,h!==null&&oh(a,h.retryQueue),h=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),v=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(v=a.memoizedState.cachePool.pool),v!==h&&(a.flags|=2048),i!==null&&Ce(ro),null;case 24:return h=null,i!==null&&(h=i.memoizedState.cache),a.memoizedState.cache!==h&&(a.flags|=2048),oa(gr),Qn(a),null;case 25:return null;case 30:return null}throw Error(M(156,a.tag))}function $h(i,a){switch(De(a),a.tag){case 1:return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 3:return oa(gr),rr(),i=a.flags,(i&65536)!==0&&(i&128)===0?(a.flags=i&-65537|128,a):null;case 26:case 27:case 5:return Ws(a),null;case 13:if(ka(a),i=a.memoizedState,i!==null&&i.dehydrated!==null){if(a.alternate===null)throw Error(M(340));Ar()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 19:return Ce(Tn),null;case 4:return rr(),null;case 10:return oa(a.type),null;case 22:case 23:return ka(a),rh(),i!==null&&Ce(ro),i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 24:return oa(gr),null;case 25:return null;default:return null}}function Gp(i,a){switch(De(a),a.tag){case 3:oa(gr),rr();break;case 26:case 27:case 5:Ws(a);break;case 4:rr();break;case 13:ka(a);break;case 19:Ce(Tn);break;case 10:oa(a.type);break;case 22:case 23:ka(a),rh(),i!==null&&Ce(ro);break;case 24:oa(gr)}}function Xh(i,a){try{var h=a.updateQueue,v=h!==null?h.lastEffect:null;if(v!==null){var C=v.next;h=C;do{if((h.tag&i)===i){v=void 0;var R=h.create,Y=h.inst;v=R(),Y.destroy=v}h=h.next}while(h!==C)}}catch(rt){Sn(a,a.return,rt)}}function Jc(i,a,h){try{var v=a.updateQueue,C=v!==null?v.lastEffect:null;if(C!==null){var R=C.next;v=R;do{if((v.tag&i)===i){var Y=v.inst,rt=Y.destroy;if(rt!==void 0){Y.destroy=void 0,C=a;var St=h,Zt=rt;try{Zt()}catch(ie){Sn(C,St,ie)}}}v=v.next}while(v!==R)}}catch(ie){Sn(a,a.return,ie)}}function Hp(i){var a=i.updateQueue;if(a!==null){var h=i.stateNode;try{Fh(a,h)}catch(v){Sn(i,i.return,v)}}}function qp(i,a,h){h.props=Au(i.type,i.memoizedProps),h.state=i.memoizedState;try{h.componentWillUnmount()}catch(v){Sn(i,a,v)}}function Yh(i,a){try{var h=i.ref;if(h!==null){switch(i.tag){case 26:case 27:case 5:var v=i.stateNode;break;case 30:v=i.stateNode;break;default:v=i.stateNode}typeof h=="function"?i.refCleanup=h(v):h.current=v}}catch(C){Sn(i,a,C)}}function Ul(i,a){var h=i.ref,v=i.refCleanup;if(h!==null)if(typeof v=="function")try{v()}catch(C){Sn(i,a,C)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(C){Sn(i,a,C)}else h.current=null}function Fd(i){var a=i.type,h=i.memoizedProps,v=i.stateNode;try{t:switch(a){case"button":case"input":case"select":case"textarea":h.autoFocus&&v.focus();break t;case"img":h.src?v.src=h.src:h.srcSet&&(v.srcset=h.srcSet)}}catch(C){Sn(i,i.return,C)}}function kf(i,a,h){try{var v=i.stateNode;_m(v,i.type,h,a),v[si]=a}catch(C){Sn(i,i.return,C)}}function Bf(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&zc(i.type)||i.tag===4}function Lu(i){t:for(;;){for(;i.sibling===null;){if(i.return===null||Bf(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&zc(i.type)||i.flags&2||i.child===null||i.tag===4)continue t;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Of(i,a,h){var v=i.tag;if(v===5||v===6)i=i.stateNode,a?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(i,a):(a=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,a.appendChild(i),h=h._reactRootContainer,h!=null||a.onclick!==null||(a.onclick=Ys));else if(v!==4&&(v===27&&zc(i.type)&&(h=i.stateNode,a=null),i=i.child,i!==null))for(Of(i,a,h),i=i.sibling;i!==null;)Of(i,a,h),i=i.sibling}function jn(i,a,h){var v=i.tag;if(v===5||v===6)i=i.stateNode,a?h.insertBefore(i,a):h.appendChild(i);else if(v!==4&&(v===27&&zc(i.type)&&(h=i.stateNode),i=i.child,i!==null))for(jn(i,a,h),i=i.sibling;i!==null;)jn(i,a,h),i=i.sibling}function Iu(i){var a=i.stateNode,h=i.memoizedProps;try{for(var v=i.type,C=a.attributes;C.length;)a.removeAttributeNode(C[0]);hr(a,v,h),a[ii]=i,a[si]=h}catch(R){Sn(i,i.return,R)}}var Zl=!1,Jn=!1,lh=!1,ch=typeof WeakSet=="function"?WeakSet:Set,$r=null;function $p(i,a){if(i=i.containerInfo,nf=be,i=Ko(i),Qo(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else t:{h=(h=i.ownerDocument)&&h.defaultView||window;var v=h.getSelection&&h.getSelection();if(v&&v.rangeCount!==0){h=v.anchorNode;var C=v.anchorOffset,R=v.focusNode;v=v.focusOffset;try{h.nodeType,R.nodeType}catch{h=null;break t}var Y=0,rt=-1,St=-1,Zt=0,ie=0,le=i,Ht=null;e:for(;;){for(var Xt;le!==h||C!==0&&le.nodeType!==3||(rt=Y+C),le!==R||v!==0&&le.nodeType!==3||(St=Y+v),le.nodeType===3&&(Y+=le.nodeValue.length),(Xt=le.firstChild)!==null;)Ht=le,le=Xt;for(;;){if(le===i)break e;if(Ht===h&&++Zt===C&&(rt=Y),Ht===R&&++ie===v&&(St=Y),(Xt=le.nextSibling)!==null)break;le=Ht,Ht=le.parentNode}le=Xt}h=rt===-1||St===-1?null:{start:rt,end:St}}else h=null}h=h||{start:0,end:0}}else h=null;for(rf={focusedElem:i,selectionRange:h},be=!1,$r=a;$r!==null;)if(a=$r,i=a.child,(a.subtreeFlags&1024)!==0&&i!==null)i.return=a,$r=i;else for(;$r!==null;){switch(a=$r,R=a.alternate,i=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&R!==null){i=void 0,h=a,C=R.memoizedProps,R=R.memoizedState,v=h.stateNode;try{var _i=Au(h.type,C,h.elementType===h.type);i=v.getSnapshotBeforeUpdate(_i,R),v.__reactInternalSnapshotBeforeUpdate=i}catch(ui){Sn(h,h.return,ui)}}break;case 3:if((i&1024)!==0){if(i=a.stateNode.containerInfo,h=i.nodeType,h===9)af(i);else if(h===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":af(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(M(163))}if(i=a.sibling,i!==null){i.return=a.return,$r=i;break}$r=a.return}}function uh(i,a,h){var v=h.flags;switch(h.tag){case 0:case 11:case 15:Pc(i,h),v&4&&Xh(5,h);break;case 1:if(Pc(i,h),v&4)if(i=h.stateNode,a===null)try{i.componentDidMount()}catch(Y){Sn(h,h.return,Y)}else{var C=Au(h.type,a.memoizedProps);a=a.memoizedState;try{i.componentDidUpdate(C,a,i.__reactInternalSnapshotBeforeUpdate)}catch(Y){Sn(h,h.return,Y)}}v&64&&Hp(h),v&512&&Yh(h,h.return);break;case 3:if(Pc(i,h),v&64&&(i=h.updateQueue,i!==null)){if(a=null,h.child!==null)switch(h.child.tag){case 27:case 5:a=h.child.stateNode;break;case 1:a=h.child.stateNode}try{Fh(i,a)}catch(Y){Sn(h,h.return,Y)}}break;case 27:a===null&&v&4&&Iu(h);case 26:case 5:Pc(i,h),a===null&&v&4&&Fd(h),v&512&&Yh(h,h.return);break;case 12:Pc(i,h);break;case 13:Pc(i,h),v&4&&Xp(i,h),v&64&&(i=h.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(h=Km.bind(null,h),n_(i,h))));break;case 22:if(v=h.memoizedState!==null||Zl,!v){a=a!==null&&a.memoizedState!==null||Jn,C=Zl;var R=Jn;Zl=v,(Jn=a)&&!R?tu(i,h,(h.subtreeFlags&8772)!==0):Pc(i,h),Zl=C,Jn=R}break;case 30:break;default:Pc(i,h)}}function Vd(i){var a=i.alternate;a!==null&&(i.alternate=null,Vd(a)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(a=i.stateNode,a!==null&&Me(a)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var yn=null,Rs=!1;function Oa(i,a,h){for(h=h.child;h!==null;)hh(i,a,h),h=h.sibling}function hh(i,a,h){if(Vn&&typeof Vn.onCommitFiberUnmount=="function")try{Vn.onCommitFiberUnmount(ts,h)}catch{}switch(h.tag){case 26:Jn||Ul(h,a),Oa(i,a,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Jn||Ul(h,a);var v=yn,C=Rs;zc(h.type)&&(yn=h.stateNode,Rs=!1),Oa(i,a,h),Gu(h.stateNode),yn=v,Rs=C;break;case 5:Jn||Ul(h,a);case 6:if(v=yn,C=Rs,yn=null,Oa(i,a,h),yn=v,Rs=C,yn!==null)if(Rs)try{(yn.nodeType===9?yn.body:yn.nodeName==="HTML"?yn.ownerDocument.body:yn).removeChild(h.stateNode)}catch(R){Sn(h,a,R)}else try{yn.removeChild(h.stateNode)}catch(R){Sn(h,a,R)}break;case 18:yn!==null&&(Rs?(i=yn,hd(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,h.stateNode),ir(i)):hd(yn,h.stateNode));break;case 4:v=yn,C=Rs,yn=h.stateNode.containerInfo,Rs=!0,Oa(i,a,h),yn=v,Rs=C;break;case 0:case 11:case 14:case 15:Jn||Jc(2,h,a),Jn||Jc(4,h,a),Oa(i,a,h);break;case 1:Jn||(Ul(h,a),v=h.stateNode,typeof v.componentWillUnmount=="function"&&qp(h,a,v)),Oa(i,a,h);break;case 21:Oa(i,a,h);break;case 22:Jn=(v=Jn)||h.memoizedState!==null,Oa(i,a,h),Jn=v;break;default:Oa(i,a,h)}}function Xp(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{ir(i)}catch(h){Sn(a,a.return,h)}}function Yp(i){switch(i.tag){case 13:case 19:var a=i.stateNode;return a===null&&(a=i.stateNode=new ch),a;case 22:return i=i.stateNode,a=i._retryCache,a===null&&(a=i._retryCache=new ch),a;default:throw Error(M(435,i.tag))}}function Mc(i,a){var h=Yp(i);a.forEach(function(v){var C=Qm.bind(null,i,v);h.has(v)||(h.add(v),v.then(C,C))})}function uo(i,a){var h=a.deletions;if(h!==null)for(var v=0;v<h.length;v++){var C=h[v],R=i,Y=a,rt=Y;t:for(;rt!==null;){switch(rt.tag){case 27:if(zc(rt.type)){yn=rt.stateNode,Rs=!1;break t}break;case 5:yn=rt.stateNode,Rs=!1;break t;case 3:case 4:yn=rt.stateNode.containerInfo,Rs=!0;break t}rt=rt.return}if(yn===null)throw Error(M(160));hh(R,Y,C),yn=null,Rs=!1,R=C.alternate,R!==null&&(R.return=null),C.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)dh(a,i),a=a.sibling}var Vo=null;function dh(i,a){var h=i.alternate,v=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:uo(a,i),ca(i),v&4&&(Jc(3,i,i.return),Xh(3,i),Jc(5,i,i.return));break;case 1:uo(a,i),ca(i),v&512&&(Jn||h===null||Ul(h,h.return)),v&64&&Zl&&(i=i.updateQueue,i!==null&&(v=i.callbacks,v!==null&&(h=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=h===null?v:h.concat(v))));break;case 26:var C=Vo;if(uo(a,i),ca(i),v&512&&(Jn||h===null||Ul(h,h.return)),v&4){var R=h!==null?h.memoizedState:null;if(v=i.memoizedState,h===null)if(v===null)if(i.stateNode===null){t:{v=i.type,h=i.memoizedProps,C=C.ownerDocument||C;e:switch(v){case"title":R=C.getElementsByTagName("title")[0],(!R||R[Js]||R[ii]||R.namespaceURI==="http://www.w3.org/2000/svg"||R.hasAttribute("itemprop"))&&(R=C.createElement(v),C.head.insertBefore(R,C.querySelector("head > title"))),hr(R,v,h),R[ii]=i,pn(R),v=R;break t;case"link":var Y=b("link","href",C).get(v+(h.href||""));if(Y){for(var rt=0;rt<Y.length;rt++)if(R=Y[rt],R.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&R.getAttribute("rel")===(h.rel==null?null:h.rel)&&R.getAttribute("title")===(h.title==null?null:h.title)&&R.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){Y.splice(rt,1);break e}}R=C.createElement(v),hr(R,v,h),C.head.appendChild(R);break;case"meta":if(Y=b("meta","content",C).get(v+(h.content||""))){for(rt=0;rt<Y.length;rt++)if(R=Y[rt],R.getAttribute("content")===(h.content==null?null:""+h.content)&&R.getAttribute("name")===(h.name==null?null:h.name)&&R.getAttribute("property")===(h.property==null?null:h.property)&&R.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&R.getAttribute("charset")===(h.charSet==null?null:h.charSet)){Y.splice(rt,1);break e}}R=C.createElement(v),hr(R,v,h),C.head.appendChild(R);break;default:throw Error(M(468,v))}R[ii]=i,pn(R),v=R}i.stateNode=v}else S(C,i.type,i.stateNode);else i.stateNode=e(C,v,i.memoizedProps);else R!==v?(R===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):R.count--,v===null?S(C,i.type,i.stateNode):e(C,v,i.memoizedProps)):v===null&&i.stateNode!==null&&kf(i,i.memoizedProps,h.memoizedProps)}break;case 27:uo(a,i),ca(i),v&512&&(Jn||h===null||Ul(h,h.return)),h!==null&&v&4&&kf(i,i.memoizedProps,h.memoizedProps);break;case 5:if(uo(a,i),ca(i),v&512&&(Jn||h===null||Ul(h,h.return)),i.flags&32){C=i.stateNode;try{ss(C,"")}catch(Xt){Sn(i,i.return,Xt)}}v&4&&i.stateNode!=null&&(C=i.memoizedProps,kf(i,C,h!==null?h.memoizedProps:C)),v&1024&&(lh=!0);break;case 6:if(uo(a,i),ca(i),v&4){if(i.stateNode===null)throw Error(M(162));v=i.memoizedProps,h=i.stateNode;try{h.nodeValue=v}catch(Xt){Sn(i,i.return,Xt)}}break;case 3:if(x=null,C=Vo,Vo=Sh(a.containerInfo),uo(a,i),Vo=C,ca(i),v&4&&h!==null&&h.memoizedState.isDehydrated)try{ir(a.containerInfo)}catch(Xt){Sn(i,i.return,Xt)}lh&&(lh=!1,Nf(i));break;case 4:v=Vo,Vo=Sh(i.stateNode.containerInfo),uo(a,i),ca(i),Vo=v;break;case 12:uo(a,i),ca(i);break;case 13:uo(a,i),ca(i),i.child.flags&8192&&i.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Zf=dr()),v&4&&(v=i.updateQueue,v!==null&&(i.updateQueue=null,Mc(i,v)));break;case 22:C=i.memoizedState!==null;var St=h!==null&&h.memoizedState!==null,Zt=Zl,ie=Jn;if(Zl=Zt||C,Jn=ie||St,uo(a,i),Jn=ie,Zl=Zt,ca(i),v&8192)t:for(a=i.stateNode,a._visibility=C?a._visibility&-2:a._visibility|1,C&&(h===null||St||Zl||Jn||Ru(i)),h=null,a=i;;){if(a.tag===5||a.tag===26){if(h===null){St=h=a;try{if(R=St.stateNode,C)Y=R.style,typeof Y.setProperty=="function"?Y.setProperty("display","none","important"):Y.display="none";else{rt=St.stateNode;var le=St.memoizedProps.style,Ht=le!=null&&le.hasOwnProperty("display")?le.display:null;rt.style.display=Ht==null||typeof Ht=="boolean"?"":(""+Ht).trim()}}catch(Xt){Sn(St,St.return,Xt)}}}else if(a.tag===6){if(h===null){St=a;try{St.stateNode.nodeValue=C?"":St.memoizedProps}catch(Xt){Sn(St,St.return,Xt)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===i)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break t;for(;a.sibling===null;){if(a.return===null||a.return===i)break t;h===a&&(h=null),a=a.return}h===a&&(h=null),a.sibling.return=a.return,a=a.sibling}v&4&&(v=i.updateQueue,v!==null&&(h=v.retryQueue,h!==null&&(v.retryQueue=null,Mc(i,h))));break;case 19:uo(a,i),ca(i),v&4&&(v=i.updateQueue,v!==null&&(i.updateQueue=null,Mc(i,v)));break;case 30:break;case 21:break;default:uo(a,i),ca(i)}}function ca(i){var a=i.flags;if(a&2){try{for(var h,v=i.return;v!==null;){if(Bf(v)){h=v;break}v=v.return}if(h==null)throw Error(M(160));switch(h.tag){case 27:var C=h.stateNode,R=Lu(i);jn(i,R,C);break;case 5:var Y=h.stateNode;h.flags&32&&(ss(Y,""),h.flags&=-33);var rt=Lu(i);jn(i,rt,Y);break;case 3:case 4:var St=h.stateNode.containerInfo,Zt=Lu(i);Of(i,Zt,St);break;default:throw Error(M(161))}}catch(ie){Sn(i,i.return,ie)}i.flags&=-3}a&4096&&(i.flags&=-4097)}function Nf(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var a=i;Nf(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),i=i.sibling}}function Pc(i,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)uh(i,a.alternate,a),a=a.sibling}function Ru(i){for(i=i.child;i!==null;){var a=i;switch(a.tag){case 0:case 11:case 14:case 15:Jc(4,a,a.return),Ru(a);break;case 1:Ul(a,a.return);var h=a.stateNode;typeof h.componentWillUnmount=="function"&&qp(a,a.return,h),Ru(a);break;case 27:Gu(a.stateNode);case 26:case 5:Ul(a,a.return),Ru(a);break;case 22:a.memoizedState===null&&Ru(a);break;case 30:Ru(a);break;default:Ru(a)}i=i.sibling}}function tu(i,a,h){for(h=h&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var v=a.alternate,C=i,R=a,Y=R.flags;switch(R.tag){case 0:case 11:case 15:tu(C,R,h),Xh(4,R);break;case 1:if(tu(C,R,h),v=R,C=v.stateNode,typeof C.componentDidMount=="function")try{C.componentDidMount()}catch(Zt){Sn(v,v.return,Zt)}if(v=R,C=v.updateQueue,C!==null){var rt=v.stateNode;try{var St=C.shared.hiddenCallbacks;if(St!==null)for(C.shared.hiddenCallbacks=null,C=0;C<St.length;C++)jh(St[C],rt)}catch(Zt){Sn(v,v.return,Zt)}}h&&Y&64&&Hp(R),Yh(R,R.return);break;case 27:Iu(R);case 26:case 5:tu(C,R,h),h&&v===null&&Y&4&&Fd(R),Yh(R,R.return);break;case 12:tu(C,R,h);break;case 13:tu(C,R,h),h&&Y&4&&Xp(C,R);break;case 22:R.memoizedState===null&&tu(C,R,h),Yh(R,R.return);break;case 30:break;default:tu(C,R,h)}a=a.sibling}}function jf(i,a){var h=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),i=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==h&&(i!=null&&i.refCount++,h!=null&&mc(h))}function Ff(i,a){i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&mc(i))}function Gl(i,a,h,v){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)ku(i,a,h,v),a=a.sibling}function ku(i,a,h,v){var C=a.flags;switch(a.tag){case 0:case 11:case 15:Gl(i,a,h,v),C&2048&&Xh(9,a);break;case 1:Gl(i,a,h,v);break;case 3:Gl(i,a,h,v),C&2048&&(i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&mc(i)));break;case 12:if(C&2048){Gl(i,a,h,v),i=a.stateNode;try{var R=a.memoizedProps,Y=R.id,rt=R.onPostCommit;typeof rt=="function"&&rt(Y,a.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(St){Sn(a,a.return,St)}}else Gl(i,a,h,v);break;case 13:Gl(i,a,h,v);break;case 23:break;case 22:R=a.stateNode,Y=a.alternate,a.memoizedState!==null?R._visibility&2?Gl(i,a,h,v):Wh(i,a):R._visibility&2?Gl(i,a,h,v):(R._visibility|=2,fh(i,a,h,v,(a.subtreeFlags&10256)!==0)),C&2048&&jf(Y,a);break;case 24:Gl(i,a,h,v),C&2048&&Ff(a.alternate,a);break;default:Gl(i,a,h,v)}}function fh(i,a,h,v,C){for(C=C&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var R=i,Y=a,rt=h,St=v,Zt=Y.flags;switch(Y.tag){case 0:case 11:case 15:fh(R,Y,rt,St,C),Xh(8,Y);break;case 23:break;case 22:var ie=Y.stateNode;Y.memoizedState!==null?ie._visibility&2?fh(R,Y,rt,St,C):Wh(R,Y):(ie._visibility|=2,fh(R,Y,rt,St,C)),C&&Zt&2048&&jf(Y.alternate,Y);break;case 24:fh(R,Y,rt,St,C),C&&Zt&2048&&Ff(Y.alternate,Y);break;default:fh(R,Y,rt,St,C)}a=a.sibling}}function Wh(i,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var h=i,v=a,C=v.flags;switch(v.tag){case 22:Wh(h,v),C&2048&&jf(v.alternate,v);break;case 24:Wh(h,v),C&2048&&Ff(v.alternate,v);break;default:Wh(h,v)}a=a.sibling}}var ph=8192;function mh(i){if(i.subtreeFlags&ph)for(i=i.child;i!==null;)Vf(i),i=i.sibling}function Vf(i){switch(i.tag){case 26:mh(i),i.flags&ph&&i.memoizedState!==null&&q(Vo,i.memoizedState,i.memoizedProps);break;case 5:mh(i);break;case 3:case 4:var a=Vo;Vo=Sh(i.stateNode.containerInfo),mh(i),Vo=a;break;case 22:i.memoizedState===null&&(a=i.alternate,a!==null&&a.memoizedState!==null?(a=ph,ph=16777216,mh(i),ph=a):mh(i));break;default:mh(i)}}function Wp(i){var a=i.alternate;if(a!==null&&(i=a.child,i!==null)){a.child=null;do a=i.sibling,i.sibling=null,i=a;while(i!==null)}}function Bu(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var h=0;h<a.length;h++){var v=a[h];$r=v,Kp(v,i)}Wp(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)_h(i),i=i.sibling}function _h(i){switch(i.tag){case 0:case 11:case 15:Bu(i),i.flags&2048&&Jc(9,i,i.return);break;case 3:Bu(i);break;case 12:Bu(i);break;case 22:var a=i.stateNode;i.memoizedState!==null&&a._visibility&2&&(i.return===null||i.return.tag!==13)?(a._visibility&=-3,gh(i)):Bu(i);break;default:Bu(i)}}function gh(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var h=0;h<a.length;h++){var v=a[h];$r=v,Kp(v,i)}Wp(i)}for(i=i.child;i!==null;){switch(a=i,a.tag){case 0:case 11:case 15:Jc(8,a,a.return),gh(a);break;case 22:h=a.stateNode,h._visibility&2&&(h._visibility&=-3,gh(a));break;default:gh(a)}i=i.sibling}}function Kp(i,a){for(;$r!==null;){var h=$r;switch(h.tag){case 0:case 11:case 15:Jc(8,h,a);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var v=h.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:mc(h.memoizedState.cache)}if(v=h.child,v!==null)v.return=h,$r=v;else t:for(h=i;$r!==null;){v=$r;var C=v.sibling,R=v.return;if(Vd(v),v===h){$r=null;break t}if(C!==null){C.return=R,$r=C;break t}$r=R}}}var Xm={getCacheForType:function(i){var a=wn(gr),h=a.data.get(i);return h===void 0&&(h=i(),a.data.set(i,h)),h}},Qp=typeof WeakMap=="function"?WeakMap:Map,un=0,Fn=null,ji=null,ki=0,hn=0,ho=null,eu=!1,yh=!1,Uf=!1,Ac=0,ur=0,Hl=0,iu=0,Ud=0,fo=0,vh=0,nu=null,Na=null,Zd=!1,Zf=0,Gd=1/0,Hd=null,Cc=null,ks=0,ru=null,ql=null,Hn=0,Kh=0,qd=null,Gf=null,Ou=0,su=null;function ja(){if((un&2)!==0&&ki!==0)return ki&-ki;if(Qt.T!==null){var i=Cr;return i!==0?i:rd()}return qn()}function Jp(){fo===0&&(fo=(ki&536870912)===0||pi?oe():536870912);var i=la.current;return i!==null&&(i.flags|=32),fo}function po(i,a,h){(i===Fn&&(hn===2||hn===9)||i.cancelPendingCommit!==null)&&(xh(i,0),au(i,ki,fo,!1)),It(i,h),((un&2)===0||i!==Fn)&&(i===Fn&&((un&2)===0&&(iu|=h),ur===4&&au(i,ki,fo,!1)),mo(i))}function tm(i,a,h){if((un&6)!==0)throw Error(M(327));var v=!h&&(a&124)===0&&(a&i.expiredLanes)===0||zt(i,a),C=v?ou(i,a):Qh(i,a,!0),R=v;do{if(C===0){yh&&!v&&au(i,a,0,!1);break}else{if(h=i.current.alternate,R&&!Ym(h)){C=Qh(i,a,!1),R=!1;continue}if(C===2){if(R=a,i.errorRecoveryDisabledLanes&R)var Y=0;else Y=i.pendingLanes&-536870913,Y=Y!==0?Y:Y&536870912?536870912:0;if(Y!==0){a=Y;t:{var rt=i;C=nu;var St=rt.current.memoizedState.isDehydrated;if(St&&(xh(rt,Y).flags|=256),Y=Qh(rt,Y,!1),Y!==2){if(Uf&&!St){rt.errorRecoveryDisabledLanes|=R,iu|=R,C=4;break t}R=Na,Na=C,R!==null&&(Na===null?Na=R:Na.push.apply(Na,R))}C=Y}if(R=!1,C!==2)continue}}if(C===1){xh(i,0),au(i,a,0,!0);break}t:{switch(v=i,R=C,R){case 0:case 1:throw Error(M(345));case 4:if((a&4194048)!==a)break;case 6:au(v,a,fo,!eu);break t;case 2:Na=null;break;case 3:case 5:break;default:throw Error(M(329))}if((a&62914560)===a&&(C=Zf+300-dr(),10<C)){if(au(v,a,fo,!eu),Ft(v,0,!0)!==0)break t;v.timeoutHandle=sp(em.bind(null,v,h,Na,Hd,Zd,a,fo,iu,vh,eu,R,2,-0,0),C);break t}em(v,h,Na,Hd,Zd,a,fo,iu,vh,eu,R,0,-0,0)}}break}while(!0);mo(i)}function em(i,a,h,v,C,R,Y,rt,St,Zt,ie,le,Ht,Xt){if(i.timeoutHandle=-1,le=a.subtreeFlags,(le&8192||(le&16785408)===16785408)&&(N={stylesheets:null,count:0,unsuspend:V},Vf(a),le=W(),le!==null)){i.cancelPendingCommit=le(qf.bind(null,i,a,R,h,v,C,Y,rt,St,ie,1,Ht,Xt)),au(i,R,Y,!Zt);return}qf(i,a,R,h,v,C,Y,rt,St)}function Ym(i){for(var a=i;;){var h=a.tag;if((h===0||h===11||h===15)&&a.flags&16384&&(h=a.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var v=0;v<h.length;v++){var C=h[v],R=C.getSnapshot;C=C.value;try{if(!Gr(R(),C))return!1}catch{return!1}}if(h=a.child,a.subtreeFlags&16384&&h!==null)h.return=a,a=h;else{if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function au(i,a,h,v){a&=~Ud,a&=~iu,i.suspendedLanes|=a,i.pingedLanes&=~a,v&&(i.warmLanes|=a),v=i.expirationTimes;for(var C=a;0<C;){var R=31-Ct(C),Y=1<<R;v[R]=-1,C&=~Y}h!==0&&bi(i,h,a)}function $d(){return(un&6)===0?(Fu(0),!1):!0}function Hf(){if(ji!==null){if(hn===0)var i=ji.return;else i=ji,$s=Or=null,Bl(i),Ln=null,Gn=0,i=ji;for(;i!==null;)Gp(i.alternate,i),i=i.return;ji=null}}function xh(i,a){var h=i.timeoutHandle;h!==-1&&(i.timeoutHandle=-1,vm(h)),h=i.cancelPendingCommit,h!==null&&(i.cancelPendingCommit=null,h()),Hf(),Fn=i,ji=h=Pr(i.current,null),ki=a,hn=0,ho=null,eu=!1,yh=zt(i,a),Uf=!1,vh=fo=Ud=iu=Hl=ur=0,Na=nu=null,Zd=!1,(a&8)!==0&&(a|=a&32);var v=i.entangledLanes;if(v!==0)for(i=i.entanglements,v&=a;0<v;){var C=31-Ct(v),R=1<<C;a|=i[C],v&=~R}return Ac=a,Oo(),h}function im(i,a){Ci=null,Qt.H=qr,a===tl||a===Ee?(a=Tu(),hn=3):a===Da?(a=Tu(),hn=4):hn=a===Gh?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,ho=a,ji===null&&(ur=1,ah(i,cr(a,i.current)))}function nm(){var i=Qt.H;return Qt.H=qr,i===null?qr:i}function rm(){var i=Qt.A;return Qt.A=Xm,i}function Xd(){ur=4,eu||(ki&4194048)!==ki&&la.current!==null||(yh=!0),(Hl&134217727)===0&&(iu&134217727)===0||Fn===null||au(Fn,ki,fo,!1)}function Qh(i,a,h){var v=un;un|=2;var C=nm(),R=rm();(Fn!==i||ki!==a)&&(Hd=null,xh(i,a)),a=!1;var Y=ur;t:do try{if(hn!==0&&ji!==null){var rt=ji,St=ho;switch(hn){case 8:Hf(),Y=6;break t;case 3:case 2:case 9:case 6:la.current===null&&(a=!0);var Zt=hn;if(hn=0,ho=null,Ec(i,rt,St,Zt),h&&yh){Y=0;break t}break;default:Zt=hn,hn=0,ho=null,Ec(i,rt,St,Zt)}}sm(),Y=ur;break}catch(ie){im(i,ie)}while(!0);return a&&i.shellSuspendCounter++,$s=Or=null,un=v,Qt.H=C,Qt.A=R,ji===null&&(Fn=null,ki=0,Oo()),Y}function sm(){for(;ji!==null;)Nu(ji)}function ou(i,a){var h=un;un|=2;var v=nm(),C=rm();Fn!==i||ki!==a?(Hd=null,Gd=dr()+500,xh(i,a)):yh=zt(i,a);t:do try{if(hn!==0&&ji!==null){a=ji;var R=ho;e:switch(hn){case 1:hn=0,ho=null,Ec(i,a,R,1);break;case 2:case 9:if(wu(R)){hn=0,ho=null,td(a);break}a=function(){hn!==2&&hn!==9||Fn!==i||(hn=7),mo(i)},R.then(a,a);break t;case 3:hn=7;break t;case 4:hn=5;break t;case 7:wu(R)?(hn=0,ho=null,td(a)):(hn=0,ho=null,Ec(i,a,R,7));break;case 5:var Y=null;switch(ji.tag){case 26:Y=ji.memoizedState;case 5:case 27:var rt=ji;if(!Y||k(Y)){hn=0,ho=null;var St=rt.sibling;if(St!==null)ji=St;else{var Zt=rt.return;Zt!==null?(ji=Zt,Yd(Zt)):ji=null}break e}}hn=0,ho=null,Ec(i,a,R,5);break;case 6:hn=0,ho=null,Ec(i,a,R,6);break;case 8:Hf(),ur=6;break t;default:throw Error(M(462))}}Jh();break}catch(ie){im(i,ie)}while(!0);return $s=Or=null,Qt.H=v,Qt.A=C,un=h,ji!==null?0:(Fn=null,ki=0,Oo(),ur)}function Jh(){for(;ji!==null&&!Os();)Nu(ji)}function Nu(i){var a=Up(i.alternate,i,Ac);i.memoizedProps=i.pendingProps,a===null?Yd(i):ji=a}function td(i){var a=i,h=a.alternate;switch(a.tag){case 15:case 0:a=Rd(h,a,a.pendingProps,a.type,void 0,ki);break;case 11:a=Rd(h,a,a.pendingProps,a.type.render,a.ref,ki);break;case 5:Bl(a);default:Gp(h,a),a=ji=Fc(a,Ac),a=Up(h,a,Ac)}i.memoizedProps=i.pendingProps,a===null?Yd(i):ji=a}function Ec(i,a,h,v){$s=Or=null,Bl(a),Ln=null,Gn=0;var C=a.return;try{if(Zh(i,C,a,h,ki)){ur=1,ah(i,cr(h,i.current)),ji=null;return}}catch(R){if(C!==null)throw ji=C,R;ur=1,ah(i,cr(h,i.current)),ji=null;return}a.flags&32768?(pi||v===1?i=!0:yh||(ki&536870912)!==0?i=!1:(eu=i=!0,(v===2||v===9||v===3||v===6)&&(v=la.current,v!==null&&v.tag===13&&(v.flags|=16384))),am(a,i)):Yd(a)}function Yd(i){var a=i;do{if((a.flags&32768)!==0){am(a,eu);return}i=a.return;var h=Du(a.alternate,a,Ac);if(h!==null){ji=h;return}if(a=a.sibling,a!==null){ji=a;return}ji=a=i}while(a!==null);ur===0&&(ur=5)}function am(i,a){do{var h=$h(i.alternate,i);if(h!==null){h.flags&=32767,ji=h;return}if(h=i.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!a&&(i=i.sibling,i!==null)){ji=i;return}ji=i=h}while(i!==null);ur=6,ji=null}function qf(i,a,h,v,C,R,Y,rt,St){i.cancelPendingCommit=null;do bh();while(ks!==0);if((un&6)!==0)throw Error(M(327));if(a!==null){if(a===i.current)throw Error(M(177));if(R=a.lanes|a.childLanes,R|=Hr,ri(i,h,R,Y,rt,St),i===Fn&&(ji=Fn=null,ki=0),ql=a,ru=i,Hn=h,Kh=R,qd=C,Gf=v,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,um(vs,function(){return Wd(),null})):(i.callbackNode=null,i.callbackPriority=0),v=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||v){v=Qt.T,Qt.T=null,C=me.p,me.p=2,Y=un,un|=4;try{$p(i,a,h)}finally{un=Y,me.p=C,Qt.T=v}}ks=1,$f(),om(),Xf()}}function $f(){if(ks===1){ks=0;var i=ru,a=ql,h=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||h){h=Qt.T,Qt.T=null;var v=me.p;me.p=2;var C=un;un|=4;try{dh(a,i);var R=rf,Y=Ko(i.containerInfo),rt=R.focusedElem,St=R.selectionRange;if(Y!==rt&&rt&&rt.ownerDocument&&Li(rt.ownerDocument.documentElement,rt)){if(St!==null&&Qo(rt)){var Zt=St.start,ie=St.end;if(ie===void 0&&(ie=Zt),"selectionStart"in rt)rt.selectionStart=Zt,rt.selectionEnd=Math.min(ie,rt.value.length);else{var le=rt.ownerDocument||document,Ht=le&&le.defaultView||window;if(Ht.getSelection){var Xt=Ht.getSelection(),_i=rt.textContent.length,ui=Math.min(St.start,_i),Pn=St.end===void 0?ui:Math.min(St.end,_i);!Xt.extend&&ui>Pn&&(Y=Pn,Pn=ui,ui=Y);var kt=aa(rt,ui),Rt=aa(rt,Pn);if(kt&&Rt&&(Xt.rangeCount!==1||Xt.anchorNode!==kt.node||Xt.anchorOffset!==kt.offset||Xt.focusNode!==Rt.node||Xt.focusOffset!==Rt.offset)){var Vt=le.createRange();Vt.setStart(kt.node,kt.offset),Xt.removeAllRanges(),ui>Pn?(Xt.addRange(Vt),Xt.extend(Rt.node,Rt.offset)):(Vt.setEnd(Rt.node,Rt.offset),Xt.addRange(Vt))}}}}for(le=[],Xt=rt;Xt=Xt.parentNode;)Xt.nodeType===1&&le.push({element:Xt,left:Xt.scrollLeft,top:Xt.scrollTop});for(typeof rt.focus=="function"&&rt.focus(),rt=0;rt<le.length;rt++){var ae=le[rt];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}be=!!nf,rf=nf=null}finally{un=C,me.p=v,Qt.T=h}}i.current=a,ks=2}}function om(){if(ks===2){ks=0;var i=ru,a=ql,h=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||h){h=Qt.T,Qt.T=null;var v=me.p;me.p=2;var C=un;un|=4;try{uh(i,a.alternate,a)}finally{un=C,me.p=v,Qt.T=h}}ks=3}}function Xf(){if(ks===4||ks===3){ks=0,Ks();var i=ru,a=ql,h=Hn,v=Gf;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?ks=5:(ks=0,ql=ru=null,Yf(i,i.pendingLanes));var C=i.pendingLanes;if(C===0&&(Cc=null),Zi(h),a=a.stateNode,Vn&&typeof Vn.onCommitFiberRoot=="function")try{Vn.onCommitFiberRoot(ts,a,void 0,(a.current.flags&128)===128)}catch{}if(v!==null){a=Qt.T,C=me.p,me.p=2,Qt.T=null;try{for(var R=i.onRecoverableError,Y=0;Y<v.length;Y++){var rt=v[Y];R(rt.value,{componentStack:rt.stack})}}finally{Qt.T=a,me.p=C}}(Hn&3)!==0&&bh(),mo(i),C=i.pendingLanes,(h&4194090)!==0&&(C&42)!==0?i===su?Ou++:(Ou=0,su=i):Ou=0,Fu(0)}}function Yf(i,a){(i.pooledCacheLanes&=a)===0&&(a=i.pooledCache,a!=null&&(i.pooledCache=null,mc(a)))}function bh(i){return $f(),om(),Xf(),Wd()}function Wd(){if(ks!==5)return!1;var i=ru,a=Kh;Kh=0;var h=Zi(Hn),v=Qt.T,C=me.p;try{me.p=32>h?32:h,Qt.T=null,h=qd,qd=null;var R=ru,Y=Hn;if(ks=0,ql=ru=null,Hn=0,(un&6)!==0)throw Error(M(331));var rt=un;if(un|=4,_h(R.current),ku(R,R.current,Y,h),un=rt,Fu(0,!1),Vn&&typeof Vn.onPostCommitFiberRoot=="function")try{Vn.onPostCommitFiberRoot(ts,R)}catch{}return!0}finally{me.p=C,Qt.T=v,Yf(i,a)}}function lm(i,a,h){a=cr(h,a),a=Id(i.stateNode,a,2),i=el(i,a,2),i!==null&&(It(i,2),mo(i))}function Sn(i,a,h){if(i.tag===3)lm(i,i,h);else for(;a!==null;){if(a.tag===3){lm(a,i,h);break}else if(a.tag===1){var v=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Cc===null||!Cc.has(v))){i=cr(h,i),h=Cu(2),v=el(a,h,2),v!==null&&(Bp(h,v,a,i),It(v,2),mo(v));break}}a=a.return}}function Wf(i,a,h){var v=i.pingCache;if(v===null){v=i.pingCache=new Qp;var C=new Set;v.set(a,C)}else C=v.get(a),C===void 0&&(C=new Set,v.set(a,C));C.has(h)||(Uf=!0,C.add(h),i=Wm.bind(null,i,a,h),a.then(i,i))}function Wm(i,a,h){var v=i.pingCache;v!==null&&v.delete(a),i.pingedLanes|=i.suspendedLanes&h,i.warmLanes&=~h,Fn===i&&(ki&h)===h&&(ur===4||ur===3&&(ki&62914560)===ki&&300>dr()-Zf?(un&2)===0&&xh(i,0):Ud|=h,vh===ki&&(vh=0)),mo(i)}function cm(i,a){a===0&&(a=ee()),i=As(i,a),i!==null&&(It(i,a),mo(i))}function Km(i){var a=i.memoizedState,h=0;a!==null&&(h=a.retryLane),cm(i,h)}function Qm(i,a){var h=0;switch(i.tag){case 13:var v=i.stateNode,C=i.memoizedState;C!==null&&(h=C.retryLane);break;case 19:v=i.stateNode;break;case 22:v=i.stateNode._retryCache;break;default:throw Error(M(314))}v!==null&&v.delete(a),cm(i,h)}function um(i,a){return sn(i,a)}var ed=null,Fa=null,$l=!1,id=!1,nd=!1,ju=0;function mo(i){i!==Fa&&i.next===null&&(Fa===null?ed=Fa=i:Fa=Fa.next=i),id=!0,$l||($l=!0,hm())}function Fu(i,a){if(!nd&&id){nd=!0;do for(var h=!1,v=ed;v!==null;){if(i!==0){var C=v.pendingLanes;if(C===0)var R=0;else{var Y=v.suspendedLanes,rt=v.pingedLanes;R=(1<<31-Ct(42|i)+1)-1,R&=C&~(Y&~rt),R=R&201326741?R&201326741|1:R?R|2:0}R!==0&&(h=!0,Kf(v,R))}else R=ki,R=Ft(v,v===Fn?R:0,v.cancelPendingCommit!==null||v.timeoutHandle!==-1),(R&3)===0||zt(v,R)||(h=!0,Kf(v,R));v=v.next}while(h);nd=!1}}function Jm(){Kd()}function Kd(){id=$l=!1;var i=0;ju!==0&&(ym()&&(i=ju),ju=0);for(var a=dr(),h=null,v=ed;v!==null;){var C=v.next,R=Qd(v,a);R===0?(v.next=null,h===null?ed=C:h.next=C,C===null&&(Fa=h)):(h=v,(i!==0||(R&3)!==0)&&(id=!0)),v=C}Fu(i)}function Qd(i,a){for(var h=i.suspendedLanes,v=i.pingedLanes,C=i.expirationTimes,R=i.pendingLanes&-62914561;0<R;){var Y=31-Ct(R),rt=1<<Y,St=C[Y];St===-1?((rt&h)===0||(rt&v)!==0)&&(C[Y]=Kt(rt,a)):St<=a&&(i.expiredLanes|=rt),R&=~rt}if(a=Fn,h=ki,h=Ft(i,i===a?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),v=i.callbackNode,h===0||i===a&&(hn===2||hn===9)||i.cancelPendingCommit!==null)return v!==null&&v!==null&&An(v),i.callbackNode=null,i.callbackPriority=0;if((h&3)===0||zt(i,h)){if(a=h&-h,a===i.callbackPriority)return a;switch(v!==null&&An(v),Zi(h)){case 2:case 8:h=vo;break;case 32:h=vs;break;case 268435456:h=fa;break;default:h=vs}return v=Vu.bind(null,i),h=sn(h,v),i.callbackPriority=a,i.callbackNode=h,a}return v!==null&&v!==null&&An(v),i.callbackPriority=2,i.callbackNode=null,2}function Vu(i,a){if(ks!==0&&ks!==5)return i.callbackNode=null,i.callbackPriority=0,null;var h=i.callbackNode;if(bh()&&i.callbackNode!==h)return null;var v=ki;return v=Ft(i,i===Fn?v:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),v===0?null:(tm(i,v,a),Qd(i,dr()),i.callbackNode!=null&&i.callbackNode===h?Vu.bind(null,i):null)}function Kf(i,a){if(bh())return null;tm(i,a,!0)}function hm(){i_(function(){(un&6)!==0?sn(Qs,Jm):Kd()})}function rd(){return ju===0&&(ju=oe()),ju}function Qf(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:di(""+i)}function sd(i,a){var h=a.ownerDocument.createElement("input");return h.name=a.name,h.value=a.value,i.id&&h.setAttribute("form",i.id),a.parentNode.insertBefore(h,a),i=new FormData(i),h.parentNode.removeChild(h),i}function dm(i,a,h,v,C){if(a==="submit"&&h&&h.stateNode===C){var R=Qf((C[si]||null).action),Y=v.submitter;Y&&(a=(a=Y[si]||null)?Qf(a.formAction):Y.getAttribute("formAction"),a!==null&&(R=a,Y=null));var rt=new as("action","action",null,v,C);i.push({event:rt,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(ju!==0){var St=Y?sd(C,Y):new FormData(C);Dn(h,{pending:!0,data:St,method:C.method,action:R},null,St)}}else typeof R=="function"&&(rt.preventDefault(),St=Y?sd(C,Y):new FormData(C),Dn(h,{pending:!0,data:St,method:C.method,action:R},R,St))},currentTarget:C}]})}}for(var Jf=0;Jf<Bo.length;Jf++){var tp=Bo[Jf],fm=tp.toLowerCase(),t_=tp[0].toUpperCase()+tp.slice(1);Gs(fm,"on"+t_)}Gs(cc,"onAnimationEnd"),Gs(ls,"onAnimationIteration"),Gs(Ro,"onAnimationStart"),Gs("dblclick","onDoubleClick"),Gs("focusin","onFocus"),Gs("focusout","onBlur"),Gs(yu,"onTransitionRun"),Gs(Ma,"onTransitionStart"),Gs(uc,"onTransitionCancel"),Gs(ko,"onTransitionEnd"),ma("onMouseEnter",["mouseout","mouseover"]),ma("onMouseLeave",["mouseout","mouseover"]),ma("onPointerEnter",["pointerout","pointerover"]),ma("onPointerLeave",["pointerout","pointerover"]),is("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),is("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),is("onBeforeInput",["compositionend","keypress","textInput","paste"]),is("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),is("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),is("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ad="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),e_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ad));function pm(i,a){a=(a&4)!==0;for(var h=0;h<i.length;h++){var v=i[h],C=v.event;v=v.listeners;t:{var R=void 0;if(a)for(var Y=v.length-1;0<=Y;Y--){var rt=v[Y],St=rt.instance,Zt=rt.currentTarget;if(rt=rt.listener,St!==R&&C.isPropagationStopped())break t;R=rt,C.currentTarget=Zt;try{R(C)}catch(ie){Uh(ie)}C.currentTarget=null,R=St}else for(Y=0;Y<v.length;Y++){if(rt=v[Y],St=rt.instance,Zt=rt.currentTarget,rt=rt.listener,St!==R&&C.isPropagationStopped())break t;R=rt,C.currentTarget=Zt;try{R(C)}catch(ie){Uh(ie)}C.currentTarget=null,R=St}}}}function Fi(i,a){var h=a[ue];h===void 0&&(h=a[ue]=new Set);var v=i+"__bubble";h.has(v)||(ep(a,i,2,!1),h.add(v))}function od(i,a,h){var v=0;a&&(v|=4),ep(h,i,v,a)}var hl="_reactListening"+Math.random().toString(36).slice(2);function Jd(i){if(!i[hl]){i[hl]=!0,hi.forEach(function(h){h!=="selectionchange"&&(e_.has(h)||od(h,!1,i),od(h,!0,i))});var a=i.nodeType===9?i:i.ownerDocument;a===null||a[hl]||(a[hl]=!0,od("selectionchange",!1,a))}}function ep(i,a,h,v){switch(We(a)){case 2:var C=He;break;case 8:C=Ae;break;default:C=Te}h=C.bind(null,a,h,i),C=void 0,!or||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(C=!0),v?C!==void 0?i.addEventListener(a,h,{capture:!0,passive:C}):i.addEventListener(a,h,!0):C!==void 0?i.addEventListener(a,h,{passive:C}):i.addEventListener(a,h,!1)}function tf(i,a,h,v,C){var R=v;if((a&1)===0&&(a&2)===0&&v!==null)t:for(;;){if(v===null)return;var Y=v.tag;if(Y===3||Y===4){var rt=v.stateNode.containerInfo;if(rt===C)break;if(Y===4)for(Y=v.return;Y!==null;){var St=Y.tag;if((St===3||St===4)&&Y.stateNode.containerInfo===C)return;Y=Y.return}for(;rt!==null;){if(Y=ci(rt),Y===null)return;if(St=Y.tag,St===5||St===6||St===26||St===27){v=R=Y;continue t}rt=rt.parentNode}}v=v.return}Ui(function(){var Zt=R,ie=Xa(h),le=[];t:{var Ht=Ps.get(i);if(Ht!==void 0){var Xt=as,_i=i;switch(i){case"keypress":if(je(h)===0)break t;case"keydown":case"keyup":Xt=tc;break;case"focusin":_i="focus",Xt=qo;break;case"focusout":_i="blur",Xt=qo;break;case"beforeblur":case"afterblur":Xt=qo;break;case"click":if(h.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Xt=Wa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Xt=pr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Xt=Ih;break;case cc:case ls:case Ro:Xt=Bn;break;case ko:Xt=Rh;break;case"scroll":case"scrollend":Xt=pu;break;case"wheel":Xt=ic;break;case"copy":case"cut":case"paste":Xt=$o;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Xt=kc;break;case"toggle":case"beforetoggle":Xt=ws}var ui=(a&4)!==0,Pn=!ui&&(i==="scroll"||i==="scrollend"),kt=ui?Ht!==null?Ht+"Capture":null:Ht;ui=[];for(var Rt=Zt,Vt;Rt!==null;){var ae=Rt;if(Vt=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||Vt===null||kt===null||(ae=ti(Rt,kt),ae!=null&&ui.push(wh(Rt,ae,Vt))),Pn)break;Rt=Rt.return}0<ui.length&&(Ht=new Xt(Ht,_i,null,h,ie),le.push({event:Ht,listeners:ui}))}}if((a&7)===0){t:{if(Ht=i==="mouseover"||i==="pointerover",Xt=i==="mouseout"||i==="pointerout",Ht&&h!==ia&&(_i=h.relatedTarget||h.fromElement)&&(ci(_i)||_i[fn]))break t;if((Xt||Ht)&&(Ht=ie.window===ie?ie:(Ht=ie.ownerDocument)?Ht.defaultView||Ht.parentWindow:window,Xt?(_i=h.relatedTarget||h.toElement,Xt=Zt,_i=_i?ci(_i):null,_i!==null&&(Pn=F(_i),ui=_i.tag,_i!==Pn||ui!==5&&ui!==27&&ui!==6)&&(_i=null)):(Xt=null,_i=Zt),Xt!==_i)){if(ui=Wa,ae="onMouseLeave",kt="onMouseEnter",Rt="mouse",(i==="pointerout"||i==="pointerover")&&(ui=kc,ae="onPointerLeave",kt="onPointerEnter",Rt="pointer"),Pn=Xt==null?Ht:an(Xt),Vt=_i==null?Ht:an(_i),Ht=new ui(ae,Rt+"leave",Xt,h,ie),Ht.target=Pn,Ht.relatedTarget=Vt,ae=null,ci(ie)===Zt&&(ui=new ui(kt,Rt+"enter",_i,h,ie),ui.target=Vt,ui.relatedTarget=Pn,ae=ui),Pn=ae,Xt&&_i)e:{for(ui=Xt,kt=_i,Rt=0,Vt=ui;Vt;Vt=lu(Vt))Rt++;for(Vt=0,ae=kt;ae;ae=lu(ae))Vt++;for(;0<Rt-Vt;)ui=lu(ui),Rt--;for(;0<Vt-Rt;)kt=lu(kt),Vt--;for(;Rt--;){if(ui===kt||kt!==null&&ui===kt.alternate)break e;ui=lu(ui),kt=lu(kt)}ui=null}else ui=null;Xt!==null&&ip(le,Ht,Xt,ui,!1),_i!==null&&Pn!==null&&ip(le,Pn,_i,ui,!0)}}t:{if(Ht=Zt?an(Zt):window,Xt=Ht.nodeName&&Ht.nodeName.toLowerCase(),Xt==="select"||Xt==="input"&&Ht.type==="file")var Ke=Wo;else if(Yo(Ht))if(Qa)Ke=Qu;else{Ke=kh;var Bi=Nc}else Xt=Ht.nodeName,!Xt||Xt.toLowerCase()!=="input"||Ht.type!=="checkbox"&&Ht.type!=="radio"?Zt&&js(Zt.elementType)&&(Ke=Wo):Ke=Ta;if(Ke&&(Ke=Ke(i,Zt))){gu(le,Ke,h,ie);break t}Bi&&Bi(i,Ht,Zt),i==="focusout"&&Zt&&Ht.type==="number"&&Zt.memoizedProps.value!=null&&So(Ht,"number",Ht.value)}switch(Bi=Zt?an(Zt):window,i){case"focusin":(Yo(Bi)||Bi.contentEditable==="true")&&(Ms=Bi,Zs=Zt,Ja=null);break;case"focusout":Ja=Zs=Ms=null;break;case"mousedown":jc=!0;break;case"contextmenu":case"mouseup":case"dragend":jc=!1,Ju(le,h,ie);break;case"selectionchange":if(oc)break;case"keydown":case"keyup":Ju(le,h,ie)}var qe;if(wa)t:{switch(i){case"compositionstart":var oi="onCompositionStart";break t;case"compositionend":oi="onCompositionEnd";break t;case"compositionupdate":oi="onCompositionUpdate";break t}oi=void 0}else wl?Oc(i,h)&&(oi="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(oi="onCompositionStart");oi&&(xl&&h.locale!=="ko"&&(wl||oi!=="onCompositionStart"?oi==="onCompositionEnd"&&wl&&(qe=Ye()):(_n=ie,Ri="value"in _n?_n.value:_n.textContent,wl=!0)),Bi=ld(Zt,oi),0<Bi.length&&(oi=new ra(oi,i,null,h,ie),le.push({event:oi,listeners:Bi}),qe?oi.data=qe:(qe=nc(h),qe!==null&&(oi.data=qe)))),(qe=Wu?zo(i,h):Ku(i,h))&&(oi=ld(Zt,"onBeforeInput"),0<oi.length&&(Bi=new ra("onBeforeInput","beforeinput",null,h,ie),le.push({event:Bi,listeners:oi}),Bi.data=qe)),dm(le,i,Zt,h,ie)}pm(le,a)})}function wh(i,a,h){return{instance:i,listener:a,currentTarget:h}}function ld(i,a){for(var h=a+"Capture",v=[];i!==null;){var C=i,R=C.stateNode;if(C=C.tag,C!==5&&C!==26&&C!==27||R===null||(C=ti(i,h),C!=null&&v.unshift(wh(i,C,R)),C=ti(i,a),C!=null&&v.push(wh(i,C,R))),i.tag===3)return v;i=i.return}return[]}function lu(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function ip(i,a,h,v,C){for(var R=a._reactName,Y=[];h!==null&&h!==v;){var rt=h,St=rt.alternate,Zt=rt.stateNode;if(rt=rt.tag,St!==null&&St===v)break;rt!==5&&rt!==26&&rt!==27||Zt===null||(St=Zt,C?(Zt=ti(h,R),Zt!=null&&Y.unshift(wh(h,Zt,St))):C||(Zt=ti(h,R),Zt!=null&&Y.push(wh(h,Zt,St)))),h=h.return}Y.length!==0&&i.push({event:a,listeners:Y})}var cd=/\r\n?/g,mm=/\u0000|\uFFFD/g;function ef(i){return(typeof i=="string"?i:""+i).replace(cd,`
`).replace(mm,"")}function np(i,a){return a=ef(a),ef(i)===a}function Ys(){}function Hi(i,a,h,v,C,R){switch(h){case"children":typeof v=="string"?a==="body"||a==="textarea"&&v===""||ss(i,v):(typeof v=="number"||typeof v=="bigint")&&a!=="body"&&ss(i,""+v);break;case"className":Vi(i,"class",v);break;case"tabIndex":Vi(i,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":Vi(i,h,v);break;case"style":Ns(i,v,R);break;case"data":if(a!=="object"){Vi(i,"data",v);break}case"src":case"href":if(v===""&&(a!=="a"||h!=="href")){i.removeAttribute(h);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){i.removeAttribute(h);break}v=di(""+v),i.setAttribute(h,v);break;case"action":case"formAction":if(typeof v=="function"){i.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof R=="function"&&(h==="formAction"?(a!=="input"&&Hi(i,a,"name",C.name,C,null),Hi(i,a,"formEncType",C.formEncType,C,null),Hi(i,a,"formMethod",C.formMethod,C,null),Hi(i,a,"formTarget",C.formTarget,C,null)):(Hi(i,a,"encType",C.encType,C,null),Hi(i,a,"method",C.method,C,null),Hi(i,a,"target",C.target,C,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){i.removeAttribute(h);break}v=di(""+v),i.setAttribute(h,v);break;case"onClick":v!=null&&(i.onclick=Ys);break;case"onScroll":v!=null&&Fi("scroll",i);break;case"onScrollEnd":v!=null&&Fi("scrollend",i);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(M(61));if(h=v.__html,h!=null){if(C.children!=null)throw Error(M(60));i.innerHTML=h}}break;case"multiple":i.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":i.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){i.removeAttribute("xlink:href");break}h=di(""+v),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(h,""+v):i.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(h,""):i.removeAttribute(h);break;case"capture":case"download":v===!0?i.setAttribute(h,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(h,v):i.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?i.setAttribute(h,v):i.removeAttribute(h);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?i.removeAttribute(h):i.setAttribute(h,v);break;case"popover":Fi("beforetoggle",i),Fi("toggle",i),wr(i,"popover",v);break;case"xlinkActuate":ya(i,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":ya(i,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":ya(i,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":ya(i,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":ya(i,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":ya(i,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":ya(i,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":ya(i,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":ya(i,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":wr(i,"is",v);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=ea.get(h)||h,wr(i,h,v))}}function Uu(i,a,h,v,C,R){switch(h){case"style":Ns(i,v,R);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(M(61));if(h=v.__html,h!=null){if(C.children!=null)throw Error(M(60));i.innerHTML=h}}break;case"children":typeof v=="string"?ss(i,v):(typeof v=="number"||typeof v=="bigint")&&ss(i,""+v);break;case"onScroll":v!=null&&Fi("scroll",i);break;case"onScrollEnd":v!=null&&Fi("scrollend",i);break;case"onClick":v!=null&&(i.onclick=Ys);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Jl.hasOwnProperty(h))t:{if(h[0]==="o"&&h[1]==="n"&&(C=h.endsWith("Capture"),a=h.slice(2,C?h.length-7:void 0),R=i[si]||null,R=R!=null?R[h]:null,typeof R=="function"&&i.removeEventListener(a,R,C),typeof v=="function")){typeof R!="function"&&R!==null&&(h in i?i[h]=null:i.hasAttribute(h)&&i.removeAttribute(h)),i.addEventListener(a,v,C);break t}h in i?i[h]=v:v===!0?i.setAttribute(h,""):wr(i,h,v)}}}function hr(i,a,h){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fi("error",i),Fi("load",i);var v=!1,C=!1,R;for(R in h)if(h.hasOwnProperty(R)){var Y=h[R];if(Y!=null)switch(R){case"src":v=!0;break;case"srcSet":C=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(M(137,a));default:Hi(i,a,R,Y,h,null)}}C&&Hi(i,a,"srcSet",h.srcSet,h,null),v&&Hi(i,a,"src",h.src,h,null);return;case"input":Fi("invalid",i);var rt=R=Y=C=null,St=null,Zt=null;for(v in h)if(h.hasOwnProperty(v)){var ie=h[v];if(ie!=null)switch(v){case"name":C=ie;break;case"type":Y=ie;break;case"checked":St=ie;break;case"defaultChecked":Zt=ie;break;case"value":R=ie;break;case"defaultValue":rt=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(M(137,a));break;default:Hi(i,a,v,ie,h,null)}}Ho(i,R,rt,St,Zt,Y,C,!1),gl(i);return;case"select":Fi("invalid",i),v=Y=R=null;for(C in h)if(h.hasOwnProperty(C)&&(rt=h[C],rt!=null))switch(C){case"value":R=rt;break;case"defaultValue":Y=rt;break;case"multiple":v=rt;default:Hi(i,a,C,rt,h,null)}a=R,h=Y,i.multiple=!!v,a!=null?rs(i,!!v,a,!1):h!=null&&rs(i,!!v,h,!0);return;case"textarea":Fi("invalid",i),R=C=v=null;for(Y in h)if(h.hasOwnProperty(Y)&&(rt=h[Y],rt!=null))switch(Y){case"value":v=rt;break;case"defaultValue":C=rt;break;case"children":R=rt;break;case"dangerouslySetInnerHTML":if(rt!=null)throw Error(M(91));break;default:Hi(i,a,Y,rt,h,null)}bs(i,v,C,R),gl(i);return;case"option":for(St in h)if(h.hasOwnProperty(St)&&(v=h[St],v!=null))switch(St){case"selected":i.selected=v&&typeof v!="function"&&typeof v!="symbol";break;default:Hi(i,a,St,v,h,null)}return;case"dialog":Fi("beforetoggle",i),Fi("toggle",i),Fi("cancel",i),Fi("close",i);break;case"iframe":case"object":Fi("load",i);break;case"video":case"audio":for(v=0;v<ad.length;v++)Fi(ad[v],i);break;case"image":Fi("error",i),Fi("load",i);break;case"details":Fi("toggle",i);break;case"embed":case"source":case"link":Fi("error",i),Fi("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Zt in h)if(h.hasOwnProperty(Zt)&&(v=h[Zt],v!=null))switch(Zt){case"children":case"dangerouslySetInnerHTML":throw Error(M(137,a));default:Hi(i,a,Zt,v,h,null)}return;default:if(js(a)){for(ie in h)h.hasOwnProperty(ie)&&(v=h[ie],v!==void 0&&Uu(i,a,ie,v,h,void 0));return}}for(rt in h)h.hasOwnProperty(rt)&&(v=h[rt],v!=null&&Hi(i,a,rt,v,h,null))}function _m(i,a,h,v){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var C=null,R=null,Y=null,rt=null,St=null,Zt=null,ie=null;for(Xt in h){var le=h[Xt];if(h.hasOwnProperty(Xt)&&le!=null)switch(Xt){case"checked":break;case"value":break;case"defaultValue":St=le;default:v.hasOwnProperty(Xt)||Hi(i,a,Xt,null,v,le)}}for(var Ht in v){var Xt=v[Ht];if(le=h[Ht],v.hasOwnProperty(Ht)&&(Xt!=null||le!=null))switch(Ht){case"type":R=Xt;break;case"name":C=Xt;break;case"checked":Zt=Xt;break;case"defaultChecked":ie=Xt;break;case"value":Y=Xt;break;case"defaultValue":rt=Xt;break;case"children":case"dangerouslySetInnerHTML":if(Xt!=null)throw Error(M(137,a));break;default:Xt!==le&&Hi(i,a,Ht,Xt,v,le)}}Rr(i,Y,rt,St,Zt,ie,R,C);return;case"select":Xt=Y=rt=Ht=null;for(R in h)if(St=h[R],h.hasOwnProperty(R)&&St!=null)switch(R){case"value":break;case"multiple":Xt=St;default:v.hasOwnProperty(R)||Hi(i,a,R,null,v,St)}for(C in v)if(R=v[C],St=h[C],v.hasOwnProperty(C)&&(R!=null||St!=null))switch(C){case"value":Ht=R;break;case"defaultValue":rt=R;break;case"multiple":Y=R;default:R!==St&&Hi(i,a,C,R,v,St)}a=rt,h=Y,v=Xt,Ht!=null?rs(i,!!h,Ht,!1):!!v!=!!h&&(a!=null?rs(i,!!h,a,!0):rs(i,!!h,h?[]:"",!1));return;case"textarea":Xt=Ht=null;for(rt in h)if(C=h[rt],h.hasOwnProperty(rt)&&C!=null&&!v.hasOwnProperty(rt))switch(rt){case"value":break;case"children":break;default:Hi(i,a,rt,null,v,C)}for(Y in v)if(C=v[Y],R=h[Y],v.hasOwnProperty(Y)&&(C!=null||R!=null))switch(Y){case"value":Ht=C;break;case"defaultValue":Xt=C;break;case"children":break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(M(91));break;default:C!==R&&Hi(i,a,Y,C,v,R)}Zn(i,Ht,Xt);return;case"option":for(var _i in h)if(Ht=h[_i],h.hasOwnProperty(_i)&&Ht!=null&&!v.hasOwnProperty(_i))switch(_i){case"selected":i.selected=!1;break;default:Hi(i,a,_i,null,v,Ht)}for(St in v)if(Ht=v[St],Xt=h[St],v.hasOwnProperty(St)&&Ht!==Xt&&(Ht!=null||Xt!=null))switch(St){case"selected":i.selected=Ht&&typeof Ht!="function"&&typeof Ht!="symbol";break;default:Hi(i,a,St,Ht,v,Xt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ui in h)Ht=h[ui],h.hasOwnProperty(ui)&&Ht!=null&&!v.hasOwnProperty(ui)&&Hi(i,a,ui,null,v,Ht);for(Zt in v)if(Ht=v[Zt],Xt=h[Zt],v.hasOwnProperty(Zt)&&Ht!==Xt&&(Ht!=null||Xt!=null))switch(Zt){case"children":case"dangerouslySetInnerHTML":if(Ht!=null)throw Error(M(137,a));break;default:Hi(i,a,Zt,Ht,v,Xt)}return;default:if(js(a)){for(var Pn in h)Ht=h[Pn],h.hasOwnProperty(Pn)&&Ht!==void 0&&!v.hasOwnProperty(Pn)&&Uu(i,a,Pn,void 0,v,Ht);for(ie in v)Ht=v[ie],Xt=h[ie],!v.hasOwnProperty(ie)||Ht===Xt||Ht===void 0&&Xt===void 0||Uu(i,a,ie,Ht,v,Xt);return}}for(var kt in h)Ht=h[kt],h.hasOwnProperty(kt)&&Ht!=null&&!v.hasOwnProperty(kt)&&Hi(i,a,kt,null,v,Ht);for(le in v)Ht=v[le],Xt=h[le],!v.hasOwnProperty(le)||Ht===Xt||Ht==null&&Xt==null||Hi(i,a,le,Ht,v,Xt)}var nf=null,rf=null;function ud(i){return i.nodeType===9?i:i.ownerDocument}function gm(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function rp(i,a){if(i===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&a==="foreignObject"?0:i}function Xl(i,a){return i==="textarea"||i==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var sf=null;function ym(){var i=window.event;return i&&i.type==="popstate"?i===sf?!1:(sf=i,!0):(sf=null,!1)}var sp=typeof setTimeout=="function"?setTimeout:void 0,vm=typeof clearTimeout=="function"?clearTimeout:void 0,xm=typeof Promise=="function"?Promise:void 0,i_=typeof queueMicrotask=="function"?queueMicrotask:typeof xm<"u"?function(i){return xm.resolve(null).then(i).catch(bm)}:sp;function bm(i){setTimeout(function(){throw i})}function zc(i){return i==="head"}function hd(i,a){var h=a,v=0,C=0;do{var R=h.nextSibling;if(i.removeChild(h),R&&R.nodeType===8)if(h=R.data,h==="/$"){if(0<v&&8>v){h=v;var Y=i.ownerDocument;if(h&1&&Gu(Y.documentElement),h&2&&Gu(Y.body),h&4)for(h=Y.head,Gu(h),Y=h.firstChild;Y;){var rt=Y.nextSibling,St=Y.nodeName;Y[Js]||St==="SCRIPT"||St==="STYLE"||St==="LINK"&&Y.rel.toLowerCase()==="stylesheet"||h.removeChild(Y),Y=rt}}if(C===0){i.removeChild(R),ir(a);return}C--}else h==="$"||h==="$?"||h==="$!"?C++:v=h.charCodeAt(0)-48;else v=0;h=R}while(h);ir(a)}function af(i){var a=i.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var h=a;switch(a=a.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":af(h),Me(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}i.removeChild(h)}}function of(i,a,h,v){for(;i.nodeType===1;){var C=h;if(i.nodeName.toLowerCase()!==a.toLowerCase()){if(!v&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(v){if(!i[Js])switch(a){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(R=i.getAttribute("rel"),R==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(R!==C.rel||i.getAttribute("href")!==(C.href==null||C.href===""?null:C.href)||i.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin)||i.getAttribute("title")!==(C.title==null?null:C.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(R=i.getAttribute("src"),(R!==(C.src==null?null:C.src)||i.getAttribute("type")!==(C.type==null?null:C.type)||i.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin))&&R&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(a==="input"&&i.type==="hidden"){var R=C.name==null?null:""+C.name;if(C.type==="hidden"&&i.getAttribute("name")===R)return i}else return i;if(i=dl(i.nextSibling),i===null)break}return null}function lf(i,a,h){if(a==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!h||(i=dl(i.nextSibling),i===null))return null;return i}function Th(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function n_(i,a){var h=i.ownerDocument;if(i.data!=="$?"||h.readyState==="complete")a();else{var v=function(){a(),h.removeEventListener("DOMContentLoaded",v)};h.addEventListener("DOMContentLoaded",v),i._reactRetry=v}}function dl(i){for(;i!=null;i=i.nextSibling){var a=i.nodeType;if(a===1||a===3)break;if(a===8){if(a=i.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return i}var ap=null;function Zu(i){i=i.previousSibling;for(var a=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"){if(a===0)return i;a--}else h==="/$"&&a++}i=i.previousSibling}return null}function Xr(i,a,h){switch(a=ud(h),i){case"html":if(i=a.documentElement,!i)throw Error(M(452));return i;case"head":if(i=a.head,!i)throw Error(M(453));return i;case"body":if(i=a.body,!i)throw Error(M(454));return i;default:throw Error(M(451))}}function Gu(i){for(var a=i.attributes;a.length;)i.removeAttributeNode(a[0]);Me(i)}var _o=new Map,op=new Set;function Sh(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Dc=me.d;me.d={f:wm,r:Tm,D:cp,C:up,L:Sm,m:dd,X:Mm,S:hp,M:dp};function wm(){var i=Dc.f(),a=$d();return i||a}function Tm(i){var a=ai(i);a!==null&&a.tag===5&&a.type==="form"?Wi(a):Dc.r(i)}var Mh=typeof document>"u"?null:document;function lp(i,a,h){var v=Mh;if(v&&typeof a=="string"&&a){var C=Tr(a);C='link[rel="'+i+'"][href="'+C+'"]',typeof h=="string"&&(C+='[crossorigin="'+h+'"]'),op.has(C)||(op.add(C),i={rel:i,crossOrigin:h,href:a},v.querySelector(C)===null&&(a=v.createElement("link"),hr(a,"link",i),pn(a),v.head.appendChild(a)))}}function cp(i){Dc.D(i),lp("dns-prefetch",i,null)}function up(i,a){Dc.C(i,a),lp("preconnect",i,a)}function Sm(i,a,h){Dc.L(i,a,h);var v=Mh;if(v&&i&&a){var C='link[rel="preload"][as="'+Tr(a)+'"]';a==="image"&&h&&h.imageSrcSet?(C+='[imagesrcset="'+Tr(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(C+='[imagesizes="'+Tr(h.imageSizes)+'"]')):C+='[href="'+Tr(i)+'"]';var R=C;switch(a){case"style":R=Yl(i);break;case"script":R=Ph(i)}_o.has(R)||(i=Q({rel:"preload",href:a==="image"&&h&&h.imageSrcSet?void 0:i,as:a},h),_o.set(R,i),v.querySelector(C)!==null||a==="style"&&v.querySelector(Hu(R))||a==="script"&&v.querySelector(r(R))||(a=v.createElement("link"),hr(a,"link",i),pn(a),v.head.appendChild(a)))}}function dd(i,a){Dc.m(i,a);var h=Mh;if(h&&i){var v=a&&typeof a.as=="string"?a.as:"script",C='link[rel="modulepreload"][as="'+Tr(v)+'"][href="'+Tr(i)+'"]',R=C;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":R=Ph(i)}if(!_o.has(R)&&(i=Q({rel:"modulepreload",href:i},a),_o.set(R,i),h.querySelector(C)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(r(R)))return}v=h.createElement("link"),hr(v,"link",i),pn(v),h.head.appendChild(v)}}}function hp(i,a,h){Dc.S(i,a,h);var v=Mh;if(v&&i){var C=xs(v).hoistableStyles,R=Yl(i);a=a||"default";var Y=C.get(R);if(!Y){var rt={loading:0,preload:null};if(Y=v.querySelector(Hu(R)))rt.loading=5;else{i=Q({rel:"stylesheet",href:i,"data-precedence":a},h),(h=_o.get(R))&&l(i,h);var St=Y=v.createElement("link");pn(St),hr(St,"link",i),St._p=new Promise(function(Zt,ie){St.onload=Zt,St.onerror=ie}),St.addEventListener("load",function(){rt.loading|=1}),St.addEventListener("error",function(){rt.loading|=2}),rt.loading|=4,n(Y,a,v)}Y={type:"stylesheet",instance:Y,count:1,state:rt},C.set(R,Y)}}}function Mm(i,a){Dc.X(i,a);var h=Mh;if(h&&i){var v=xs(h).hoistableScripts,C=Ph(i),R=v.get(C);R||(R=h.querySelector(r(C)),R||(i=Q({src:i,async:!0},a),(a=_o.get(C))&&d(i,a),R=h.createElement("script"),pn(R),hr(R,"link",i),h.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},v.set(C,R))}}function dp(i,a){Dc.M(i,a);var h=Mh;if(h&&i){var v=xs(h).hoistableScripts,C=Ph(i),R=v.get(C);R||(R=h.querySelector(r(C)),R||(i=Q({src:i,async:!0,type:"module"},a),(a=_o.get(C))&&d(i,a),R=h.createElement("script"),pn(R),hr(R,"link",i),h.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},v.set(C,R))}}function fd(i,a,h,v){var C=(C=Se.current)?Sh(C):null;if(!C)throw Error(M(446));switch(i){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(a=Yl(h.href),h=xs(C).hoistableStyles,v=h.get(a),v||(v={type:"style",instance:null,count:0,state:null},h.set(a,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){i=Yl(h.href);var R=xs(C).hoistableStyles,Y=R.get(i);if(Y||(C=C.ownerDocument||C,Y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},R.set(i,Y),(R=C.querySelector(Hu(i)))&&!R._p&&(Y.instance=R,Y.state.loading=5),_o.has(i)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},_o.set(i,h),R||fp(C,i,h,Y.state))),a&&v===null)throw Error(M(528,""));return Y}if(a&&v!==null)throw Error(M(529,""));return null;case"script":return a=h.async,h=h.src,typeof h=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Ph(h),h=xs(C).hoistableScripts,v=h.get(a),v||(v={type:"script",instance:null,count:0,state:null},h.set(a,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(M(444,i))}}function Yl(i){return'href="'+Tr(i)+'"'}function Hu(i){return'link[rel="stylesheet"]['+i+"]"}function cf(i){return Q({},i,{"data-precedence":i.precedence,precedence:null})}function fp(i,a,h,v){i.querySelector('link[rel="preload"][as="style"]['+a+"]")?v.loading=1:(a=i.createElement("link"),v.preload=a,a.addEventListener("load",function(){return v.loading|=1}),a.addEventListener("error",function(){return v.loading|=2}),hr(a,"link",h),pn(a),i.head.appendChild(a))}function Ph(i){return'[src="'+Tr(i)+'"]'}function r(i){return"script[async]"+i}function e(i,a,h){if(a.count++,a.instance===null)switch(a.type){case"style":var v=i.querySelector('style[data-href~="'+Tr(h.href)+'"]');if(v)return a.instance=v,pn(v),v;var C=Q({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return v=(i.ownerDocument||i).createElement("style"),pn(v),hr(v,"style",C),n(v,h.precedence,i),a.instance=v;case"stylesheet":C=Yl(h.href);var R=i.querySelector(Hu(C));if(R)return a.state.loading|=4,a.instance=R,pn(R),R;v=cf(h),(C=_o.get(C))&&l(v,C),R=(i.ownerDocument||i).createElement("link"),pn(R);var Y=R;return Y._p=new Promise(function(rt,St){Y.onload=rt,Y.onerror=St}),hr(R,"link",v),a.state.loading|=4,n(R,h.precedence,i),a.instance=R;case"script":return R=Ph(h.src),(C=i.querySelector(r(R)))?(a.instance=C,pn(C),C):(v=h,(C=_o.get(R))&&(v=Q({},h),d(v,C)),i=i.ownerDocument||i,C=i.createElement("script"),pn(C),hr(C,"link",v),i.head.appendChild(C),a.instance=C);case"void":return null;default:throw Error(M(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(v=a.instance,a.state.loading|=4,n(v,h.precedence,i));return a.instance}function n(i,a,h){for(var v=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),C=v.length?v[v.length-1]:null,R=C,Y=0;Y<v.length;Y++){var rt=v[Y];if(rt.dataset.precedence===a)R=rt;else if(R!==C)break}R?R.parentNode.insertBefore(i,R.nextSibling):(a=h.nodeType===9?h.head:h,a.insertBefore(i,a.firstChild))}function l(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.title==null&&(i.title=a.title)}function d(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.integrity==null&&(i.integrity=a.integrity)}var x=null;function b(i,a,h){if(x===null){var v=new Map,C=x=new Map;C.set(h,v)}else C=x,v=C.get(h),v||(v=new Map,C.set(h,v));if(v.has(i))return v;for(v.set(i,null),h=h.getElementsByTagName(i),C=0;C<h.length;C++){var R=h[C];if(!(R[Js]||R[ii]||i==="link"&&R.getAttribute("rel")==="stylesheet")&&R.namespaceURI!=="http://www.w3.org/2000/svg"){var Y=R.getAttribute(a)||"";Y=i+Y;var rt=v.get(Y);rt?rt.push(R):v.set(Y,[R])}}return v}function S(i,a,h){i=i.ownerDocument||i,i.head.insertBefore(h,a==="title"?i.querySelector("head > title"):null)}function E(i,a,h){if(h===1||a.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return i=a.disabled,typeof a.precedence=="string"&&i==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function k(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var N=null;function V(){}function q(i,a,h){if(N===null)throw Error(M(475));var v=N;if(a.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var C=Yl(h.href),R=i.querySelector(Hu(C));if(R){i=R._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(v.count++,v=K.bind(v),i.then(v,v)),a.state.loading|=4,a.instance=R,pn(R);return}R=i.ownerDocument||i,h=cf(h),(C=_o.get(C))&&l(h,C),R=R.createElement("link"),pn(R);var Y=R;Y._p=new Promise(function(rt,St){Y.onload=rt,Y.onerror=St}),hr(R,"link",h),a.instance=R}v.stylesheets===null&&(v.stylesheets=new Map),v.stylesheets.set(a,i),(i=a.state.preload)&&(a.state.loading&3)===0&&(v.count++,a=K.bind(v),i.addEventListener("load",a),i.addEventListener("error",a))}}function W(){if(N===null)throw Error(M(475));var i=N;return i.stylesheets&&i.count===0&&at(i,i.stylesheets),0<i.count?function(a){var h=setTimeout(function(){if(i.stylesheets&&at(i,i.stylesheets),i.unsuspend){var v=i.unsuspend;i.unsuspend=null,v()}},6e4);return i.unsuspend=a,function(){i.unsuspend=null,clearTimeout(h)}}:null}function K(){if(this.count--,this.count===0){if(this.stylesheets)at(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var et=null;function at(i,a){i.stylesheets=null,i.unsuspend!==null&&(i.count++,et=new Map,a.forEach(ft,i),et=null,K.call(i))}function ft(i,a){if(!(a.state.loading&4)){var h=et.get(i);if(h)var v=h.get(null);else{h=new Map,et.set(i,h);for(var C=i.querySelectorAll("link[data-precedence],style[data-precedence]"),R=0;R<C.length;R++){var Y=C[R];(Y.nodeName==="LINK"||Y.getAttribute("media")!=="not all")&&(h.set(Y.dataset.precedence,Y),v=Y)}v&&h.set(null,v)}C=a.instance,Y=C.getAttribute("data-precedence"),R=h.get(Y)||v,R===v&&h.set(null,C),h.set(Y,C),this.count++,v=K.bind(this),C.addEventListener("load",v),C.addEventListener("error",v),R?R.parentNode.insertBefore(C,R.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(C,i.firstChild)),a.state.loading|=4}}var Dt={$$typeof:ne,Provider:null,Consumer:null,_currentValue:fe,_currentValue2:fe,_threadCount:0};function xt(i,a,h,v,C,R,Y,rt){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Le(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Le(0),this.hiddenUpdates=Le(null),this.identifierPrefix=v,this.onUncaughtError=C,this.onCaughtError=R,this.onRecoverableError=Y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=rt,this.incompleteTransitions=new Map}function Mt(i,a,h,v,C,R,Y,rt,St,Zt,ie,le){return i=new xt(i,a,h,Y,rt,St,Zt,le),a=1,R===!0&&(a|=24),R=Cs(3,null,null,a),i.current=R,R.stateNode=i,a=Il(),a.refCount++,i.pooledCache=a,a.refCount++,R.memoizedState={element:v,isDehydrated:h,cache:a},Nh(R),i}function jt(i){return i?(i=fi,i):fi}function $t(i,a,h,v,C,R){C=jt(C),v.context===null?v.context=C:v.pendingContext=C,v=Rl(a),v.payload={element:h},R=R===void 0?null:R,R!==null&&(v.callback=R),h=el(i,v,a),h!==null&&(po(h,i,a),gc(h,i,a))}function se(i,a){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<a?h:a}}function Pe(i,a){se(i,a),(i=i.alternate)&&se(i,a)}function ye(i){if(i.tag===13){var a=As(i,67108864);a!==null&&po(a,i,67108864),Pe(i,67108864)}}var be=!0;function He(i,a,h,v){var C=Qt.T;Qt.T=null;var R=me.p;try{me.p=2,Te(i,a,h,v)}finally{me.p=R,Qt.T=C}}function Ae(i,a,h,v){var C=Qt.T;Qt.T=null;var R=me.p;try{me.p=8,Te(i,a,h,v)}finally{me.p=R,Qt.T=C}}function Te(i,a,h,v){if(be){var C=te(v);if(C===null)tf(i,a,v,ei,h),In(i,v);else if(Wr(C,i,a,h,v))v.stopPropagation();else if(In(i,v),a&4&&-1<Yr.indexOf(i)){for(;C!==null;){var R=ai(C);if(R!==null)switch(R.tag){case 3:if(R=R.stateNode,R.current.memoizedState.isDehydrated){var Y=Et(R.pendingLanes);if(Y!==0){var rt=R;for(rt.pendingLanes|=2,rt.entangledLanes|=2;Y;){var St=1<<31-Ct(Y);rt.entanglements[1]|=St,Y&=~St}mo(R),(un&6)===0&&(Gd=dr()+500,Fu(0))}}break;case 13:rt=As(R,2),rt!==null&&po(rt,R,2),$d(),Pe(R,2)}if(R=te(v),R===null&&tf(i,a,v,ei,h),R===C)break;C=R}C!==null&&v.stopPropagation()}else tf(i,a,v,null,h)}}function te(i){return i=Xa(i),ni(i)}var ei=null;function ni(i){if(ei=null,i=ci(i),i!==null){var a=F(i);if(a===null)i=null;else{var h=a.tag;if(h===13){if(i=P(a),i!==null)return i;i=null}else if(h===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return ei=i,null}function We(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ys()){case Qs:return 2;case vo:return 8;case vs:case Ha:return 32;case fa:return 268435456;default:return 32}default:return 32}}var Be=!1,vi=null,Ki=null,Mn=null,vr=new Map,Bs=new Map,xr=[],Yr="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function In(i,a){switch(i){case"focusin":case"focusout":vi=null;break;case"dragenter":case"dragleave":Ki=null;break;case"mouseover":case"mouseout":Mn=null;break;case"pointerover":case"pointerout":vr.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bs.delete(a.pointerId)}}function tr(i,a,h,v,C,R){return i===null||i.nativeEvent!==R?(i={blockedOn:a,domEventName:h,eventSystemFlags:v,nativeEvent:R,targetContainers:[C]},a!==null&&(a=ai(a),a!==null&&ye(a)),i):(i.eventSystemFlags|=v,a=i.targetContainers,C!==null&&a.indexOf(C)===-1&&a.push(C),i)}function Wr(i,a,h,v,C){switch(a){case"focusin":return vi=tr(vi,i,a,h,v,C),!0;case"dragenter":return Ki=tr(Ki,i,a,h,v,C),!0;case"mouseover":return Mn=tr(Mn,i,a,h,v,C),!0;case"pointerover":var R=C.pointerId;return vr.set(R,tr(vr.get(R)||null,i,a,h,v,C)),!0;case"gotpointercapture":return R=C.pointerId,Bs.set(R,tr(Bs.get(R)||null,i,a,h,v,C)),!0}return!1}function jr(i){var a=ci(i.target);if(a!==null){var h=F(a);if(h!==null){if(a=h.tag,a===13){if(a=P(h),a!==null){i.blockedOn=a,Un(i.priority,function(){if(h.tag===13){var v=ja();v=li(v);var C=As(h,v);C!==null&&po(C,h,v),Pe(h,v)}});return}}else if(a===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Kr(i){if(i.blockedOn!==null)return!1;for(var a=i.targetContainers;0<a.length;){var h=te(i.nativeEvent);if(h===null){h=i.nativeEvent;var v=new h.constructor(h.type,h);ia=v,h.target.dispatchEvent(v),ia=null}else return a=ai(h),a!==null&&ye(a),i.blockedOn=h,!1;a.shift()}return!0}function Va(i,a,h){Kr(i)&&h.delete(a)}function Fr(){Be=!1,vi!==null&&Kr(vi)&&(vi=null),Ki!==null&&Kr(Ki)&&(Ki=null),Mn!==null&&Kr(Mn)&&(Mn=null),vr.forEach(Va),Bs.forEach(Va)}function _s(i,a){i.blockedOn===a&&(i.blockedOn=null,Be||(Be=!0,p.unstable_scheduleCallback(p.unstable_NormalPriority,Fr)))}var er=null;function Dr(i){er!==i&&(er=i,p.unstable_scheduleCallback(p.unstable_NormalPriority,function(){er===i&&(er=null);for(var a=0;a<i.length;a+=3){var h=i[a],v=i[a+1],C=i[a+2];if(typeof v!="function"){if(ni(v||h)===null)continue;break}var R=ai(h);R!==null&&(i.splice(a,3),a-=3,Dn(R,{pending:!0,data:C,method:h.method,action:v},v,C))}}))}function ir(i){function a(St){return _s(St,i)}vi!==null&&_s(vi,i),Ki!==null&&_s(Ki,i),Mn!==null&&_s(Mn,i),vr.forEach(a),Bs.forEach(a);for(var h=0;h<xr.length;h++){var v=xr[h];v.blockedOn===i&&(v.blockedOn=null)}for(;0<xr.length&&(h=xr[0],h.blockedOn===null);)jr(h),h.blockedOn===null&&xr.shift();if(h=(i.ownerDocument||i).$$reactFormReplay,h!=null)for(v=0;v<h.length;v+=3){var C=h[v],R=h[v+1],Y=C[si]||null;if(typeof R=="function")Y||Dr(h);else if(Y){var rt=null;if(R&&R.hasAttribute("formAction")){if(C=R,Y=R[si]||null)rt=Y.formAction;else if(ni(C)!==null)continue}else rt=Y.action;typeof rt=="function"?h[v+1]=rt:(h.splice(v,3),v-=3),Dr(h)}}}function nr(i){this._internalRoot=i}nn.prototype.render=nr.prototype.render=function(i){var a=this._internalRoot;if(a===null)throw Error(M(409));var h=a.current,v=ja();$t(h,v,i,a,null,null)},nn.prototype.unmount=nr.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var a=i.containerInfo;$t(i.current,2,null,i,null,null),$d(),a[fn]=null}};function nn(i){this._internalRoot=i}nn.prototype.unstable_scheduleHydration=function(i){if(i){var a=qn();i={blockedOn:null,target:i,priority:a};for(var h=0;h<xr.length&&a!==0&&a<xr[h].priority;h++);xr.splice(h,0,i),h===0&&jr(i)}};var Uo=m.version;if(Uo!=="19.1.1")throw Error(M(527,Uo,"19.1.1"));me.findDOMNode=function(i){var a=i._reactInternals;if(a===void 0)throw typeof i.render=="function"?Error(M(188)):(i=Object.keys(i).join(","),Error(M(268,i)));return i=H(a),i=i!==null?X(i):null,i=i===null?null:i.stateNode,i};var Ah={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Qt,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ua=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ua.isDisabled&&Ua.supportsFiber)try{ts=Ua.inject(Ah),Vn=Ua}catch{}}return mp.createRoot=function(i,a){if(!I(i))throw Error(M(299));var h=!1,v="",C=Rp,R=Ld,Y=kp,rt=null;return a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(v=a.identifierPrefix),a.onUncaughtError!==void 0&&(C=a.onUncaughtError),a.onCaughtError!==void 0&&(R=a.onCaughtError),a.onRecoverableError!==void 0&&(Y=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(rt=a.unstable_transitionCallbacks)),a=Mt(i,1,!1,null,null,h,v,C,R,Y,rt,null),i[fn]=a.current,Jd(i),new nr(a)},mp.hydrateRoot=function(i,a,h){if(!I(i))throw Error(M(299));var v=!1,C="",R=Rp,Y=Ld,rt=kp,St=null,Zt=null;return h!=null&&(h.unstable_strictMode===!0&&(v=!0),h.identifierPrefix!==void 0&&(C=h.identifierPrefix),h.onUncaughtError!==void 0&&(R=h.onUncaughtError),h.onCaughtError!==void 0&&(Y=h.onCaughtError),h.onRecoverableError!==void 0&&(rt=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(St=h.unstable_transitionCallbacks),h.formState!==void 0&&(Zt=h.formState)),a=Mt(i,1,!0,a,h??null,v,C,R,Y,rt,St,Zt),a.context=jt(null),h=a.current,v=ja(),v=li(v),C=Rl(v),C.callback=null,el(h,C,v),h=v,a.current.lanes=h,It(a,h),mo(a),i[fn]=a.current,Jd(i),new nn(a)},mp.version="19.1.1",mp}var Qg;function T3(){if(Qg)return a_.exports;Qg=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(m){console.error(m)}}return p(),a_.exports=w3(),a_.exports}var S3=T3(),gp={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var M3=gp.exports,Jg;function rg(){return Jg||(Jg=1,function(p,m){(function(w,M){M(m)})(M3,function(w){var M="1.9.4";function I(o){var _,A,B,G;for(A=1,B=arguments.length;A<B;A++){G=arguments[A];for(_ in G)o[_]=G[_]}return o}var F=Object.create||function(){function o(){}return function(_){return o.prototype=_,new o}}();function P(o,_){var A=Array.prototype.slice;if(o.bind)return o.bind.apply(o,A.call(arguments,1));var B=A.call(arguments,2);return function(){return o.apply(_,B.length?B.concat(A.call(arguments)):arguments)}}var u=0;function H(o){return"_leaflet_id"in o||(o._leaflet_id=++u),o._leaflet_id}function X(o,_,A){var B,G,nt,wt;return wt=function(){B=!1,G&&(nt.apply(A,G),G=!1)},nt=function(){B?G=arguments:(o.apply(A,arguments),setTimeout(wt,_),B=!0)},nt}function Q(o,_,A){var B=_[1],G=_[0],nt=B-G;return o===B&&A?o:((o-G)%nt+nt)%nt+G}function dt(){return!1}function ht(o,_){if(_===!1)return o;var A=Math.pow(10,_===void 0?6:_);return Math.round(o*A)/A}function lt(o){return o.trim?o.trim():o.replace(/^\s+|\s+$/g,"")}function Yt(o){return lt(o).split(/\s+/)}function Jt(o,_){Object.prototype.hasOwnProperty.call(o,"options")||(o.options=o.options?F(o.options):{});for(var A in _)o.options[A]=_[A];return o.options}function pe(o,_,A){var B=[];for(var G in o)B.push(encodeURIComponent(A?G.toUpperCase():G)+"="+encodeURIComponent(o[G]));return(!_||_.indexOf("?")===-1?"?":"&")+B.join("&")}var ge=/\{ *([\w_ -]+) *\}/g;function de(o,_){return o.replace(ge,function(A,B){var G=_[B];if(G===void 0)throw new Error("No value provided for variable "+A);return typeof G=="function"&&(G=G(_)),G})}var ne=Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"};function Ne(o,_){for(var A=0;A<o.length;A++)if(o[A]===_)return A;return-1}var we="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Ve(o){return window["webkit"+o]||window["moz"+o]||window["ms"+o]}var Je=0;function Ue(o){var _=+new Date,A=Math.max(0,16-(_-Je));return Je=_+A,window.setTimeout(o,A)}var Ei=window.requestAnimationFrame||Ve("RequestAnimationFrame")||Ue,Ti=window.cancelAnimationFrame||Ve("CancelAnimationFrame")||Ve("CancelRequestAnimationFrame")||function(o){window.clearTimeout(o)};function zi(o,_,A){if(A&&Ei===Ue)o.call(_);else return Ei.call(window,P(o,_))}function Pi(o){o&&Ti.call(window,o)}var Ir={__proto__:null,extend:I,create:F,bind:P,get lastId(){return u},stamp:H,throttle:X,wrapNum:Q,falseFn:dt,formatNum:ht,trim:lt,splitWords:Yt,setOptions:Jt,getParamString:pe,template:de,isArray:ne,indexOf:Ne,emptyImageUrl:we,requestFn:Ei,cancelFn:Ti,requestAnimFrame:zi,cancelAnimFrame:Pi};function Rn(){}Rn.extend=function(o){var _=function(){Jt(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},A=_.__super__=this.prototype,B=F(A);B.constructor=_,_.prototype=B;for(var G in this)Object.prototype.hasOwnProperty.call(this,G)&&G!=="prototype"&&G!=="__super__"&&(_[G]=this[G]);return o.statics&&I(_,o.statics),o.includes&&(dn(o.includes),I.apply(null,[B].concat(o.includes))),I(B,o),delete B.statics,delete B.includes,B.options&&(B.options=A.options?F(A.options):{},I(B.options,o.options)),B._initHooks=[],B.callInitHooks=function(){if(!this._initHooksCalled){A.callInitHooks&&A.callInitHooks.call(this),this._initHooksCalled=!0;for(var nt=0,wt=B._initHooks.length;nt<wt;nt++)B._initHooks[nt].call(this)}},_},Rn.include=function(o){var _=this.prototype.options;return I(this.prototype,o),o.options&&(this.prototype.options=_,this.mergeOptions(o.options)),this},Rn.mergeOptions=function(o){return I(this.prototype.options,o),this},Rn.addInitHook=function(o){var _=Array.prototype.slice.call(arguments,1),A=typeof o=="function"?o:function(){this[o].apply(this,_)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(A),this};function dn(o){if(!(typeof L>"u"||!L||!L.Mixin)){o=ne(o)?o:[o];for(var _=0;_<o.length;_++)o[_]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Qt={on:function(o,_,A){if(typeof o=="object")for(var B in o)this._on(B,o[B],_);else{o=Yt(o);for(var G=0,nt=o.length;G<nt;G++)this._on(o[G],_,A)}return this},off:function(o,_,A){if(!arguments.length)delete this._events;else if(typeof o=="object")for(var B in o)this._off(B,o[B],_);else{o=Yt(o);for(var G=arguments.length===1,nt=0,wt=o.length;nt<wt;nt++)G?this._off(o[nt]):this._off(o[nt],_,A)}return this},_on:function(o,_,A,B){if(typeof _!="function"){console.warn("wrong listener type: "+typeof _);return}if(this._listens(o,_,A)===!1){A===this&&(A=void 0);var G={fn:_,ctx:A};B&&(G.once=!0),this._events=this._events||{},this._events[o]=this._events[o]||[],this._events[o].push(G)}},_off:function(o,_,A){var B,G,nt;if(this._events&&(B=this._events[o],!!B)){if(arguments.length===1){if(this._firingCount)for(G=0,nt=B.length;G<nt;G++)B[G].fn=dt;delete this._events[o];return}if(typeof _!="function"){console.warn("wrong listener type: "+typeof _);return}var wt=this._listens(o,_,A);if(wt!==!1){var Bt=B[wt];this._firingCount&&(Bt.fn=dt,this._events[o]=B=B.slice()),B.splice(wt,1)}}},fire:function(o,_,A){if(!this.listens(o,A))return this;var B=I({},_,{type:o,target:this,sourceTarget:_&&_.sourceTarget||this});if(this._events){var G=this._events[o];if(G){this._firingCount=this._firingCount+1||1;for(var nt=0,wt=G.length;nt<wt;nt++){var Bt=G[nt],qt=Bt.fn;Bt.once&&this.off(o,qt,Bt.ctx),qt.call(Bt.ctx||this,B)}this._firingCount--}}return A&&this._propagateEvent(B),this},listens:function(o,_,A,B){typeof o!="string"&&console.warn('"string" type argument expected');var G=_;typeof _!="function"&&(B=!!_,G=void 0,A=void 0);var nt=this._events&&this._events[o];if(nt&&nt.length&&this._listens(o,G,A)!==!1)return!0;if(B){for(var wt in this._eventParents)if(this._eventParents[wt].listens(o,_,A,B))return!0}return!1},_listens:function(o,_,A){if(!this._events)return!1;var B=this._events[o]||[];if(!_)return!!B.length;A===this&&(A=void 0);for(var G=0,nt=B.length;G<nt;G++)if(B[G].fn===_&&B[G].ctx===A)return G;return!1},once:function(o,_,A){if(typeof o=="object")for(var B in o)this._on(B,o[B],_,!0);else{o=Yt(o);for(var G=0,nt=o.length;G<nt;G++)this._on(o[G],_,A,!0)}return this},addEventParent:function(o){return this._eventParents=this._eventParents||{},this._eventParents[H(o)]=o,this},removeEventParent:function(o){return this._eventParents&&delete this._eventParents[H(o)],this},_propagateEvent:function(o){for(var _ in this._eventParents)this._eventParents[_].fire(o.type,I({layer:o.target,propagatedFrom:o.target},o),!0)}};Qt.addEventListener=Qt.on,Qt.removeEventListener=Qt.clearAllEventListeners=Qt.off,Qt.addOneTimeEventListener=Qt.once,Qt.fireEvent=Qt.fire,Qt.hasEventListeners=Qt.listens;var me=Rn.extend(Qt);function fe(o,_,A){this.x=A?Math.round(o):o,this.y=A?Math.round(_):_}var Ze=Math.trunc||function(o){return o>0?Math.floor(o):Math.ceil(o)};fe.prototype={clone:function(){return new fe(this.x,this.y)},add:function(o){return this.clone()._add(yt(o))},_add:function(o){return this.x+=o.x,this.y+=o.y,this},subtract:function(o){return this.clone()._subtract(yt(o))},_subtract:function(o){return this.x-=o.x,this.y-=o.y,this},divideBy:function(o){return this.clone()._divideBy(o)},_divideBy:function(o){return this.x/=o,this.y/=o,this},multiplyBy:function(o){return this.clone()._multiplyBy(o)},_multiplyBy:function(o){return this.x*=o,this.y*=o,this},scaleBy:function(o){return new fe(this.x*o.x,this.y*o.y)},unscaleBy:function(o){return new fe(this.x/o.x,this.y/o.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Ze(this.x),this.y=Ze(this.y),this},distanceTo:function(o){o=yt(o);var _=o.x-this.x,A=o.y-this.y;return Math.sqrt(_*_+A*A)},equals:function(o){return o=yt(o),o.x===this.x&&o.y===this.y},contains:function(o){return o=yt(o),Math.abs(o.x)<=Math.abs(this.x)&&Math.abs(o.y)<=Math.abs(this.y)},toString:function(){return"Point("+ht(this.x)+", "+ht(this.y)+")"}};function yt(o,_,A){return o instanceof fe?o:ne(o)?new fe(o[0],o[1]):o==null?o:typeof o=="object"&&"x"in o&&"y"in o?new fe(o.x,o.y):new fe(o,_,A)}function Wt(o,_){if(o)for(var A=_?[o,_]:o,B=0,G=A.length;B<G;B++)this.extend(A[B])}Wt.prototype={extend:function(o){var _,A;if(!o)return this;if(o instanceof fe||typeof o[0]=="number"||"x"in o)_=A=yt(o);else if(o=Ce(o),_=o.min,A=o.max,!_||!A)return this;return!this.min&&!this.max?(this.min=_.clone(),this.max=A.clone()):(this.min.x=Math.min(_.x,this.min.x),this.max.x=Math.max(A.x,this.max.x),this.min.y=Math.min(_.y,this.min.y),this.max.y=Math.max(A.y,this.max.y)),this},getCenter:function(o){return yt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,o)},getBottomLeft:function(){return yt(this.min.x,this.max.y)},getTopRight:function(){return yt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(o){var _,A;return typeof o[0]=="number"||o instanceof fe?o=yt(o):o=Ce(o),o instanceof Wt?(_=o.min,A=o.max):_=A=o,_.x>=this.min.x&&A.x<=this.max.x&&_.y>=this.min.y&&A.y<=this.max.y},intersects:function(o){o=Ce(o);var _=this.min,A=this.max,B=o.min,G=o.max,nt=G.x>=_.x&&B.x<=A.x,wt=G.y>=_.y&&B.y<=A.y;return nt&&wt},overlaps:function(o){o=Ce(o);var _=this.min,A=this.max,B=o.min,G=o.max,nt=G.x>_.x&&B.x<A.x,wt=G.y>_.y&&B.y<A.y;return nt&&wt},isValid:function(){return!!(this.min&&this.max)},pad:function(o){var _=this.min,A=this.max,B=Math.abs(_.x-A.x)*o,G=Math.abs(_.y-A.y)*o;return Ce(yt(_.x-B,_.y-G),yt(A.x+B,A.y+G))},equals:function(o){return o?(o=Ce(o),this.min.equals(o.getTopLeft())&&this.max.equals(o.getBottomRight())):!1}};function Ce(o,_){return!o||o instanceof Wt?o:new Wt(o,_)}function xe(o,_){if(o)for(var A=_?[o,_]:o,B=0,G=A.length;B<G;B++)this.extend(A[B])}xe.prototype={extend:function(o){var _=this._southWest,A=this._northEast,B,G;if(o instanceof Fe)B=o,G=o;else if(o instanceof xe){if(B=o._southWest,G=o._northEast,!B||!G)return this}else return o?this.extend(Se(o)||ze(o)):this;return!_&&!A?(this._southWest=new Fe(B.lat,B.lng),this._northEast=new Fe(G.lat,G.lng)):(_.lat=Math.min(B.lat,_.lat),_.lng=Math.min(B.lng,_.lng),A.lat=Math.max(G.lat,A.lat),A.lng=Math.max(G.lng,A.lng)),this},pad:function(o){var _=this._southWest,A=this._northEast,B=Math.abs(_.lat-A.lat)*o,G=Math.abs(_.lng-A.lng)*o;return new xe(new Fe(_.lat-B,_.lng-G),new Fe(A.lat+B,A.lng+G))},getCenter:function(){return new Fe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Fe(this.getNorth(),this.getWest())},getSouthEast:function(){return new Fe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(o){typeof o[0]=="number"||o instanceof Fe||"lat"in o?o=Se(o):o=ze(o);var _=this._southWest,A=this._northEast,B,G;return o instanceof xe?(B=o.getSouthWest(),G=o.getNorthEast()):B=G=o,B.lat>=_.lat&&G.lat<=A.lat&&B.lng>=_.lng&&G.lng<=A.lng},intersects:function(o){o=ze(o);var _=this._southWest,A=this._northEast,B=o.getSouthWest(),G=o.getNorthEast(),nt=G.lat>=_.lat&&B.lat<=A.lat,wt=G.lng>=_.lng&&B.lng<=A.lng;return nt&&wt},overlaps:function(o){o=ze(o);var _=this._southWest,A=this._northEast,B=o.getSouthWest(),G=o.getNorthEast(),nt=G.lat>_.lat&&B.lat<A.lat,wt=G.lng>_.lng&&B.lng<A.lng;return nt&&wt},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(o,_){return o?(o=ze(o),this._southWest.equals(o.getSouthWest(),_)&&this._northEast.equals(o.getNorthEast(),_)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ze(o,_){return o instanceof xe?o:new xe(o,_)}function Fe(o,_,A){if(isNaN(o)||isNaN(_))throw new Error("Invalid LatLng object: ("+o+", "+_+")");this.lat=+o,this.lng=+_,A!==void 0&&(this.alt=+A)}Fe.prototype={equals:function(o,_){if(!o)return!1;o=Se(o);var A=Math.max(Math.abs(this.lat-o.lat),Math.abs(this.lng-o.lng));return A<=(_===void 0?1e-9:_)},toString:function(o){return"LatLng("+ht(this.lat,o)+", "+ht(this.lng,o)+")"},distanceTo:function(o){return xi.distance(this,Se(o))},wrap:function(){return xi.wrapLatLng(this)},toBounds:function(o){var _=180*o/40075017,A=_/Math.cos(Math.PI/180*this.lat);return ze([this.lat-_,this.lng-A],[this.lat+_,this.lng+A])},clone:function(){return new Fe(this.lat,this.lng,this.alt)}};function Se(o,_,A){return o instanceof Fe?o:ne(o)&&typeof o[0]!="object"?o.length===3?new Fe(o[0],o[1],o[2]):o.length===2?new Fe(o[0],o[1]):null:o==null?o:typeof o=="object"&&"lat"in o?new Fe(o.lat,"lng"in o?o.lng:o.lon,o.alt):_===void 0?null:new Fe(o,_,A)}var rn={latLngToPoint:function(o,_){var A=this.projection.project(o),B=this.scale(_);return this.transformation._transform(A,B)},pointToLatLng:function(o,_){var A=this.scale(_),B=this.transformation.untransform(o,A);return this.projection.unproject(B)},project:function(o){return this.projection.project(o)},unproject:function(o){return this.projection.unproject(o)},scale:function(o){return 256*Math.pow(2,o)},zoom:function(o){return Math.log(o/256)/Math.LN2},getProjectedBounds:function(o){if(this.infinite)return null;var _=this.projection.bounds,A=this.scale(o),B=this.transformation.transform(_.min,A),G=this.transformation.transform(_.max,A);return new Wt(B,G)},infinite:!1,wrapLatLng:function(o){var _=this.wrapLng?Q(o.lng,this.wrapLng,!0):o.lng,A=this.wrapLat?Q(o.lat,this.wrapLat,!0):o.lat,B=o.alt;return new Fe(A,_,B)},wrapLatLngBounds:function(o){var _=o.getCenter(),A=this.wrapLatLng(_),B=_.lat-A.lat,G=_.lng-A.lng;if(B===0&&G===0)return o;var nt=o.getSouthWest(),wt=o.getNorthEast(),Bt=new Fe(nt.lat-B,nt.lng-G),qt=new Fe(wt.lat-B,wt.lng-G);return new xe(Bt,qt)}},xi=I({},rn,{wrapLng:[-180,180],R:6371e3,distance:function(o,_){var A=Math.PI/180,B=o.lat*A,G=_.lat*A,nt=Math.sin((_.lat-o.lat)*A/2),wt=Math.sin((_.lng-o.lng)*A/2),Bt=nt*nt+Math.cos(B)*Math.cos(G)*wt*wt,qt=2*Math.atan2(Math.sqrt(Bt),Math.sqrt(1-Bt));return this.R*qt}}),rr=6378137,da={R:rr,MAX_LATITUDE:85.0511287798,project:function(o){var _=Math.PI/180,A=this.MAX_LATITUDE,B=Math.max(Math.min(A,o.lat),-A),G=Math.sin(B*_);return new fe(this.R*o.lng*_,this.R*Math.log((1+G)/(1-G))/2)},unproject:function(o){var _=180/Math.PI;return new Fe((2*Math.atan(Math.exp(o.y/this.R))-Math.PI/2)*_,o.x*_/this.R)},bounds:function(){var o=rr*Math.PI;return new Wt([-o,-o],[o,o])}()};function Ws(o,_,A,B){if(ne(o)){this._a=o[0],this._b=o[1],this._c=o[2],this._d=o[3];return}this._a=o,this._b=_,this._c=A,this._d=B}Ws.prototype={transform:function(o,_){return this._transform(o.clone(),_)},_transform:function(o,_){return _=_||1,o.x=_*(this._a*o.x+this._b),o.y=_*(this._c*o.y+this._d),o},untransform:function(o,_){return _=_||1,new fe((o.x/_-this._b)/this._a,(o.y/_-this._d)/this._c)}};function sr(o,_,A,B){return new Ws(o,_,A,B)}var sn=I({},xi,{code:"EPSG:3857",projection:da,transformation:function(){var o=.5/(Math.PI*da.R);return sr(o,.5,-o,.5)}()}),An=I({},sn,{code:"EPSG:900913"});function Os(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function Ks(o,_){var A="",B,G,nt,wt,Bt,qt;for(B=0,nt=o.length;B<nt;B++){for(Bt=o[B],G=0,wt=Bt.length;G<wt;G++)qt=Bt[G],A+=(G?"L":"M")+qt.x+" "+qt.y;A+=_?Ie.svg?"z":"x":""}return A||"M0 0"}var dr=document.documentElement.style,ys="ActiveXObject"in window,Qs=ys&&!document.addEventListener,vo="msLaunchUri"in navigator&&!("documentMode"in document),vs=ue("webkit"),Ha=ue("android"),fa=ue("android 2")||ue("android 3"),Go=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),xo=Ha&&ue("Google")&&Go<537&&!("AudioNode"in window),ts=!!window.opera,Vn=!vo&&ue("chrome"),es=ue("gecko")&&!vs&&!ts&&!ys,Ct=!Vn&&ue("safari"),tt=ue("phantom"),it="OTransition"in dr,st=navigator.platform.indexOf("Win")===0,_t=ys&&"transition"in dr,Pt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!fa,Et="MozPerspective"in dr,Ft=!window.L_DISABLE_3D&&(_t||Pt||Et)&&!it&&!tt,zt=typeof orientation<"u"||ue("mobile"),Kt=zt&&vs,oe=zt&&Pt,ee=!window.PointerEvent&&window.MSPointerEvent,Le=!!(window.PointerEvent||ee),It="ontouchstart"in window||!!window.TouchEvent,ri=!window.L_NO_TOUCH&&(It||Le),bi=zt&&ts,Ge=zt&&es,li=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Zi=function(){var o=!1;try{var _=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("testPassiveEventSupport",dt,_),window.removeEventListener("testPassiveEventSupport",dt,_)}catch{}return o}(),qn=function(){return!!document.createElement("canvas").getContext}(),Un=!!(document.createElementNS&&Os("svg").createSVGRect),$i=!!Un&&function(){var o=document.createElement("div");return o.innerHTML="<svg/>",(o.firstChild&&o.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),ii=!Un&&function(){try{var o=document.createElement("div");o.innerHTML='<v:shape adj="1"/>';var _=o.firstChild;return _.style.behavior="url(#default#VML)",_&&typeof _.adj=="object"}catch{return!1}}(),si=navigator.platform.indexOf("Mac")===0,fn=navigator.platform.indexOf("Linux")===0;function ue(o){return navigator.userAgent.toLowerCase().indexOf(o)>=0}var Ie={ie:ys,ielt9:Qs,edge:vo,webkit:vs,android:Ha,android23:fa,androidStock:xo,opera:ts,chrome:Vn,gecko:es,safari:Ct,phantom:tt,opera12:it,win:st,ie3d:_t,webkit3d:Pt,gecko3d:Et,any3d:Ft,mobile:zt,mobileWebkit:Kt,mobileWebkit3d:oe,msPointer:ee,pointer:Le,touch:ri,touchNative:It,mobileOpera:bi,mobileGecko:Ge,retina:li,passiveEvents:Zi,canvas:qn,svg:Un,vml:ii,inlineSvg:$i,mac:si,linux:fn},vn=Ie.msPointer?"MSPointerDown":"pointerdown",pa=Ie.msPointer?"MSPointerMove":"pointermove",Js=Ie.msPointer?"MSPointerUp":"pointerup",Me=Ie.msPointer?"MSPointerCancel":"pointercancel",ci={touchstart:vn,touchmove:pa,touchend:Js,touchcancel:Me},ai={touchstart:Cn,touchmove:ga,touchend:ga,touchcancel:ga},an={},xs=!1;function pn(o,_,A){return _==="touchstart"&&_a(),ai[_]?(A=ai[_].bind(this,A),o.addEventListener(ci[_],A,!1),A):(console.warn("wrong event specified:",_),dt)}function hi(o,_,A){if(!ci[_]){console.warn("wrong event specified:",_);return}o.removeEventListener(ci[_],A,!1)}function Jl(o){an[o.pointerId]=o}function is(o){an[o.pointerId]&&(an[o.pointerId]=o)}function ma(o){delete an[o.pointerId]}function _a(){xs||(document.addEventListener(vn,Jl,!0),document.addEventListener(pa,is,!0),document.addEventListener(Js,ma,!0),document.addEventListener(Me,ma,!0),xs=!0)}function ga(o,_){if(_.pointerType!==(_.MSPOINTER_TYPE_MOUSE||"mouse")){_.touches=[];for(var A in an)_.touches.push(an[A]);_.changedTouches=[_],o(_)}}function Cn(o,_){_.MSPOINTER_TYPE_TOUCH&&_.pointerType===_.MSPOINTER_TYPE_TOUCH&&je(_),ga(o,_)}function Rc(o){var _={},A,B;for(B in o)A=o[B],_[B]=A&&A.bind?A.bind(o):A;return o=_,_.type="dblclick",_.detail=2,_.isTrusted=!1,_._simulated=!0,_}var wr=200;function Vi(o,_){o.addEventListener("dblclick",_);var A=0,B;function G(nt){if(nt.detail!==1){B=nt.detail;return}if(!(nt.pointerType==="mouse"||nt.sourceCapabilities&&!nt.sourceCapabilities.firesTouchEvents)){var wt=Ai(nt);if(!(wt.some(function(qt){return qt instanceof HTMLLabelElement&&qt.attributes.for})&&!wt.some(function(qt){return qt instanceof HTMLInputElement||qt instanceof HTMLSelectElement}))){var Bt=Date.now();Bt-A<=wr?(B++,B===2&&_(Rc(nt))):B=1,A=Bt}}}return o.addEventListener("click",G),{dblclick:_,simDblclick:G}}function ya(o,_){o.removeEventListener("dblclick",_.dblclick),o.removeEventListener("click",_.simDblclick)}var qa=So(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),bo=So(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ns=bo==="webkitTransition"||bo==="OTransition"?bo+"End":"transitionend";function ta(o){return typeof o=="string"?document.getElementById(o):o}function $a(o,_){var A=o.style[_]||o.currentStyle&&o.currentStyle[_];if((!A||A==="auto")&&document.defaultView){var B=document.defaultView.getComputedStyle(o,null);A=B?B[_]:null}return A==="auto"?null:A}function Oi(o,_,A){var B=document.createElement(o);return B.className=_||"",A&&A.appendChild(B),B}function mn(o){var _=o.parentNode;_&&_.removeChild(o)}function $n(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function wo(o){var _=o.parentNode;_&&_.lastChild!==o&&_.appendChild(o)}function _l(o){var _=o.parentNode;_&&_.firstChild!==o&&_.insertBefore(o,_.firstChild)}function gl(o,_){if(o.classList!==void 0)return o.classList.contains(_);var A=Tr(o);return A.length>0&&new RegExp("(^|\\s)"+_+"(\\s|$)").test(A)}function Si(o,_){if(o.classList!==void 0)for(var A=Yt(_),B=0,G=A.length;B<G;B++)o.classList.add(A[B]);else if(!gl(o,_)){var nt=Tr(o);To(o,(nt?nt+" ":"")+_)}}function on(o,_){o.classList!==void 0?o.classList.remove(_):To(o,lt((" "+Tr(o)+" ").replace(" "+_+" "," ")))}function To(o,_){o.className.baseVal===void 0?o.className=_:o.className.baseVal=_}function Tr(o){return o.correspondingElement&&(o=o.correspondingElement),o.className.baseVal===void 0?o.className:o.className.baseVal}function Rr(o,_){"opacity"in o.style?o.style.opacity=_:"filter"in o.style&&Ho(o,_)}function Ho(o,_){var A=!1,B="DXImageTransform.Microsoft.Alpha";try{A=o.filters.item(B)}catch{if(_===1)return}_=Math.round(_*100),A?(A.Enabled=_!==100,A.Opacity=_):o.style.filter+=" progid:"+B+"(opacity="+_+")"}function So(o){for(var _=document.documentElement.style,A=0;A<o.length;A++)if(o[A]in _)return o[A];return!1}function rs(o,_,A){var B=_||new fe(0,0);o.style[qa]=(Ie.ie3d?"translate("+B.x+"px,"+B.y+"px)":"translate3d("+B.x+"px,"+B.y+"px,0)")+(A?" scale("+A+")":"")}function Zn(o,_){o._leaflet_pos=_,Ie.any3d?rs(o,_):(o.style.left=_.x+"px",o.style.top=_.y+"px")}function bs(o){return o._leaflet_pos||new fe(0,0)}var ss,Ur,gi;if("onselectstart"in document)ss=function(){Qe(window,"selectstart",je)},Ur=function(){ti(window,"selectstart",je)};else{var Ns=So(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ss=function(){if(Ns){var o=document.documentElement.style;gi=o[Ns],o[Ns]="none"}},Ur=function(){Ns&&(document.documentElement.style[Ns]=gi,gi=void 0)}}function js(){Qe(window,"dragstart",je)}function ea(){ti(window,"dragstart",je)}var va,di;function ia(o){for(;o.tabIndex===-1;)o=o.parentNode;o.style&&(Xa(),va=o,di=o.style.outlineStyle,o.style.outlineStyle="none",Qe(window,"keydown",Xa))}function Xa(){va&&(va.style.outlineStyle=di,va=void 0,di=void 0,ti(window,"keydown",Xa))}function xa(o){do o=o.parentNode;while((!o.offsetWidth||!o.offsetHeight)&&o!==document.body);return o}function kn(o){var _=o.getBoundingClientRect();return{x:_.width/o.offsetWidth||1,y:_.height/o.offsetHeight||1,boundingClientRect:_}}var ar={__proto__:null,TRANSFORM:qa,TRANSITION:bo,TRANSITION_END:ns,get:ta,getStyle:$a,create:Oi,remove:mn,empty:$n,toFront:wo,toBack:_l,hasClass:gl,addClass:Si,removeClass:on,setClass:To,getClass:Tr,setOpacity:Rr,testProp:So,setTransform:rs,setPosition:Zn,getPosition:bs,get disableTextSelection(){return ss},get enableTextSelection(){return Ur},disableImageDrag:js,enableImageDrag:ea,preventOutline:ia,restoreOutline:Xa,getSizedParentNode:xa,getScale:kn};function Qe(o,_,A,B){if(_&&typeof _=="object")for(var G in _)lr(o,G,_[G],A);else{_=Yt(_);for(var nt=0,wt=_.length;nt<wt;nt++)lr(o,_[nt],A,B)}return this}var Ui="_leaflet_events";function ti(o,_,A,B){if(arguments.length===1)na(o),delete o[Ui];else if(_&&typeof _=="object")for(var G in _)_n(o,G,_[G],A);else if(_=Yt(_),arguments.length===2)na(o,function(Bt){return Ne(_,Bt)!==-1});else for(var nt=0,wt=_.length;nt<wt;nt++)_n(o,_[nt],A,B);return this}function na(o,_){for(var A in o[Ui]){var B=A.split(/\d/)[0];(!_||_(B))&&_n(o,B,null,null,A)}}var or={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function lr(o,_,A,B){var G=_+H(A)+(B?"_"+H(B):"");if(o[Ui]&&o[Ui][G])return this;var nt=function(Bt){return A.call(B||o,Bt||window.event)},wt=nt;!Ie.touchNative&&Ie.pointer&&_.indexOf("touch")===0?nt=pn(o,_,nt):Ie.touch&&_==="dblclick"?nt=Vi(o,nt):"addEventListener"in o?_==="touchstart"||_==="touchmove"||_==="wheel"||_==="mousewheel"?o.addEventListener(or[_]||_,nt,Ie.passiveEvents?{passive:!1}:!1):_==="mouseenter"||_==="mouseleave"?(nt=function(Bt){Bt=Bt||window.event,ba(o,Bt)&&wt(Bt)},o.addEventListener(or[_],nt,!1)):o.addEventListener(_,wt,!1):o.attachEvent("on"+_,nt),o[Ui]=o[Ui]||{},o[Ui][G]=nt}function _n(o,_,A,B,G){G=G||_+H(A)+(B?"_"+H(B):"");var nt=o[Ui]&&o[Ui][G];if(!nt)return this;!Ie.touchNative&&Ie.pointer&&_.indexOf("touch")===0?hi(o,_,nt):Ie.touch&&_==="dblclick"?ya(o,nt):"removeEventListener"in o?o.removeEventListener(or[_]||_,nt,!1):o.detachEvent("on"+_,nt),o[Ui][G]=null}function Ri(o){return o.stopPropagation?o.stopPropagation():o.originalEvent?o.originalEvent._stopped=!0:o.cancelBubble=!0,this}function Fs(o){return lr(o,"wheel",Ri),this}function Ye(o){return Qe(o,"mousedown touchstart dblclick contextmenu",Ri),o._leaflet_disable_click=!0,this}function je(o){return o.preventDefault?o.preventDefault():o.returnValue=!1,this}function fr(o){return je(o),Ri(o),this}function Ai(o){if(o.composedPath)return o.composedPath();for(var _=[],A=o.target;A;)_.push(A),A=A.parentNode;return _}function Ji(o,_){if(!_)return new fe(o.clientX,o.clientY);var A=kn(_),B=A.boundingClientRect;return new fe((o.clientX-B.left)/A.x-_.clientLeft,(o.clientY-B.top)/A.y-_.clientTop)}var kr=Ie.linux&&Ie.chrome?window.devicePixelRatio:Ie.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function as(o){return Ie.edge?o.wheelDeltaY/2:o.deltaY&&o.deltaMode===0?-o.deltaY/kr:o.deltaY&&o.deltaMode===1?-o.deltaY*20:o.deltaY&&o.deltaMode===2?-o.deltaY*60:o.deltaX||o.deltaZ?0:o.wheelDelta?(o.wheelDeltaY||o.wheelDelta)/2:o.detail&&Math.abs(o.detail)<32765?-o.detail*20:o.detail?o.detail/-32765*60:0}function ba(o,_){var A=_.relatedTarget;if(!A)return!0;try{for(;A&&A!==o;)A=A.parentNode}catch{return!1}return A!==o}var pu={__proto__:null,on:Qe,off:ti,stopPropagation:Ri,disableScrollPropagation:Fs,disableClickPropagation:Ye,preventDefault:je,stop:fr,getPropagationPath:Ai,getMousePosition:Ji,getWheelDelta:as,isExternalTarget:ba,addListener:Qe,removeListener:ti},Ya=me.extend({run:function(o,_,A,B){this.stop(),this._el=o,this._inProgress=!0,this._duration=A||.25,this._easeOutPower=1/Math.max(B||.5,.2),this._startPos=bs(o),this._offset=_.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=zi(this._animate,this),this._step()},_step:function(o){var _=+new Date-this._startTime,A=this._duration*1e3;_<A?this._runFrame(this._easeOut(_/A),o):(this._runFrame(1),this._complete())},_runFrame:function(o,_){var A=this._startPos.add(this._offset.multiplyBy(o));_&&A._round(),Zn(this._el,A),this.fire("step")},_complete:function(){Pi(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(o){return 1-Math.pow(1-o,this._easeOutPower)}}),Mi=me.extend({options:{crs:sn,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(o,_){_=Jt(this,_),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(o),this._initLayout(),this._onResize=P(this._onResize,this),this._initEvents(),_.maxBounds&&this.setMaxBounds(_.maxBounds),_.zoom!==void 0&&(this._zoom=this._limitZoom(_.zoom)),_.center&&_.zoom!==void 0&&this.setView(Se(_.center),_.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=bo&&Ie.any3d&&!Ie.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Qe(this._proxy,ns,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(o,_,A){if(_=_===void 0?this._zoom:this._limitZoom(_),o=this._limitCenter(Se(o),_,this.options.maxBounds),A=A||{},this._stop(),this._loaded&&!A.reset&&A!==!0){A.animate!==void 0&&(A.zoom=I({animate:A.animate},A.zoom),A.pan=I({animate:A.animate,duration:A.duration},A.pan));var B=this._zoom!==_?this._tryAnimatedZoom&&this._tryAnimatedZoom(o,_,A.zoom):this._tryAnimatedPan(o,A.pan);if(B)return clearTimeout(this._sizeTimer),this}return this._resetView(o,_,A.pan&&A.pan.noMoveStart),this},setZoom:function(o,_){return this._loaded?this.setView(this.getCenter(),o,{zoom:_}):(this._zoom=o,this)},zoomIn:function(o,_){return o=o||(Ie.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+o,_)},zoomOut:function(o,_){return o=o||(Ie.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-o,_)},setZoomAround:function(o,_,A){var B=this.getZoomScale(_),G=this.getSize().divideBy(2),nt=o instanceof fe?o:this.latLngToContainerPoint(o),wt=nt.subtract(G).multiplyBy(1-1/B),Bt=this.containerPointToLatLng(G.add(wt));return this.setView(Bt,_,{zoom:A})},_getBoundsCenterZoom:function(o,_){_=_||{},o=o.getBounds?o.getBounds():ze(o);var A=yt(_.paddingTopLeft||_.padding||[0,0]),B=yt(_.paddingBottomRight||_.padding||[0,0]),G=this.getBoundsZoom(o,!1,A.add(B));if(G=typeof _.maxZoom=="number"?Math.min(_.maxZoom,G):G,G===1/0)return{center:o.getCenter(),zoom:G};var nt=B.subtract(A).divideBy(2),wt=this.project(o.getSouthWest(),G),Bt=this.project(o.getNorthEast(),G),qt=this.unproject(wt.add(Bt).divideBy(2).add(nt),G);return{center:qt,zoom:G}},fitBounds:function(o,_){if(o=ze(o),!o.isValid())throw new Error("Bounds are not valid.");var A=this._getBoundsCenterZoom(o,_);return this.setView(A.center,A.zoom,_)},fitWorld:function(o){return this.fitBounds([[-90,-180],[90,180]],o)},panTo:function(o,_){return this.setView(o,this._zoom,{pan:_})},panBy:function(o,_){if(o=yt(o).round(),_=_||{},!o.x&&!o.y)return this.fire("moveend");if(_.animate!==!0&&!this.getSize().contains(o))return this._resetView(this.unproject(this.project(this.getCenter()).add(o)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ya,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),_.noMoveStart||this.fire("movestart"),_.animate!==!1){Si(this._mapPane,"leaflet-pan-anim");var A=this._getMapPanePos().subtract(o).round();this._panAnim.run(this._mapPane,A,_.duration||.25,_.easeLinearity)}else this._rawPanBy(o),this.fire("move").fire("moveend");return this},flyTo:function(o,_,A){if(A=A||{},A.animate===!1||!Ie.any3d)return this.setView(o,_,A);this._stop();var B=this.project(this.getCenter()),G=this.project(o),nt=this.getSize(),wt=this._zoom;o=Se(o),_=_===void 0?wt:_;var Bt=Math.max(nt.x,nt.y),qt=Bt*this.getZoomScale(wt,_),he=G.distanceTo(B)||1,De=1.42,ke=De*De;function $e(En){var Or=En?-1:1,$s=En?qt:Bt,Nr=qt*qt-Bt*Bt+Or*ke*ke*he*he,oa=2*$s*ke*he,zl=Nr/oa,pc=Math.sqrt(zl*zl+1)-zl,Dl=pc<1e-9?-18:Math.log(pc);return Dl}function pi(En){return(Math.exp(En)-Math.exp(-En))/2}function gn(En){return(Math.exp(En)+Math.exp(-En))/2}function xn(En){return pi(En)/gn(En)}var _r=$e(0);function qs(En){return Bt*(gn(_r)/gn(_r+De*En))}function Vc(En){return Bt*(gn(_r)*xn(_r+De*En)-pi(_r))/ke}function bn(En){return 1-Math.pow(1-En,1.5)}var cs=Date.now(),Ar=($e(1)-_r)/De,fc=A.duration?1e3*A.duration:1e3*Ar*.8;function Ea(){var En=(Date.now()-cs)/fc,Or=bn(En)*Ar;En<=1?(this._flyToFrame=zi(Ea,this),this._move(this.unproject(B.add(G.subtract(B).multiplyBy(Vc(Or)/he)),wt),this.getScaleZoom(Bt/qs(Or),wt),{flyTo:!0})):this._move(o,_)._moveEnd(!0)}return this._moveStart(!0,A.noMoveStart),Ea.call(this),this},flyToBounds:function(o,_){var A=this._getBoundsCenterZoom(o,_);return this.flyTo(A.center,A.zoom,_)},setMaxBounds:function(o){return o=ze(o),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),o.isValid()?(this.options.maxBounds=o,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(o){var _=this.options.minZoom;return this.options.minZoom=o,this._loaded&&_!==o&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(o):this},setMaxZoom:function(o){var _=this.options.maxZoom;return this.options.maxZoom=o,this._loaded&&_!==o&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(o):this},panInsideBounds:function(o,_){this._enforcingBounds=!0;var A=this.getCenter(),B=this._limitCenter(A,this._zoom,ze(o));return A.equals(B)||this.panTo(B,_),this._enforcingBounds=!1,this},panInside:function(o,_){_=_||{};var A=yt(_.paddingTopLeft||_.padding||[0,0]),B=yt(_.paddingBottomRight||_.padding||[0,0]),G=this.project(this.getCenter()),nt=this.project(o),wt=this.getPixelBounds(),Bt=Ce([wt.min.add(A),wt.max.subtract(B)]),qt=Bt.getSize();if(!Bt.contains(nt)){this._enforcingBounds=!0;var he=nt.subtract(Bt.getCenter()),De=Bt.extend(nt).getSize().subtract(qt);G.x+=he.x<0?-De.x:De.x,G.y+=he.y<0?-De.y:De.y,this.panTo(this.unproject(G),_),this._enforcingBounds=!1}return this},invalidateSize:function(o){if(!this._loaded)return this;o=I({animate:!1,pan:!0},o===!0?{animate:!0}:o);var _=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var A=this.getSize(),B=_.divideBy(2).round(),G=A.divideBy(2).round(),nt=B.subtract(G);return!nt.x&&!nt.y?this:(o.animate&&o.pan?this.panBy(nt):(o.pan&&this._rawPanBy(nt),this.fire("move"),o.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(P(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:_,newSize:A}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(o){if(o=this._locateOptions=I({timeout:1e4,watch:!1},o),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var _=P(this._handleGeolocationResponse,this),A=P(this._handleGeolocationError,this);return o.watch?this._locationWatchId=navigator.geolocation.watchPosition(_,A,o):navigator.geolocation.getCurrentPosition(_,A,o),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(o){if(this._container._leaflet_id){var _=o.code,A=o.message||(_===1?"permission denied":_===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:_,message:"Geolocation error: "+A+"."})}},_handleGeolocationResponse:function(o){if(this._container._leaflet_id){var _=o.coords.latitude,A=o.coords.longitude,B=new Fe(_,A),G=B.toBounds(o.coords.accuracy*2),nt=this._locateOptions;if(nt.setView){var wt=this.getBoundsZoom(G);this.setView(B,nt.maxZoom?Math.min(wt,nt.maxZoom):wt)}var Bt={latlng:B,bounds:G,timestamp:o.timestamp};for(var qt in o.coords)typeof o.coords[qt]=="number"&&(Bt[qt]=o.coords[qt]);this.fire("locationfound",Bt)}},addHandler:function(o,_){if(!_)return this;var A=this[o]=new _(this);return this._handlers.push(A),this.options[o]&&A.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),mn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Pi(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var o;for(o in this._layers)this._layers[o].remove();for(o in this._panes)mn(this._panes[o]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(o,_){var A="leaflet-pane"+(o?" leaflet-"+o.replace("Pane","")+"-pane":""),B=Oi("div",A,_||this._mapPane);return o&&(this._panes[o]=B),B},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var o=this.getPixelBounds(),_=this.unproject(o.getBottomLeft()),A=this.unproject(o.getTopRight());return new xe(_,A)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(o,_,A){o=ze(o),A=yt(A||[0,0]);var B=this.getZoom()||0,G=this.getMinZoom(),nt=this.getMaxZoom(),wt=o.getNorthWest(),Bt=o.getSouthEast(),qt=this.getSize().subtract(A),he=Ce(this.project(Bt,B),this.project(wt,B)).getSize(),De=Ie.any3d?this.options.zoomSnap:1,ke=qt.x/he.x,$e=qt.y/he.y,pi=_?Math.max(ke,$e):Math.min(ke,$e);return B=this.getScaleZoom(pi,B),De&&(B=Math.round(B/(De/100))*(De/100),B=_?Math.ceil(B/De)*De:Math.floor(B/De)*De),Math.max(G,Math.min(nt,B))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new fe(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(o,_){var A=this._getTopLeftPoint(o,_);return new Wt(A,A.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(o){return this.options.crs.getProjectedBounds(o===void 0?this.getZoom():o)},getPane:function(o){return typeof o=="string"?this._panes[o]:o},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(o,_){var A=this.options.crs;return _=_===void 0?this._zoom:_,A.scale(o)/A.scale(_)},getScaleZoom:function(o,_){var A=this.options.crs;_=_===void 0?this._zoom:_;var B=A.zoom(o*A.scale(_));return isNaN(B)?1/0:B},project:function(o,_){return _=_===void 0?this._zoom:_,this.options.crs.latLngToPoint(Se(o),_)},unproject:function(o,_){return _=_===void 0?this._zoom:_,this.options.crs.pointToLatLng(yt(o),_)},layerPointToLatLng:function(o){var _=yt(o).add(this.getPixelOrigin());return this.unproject(_)},latLngToLayerPoint:function(o){var _=this.project(Se(o))._round();return _._subtract(this.getPixelOrigin())},wrapLatLng:function(o){return this.options.crs.wrapLatLng(Se(o))},wrapLatLngBounds:function(o){return this.options.crs.wrapLatLngBounds(ze(o))},distance:function(o,_){return this.options.crs.distance(Se(o),Se(_))},containerPointToLayerPoint:function(o){return yt(o).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(o){return yt(o).add(this._getMapPanePos())},containerPointToLatLng:function(o){var _=this.containerPointToLayerPoint(yt(o));return this.layerPointToLatLng(_)},latLngToContainerPoint:function(o){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Se(o)))},mouseEventToContainerPoint:function(o){return Ji(o,this._container)},mouseEventToLayerPoint:function(o){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(o))},mouseEventToLatLng:function(o){return this.layerPointToLatLng(this.mouseEventToLayerPoint(o))},_initContainer:function(o){var _=this._container=ta(o);if(_){if(_._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Qe(_,"scroll",this._onScroll,this),this._containerId=H(_)},_initLayout:function(){var o=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ie.any3d,Si(o,"leaflet-container"+(Ie.touch?" leaflet-touch":"")+(Ie.retina?" leaflet-retina":"")+(Ie.ielt9?" leaflet-oldie":"")+(Ie.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var _=$a(o,"position");_!=="absolute"&&_!=="relative"&&_!=="fixed"&&_!=="sticky"&&(o.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var o=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Zn(this._mapPane,new fe(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Si(o.markerPane,"leaflet-zoom-hide"),Si(o.shadowPane,"leaflet-zoom-hide"))},_resetView:function(o,_,A){Zn(this._mapPane,new fe(0,0));var B=!this._loaded;this._loaded=!0,_=this._limitZoom(_),this.fire("viewprereset");var G=this._zoom!==_;this._moveStart(G,A)._move(o,_)._moveEnd(G),this.fire("viewreset"),B&&this.fire("load")},_moveStart:function(o,_){return o&&this.fire("zoomstart"),_||this.fire("movestart"),this},_move:function(o,_,A,B){_===void 0&&(_=this._zoom);var G=this._zoom!==_;return this._zoom=_,this._lastCenter=o,this._pixelOrigin=this._getNewPixelOrigin(o),B?A&&A.pinch&&this.fire("zoom",A):((G||A&&A.pinch)&&this.fire("zoom",A),this.fire("move",A)),this},_moveEnd:function(o){return o&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Pi(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(o){Zn(this._mapPane,this._getMapPanePos().subtract(o))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(o){this._targets={},this._targets[H(this._container)]=this;var _=o?ti:Qe;_(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&_(window,"resize",this._onResize,this),Ie.any3d&&this.options.transform3DLimit&&(o?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Pi(this._resizeRequest),this._resizeRequest=zi(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var o=this._getMapPanePos();Math.max(Math.abs(o.x),Math.abs(o.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(o,_){for(var A=[],B,G=_==="mouseout"||_==="mouseover",nt=o.target||o.srcElement,wt=!1;nt;){if(B=this._targets[H(nt)],B&&(_==="click"||_==="preclick")&&this._draggableMoved(B)){wt=!0;break}if(B&&B.listens(_,!0)&&(G&&!ba(nt,o)||(A.push(B),G))||nt===this._container)break;nt=nt.parentNode}return!A.length&&!wt&&!G&&this.listens(_,!0)&&(A=[this]),A},_isClickDisabled:function(o){for(;o&&o!==this._container;){if(o._leaflet_disable_click)return!0;o=o.parentNode}},_handleDOMEvent:function(o){var _=o.target||o.srcElement;if(!(!this._loaded||_._leaflet_disable_events||o.type==="click"&&this._isClickDisabled(_))){var A=o.type;A==="mousedown"&&ia(_),this._fireDOMEvent(o,A)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(o,_,A){if(o.type==="click"){var B=I({},o);B.type="preclick",this._fireDOMEvent(B,B.type,A)}var G=this._findEventTargets(o,_);if(A){for(var nt=[],wt=0;wt<A.length;wt++)A[wt].listens(_,!0)&&nt.push(A[wt]);G=nt.concat(G)}if(G.length){_==="contextmenu"&&je(o);var Bt=G[0],qt={originalEvent:o};if(o.type!=="keypress"&&o.type!=="keydown"&&o.type!=="keyup"){var he=Bt.getLatLng&&(!Bt._radius||Bt._radius<=10);qt.containerPoint=he?this.latLngToContainerPoint(Bt.getLatLng()):this.mouseEventToContainerPoint(o),qt.layerPoint=this.containerPointToLayerPoint(qt.containerPoint),qt.latlng=he?Bt.getLatLng():this.layerPointToLatLng(qt.layerPoint)}for(wt=0;wt<G.length;wt++)if(G[wt].fire(_,qt,!0),qt.originalEvent._stopped||G[wt].options.bubblingMouseEvents===!1&&Ne(this._mouseEvents,_)!==-1)return}},_draggableMoved:function(o){return o=o.dragging&&o.dragging.enabled()?o:this,o.dragging&&o.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var o=0,_=this._handlers.length;o<_;o++)this._handlers[o].disable()},whenReady:function(o,_){return this._loaded?o.call(_||this,{target:this}):this.on("load",o,_),this},_getMapPanePos:function(){return bs(this._mapPane)||new fe(0,0)},_moved:function(){var o=this._getMapPanePos();return o&&!o.equals([0,0])},_getTopLeftPoint:function(o,_){var A=o&&_!==void 0?this._getNewPixelOrigin(o,_):this.getPixelOrigin();return A.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(o,_){var A=this.getSize()._divideBy(2);return this.project(o,_)._subtract(A)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(o,_,A){var B=this._getNewPixelOrigin(A,_);return this.project(o,_)._subtract(B)},_latLngBoundsToNewLayerBounds:function(o,_,A){var B=this._getNewPixelOrigin(A,_);return Ce([this.project(o.getSouthWest(),_)._subtract(B),this.project(o.getNorthWest(),_)._subtract(B),this.project(o.getSouthEast(),_)._subtract(B),this.project(o.getNorthEast(),_)._subtract(B)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(o){return this.latLngToLayerPoint(o).subtract(this._getCenterLayerPoint())},_limitCenter:function(o,_,A){if(!A)return o;var B=this.project(o,_),G=this.getSize().divideBy(2),nt=new Wt(B.subtract(G),B.add(G)),wt=this._getBoundsOffset(nt,A,_);return Math.abs(wt.x)<=1&&Math.abs(wt.y)<=1?o:this.unproject(B.add(wt),_)},_limitOffset:function(o,_){if(!_)return o;var A=this.getPixelBounds(),B=new Wt(A.min.add(o),A.max.add(o));return o.add(this._getBoundsOffset(B,_))},_getBoundsOffset:function(o,_,A){var B=Ce(this.project(_.getNorthEast(),A),this.project(_.getSouthWest(),A)),G=B.min.subtract(o.min),nt=B.max.subtract(o.max),wt=this._rebound(G.x,-nt.x),Bt=this._rebound(G.y,-nt.y);return new fe(wt,Bt)},_rebound:function(o,_){return o+_>0?Math.round(o-_)/2:Math.max(0,Math.ceil(o))-Math.max(0,Math.floor(_))},_limitZoom:function(o){var _=this.getMinZoom(),A=this.getMaxZoom(),B=Ie.any3d?this.options.zoomSnap:1;return B&&(o=Math.round(o/B)*B),Math.max(_,Math.min(A,o))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){on(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(o,_){var A=this._getCenterOffset(o)._trunc();return(_&&_.animate)!==!0&&!this.getSize().contains(A)?!1:(this.panBy(A,_),!0)},_createAnimProxy:function(){var o=this._proxy=Oi("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(o),this.on("zoomanim",function(_){var A=qa,B=this._proxy.style[A];rs(this._proxy,this.project(_.center,_.zoom),this.getZoomScale(_.zoom,1)),B===this._proxy.style[A]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){mn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var o=this.getCenter(),_=this.getZoom();rs(this._proxy,this.project(o,_),this.getZoomScale(_,1))},_catchTransitionEnd:function(o){this._animatingZoom&&o.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(o,_,A){if(this._animatingZoom)return!0;if(A=A||{},!this._zoomAnimated||A.animate===!1||this._nothingToAnimate()||Math.abs(_-this._zoom)>this.options.zoomAnimationThreshold)return!1;var B=this.getZoomScale(_),G=this._getCenterOffset(o)._divideBy(1-1/B);return A.animate!==!0&&!this.getSize().contains(G)?!1:(zi(function(){this._moveStart(!0,A.noMoveStart||!1)._animateZoom(o,_,!0)},this),!0)},_animateZoom:function(o,_,A,B){this._mapPane&&(A&&(this._animatingZoom=!0,this._animateToCenter=o,this._animateToZoom=_,Si(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:o,zoom:_,noUpdate:B}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(P(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&on(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Mo(o,_){return new Mi(o,_)}var Sr=Rn.extend({options:{position:"topright"},initialize:function(o){Jt(this,o)},getPosition:function(){return this.options.position},setPosition:function(o){var _=this._map;return _&&_.removeControl(this),this.options.position=o,_&&_.addControl(this),this},getContainer:function(){return this._container},addTo:function(o){this.remove(),this._map=o;var _=this._container=this.onAdd(o),A=this.getPosition(),B=o._controlCorners[A];return Si(_,"leaflet-control"),A.indexOf("bottom")!==-1?B.insertBefore(_,B.firstChild):B.appendChild(_),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(mn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(o){this._map&&o&&o.screenX>0&&o.screenY>0&&this._map.getContainer().focus()}}),Wa=function(o){return new Sr(o)};Mi.include({addControl:function(o){return o.addTo(this),this},removeControl:function(o){return o.remove(),this},_initControlPos:function(){var o=this._controlCorners={},_="leaflet-",A=this._controlContainer=Oi("div",_+"control-container",this._container);function B(G,nt){var wt=_+G+" "+_+nt;o[G+nt]=Oi("div",wt,A)}B("top","left"),B("top","right"),B("bottom","left"),B("bottom","right")},_clearControlPos:function(){for(var o in this._controlCorners)mn(this._controlCorners[o]);mn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Vs=Sr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(o,_,A,B){return A<B?-1:B<A?1:0}},initialize:function(o,_,A){Jt(this,A),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var B in o)this._addLayer(o[B],B);for(B in _)this._addLayer(_[B],B,!0)},onAdd:function(o){this._initLayout(),this._update(),this._map=o,o.on("zoomend",this._checkDisabledLayers,this);for(var _=0;_<this._layers.length;_++)this._layers[_].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(o){return Sr.prototype.addTo.call(this,o),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(o,_){return this._addLayer(o,_),this._map?this._update():this},addOverlay:function(o,_){return this._addLayer(o,_,!0),this._map?this._update():this},removeLayer:function(o){o.off("add remove",this._onLayerChange,this);var _=this._getLayer(H(o));return _&&this._layers.splice(this._layers.indexOf(_),1),this._map?this._update():this},expand:function(){Si(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var o=this._map.getSize().y-(this._container.offsetTop+50);return o<this._section.clientHeight?(Si(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=o+"px"):on(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return on(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var o="leaflet-control-layers",_=this._container=Oi("div",o),A=this.options.collapsed;_.setAttribute("aria-haspopup",!0),Ye(_),Fs(_);var B=this._section=Oi("section",o+"-list");A&&(this._map.on("click",this.collapse,this),Qe(_,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var G=this._layersLink=Oi("a",o+"-toggle",_);G.href="#",G.title="Layers",G.setAttribute("role","button"),Qe(G,{keydown:function(nt){nt.keyCode===13&&this._expandSafely()},click:function(nt){je(nt),this._expandSafely()}},this),A||this.expand(),this._baseLayersList=Oi("div",o+"-base",B),this._separator=Oi("div",o+"-separator",B),this._overlaysList=Oi("div",o+"-overlays",B),_.appendChild(B)},_getLayer:function(o){for(var _=0;_<this._layers.length;_++)if(this._layers[_]&&H(this._layers[_].layer)===o)return this._layers[_]},_addLayer:function(o,_,A){this._map&&o.on("add remove",this._onLayerChange,this),this._layers.push({layer:o,name:_,overlay:A}),this.options.sortLayers&&this._layers.sort(P(function(B,G){return this.options.sortFunction(B.layer,G.layer,B.name,G.name)},this)),this.options.autoZIndex&&o.setZIndex&&(this._lastZIndex++,o.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;$n(this._baseLayersList),$n(this._overlaysList),this._layerControlInputs=[];var o,_,A,B,G=0;for(A=0;A<this._layers.length;A++)B=this._layers[A],this._addItem(B),_=_||B.overlay,o=o||!B.overlay,G+=B.overlay?0:1;return this.options.hideSingleBase&&(o=o&&G>1,this._baseLayersList.style.display=o?"":"none"),this._separator.style.display=_&&o?"":"none",this},_onLayerChange:function(o){this._handlingClick||this._update();var _=this._getLayer(H(o.target)),A=_.overlay?o.type==="add"?"overlayadd":"overlayremove":o.type==="add"?"baselayerchange":null;A&&this._map.fire(A,_)},_createRadioElement:function(o,_){var A='<input type="radio" class="leaflet-control-layers-selector" name="'+o+'"'+(_?' checked="checked"':"")+"/>",B=document.createElement("div");return B.innerHTML=A,B.firstChild},_addItem:function(o){var _=document.createElement("label"),A=this._map.hasLayer(o.layer),B;o.overlay?(B=document.createElement("input"),B.type="checkbox",B.className="leaflet-control-layers-selector",B.defaultChecked=A):B=this._createRadioElement("leaflet-base-layers_"+H(this),A),this._layerControlInputs.push(B),B.layerId=H(o.layer),Qe(B,"click",this._onInputClick,this);var G=document.createElement("span");G.innerHTML=" "+o.name;var nt=document.createElement("span");_.appendChild(nt),nt.appendChild(B),nt.appendChild(G);var wt=o.overlay?this._overlaysList:this._baseLayersList;return wt.appendChild(_),this._checkDisabledLayers(),_},_onInputClick:function(){if(!this._preventClick){var o=this._layerControlInputs,_,A,B=[],G=[];this._handlingClick=!0;for(var nt=o.length-1;nt>=0;nt--)_=o[nt],A=this._getLayer(_.layerId).layer,_.checked?B.push(A):_.checked||G.push(A);for(nt=0;nt<G.length;nt++)this._map.hasLayer(G[nt])&&this._map.removeLayer(G[nt]);for(nt=0;nt<B.length;nt++)this._map.hasLayer(B[nt])||this._map.addLayer(B[nt]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var o=this._layerControlInputs,_,A,B=this._map.getZoom(),G=o.length-1;G>=0;G--)_=o[G],A=this._getLayer(_.layerId).layer,_.disabled=A.options.minZoom!==void 0&&B<A.options.minZoom||A.options.maxZoom!==void 0&&B>A.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var o=this._section;this._preventClick=!0,Qe(o,"click",je),this.expand();var _=this;setTimeout(function(){ti(o,"click",je),_._preventClick=!1})}}),pr=function(o,_,A){return new Vs(o,_,A)},Po=Sr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(o){var _="leaflet-control-zoom",A=Oi("div",_+" leaflet-bar"),B=this.options;return this._zoomInButton=this._createButton(B.zoomInText,B.zoomInTitle,_+"-in",A,this._zoomIn),this._zoomOutButton=this._createButton(B.zoomOutText,B.zoomOutTitle,_+"-out",A,this._zoomOut),this._updateDisabled(),o.on("zoomend zoomlevelschange",this._updateDisabled,this),A},onRemove:function(o){o.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(o){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(o.shiftKey?3:1))},_zoomOut:function(o){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(o.shiftKey?3:1))},_createButton:function(o,_,A,B,G){var nt=Oi("a",A,B);return nt.innerHTML=o,nt.href="#",nt.title=_,nt.setAttribute("role","button"),nt.setAttribute("aria-label",_),Ye(nt),Qe(nt,"click",fr),Qe(nt,"click",G,this),Qe(nt,"click",this._refocusOnMap,this),nt},_updateDisabled:function(){var o=this._map,_="leaflet-disabled";on(this._zoomInButton,_),on(this._zoomOutButton,_),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||o._zoom===o.getMinZoom())&&(Si(this._zoomOutButton,_),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||o._zoom===o.getMaxZoom())&&(Si(this._zoomInButton,_),this._zoomInButton.setAttribute("aria-disabled","true"))}});Mi.mergeOptions({zoomControl:!0}),Mi.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Po,this.addControl(this.zoomControl))});var qo=function(o){return new Po(o)},Ao=Sr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(o){var _="leaflet-control-scale",A=Oi("div",_),B=this.options;return this._addScales(B,_+"-line",A),o.on(B.updateWhenIdle?"moveend":"move",this._update,this),o.whenReady(this._update,this),A},onRemove:function(o){o.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(o,_,A){o.metric&&(this._mScale=Oi("div",_,A)),o.imperial&&(this._iScale=Oi("div",_,A))},_update:function(){var o=this._map,_=o.getSize().y/2,A=o.distance(o.containerPointToLatLng([0,_]),o.containerPointToLatLng([this.options.maxWidth,_]));this._updateScales(A)},_updateScales:function(o){this.options.metric&&o&&this._updateMetric(o),this.options.imperial&&o&&this._updateImperial(o)},_updateMetric:function(o){var _=this._getRoundNum(o),A=_<1e3?_+" m":_/1e3+" km";this._updateScale(this._mScale,A,_/o)},_updateImperial:function(o){var _=o*3.2808399,A,B,G;_>5280?(A=_/5280,B=this._getRoundNum(A),this._updateScale(this._iScale,B+" mi",B/A)):(G=this._getRoundNum(_),this._updateScale(this._iScale,G+" ft",G/_))},_updateScale:function(o,_,A){o.style.width=Math.round(this.options.maxWidth*A)+"px",o.innerHTML=_},_getRoundNum:function(o){var _=Math.pow(10,(Math.floor(o)+"").length-1),A=o/_;return A=A>=10?10:A>=5?5:A>=3?3:A>=2?2:1,_*A}}),Bn=function(o){return new Ao(o)},Xu='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',$o=Sr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ie.inlineSvg?Xu+" ":"")+"Leaflet</a>"},initialize:function(o){Jt(this,o),this._attributions={}},onAdd:function(o){o.attributionControl=this,this._container=Oi("div","leaflet-control-attribution"),Ye(this._container);for(var _ in o._layers)o._layers[_].getAttribution&&this.addAttribution(o._layers[_].getAttribution());return this._update(),o.on("layeradd",this._addAttribution,this),this._container},onRemove:function(o){o.off("layeradd",this._addAttribution,this)},_addAttribution:function(o){o.layer.getAttribution&&(this.addAttribution(o.layer.getAttribution()),o.layer.once("remove",function(){this.removeAttribution(o.layer.getAttribution())},this))},setPrefix:function(o){return this.options.prefix=o,this._update(),this},addAttribution:function(o){return o?(this._attributions[o]||(this._attributions[o]=0),this._attributions[o]++,this._update(),this):this},removeAttribution:function(o){return o?(this._attributions[o]&&(this._attributions[o]--,this._update()),this):this},_update:function(){if(this._map){var o=[];for(var _ in this._attributions)this._attributions[_]&&o.push(_);var A=[];this.options.prefix&&A.push(this.options.prefix),o.length&&A.push(o.join(", ")),this._container.innerHTML=A.join(' <span aria-hidden="true">|</span> ')}}});Mi.mergeOptions({attributionControl:!0}),Mi.addInitHook(function(){this.options.attributionControl&&new $o().addTo(this)});var mu=function(o){return new $o(o)};Sr.Layers=Vs,Sr.Zoom=Po,Sr.Scale=Ao,Sr.Attribution=$o,Wa.layers=pr,Wa.zoom=qo,Wa.scale=Bn,Wa.attribution=mu;var ra=Rn.extend({initialize:function(o){this._map=o},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ra.addTo=function(o,_){return o.addHandler(_,this),this};var yl={Events:Qt},mr=Ie.touch?"touchstart mousedown":"mousedown",Us=me.extend({options:{clickTolerance:3},initialize:function(o,_,A,B){Jt(this,B),this._element=o,this._dragStartTarget=_||o,this._preventOutline=A},enable:function(){this._enabled||(Qe(this._dragStartTarget,mr,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Us._dragging===this&&this.finishDrag(!0),ti(this._dragStartTarget,mr,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(o){if(this._enabled&&(this._moved=!1,!gl(this._element,"leaflet-zoom-anim"))){if(o.touches&&o.touches.length!==1){Us._dragging===this&&this.finishDrag();return}if(!(Us._dragging||o.shiftKey||o.which!==1&&o.button!==1&&!o.touches)&&(Us._dragging=this,this._preventOutline&&ia(this._element),js(),ss(),!this._moving)){this.fire("down");var _=o.touches?o.touches[0]:o,A=xa(this._element);this._startPoint=new fe(_.clientX,_.clientY),this._startPos=bs(this._element),this._parentScale=kn(A);var B=o.type==="mousedown";Qe(document,B?"mousemove":"touchmove",this._onMove,this),Qe(document,B?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(o){if(this._enabled){if(o.touches&&o.touches.length>1){this._moved=!0;return}var _=o.touches&&o.touches.length===1?o.touches[0]:o,A=new fe(_.clientX,_.clientY)._subtract(this._startPoint);!A.x&&!A.y||Math.abs(A.x)+Math.abs(A.y)<this.options.clickTolerance||(A.x/=this._parentScale.x,A.y/=this._parentScale.y,je(o),this._moved||(this.fire("dragstart"),this._moved=!0,Si(document.body,"leaflet-dragging"),this._lastTarget=o.target||o.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Si(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(A),this._moving=!0,this._lastEvent=o,this._updatePosition())}},_updatePosition:function(){var o={originalEvent:this._lastEvent};this.fire("predrag",o),Zn(this._element,this._newPos),this.fire("drag",o)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(o){on(document.body,"leaflet-dragging"),this._lastTarget&&(on(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ti(document,"mousemove touchmove",this._onMove,this),ti(document,"mouseup touchend touchcancel",this._onUp,this),ea(),Ur();var _=this._moved&&this._moving;this._moving=!1,Us._dragging=!1,_&&this.fire("dragend",{noInertia:o,distance:this._newPos.distanceTo(this._startPos)})}});function sa(o,_,A){var B,G=[1,4,2,8],nt,wt,Bt,qt,he,De,ke,$e;for(nt=0,De=o.length;nt<De;nt++)o[nt]._code=ws(o[nt],_);for(Bt=0;Bt<4;Bt++){for(ke=G[Bt],B=[],nt=0,De=o.length,wt=De-1;nt<De;wt=nt++)qt=o[nt],he=o[wt],qt._code&ke?he._code&ke||($e=vl(he,qt,ke,_,A),$e._code=ws($e,_),B.push($e)):(he._code&ke&&($e=vl(he,qt,ke,_,A),$e._code=ws($e,_),B.push($e)),B.push(qt));o=B}return o}function Co(o,_){var A,B,G,nt,wt,Bt,qt,he,De;if(!o||o.length===0)throw new Error("latlngs not passed");ln(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var ke=Se([0,0]),$e=ze(o),pi=$e.getNorthWest().distanceTo($e.getSouthWest())*$e.getNorthEast().distanceTo($e.getNorthWest());pi<1700&&(ke=Xo(o));var gn=o.length,xn=[];for(A=0;A<gn;A++){var _r=Se(o[A]);xn.push(_.project(Se([_r.lat-ke.lat,_r.lng-ke.lng])))}for(Bt=qt=he=0,A=0,B=gn-1;A<gn;B=A++)G=xn[A],nt=xn[B],wt=G.y*nt.x-nt.y*G.x,qt+=(G.x+nt.x)*wt,he+=(G.y+nt.y)*wt,Bt+=wt*3;Bt===0?De=xn[0]:De=[qt/Bt,he/Bt];var qs=_.unproject(yt(De));return Se([qs.lat+ke.lat,qs.lng+ke.lng])}function Xo(o){for(var _=0,A=0,B=0,G=0;G<o.length;G++){var nt=Se(o[G]);_+=nt.lat,A+=nt.lng,B++}return Se([_/B,A/B])}var tc={__proto__:null,clipPolygon:sa,polygonCenter:Co,centroid:Xo};function Mr(o,_){if(!_||!o.length)return o.slice();var A=_*_;return o=Rh(o,A),o=Ih(o,A),o}function kc(o,_,A){return Math.sqrt(wa(o,_,A,!0))}function Bc(o,_,A){return wa(o,_,A)}function Ih(o,_){var A=o.length,B=typeof Uint8Array<"u"?Uint8Array:Array,G=new B(A);G[0]=G[A-1]=1,ec(o,G,_,0,A-1);var nt,wt=[];for(nt=0;nt<A;nt++)G[nt]&&wt.push(o[nt]);return wt}function ec(o,_,A,B,G){var nt=0,wt,Bt,qt;for(Bt=B+1;Bt<=G-1;Bt++)qt=wa(o[Bt],o[B],o[G],!0),qt>nt&&(wt=Bt,nt=qt);nt>A&&(_[wt]=1,ec(o,_,A,B,wt),ec(o,_,A,wt,G))}function Rh(o,_){for(var A=[o[0]],B=1,G=0,nt=o.length;B<nt;B++)_u(o[B],o[G])>_&&(A.push(o[B]),G=B);return G<nt-1&&A.push(o[nt-1]),A}var Yu;function ic(o,_,A,B,G){var nt=B?Yu:ws(o,A),wt=ws(_,A),Bt,qt,he;for(Yu=wt;;){if(!(nt|wt))return[o,_];if(nt&wt)return!1;Bt=nt||wt,qt=vl(o,_,Bt,A,G),he=ws(qt,A),Bt===nt?(o=qt,nt=he):(_=qt,wt=he)}}function vl(o,_,A,B,G){var nt=_.x-o.x,wt=_.y-o.y,Bt=B.min,qt=B.max,he,De;return A&8?(he=o.x+nt*(qt.y-o.y)/wt,De=qt.y):A&4?(he=o.x+nt*(Bt.y-o.y)/wt,De=Bt.y):A&2?(he=qt.x,De=o.y+wt*(qt.x-o.x)/nt):A&1&&(he=Bt.x,De=o.y+wt*(Bt.x-o.x)/nt),new fe(he,De,G)}function ws(o,_){var A=0;return o.x<_.min.x?A|=1:o.x>_.max.x&&(A|=2),o.y<_.min.y?A|=4:o.y>_.max.y&&(A|=8),A}function _u(o,_){var A=_.x-o.x,B=_.y-o.y;return A*A+B*B}function wa(o,_,A,B){var G=_.x,nt=_.y,wt=A.x-G,Bt=A.y-nt,qt=wt*wt+Bt*Bt,he;return qt>0&&(he=((o.x-G)*wt+(o.y-nt)*Bt)/qt,he>1?(G=A.x,nt=A.y):he>0&&(G+=wt*he,nt+=Bt*he)),wt=o.x-G,Bt=o.y-nt,B?wt*wt+Bt*Bt:new fe(G,nt)}function ln(o){return!ne(o[0])||typeof o[0][0]!="object"&&typeof o[0][0]<"u"}function Wu(o){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ln(o)}function xl(o,_){var A,B,G,nt,wt,Bt,qt,he;if(!o||o.length===0)throw new Error("latlngs not passed");ln(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var De=Se([0,0]),ke=ze(o),$e=ke.getNorthWest().distanceTo(ke.getSouthWest())*ke.getNorthEast().distanceTo(ke.getNorthWest());$e<1700&&(De=Xo(o));var pi=o.length,gn=[];for(A=0;A<pi;A++){var xn=Se(o[A]);gn.push(_.project(Se([xn.lat-De.lat,xn.lng-De.lng])))}for(A=0,B=0;A<pi-1;A++)B+=gn[A].distanceTo(gn[A+1])/2;if(B===0)he=gn[0];else for(A=0,nt=0;A<pi-1;A++)if(wt=gn[A],Bt=gn[A+1],G=wt.distanceTo(Bt),nt+=G,nt>B){qt=(nt-B)/G,he=[Bt.x-qt*(Bt.x-wt.x),Bt.y-qt*(Bt.y-wt.y)];break}var _r=_.unproject(yt(he));return Se([_r.lat+De.lat,_r.lng+De.lng])}var bl={__proto__:null,simplify:Mr,pointToSegmentDistance:kc,closestPointOnSegment:Bc,clipSegment:ic,_getEdgeIntersection:vl,_getBitCode:ws,_sqClosestPointOnSegment:wa,isFlat:ln,_flat:Wu,polylineCenter:xl},Eo={project:function(o){return new fe(o.lng,o.lat)},unproject:function(o){return new Fe(o.y,o.x)},bounds:new Wt([-180,-90],[180,90])},Oc={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Wt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(o){var _=Math.PI/180,A=this.R,B=o.lat*_,G=this.R_MINOR/A,nt=Math.sqrt(1-G*G),wt=nt*Math.sin(B),Bt=Math.tan(Math.PI/4-B/2)/Math.pow((1-wt)/(1+wt),nt/2);return B=-A*Math.log(Math.max(Bt,1e-10)),new fe(o.lng*_*A,B)},unproject:function(o){for(var _=180/Math.PI,A=this.R,B=this.R_MINOR/A,G=Math.sqrt(1-B*B),nt=Math.exp(-o.y/A),wt=Math.PI/2-2*Math.atan(nt),Bt=0,qt=.1,he;Bt<15&&Math.abs(qt)>1e-7;Bt++)he=G*Math.sin(wt),he=Math.pow((1-he)/(1+he),G/2),qt=Math.PI/2-2*Math.atan(nt*he)-wt,wt+=qt;return new Fe(wt*_,o.x*_/A)}},nc={__proto__:null,LonLat:Eo,Mercator:Oc,SphericalMercator:da},wl=I({},xi,{code:"EPSG:3395",projection:Oc,transformation:function(){var o=.5/(Math.PI*Oc.R);return sr(o,.5,-o,.5)}()}),zo=I({},xi,{code:"EPSG:4326",projection:Eo,transformation:sr(1/180,1,-1/180,.5)}),Ku=I({},rn,{projection:Eo,transformation:sr(1,0,-1,0),scale:function(o){return Math.pow(2,o)},zoom:function(o){return Math.log(o)/Math.LN2},distance:function(o,_){var A=_.lng-o.lng,B=_.lat-o.lat;return Math.sqrt(A*A+B*B)},infinite:!0});rn.Earth=xi,rn.EPSG3395=wl,rn.EPSG3857=sn,rn.EPSG900913=An,rn.EPSG4326=zo,rn.Simple=Ku;var Ts=me.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(o){return o.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(o){return o&&o.removeLayer(this),this},getPane:function(o){return this._map.getPane(o?this.options[o]||o:this.options.pane)},addInteractiveTarget:function(o){return this._map._targets[H(o)]=this,this},removeInteractiveTarget:function(o){return delete this._map._targets[H(o)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(o){var _=o.target;if(_.hasLayer(this)){if(this._map=_,this._zoomAnimated=_._zoomAnimated,this.getEvents){var A=this.getEvents();_.on(A,this),this.once("remove",function(){_.off(A,this)},this)}this.onAdd(_),this.fire("add"),_.fire("layeradd",{layer:this})}}});Mi.include({addLayer:function(o){if(!o._layerAdd)throw new Error("The provided object is not a Layer.");var _=H(o);return this._layers[_]?this:(this._layers[_]=o,o._mapToAdd=this,o.beforeAdd&&o.beforeAdd(this),this.whenReady(o._layerAdd,o),this)},removeLayer:function(o){var _=H(o);return this._layers[_]?(this._loaded&&o.onRemove(this),delete this._layers[_],this._loaded&&(this.fire("layerremove",{layer:o}),o.fire("remove")),o._map=o._mapToAdd=null,this):this},hasLayer:function(o){return H(o)in this._layers},eachLayer:function(o,_){for(var A in this._layers)o.call(_,this._layers[A]);return this},_addLayers:function(o){o=o?ne(o)?o:[o]:[];for(var _=0,A=o.length;_<A;_++)this.addLayer(o[_])},_addZoomLimit:function(o){(!isNaN(o.options.maxZoom)||!isNaN(o.options.minZoom))&&(this._zoomBoundLayers[H(o)]=o,this._updateZoomLevels())},_removeZoomLimit:function(o){var _=H(o);this._zoomBoundLayers[_]&&(delete this._zoomBoundLayers[_],this._updateZoomLevels())},_updateZoomLevels:function(){var o=1/0,_=-1/0,A=this._getZoomSpan();for(var B in this._zoomBoundLayers){var G=this._zoomBoundLayers[B].options;o=G.minZoom===void 0?o:Math.min(o,G.minZoom),_=G.maxZoom===void 0?_:Math.max(_,G.maxZoom)}this._layersMaxZoom=_===-1/0?void 0:_,this._layersMinZoom=o===1/0?void 0:o,A!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Yo=Ts.extend({initialize:function(o,_){Jt(this,_),this._layers={};var A,B;if(o)for(A=0,B=o.length;A<B;A++)this.addLayer(o[A])},addLayer:function(o){var _=this.getLayerId(o);return this._layers[_]=o,this._map&&this._map.addLayer(o),this},removeLayer:function(o){var _=o in this._layers?o:this.getLayerId(o);return this._map&&this._layers[_]&&this._map.removeLayer(this._layers[_]),delete this._layers[_],this},hasLayer:function(o){var _=typeof o=="number"?o:this.getLayerId(o);return _ in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(o){var _=Array.prototype.slice.call(arguments,1),A,B;for(A in this._layers)B=this._layers[A],B[o]&&B[o].apply(B,_);return this},onAdd:function(o){this.eachLayer(o.addLayer,o)},onRemove:function(o){this.eachLayer(o.removeLayer,o)},eachLayer:function(o,_){for(var A in this._layers)o.call(_,this._layers[A]);return this},getLayer:function(o){return this._layers[o]},getLayers:function(){var o=[];return this.eachLayer(o.push,o),o},setZIndex:function(o){return this.invoke("setZIndex",o)},getLayerId:function(o){return H(o)}}),gu=function(o,_){return new Yo(o,_)},Zr=Yo.extend({addLayer:function(o){return this.hasLayer(o)?this:(o.addEventParent(this),Yo.prototype.addLayer.call(this,o),this.fire("layeradd",{layer:o}))},removeLayer:function(o){return this.hasLayer(o)?(o in this._layers&&(o=this._layers[o]),o.removeEventParent(this),Yo.prototype.removeLayer.call(this,o),this.fire("layerremove",{layer:o})):this},setStyle:function(o){return this.invoke("setStyle",o)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var o=new xe;for(var _ in this._layers){var A=this._layers[_];o.extend(A.getBounds?A.getBounds():A.getLatLng())}return o}}),Tl=function(o,_){return new Zr(o,_)},Ka=Rn.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(o){Jt(this,o)},createIcon:function(o){return this._createIcon("icon",o)},createShadow:function(o){return this._createIcon("shadow",o)},_createIcon:function(o,_){var A=this._getIconUrl(o);if(!A){if(o==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var B=this._createImg(A,_&&_.tagName==="IMG"?_:null);return this._setIconStyles(B,o),(this.options.crossOrigin||this.options.crossOrigin==="")&&(B.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),B},_setIconStyles:function(o,_){var A=this.options,B=A[_+"Size"];typeof B=="number"&&(B=[B,B]);var G=yt(B),nt=yt(_==="shadow"&&A.shadowAnchor||A.iconAnchor||G&&G.divideBy(2,!0));o.className="leaflet-marker-"+_+" "+(A.className||""),nt&&(o.style.marginLeft=-nt.x+"px",o.style.marginTop=-nt.y+"px"),G&&(o.style.width=G.x+"px",o.style.height=G.y+"px")},_createImg:function(o,_){return _=_||document.createElement("img"),_.src=o,_},_getIconUrl:function(o){return Ie.retina&&this.options[o+"RetinaUrl"]||this.options[o+"Url"]}});function rc(o){return new Ka(o)}var Wo=Ka.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(o){return typeof Wo.imagePath!="string"&&(Wo.imagePath=this._detectIconPath()),(this.options.imagePath||Wo.imagePath)+Ka.prototype._getIconUrl.call(this,o)},_stripUrl:function(o){var _=function(A,B,G){var nt=B.exec(A);return nt&&nt[G]};return o=_(o,/^url\((['"])?(.+)\1\)$/,2),o&&_(o,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var o=Oi("div","leaflet-default-icon-path",document.body),_=$a(o,"background-image")||$a(o,"backgroundImage");if(document.body.removeChild(o),_=this._stripUrl(_),_)return _;var A=document.querySelector('link[href$="leaflet.css"]');return A?A.href.substring(0,A.href.length-11-1):""}}),Qa=ra.extend({initialize:function(o){this._marker=o},addHooks:function(){var o=this._marker._icon;this._draggable||(this._draggable=new Us(o,o,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Si(o,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&on(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(o){var _=this._marker,A=_._map,B=this._marker.options.autoPanSpeed,G=this._marker.options.autoPanPadding,nt=bs(_._icon),wt=A.getPixelBounds(),Bt=A.getPixelOrigin(),qt=Ce(wt.min._subtract(Bt).add(G),wt.max._subtract(Bt).subtract(G));if(!qt.contains(nt)){var he=yt((Math.max(qt.max.x,nt.x)-qt.max.x)/(wt.max.x-qt.max.x)-(Math.min(qt.min.x,nt.x)-qt.min.x)/(wt.min.x-qt.min.x),(Math.max(qt.max.y,nt.y)-qt.max.y)/(wt.max.y-qt.max.y)-(Math.min(qt.min.y,nt.y)-qt.min.y)/(wt.min.y-qt.min.y)).multiplyBy(B);A.panBy(he,{animate:!1}),this._draggable._newPos._add(he),this._draggable._startPos._add(he),Zn(_._icon,this._draggable._newPos),this._onDrag(o),this._panRequest=zi(this._adjustPan.bind(this,o))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(o){this._marker.options.autoPan&&(Pi(this._panRequest),this._panRequest=zi(this._adjustPan.bind(this,o)))},_onDrag:function(o){var _=this._marker,A=_._shadow,B=bs(_._icon),G=_._map.layerPointToLatLng(B);A&&Zn(A,B),_._latlng=G,o.latlng=G,o.oldLatLng=this._oldLatLng,_.fire("move",o).fire("drag",o)},_onDragEnd:function(o){Pi(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",o)}}),Do=Ts.extend({options:{icon:new Wo,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(o,_){Jt(this,_),this._latlng=Se(o)},onAdd:function(o){this._zoomAnimated=this._zoomAnimated&&o.options.markerZoomAnimation,this._zoomAnimated&&o.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(o){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&o.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(o){var _=this._latlng;return this._latlng=Se(o),this.update(),this.fire("move",{oldLatLng:_,latlng:this._latlng})},setZIndexOffset:function(o){return this.options.zIndexOffset=o,this.update()},getIcon:function(){return this.options.icon},setIcon:function(o){return this.options.icon=o,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var o=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(o)}return this},_initIcon:function(){var o=this.options,_="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),A=o.icon.createIcon(this._icon),B=!1;A!==this._icon&&(this._icon&&this._removeIcon(),B=!0,o.title&&(A.title=o.title),A.tagName==="IMG"&&(A.alt=o.alt||"")),Si(A,_),o.keyboard&&(A.tabIndex="0",A.setAttribute("role","button")),this._icon=A,o.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Qe(A,"focus",this._panOnFocus,this);var G=o.icon.createShadow(this._shadow),nt=!1;G!==this._shadow&&(this._removeShadow(),nt=!0),G&&(Si(G,_),G.alt=""),this._shadow=G,o.opacity<1&&this._updateOpacity(),B&&this.getPane().appendChild(this._icon),this._initInteraction(),G&&nt&&this.getPane(o.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ti(this._icon,"focus",this._panOnFocus,this),mn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&mn(this._shadow),this._shadow=null},_setPos:function(o){this._icon&&Zn(this._icon,o),this._shadow&&Zn(this._shadow,o),this._zIndex=o.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(o){this._icon&&(this._icon.style.zIndex=this._zIndex+o)},_animateZoom:function(o){var _=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center).round();this._setPos(_)},_initInteraction:function(){if(this.options.interactive&&(Si(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Qa)){var o=this.options.draggable;this.dragging&&(o=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Qa(this),o&&this.dragging.enable()}},setOpacity:function(o){return this.options.opacity=o,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var o=this.options.opacity;this._icon&&Rr(this._icon,o),this._shadow&&Rr(this._shadow,o)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var o=this._map;if(o){var _=this.options.icon.options,A=_.iconSize?yt(_.iconSize):yt(0,0),B=_.iconAnchor?yt(_.iconAnchor):yt(0,0);o.panInside(this._latlng,{paddingTopLeft:B,paddingBottomRight:A.subtract(B)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function sc(o,_){return new Do(o,_)}var Ss=Ts.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(o){this._renderer=o.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(o){return Jt(this,o),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&o&&Object.prototype.hasOwnProperty.call(o,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ac=Ss.extend({options:{fill:!0,radius:10},initialize:function(o,_){Jt(this,_),this._latlng=Se(o),this._radius=this.options.radius},setLatLng:function(o){var _=this._latlng;return this._latlng=Se(o),this.redraw(),this.fire("move",{oldLatLng:_,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(o){return this.options.radius=this._radius=o,this.redraw()},getRadius:function(){return this._radius},setStyle:function(o){var _=o&&o.radius||this._radius;return Ss.prototype.setStyle.call(this,o),this.setRadius(_),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var o=this._radius,_=this._radiusY||o,A=this._clickTolerance(),B=[o+A,_+A];this._pxBounds=new Wt(this._point.subtract(B),this._point.add(B))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(o){return o.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Sl(o,_){return new ac(o,_)}var Nc=ac.extend({initialize:function(o,_,A){if(typeof _=="number"&&(_=I({},A,{radius:_})),Jt(this,_),this._latlng=Se(o),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(o){return this._mRadius=o,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var o=[this._radius,this._radiusY||this._radius];return new xe(this._map.layerPointToLatLng(this._point.subtract(o)),this._map.layerPointToLatLng(this._point.add(o)))},setStyle:Ss.prototype.setStyle,_project:function(){var o=this._latlng.lng,_=this._latlng.lat,A=this._map,B=A.options.crs;if(B.distance===xi.distance){var G=Math.PI/180,nt=this._mRadius/xi.R/G,wt=A.project([_+nt,o]),Bt=A.project([_-nt,o]),qt=wt.add(Bt).divideBy(2),he=A.unproject(qt).lat,De=Math.acos((Math.cos(nt*G)-Math.sin(_*G)*Math.sin(he*G))/(Math.cos(_*G)*Math.cos(he*G)))/G;(isNaN(De)||De===0)&&(De=nt/Math.cos(Math.PI/180*_)),this._point=qt.subtract(A.getPixelOrigin()),this._radius=isNaN(De)?0:qt.x-A.project([he,o-De]).x,this._radiusY=qt.y-wt.y}else{var ke=B.unproject(B.project(this._latlng).subtract([this._mRadius,0]));this._point=A.latLngToLayerPoint(this._latlng),this._radius=this._point.x-A.latLngToLayerPoint(ke).x}this._updateBounds()}});function kh(o,_,A){return new Nc(o,_,A)}var Ta=Ss.extend({options:{smoothFactor:1,noClip:!1},initialize:function(o,_){Jt(this,_),this._setLatLngs(o)},getLatLngs:function(){return this._latlngs},setLatLngs:function(o){return this._setLatLngs(o),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(o){for(var _=1/0,A=null,B=wa,G,nt,wt=0,Bt=this._parts.length;wt<Bt;wt++)for(var qt=this._parts[wt],he=1,De=qt.length;he<De;he++){G=qt[he-1],nt=qt[he];var ke=B(o,G,nt,!0);ke<_&&(_=ke,A=B(o,G,nt))}return A&&(A.distance=Math.sqrt(_)),A},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return xl(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(o,_){return _=_||this._defaultShape(),o=Se(o),_.push(o),this._bounds.extend(o),this.redraw()},_setLatLngs:function(o){this._bounds=new xe,this._latlngs=this._convertLatLngs(o)},_defaultShape:function(){return ln(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(o){for(var _=[],A=ln(o),B=0,G=o.length;B<G;B++)A?(_[B]=Se(o[B]),this._bounds.extend(_[B])):_[B]=this._convertLatLngs(o[B]);return _},_project:function(){var o=new Wt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,o),this._bounds.isValid()&&o.isValid()&&(this._rawPxBounds=o,this._updateBounds())},_updateBounds:function(){var o=this._clickTolerance(),_=new fe(o,o);this._rawPxBounds&&(this._pxBounds=new Wt([this._rawPxBounds.min.subtract(_),this._rawPxBounds.max.add(_)]))},_projectLatlngs:function(o,_,A){var B=o[0]instanceof Fe,G=o.length,nt,wt;if(B){for(wt=[],nt=0;nt<G;nt++)wt[nt]=this._map.latLngToLayerPoint(o[nt]),A.extend(wt[nt]);_.push(wt)}else for(nt=0;nt<G;nt++)this._projectLatlngs(o[nt],_,A)},_clipPoints:function(){var o=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}var _=this._parts,A,B,G,nt,wt,Bt,qt;for(A=0,G=0,nt=this._rings.length;A<nt;A++)for(qt=this._rings[A],B=0,wt=qt.length;B<wt-1;B++)Bt=ic(qt[B],qt[B+1],o,B,!0),Bt&&(_[G]=_[G]||[],_[G].push(Bt[0]),(Bt[1]!==qt[B+1]||B===wt-2)&&(_[G].push(Bt[1]),G++))}},_simplifyPoints:function(){for(var o=this._parts,_=this.options.smoothFactor,A=0,B=o.length;A<B;A++)o[A]=Mr(o[A],_)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(o,_){var A,B,G,nt,wt,Bt,qt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(A=0,nt=this._parts.length;A<nt;A++)for(Bt=this._parts[A],B=0,wt=Bt.length,G=wt-1;B<wt;G=B++)if(!(!_&&B===0)&&kc(o,Bt[G],Bt[B])<=qt)return!0;return!1}});function Qu(o,_){return new Ta(o,_)}Ta._flat=Wu;var Lo=Ta.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Co(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(o){var _=Ta.prototype._convertLatLngs.call(this,o),A=_.length;return A>=2&&_[0]instanceof Fe&&_[0].equals(_[A-1])&&_.pop(),_},_setLatLngs:function(o){Ta.prototype._setLatLngs.call(this,o),ln(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return ln(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var o=this._renderer._bounds,_=this.options.weight,A=new fe(_,_);if(o=new Wt(o.min.subtract(A),o.max.add(A)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}for(var B=0,G=this._rings.length,nt;B<G;B++)nt=sa(this._rings[B],o,!0),nt.length&&this._parts.push(nt)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(o){var _=!1,A,B,G,nt,wt,Bt,qt,he;if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(nt=0,qt=this._parts.length;nt<qt;nt++)for(A=this._parts[nt],wt=0,he=A.length,Bt=he-1;wt<he;Bt=wt++)B=A[wt],G=A[Bt],B.y>o.y!=G.y>o.y&&o.x<(G.x-B.x)*(o.y-B.y)/(G.y-B.y)+B.x&&(_=!_);return _||Ta.prototype._containsPoint.call(this,o,!0)}});function Gr(o,_){return new Lo(o,_)}var os=Zr.extend({initialize:function(o,_){Jt(this,_),this._layers={},o&&this.addData(o)},addData:function(o){var _=ne(o)?o:o.features,A,B,G;if(_){for(A=0,B=_.length;A<B;A++)G=_[A],(G.geometries||G.geometry||G.features||G.coordinates)&&this.addData(G);return this}var nt=this.options;if(nt.filter&&!nt.filter(o))return this;var wt=Io(o,nt);return wt?(wt.feature=Zs(o),wt.defaultOptions=wt.options,this.resetStyle(wt),nt.onEachFeature&&nt.onEachFeature(o,wt),this.addLayer(wt)):this},resetStyle:function(o){return o===void 0?this.eachLayer(this.resetStyle,this):(o.options=I({},o.defaultOptions),this._setLayerStyle(o,this.options.style),this)},setStyle:function(o){return this.eachLayer(function(_){this._setLayerStyle(_,o)},this)},_setLayerStyle:function(o,_){o.setStyle&&(typeof _=="function"&&(_=_(o.feature)),o.setStyle(_))}});function Io(o,_){var A=o.type==="Feature"?o.geometry:o,B=A?A.coordinates:null,G=[],nt=_&&_.pointToLayer,wt=_&&_.coordsToLatLng||Li,Bt,qt,he,De;if(!B&&!A)return null;switch(A.type){case"Point":return Bt=wt(B),aa(nt,o,Bt,_);case"MultiPoint":for(he=0,De=B.length;he<De;he++)Bt=wt(B[he]),G.push(aa(nt,o,Bt,_));return new Zr(G);case"LineString":case"MultiLineString":return qt=Ko(B,A.type==="LineString"?0:1,wt),new Ta(qt,_);case"Polygon":case"MultiPolygon":return qt=Ko(B,A.type==="Polygon"?1:2,wt),new Lo(qt,_);case"GeometryCollection":for(he=0,De=A.geometries.length;he<De;he++){var ke=Io({geometry:A.geometries[he],type:"Feature",properties:o.properties},_);ke&&G.push(ke)}return new Zr(G);case"FeatureCollection":for(he=0,De=A.features.length;he<De;he++){var $e=Io(A.features[he],_);$e&&G.push($e)}return new Zr(G);default:throw new Error("Invalid GeoJSON object.")}}function aa(o,_,A,B){return o?o(_,A):new Do(A,B&&B.markersInheritOptions&&B)}function Li(o){return new Fe(o[1],o[0],o[2])}function Ko(o,_,A){for(var B=[],G=0,nt=o.length,wt;G<nt;G++)wt=_?Ko(o[G],_-1,A):(A||Li)(o[G]),B.push(wt);return B}function Qo(o,_){return o=Se(o),o.alt!==void 0?[ht(o.lng,_),ht(o.lat,_),ht(o.alt,_)]:[ht(o.lng,_),ht(o.lat,_)]}function oc(o,_,A,B){for(var G=[],nt=0,wt=o.length;nt<wt;nt++)G.push(_?oc(o[nt],ln(o[nt])?0:_-1,A,B):Qo(o[nt],B));return!_&&A&&G.length>0&&G.push(G[0].slice()),G}function Ms(o,_){return o.feature?I({},o.feature,{geometry:_}):Zs(_)}function Zs(o){return o.type==="Feature"||o.type==="FeatureCollection"?o:{type:"Feature",properties:{},geometry:o}}var Ja={toGeoJSON:function(o){return Ms(this,{type:"Point",coordinates:Qo(this.getLatLng(),o)})}};Do.include(Ja),Nc.include(Ja),ac.include(Ja),Ta.include({toGeoJSON:function(o){var _=!ln(this._latlngs),A=oc(this._latlngs,_?1:0,!1,o);return Ms(this,{type:(_?"Multi":"")+"LineString",coordinates:A})}}),Lo.include({toGeoJSON:function(o){var _=!ln(this._latlngs),A=_&&!ln(this._latlngs[0]),B=oc(this._latlngs,A?2:_?1:0,!0,o);return _||(B=[B]),Ms(this,{type:(A?"Multi":"")+"Polygon",coordinates:B})}}),Yo.include({toMultiPoint:function(o){var _=[];return this.eachLayer(function(A){_.push(A.toGeoJSON(o).geometry.coordinates)}),Ms(this,{type:"MultiPoint",coordinates:_})},toGeoJSON:function(o){var _=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(_==="MultiPoint")return this.toMultiPoint(o);var A=_==="GeometryCollection",B=[];return this.eachLayer(function(G){if(G.toGeoJSON){var nt=G.toGeoJSON(o);if(A)B.push(nt.geometry);else{var wt=Zs(nt);wt.type==="FeatureCollection"?B.push.apply(B,wt.features):B.push(wt)}}}),A?Ms(this,{geometries:B,type:"GeometryCollection"}):{type:"FeatureCollection",features:B}}});function jc(o,_){return new os(o,_)}var Ju=jc,Sa=Ts.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(o,_,A){this._url=o,this._bounds=ze(_),Jt(this,A)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Si(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){mn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(o){return this.options.opacity=o,this._image&&this._updateOpacity(),this},setStyle:function(o){return o.opacity&&this.setOpacity(o.opacity),this},bringToFront:function(){return this._map&&wo(this._image),this},bringToBack:function(){return this._map&&_l(this._image),this},setUrl:function(o){return this._url=o,this._image&&(this._image.src=o),this},setBounds:function(o){return this._bounds=ze(o),this._map&&this._reset(),this},getEvents:function(){var o={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var o=this._url.tagName==="IMG",_=this._image=o?this._url:Oi("img");if(Si(_,"leaflet-image-layer"),this._zoomAnimated&&Si(_,"leaflet-zoom-animated"),this.options.className&&Si(_,this.options.className),_.onselectstart=dt,_.onmousemove=dt,_.onload=P(this.fire,this,"load"),_.onerror=P(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),o){this._url=_.src;return}_.src=this._url,_.alt=this.options.alt},_animateZoom:function(o){var _=this._map.getZoomScale(o.zoom),A=this._map._latLngBoundsToNewLayerBounds(this._bounds,o.zoom,o.center).min;rs(this._image,A,_)},_reset:function(){var o=this._image,_=new Wt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),A=_.getSize();Zn(o,_.min),o.style.width=A.x+"px",o.style.height=A.y+"px"},_updateOpacity:function(){Rr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var o=this.options.errorOverlayUrl;o&&this._url!==o&&(this._url=o,this._image.src=o)},getCenter:function(){return this._bounds.getCenter()}}),Ml=function(o,_,A){return new Sa(o,_,A)},lc=Sa.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var o=this._url.tagName==="VIDEO",_=this._image=o?this._url:Oi("video");if(Si(_,"leaflet-image-layer"),this._zoomAnimated&&Si(_,"leaflet-zoom-animated"),this.options.className&&Si(_,this.options.className),_.onselectstart=dt,_.onmousemove=dt,_.onloadeddata=P(this.fire,this,"load"),o){for(var A=_.getElementsByTagName("source"),B=[],G=0;G<A.length;G++)B.push(A[G].src);this._url=A.length>0?B:[_.src];return}ne(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(_.style,"objectFit")&&(_.style.objectFit="fill"),_.autoplay=!!this.options.autoplay,_.loop=!!this.options.loop,_.muted=!!this.options.muted,_.playsInline=!!this.options.playsInline;for(var nt=0;nt<this._url.length;nt++){var wt=Oi("source");wt.src=this._url[nt],_.appendChild(wt)}}});function th(o,_,A){return new lc(o,_,A)}var to=Sa.extend({_initImage:function(){var o=this._image=this._url;Si(o,"leaflet-image-layer"),this._zoomAnimated&&Si(o,"leaflet-zoom-animated"),this.options.className&&Si(o,this.options.className),o.onselectstart=dt,o.onmousemove=dt}});function cc(o,_,A){return new to(o,_,A)}var ls=Ts.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(o,_){o&&(o instanceof Fe||ne(o))?(this._latlng=Se(o),Jt(this,_)):(Jt(this,o),this._source=_),this.options.content&&(this._content=this.options.content)},openOn:function(o){return o=arguments.length?o:this._source._map,o.hasLayer(this)||o.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(o){return this._map?this.close():(arguments.length?this._source=o:o=this._source,this._prepareOpen(),this.openOn(o._map)),this},onAdd:function(o){this._zoomAnimated=o._zoomAnimated,this._container||this._initLayout(),o._fadeAnimated&&Rr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),o._fadeAnimated&&Rr(this._container,1),this.bringToFront(),this.options.interactive&&(Si(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(o){o._fadeAnimated?(Rr(this._container,0),this._removeTimeout=setTimeout(P(mn,void 0,this._container),200)):mn(this._container),this.options.interactive&&(on(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(o){return this._latlng=Se(o),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(o){return this._content=o,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var o={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&wo(this._container),this},bringToBack:function(){return this._map&&_l(this._container),this},_prepareOpen:function(o){var _=this._source;if(!_._map)return!1;if(_ instanceof Zr){_=null;var A=this._source._layers;for(var B in A)if(A[B]._map){_=A[B];break}if(!_)return!1;this._source=_}if(!o)if(_.getCenter)o=_.getCenter();else if(_.getLatLng)o=_.getLatLng();else if(_.getBounds)o=_.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(o),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var o=this._contentNode,_=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof _=="string")o.innerHTML=_;else{for(;o.hasChildNodes();)o.removeChild(o.firstChild);o.appendChild(_)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var o=this._map.latLngToLayerPoint(this._latlng),_=yt(this.options.offset),A=this._getAnchor();this._zoomAnimated?Zn(this._container,o.add(A)):_=_.add(o).add(A);var B=this._containerBottom=-_.y,G=this._containerLeft=-Math.round(this._containerWidth/2)+_.x;this._container.style.bottom=B+"px",this._container.style.left=G+"px"}},_getAnchor:function(){return[0,0]}});Mi.include({_initOverlay:function(o,_,A,B){var G=_;return G instanceof o||(G=new o(B).setContent(_)),A&&G.setLatLng(A),G}}),Ts.include({_initOverlay:function(o,_,A,B){var G=A;return G instanceof o?(Jt(G,B),G._source=this):(G=_&&!B?_:new o(B,this),G.setContent(A)),G}});var Ro=ls.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(o){return o=arguments.length?o:this._source._map,!o.hasLayer(this)&&o._popup&&o._popup.options.autoClose&&o.removeLayer(o._popup),o._popup=this,ls.prototype.openOn.call(this,o)},onAdd:function(o){ls.prototype.onAdd.call(this,o),o.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ss||this._source.on("preclick",Ri))},onRemove:function(o){ls.prototype.onRemove.call(this,o),o.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ss||this._source.off("preclick",Ri))},getEvents:function(){var o=ls.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(o.preclick=this.close),this.options.keepInView&&(o.moveend=this._adjustPan),o},_initLayout:function(){var o="leaflet-popup",_=this._container=Oi("div",o+" "+(this.options.className||"")+" leaflet-zoom-animated"),A=this._wrapper=Oi("div",o+"-content-wrapper",_);if(this._contentNode=Oi("div",o+"-content",A),Ye(_),Fs(this._contentNode),Qe(_,"contextmenu",Ri),this._tipContainer=Oi("div",o+"-tip-container",_),this._tip=Oi("div",o+"-tip",this._tipContainer),this.options.closeButton){var B=this._closeButton=Oi("a",o+"-close-button",_);B.setAttribute("role","button"),B.setAttribute("aria-label","Close popup"),B.href="#close",B.innerHTML='<span aria-hidden="true">&#215;</span>',Qe(B,"click",function(G){je(G),this.close()},this)}},_updateLayout:function(){var o=this._contentNode,_=o.style;_.width="",_.whiteSpace="nowrap";var A=o.offsetWidth;A=Math.min(A,this.options.maxWidth),A=Math.max(A,this.options.minWidth),_.width=A+1+"px",_.whiteSpace="",_.height="";var B=o.offsetHeight,G=this.options.maxHeight,nt="leaflet-popup-scrolled";G&&B>G?(_.height=G+"px",Si(o,nt)):on(o,nt),this._containerWidth=this._container.offsetWidth},_animateZoom:function(o){var _=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center),A=this._getAnchor();Zn(this._container,_.add(A))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var o=this._map,_=parseInt($a(this._container,"marginBottom"),10)||0,A=this._container.offsetHeight+_,B=this._containerWidth,G=new fe(this._containerLeft,-A-this._containerBottom);G._add(bs(this._container));var nt=o.layerPointToContainerPoint(G),wt=yt(this.options.autoPanPadding),Bt=yt(this.options.autoPanPaddingTopLeft||wt),qt=yt(this.options.autoPanPaddingBottomRight||wt),he=o.getSize(),De=0,ke=0;nt.x+B+qt.x>he.x&&(De=nt.x+B-he.x+qt.x),nt.x-De-Bt.x<0&&(De=nt.x-Bt.x),nt.y+A+qt.y>he.y&&(ke=nt.y+A-he.y+qt.y),nt.y-ke-Bt.y<0&&(ke=nt.y-Bt.y),(De||ke)&&(this.options.keepInView&&(this._autopanning=!0),o.fire("autopanstart").panBy([De,ke]))}},_getAnchor:function(){return yt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),yu=function(o,_){return new Ro(o,_)};Mi.mergeOptions({closePopupOnClick:!0}),Mi.include({openPopup:function(o,_,A){return this._initOverlay(Ro,o,_,A).openOn(this),this},closePopup:function(o){return o=arguments.length?o:this._popup,o&&o.close(),this}}),Ts.include({bindPopup:function(o,_){return this._popup=this._initOverlay(Ro,this._popup,o,_),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(o){return this._popup&&(this instanceof Zr||(this._popup._source=this),this._popup._prepareOpen(o||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(o){return this._popup&&this._popup.setContent(o),this},getPopup:function(){return this._popup},_openPopup:function(o){if(!(!this._popup||!this._map)){fr(o);var _=o.layer||o.target;if(this._popup._source===_&&!(_ instanceof Ss)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(o.latlng);return}this._popup._source=_,this.openPopup(o.latlng)}},_movePopup:function(o){this._popup.setLatLng(o.latlng)},_onKeyPress:function(o){o.originalEvent.keyCode===13&&this._openPopup(o)}});var Ma=ls.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(o){ls.prototype.onAdd.call(this,o),this.setOpacity(this.options.opacity),o.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(o){ls.prototype.onRemove.call(this,o),o.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var o=ls.prototype.getEvents.call(this);return this.options.permanent||(o.preclick=this.close),o},_initLayout:function(){var o="leaflet-tooltip",_=o+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Oi("div",_),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+H(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(o){var _,A,B=this._map,G=this._container,nt=B.latLngToContainerPoint(B.getCenter()),wt=B.layerPointToContainerPoint(o),Bt=this.options.direction,qt=G.offsetWidth,he=G.offsetHeight,De=yt(this.options.offset),ke=this._getAnchor();Bt==="top"?(_=qt/2,A=he):Bt==="bottom"?(_=qt/2,A=0):Bt==="center"?(_=qt/2,A=he/2):Bt==="right"?(_=0,A=he/2):Bt==="left"?(_=qt,A=he/2):wt.x<nt.x?(Bt="right",_=0,A=he/2):(Bt="left",_=qt+(De.x+ke.x)*2,A=he/2),o=o.subtract(yt(_,A,!0)).add(De).add(ke),on(G,"leaflet-tooltip-right"),on(G,"leaflet-tooltip-left"),on(G,"leaflet-tooltip-top"),on(G,"leaflet-tooltip-bottom"),Si(G,"leaflet-tooltip-"+Bt),Zn(G,o)},_updatePosition:function(){var o=this._map.latLngToLayerPoint(this._latlng);this._setPosition(o)},setOpacity:function(o){this.options.opacity=o,this._container&&Rr(this._container,o)},_animateZoom:function(o){var _=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center);this._setPosition(_)},_getAnchor:function(){return yt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),uc=function(o,_){return new Ma(o,_)};Mi.include({openTooltip:function(o,_,A){return this._initOverlay(Ma,o,_,A).openOn(this),this},closeTooltip:function(o){return o.close(),this}}),Ts.include({bindTooltip:function(o,_){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ma,this._tooltip,o,_),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(o){if(!(!o&&this._tooltipHandlersAdded)){var _=o?"off":"on",A={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?A.add=this._openTooltip:(A.mouseover=this._openTooltip,A.mouseout=this.closeTooltip,A.click=this._openTooltip,this._map?this._addFocusListeners():A.add=this._addFocusListeners),this._tooltip.options.sticky&&(A.mousemove=this._moveTooltip),this[_](A),this._tooltipHandlersAdded=!o}},openTooltip:function(o){return this._tooltip&&(this instanceof Zr||(this._tooltip._source=this),this._tooltip._prepareOpen(o)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(o){return this._tooltip&&this._tooltip.setContent(o),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(o){var _=typeof o.getElement=="function"&&o.getElement();_&&(Qe(_,"focus",function(){this._tooltip._source=o,this.openTooltip()},this),Qe(_,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(o){var _=typeof o.getElement=="function"&&o.getElement();_&&_.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(o){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var _=this;this._map.once("moveend",function(){_._openOnceFlag=!1,_._openTooltip(o)});return}this._tooltip._source=o.layer||o.target,this.openTooltip(this._tooltip.options.sticky?o.latlng:void 0)}},_moveTooltip:function(o){var _=o.latlng,A,B;this._tooltip.options.sticky&&o.originalEvent&&(A=this._map.mouseEventToContainerPoint(o.originalEvent),B=this._map.containerPointToLayerPoint(A),_=this._map.layerPointToLatLng(B)),this._tooltip.setLatLng(_)}});var ko=Ka.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(o){var _=o&&o.tagName==="DIV"?o:document.createElement("div"),A=this.options;if(A.html instanceof Element?($n(_),_.appendChild(A.html)):_.innerHTML=A.html!==!1?A.html:"",A.bgPos){var B=yt(A.bgPos);_.style.backgroundPosition=-B.x+"px "+-B.y+"px"}return this._setIconStyles(_,"icon"),_},createShadow:function(){return null}});function Ps(o){return new ko(o)}Ka.Default=Wo;var Bo=Ts.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ie.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(o){Jt(this,o)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(o){o._addZoomLimit(this)},onRemove:function(o){this._removeAllTiles(),mn(this._container),o._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(wo(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(_l(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(o){return this.options.opacity=o,this._updateOpacity(),this},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var o=this._clampZoom(this._map.getZoom());o!==this._tileZoom&&(this._tileZoom=o,this._updateLevels()),this._update()}return this},getEvents:function(){var o={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=X(this._onMoveEnd,this.options.updateInterval,this)),o.move=this._onMove),this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},createTile:function(){return document.createElement("div")},getTileSize:function(){var o=this.options.tileSize;return o instanceof fe?o:new fe(o,o)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(o){for(var _=this.getPane().children,A=-o(-1/0,1/0),B=0,G=_.length,nt;B<G;B++)nt=_[B].style.zIndex,_[B]!==this._container&&nt&&(A=o(A,+nt));isFinite(A)&&(this.options.zIndex=A+o(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ie.ielt9){Rr(this._container,this.options.opacity);var o=+new Date,_=!1,A=!1;for(var B in this._tiles){var G=this._tiles[B];if(!(!G.current||!G.loaded)){var nt=Math.min(1,(o-G.loaded)/200);Rr(G.el,nt),nt<1?_=!0:(G.active?A=!0:this._onOpaqueTile(G),G.active=!0)}}A&&!this._noPrune&&this._pruneTiles(),_&&(Pi(this._fadeFrame),this._fadeFrame=zi(this._updateOpacity,this))}},_onOpaqueTile:dt,_initContainer:function(){this._container||(this._container=Oi("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var o=this._tileZoom,_=this.options.maxZoom;if(o!==void 0){for(var A in this._levels)A=Number(A),this._levels[A].el.children.length||A===o?(this._levels[A].el.style.zIndex=_-Math.abs(o-A),this._onUpdateLevel(A)):(mn(this._levels[A].el),this._removeTilesAtZoom(A),this._onRemoveLevel(A),delete this._levels[A]);var B=this._levels[o],G=this._map;return B||(B=this._levels[o]={},B.el=Oi("div","leaflet-tile-container leaflet-zoom-animated",this._container),B.el.style.zIndex=_,B.origin=G.project(G.unproject(G.getPixelOrigin()),o).round(),B.zoom=o,this._setZoomTransform(B,G.getCenter(),G.getZoom()),dt(B.el.offsetWidth),this._onCreateLevel(B)),this._level=B,B}},_onUpdateLevel:dt,_onRemoveLevel:dt,_onCreateLevel:dt,_pruneTiles:function(){if(this._map){var o,_,A=this._map.getZoom();if(A>this.options.maxZoom||A<this.options.minZoom){this._removeAllTiles();return}for(o in this._tiles)_=this._tiles[o],_.retain=_.current;for(o in this._tiles)if(_=this._tiles[o],_.current&&!_.active){var B=_.coords;this._retainParent(B.x,B.y,B.z,B.z-5)||this._retainChildren(B.x,B.y,B.z,B.z+2)}for(o in this._tiles)this._tiles[o].retain||this._removeTile(o)}},_removeTilesAtZoom:function(o){for(var _ in this._tiles)this._tiles[_].coords.z===o&&this._removeTile(_)},_removeAllTiles:function(){for(var o in this._tiles)this._removeTile(o)},_invalidateAll:function(){for(var o in this._levels)mn(this._levels[o].el),this._onRemoveLevel(Number(o)),delete this._levels[o];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(o,_,A,B){var G=Math.floor(o/2),nt=Math.floor(_/2),wt=A-1,Bt=new fe(+G,+nt);Bt.z=+wt;var qt=this._tileCoordsToKey(Bt),he=this._tiles[qt];return he&&he.active?(he.retain=!0,!0):(he&&he.loaded&&(he.retain=!0),wt>B?this._retainParent(G,nt,wt,B):!1)},_retainChildren:function(o,_,A,B){for(var G=2*o;G<2*o+2;G++)for(var nt=2*_;nt<2*_+2;nt++){var wt=new fe(G,nt);wt.z=A+1;var Bt=this._tileCoordsToKey(wt),qt=this._tiles[Bt];if(qt&&qt.active){qt.retain=!0;continue}else qt&&qt.loaded&&(qt.retain=!0);A+1<B&&this._retainChildren(G,nt,A+1,B)}},_resetView:function(o){var _=o&&(o.pinch||o.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),_,_)},_animateZoom:function(o){this._setView(o.center,o.zoom,!0,o.noUpdate)},_clampZoom:function(o){var _=this.options;return _.minNativeZoom!==void 0&&o<_.minNativeZoom?_.minNativeZoom:_.maxNativeZoom!==void 0&&_.maxNativeZoom<o?_.maxNativeZoom:o},_setView:function(o,_,A,B){var G=Math.round(_);this.options.maxZoom!==void 0&&G>this.options.maxZoom||this.options.minZoom!==void 0&&G<this.options.minZoom?G=void 0:G=this._clampZoom(G);var nt=this.options.updateWhenZooming&&G!==this._tileZoom;(!B||nt)&&(this._tileZoom=G,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),G!==void 0&&this._update(o),A||this._pruneTiles(),this._noPrune=!!A),this._setZoomTransforms(o,_)},_setZoomTransforms:function(o,_){for(var A in this._levels)this._setZoomTransform(this._levels[A],o,_)},_setZoomTransform:function(o,_,A){var B=this._map.getZoomScale(A,o.zoom),G=o.origin.multiplyBy(B).subtract(this._map._getNewPixelOrigin(_,A)).round();Ie.any3d?rs(o.el,G,B):Zn(o.el,G)},_resetGrid:function(){var o=this._map,_=o.options.crs,A=this._tileSize=this.getTileSize(),B=this._tileZoom,G=this._map.getPixelWorldBounds(this._tileZoom);G&&(this._globalTileRange=this._pxBoundsToTileRange(G)),this._wrapX=_.wrapLng&&!this.options.noWrap&&[Math.floor(o.project([0,_.wrapLng[0]],B).x/A.x),Math.ceil(o.project([0,_.wrapLng[1]],B).x/A.y)],this._wrapY=_.wrapLat&&!this.options.noWrap&&[Math.floor(o.project([_.wrapLat[0],0],B).y/A.x),Math.ceil(o.project([_.wrapLat[1],0],B).y/A.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(o){var _=this._map,A=_._animatingZoom?Math.max(_._animateToZoom,_.getZoom()):_.getZoom(),B=_.getZoomScale(A,this._tileZoom),G=_.project(o,this._tileZoom).floor(),nt=_.getSize().divideBy(B*2);return new Wt(G.subtract(nt),G.add(nt))},_update:function(o){var _=this._map;if(_){var A=this._clampZoom(_.getZoom());if(o===void 0&&(o=_.getCenter()),this._tileZoom!==void 0){var B=this._getTiledPixelBounds(o),G=this._pxBoundsToTileRange(B),nt=G.getCenter(),wt=[],Bt=this.options.keepBuffer,qt=new Wt(G.getBottomLeft().subtract([Bt,-Bt]),G.getTopRight().add([Bt,-Bt]));if(!(isFinite(G.min.x)&&isFinite(G.min.y)&&isFinite(G.max.x)&&isFinite(G.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var he in this._tiles){var De=this._tiles[he].coords;(De.z!==this._tileZoom||!qt.contains(new fe(De.x,De.y)))&&(this._tiles[he].current=!1)}if(Math.abs(A-this._tileZoom)>1){this._setView(o,A);return}for(var ke=G.min.y;ke<=G.max.y;ke++)for(var $e=G.min.x;$e<=G.max.x;$e++){var pi=new fe($e,ke);if(pi.z=this._tileZoom,!!this._isValidTile(pi)){var gn=this._tiles[this._tileCoordsToKey(pi)];gn?gn.current=!0:wt.push(pi)}}if(wt.sort(function(_r,qs){return _r.distanceTo(nt)-qs.distanceTo(nt)}),wt.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var xn=document.createDocumentFragment();for($e=0;$e<wt.length;$e++)this._addTile(wt[$e],xn);this._level.el.appendChild(xn)}}}},_isValidTile:function(o){var _=this._map.options.crs;if(!_.infinite){var A=this._globalTileRange;if(!_.wrapLng&&(o.x<A.min.x||o.x>A.max.x)||!_.wrapLat&&(o.y<A.min.y||o.y>A.max.y))return!1}if(!this.options.bounds)return!0;var B=this._tileCoordsToBounds(o);return ze(this.options.bounds).overlaps(B)},_keyToBounds:function(o){return this._tileCoordsToBounds(this._keyToTileCoords(o))},_tileCoordsToNwSe:function(o){var _=this._map,A=this.getTileSize(),B=o.scaleBy(A),G=B.add(A),nt=_.unproject(B,o.z),wt=_.unproject(G,o.z);return[nt,wt]},_tileCoordsToBounds:function(o){var _=this._tileCoordsToNwSe(o),A=new xe(_[0],_[1]);return this.options.noWrap||(A=this._map.wrapLatLngBounds(A)),A},_tileCoordsToKey:function(o){return o.x+":"+o.y+":"+o.z},_keyToTileCoords:function(o){var _=o.split(":"),A=new fe(+_[0],+_[1]);return A.z=+_[2],A},_removeTile:function(o){var _=this._tiles[o];_&&(mn(_.el),delete this._tiles[o],this.fire("tileunload",{tile:_.el,coords:this._keyToTileCoords(o)}))},_initTile:function(o){Si(o,"leaflet-tile");var _=this.getTileSize();o.style.width=_.x+"px",o.style.height=_.y+"px",o.onselectstart=dt,o.onmousemove=dt,Ie.ielt9&&this.options.opacity<1&&Rr(o,this.options.opacity)},_addTile:function(o,_){var A=this._getTilePos(o),B=this._tileCoordsToKey(o),G=this.createTile(this._wrapCoords(o),P(this._tileReady,this,o));this._initTile(G),this.createTile.length<2&&zi(P(this._tileReady,this,o,null,G)),Zn(G,A),this._tiles[B]={el:G,coords:o,current:!0},_.appendChild(G),this.fire("tileloadstart",{tile:G,coords:o})},_tileReady:function(o,_,A){_&&this.fire("tileerror",{error:_,tile:A,coords:o});var B=this._tileCoordsToKey(o);A=this._tiles[B],A&&(A.loaded=+new Date,this._map._fadeAnimated?(Rr(A.el,0),Pi(this._fadeFrame),this._fadeFrame=zi(this._updateOpacity,this)):(A.active=!0,this._pruneTiles()),_||(Si(A.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:A.el,coords:o})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ie.ielt9||!this._map._fadeAnimated?zi(this._pruneTiles,this):setTimeout(P(this._pruneTiles,this),250)))},_getTilePos:function(o){return o.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(o){var _=new fe(this._wrapX?Q(o.x,this._wrapX):o.x,this._wrapY?Q(o.y,this._wrapY):o.y);return _.z=o.z,_},_pxBoundsToTileRange:function(o){var _=this.getTileSize();return new Wt(o.min.unscaleBy(_).floor(),o.max.unscaleBy(_).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var o in this._tiles)if(!this._tiles[o].loaded)return!1;return!0}});function Gs(o){return new Bo(o)}var eo=Bo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(o,_){this._url=o,_=Jt(this,_),_.detectRetina&&Ie.retina&&_.maxZoom>0?(_.tileSize=Math.floor(_.tileSize/2),_.zoomReverse?(_.zoomOffset--,_.minZoom=Math.min(_.maxZoom,_.minZoom+1)):(_.zoomOffset++,_.maxZoom=Math.max(_.minZoom,_.maxZoom-1)),_.minZoom=Math.max(0,_.minZoom)):_.zoomReverse?_.minZoom=Math.min(_.maxZoom,_.minZoom):_.maxZoom=Math.max(_.minZoom,_.maxZoom),typeof _.subdomains=="string"&&(_.subdomains=_.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(o,_){return this._url===o&&_===void 0&&(_=!0),this._url=o,_||this.redraw(),this},createTile:function(o,_){var A=document.createElement("img");return Qe(A,"load",P(this._tileOnLoad,this,_,A)),Qe(A,"error",P(this._tileOnError,this,_,A)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(A.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(A.referrerPolicy=this.options.referrerPolicy),A.alt="",A.src=this.getTileUrl(o),A},getTileUrl:function(o){var _={r:Ie.retina?"@2x":"",s:this._getSubdomain(o),x:o.x,y:o.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var A=this._globalTileRange.max.y-o.y;this.options.tms&&(_.y=A),_["-y"]=A}return de(this._url,I(_,this.options))},_tileOnLoad:function(o,_){Ie.ielt9?setTimeout(P(o,this,null,_),0):o(null,_)},_tileOnError:function(o,_,A){var B=this.options.errorTileUrl;B&&_.getAttribute("src")!==B&&(_.src=B),o(A,_)},_onTileRemove:function(o){o.tile.onload=null},_getZoomForUrl:function(){var o=this._tileZoom,_=this.options.maxZoom,A=this.options.zoomReverse,B=this.options.zoomOffset;return A&&(o=_-o),o+B},_getSubdomain:function(o){var _=Math.abs(o.x+o.y)%this.options.subdomains.length;return this.options.subdomains[_]},_abortLoading:function(){var o,_;for(o in this._tiles)if(this._tiles[o].coords.z!==this._tileZoom&&(_=this._tiles[o].el,_.onload=dt,_.onerror=dt,!_.complete)){_.src=we;var A=this._tiles[o].coords;mn(_),delete this._tiles[o],this.fire("tileabort",{tile:_,coords:A})}},_removeTile:function(o){var _=this._tiles[o];if(_)return _.el.setAttribute("src",we),Bo.prototype._removeTile.call(this,o)},_tileReady:function(o,_,A){if(!(!this._map||A&&A.getAttribute("src")===we))return Bo.prototype._tileReady.call(this,o,_,A)}});function cr(o,_){return new eo(o,_)}var Br=eo.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(o,_){this._url=o;var A=I({},this.defaultWmsParams);for(var B in _)B in this.options||(A[B]=_[B]);_=Jt(this,_);var G=_.detectRetina&&Ie.retina?2:1,nt=this.getTileSize();A.width=nt.x*G,A.height=nt.y*G,this.wmsParams=A},onAdd:function(o){this._crs=this.options.crs||o.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var _=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[_]=this._crs.code,eo.prototype.onAdd.call(this,o)},getTileUrl:function(o){var _=this._tileCoordsToNwSe(o),A=this._crs,B=Ce(A.project(_[0]),A.project(_[1])),G=B.min,nt=B.max,wt=(this._wmsVersion>=1.3&&this._crs===zo?[G.y,G.x,nt.y,nt.x]:[G.x,G.y,nt.x,nt.y]).join(","),Bt=eo.prototype.getTileUrl.call(this,o);return Bt+pe(this.wmsParams,Bt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+wt},setParams:function(o,_){return I(this.wmsParams,o),_||this.redraw(),this}});function io(o,_){return new Br(o,_)}eo.WMS=Br,cr.wms=io;var Hr=Ts.extend({options:{padding:.1},initialize:function(o){Jt(this,o),H(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Si(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var o={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(o.zoomanim=this._onAnimZoom),o},_onAnimZoom:function(o){this._updateTransform(o.center,o.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(o,_){var A=this._map.getZoomScale(_,this._zoom),B=this._map.getSize().multiplyBy(.5+this.options.padding),G=this._map.project(this._center,_),nt=B.multiplyBy(-A).add(G).subtract(this._map._getNewPixelOrigin(o,_));Ie.any3d?rs(this._container,nt,A):Zn(this._container,nt)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var o in this._layers)this._layers[o]._reset()},_onZoomEnd:function(){for(var o in this._layers)this._layers[o]._project()},_updatePaths:function(){for(var o in this._layers)this._layers[o]._update()},_update:function(){var o=this.options.padding,_=this._map.getSize(),A=this._map.containerPointToLayerPoint(_.multiplyBy(-o)).round();this._bounds=new Wt(A,A.add(_.multiplyBy(1+o*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Oo=Hr.extend({options:{tolerance:0},getEvents:function(){var o=Hr.prototype.getEvents.call(this);return o.viewprereset=this._onViewPreReset,o},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Hr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var o=this._container=document.createElement("canvas");Qe(o,"mousemove",this._onMouseMove,this),Qe(o,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Qe(o,"mouseout",this._handleMouseOut,this),o._leaflet_disable_events=!0,this._ctx=o.getContext("2d")},_destroyContainer:function(){Pi(this._redrawRequest),delete this._ctx,mn(this._container),ti(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var o;this._redrawBounds=null;for(var _ in this._layers)o=this._layers[_],o._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Hr.prototype._update.call(this);var o=this._bounds,_=this._container,A=o.getSize(),B=Ie.retina?2:1;Zn(_,o.min),_.width=B*A.x,_.height=B*A.y,_.style.width=A.x+"px",_.style.height=A.y+"px",Ie.retina&&this._ctx.scale(2,2),this._ctx.translate(-o.min.x,-o.min.y),this.fire("update")}},_reset:function(){Hr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(o){this._updateDashArray(o),this._layers[H(o)]=o;var _=o._order={layer:o,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=_),this._drawLast=_,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(o){this._requestRedraw(o)},_removePath:function(o){var _=o._order,A=_.next,B=_.prev;A?A.prev=B:this._drawLast=B,B?B.next=A:this._drawFirst=A,delete o._order,delete this._layers[H(o)],this._requestRedraw(o)},_updatePath:function(o){this._extendRedrawBounds(o),o._project(),o._update(),this._requestRedraw(o)},_updateStyle:function(o){this._updateDashArray(o),this._requestRedraw(o)},_updateDashArray:function(o){if(typeof o.options.dashArray=="string"){var _=o.options.dashArray.split(/[, ]+/),A=[],B,G;for(G=0;G<_.length;G++){if(B=Number(_[G]),isNaN(B))return;A.push(B)}o.options._dashArray=A}else o.options._dashArray=o.options.dashArray},_requestRedraw:function(o){this._map&&(this._extendRedrawBounds(o),this._redrawRequest=this._redrawRequest||zi(this._redraw,this))},_extendRedrawBounds:function(o){if(o._pxBounds){var _=(o.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Wt,this._redrawBounds.extend(o._pxBounds.min.subtract([_,_])),this._redrawBounds.extend(o._pxBounds.max.add([_,_]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var o=this._redrawBounds;if(o){var _=o.getSize();this._ctx.clearRect(o.min.x,o.min.y,_.x,_.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var o,_=this._redrawBounds;if(this._ctx.save(),_){var A=_.getSize();this._ctx.beginPath(),this._ctx.rect(_.min.x,_.min.y,A.x,A.y),this._ctx.clip()}this._drawing=!0;for(var B=this._drawFirst;B;B=B.next)o=B.layer,(!_||o._pxBounds&&o._pxBounds.intersects(_))&&o._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(o,_){if(this._drawing){var A,B,G,nt,wt=o._parts,Bt=wt.length,qt=this._ctx;if(Bt){for(qt.beginPath(),A=0;A<Bt;A++){for(B=0,G=wt[A].length;B<G;B++)nt=wt[A][B],qt[B?"lineTo":"moveTo"](nt.x,nt.y);_&&qt.closePath()}this._fillStroke(qt,o)}}},_updateCircle:function(o){if(!(!this._drawing||o._empty())){var _=o._point,A=this._ctx,B=Math.max(Math.round(o._radius),1),G=(Math.max(Math.round(o._radiusY),1)||B)/B;G!==1&&(A.save(),A.scale(1,G)),A.beginPath(),A.arc(_.x,_.y/G,B,0,Math.PI*2,!1),G!==1&&A.restore(),this._fillStroke(A,o)}},_fillStroke:function(o,_){var A=_.options;A.fill&&(o.globalAlpha=A.fillOpacity,o.fillStyle=A.fillColor||A.color,o.fill(A.fillRule||"evenodd")),A.stroke&&A.weight!==0&&(o.setLineDash&&o.setLineDash(_.options&&_.options._dashArray||[]),o.globalAlpha=A.opacity,o.lineWidth=A.weight,o.strokeStyle=A.color,o.lineCap=A.lineCap,o.lineJoin=A.lineJoin,o.stroke())},_onClick:function(o){for(var _=this._map.mouseEventToLayerPoint(o),A,B,G=this._drawFirst;G;G=G.next)A=G.layer,A.options.interactive&&A._containsPoint(_)&&(!(o.type==="click"||o.type==="preclick")||!this._map._draggableMoved(A))&&(B=A);this._fireEvent(B?[B]:!1,o)},_onMouseMove:function(o){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var _=this._map.mouseEventToLayerPoint(o);this._handleMouseHover(o,_)}},_handleMouseOut:function(o){var _=this._hoveredLayer;_&&(on(this._container,"leaflet-interactive"),this._fireEvent([_],o,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(o,_){if(!this._mouseHoverThrottled){for(var A,B,G=this._drawFirst;G;G=G.next)A=G.layer,A.options.interactive&&A._containsPoint(_)&&(B=A);B!==this._hoveredLayer&&(this._handleMouseOut(o),B&&(Si(this._container,"leaflet-interactive"),this._fireEvent([B],o,"mouseover"),this._hoveredLayer=B)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,o),this._mouseHoverThrottled=!0,setTimeout(P(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(o,_,A){this._map._fireDOMEvent(_,A||_.type,o)},_bringToFront:function(o){var _=o._order;if(_){var A=_.next,B=_.prev;if(A)A.prev=B;else return;B?B.next=A:A&&(this._drawFirst=A),_.prev=this._drawLast,this._drawLast.next=_,_.next=null,this._drawLast=_,this._requestRedraw(o)}},_bringToBack:function(o){var _=o._order;if(_){var A=_.next,B=_.prev;if(B)B.next=A;else return;A?A.prev=B:B&&(this._drawLast=B),_.prev=null,_.next=this._drawFirst,this._drawFirst.prev=_,this._drawFirst=_,this._requestRedraw(o)}}});function Pl(o){return Ie.canvas?new Oo(o):null}var Hs=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(o){return document.createElement("<lvml:"+o+' class="lvml">')}}catch{}return function(o){return document.createElement("<"+o+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),As={_initContainer:function(){this._container=Oi("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Hr.prototype._update.call(this),this.fire("update"))},_initPath:function(o){var _=o._container=Hs("shape");Si(_,"leaflet-vml-shape "+(this.options.className||"")),_.coordsize="1 1",o._path=Hs("path"),_.appendChild(o._path),this._updateStyle(o),this._layers[H(o)]=o},_addPath:function(o){var _=o._container;this._container.appendChild(_),o.options.interactive&&o.addInteractiveTarget(_)},_removePath:function(o){var _=o._container;mn(_),o.removeInteractiveTarget(_),delete this._layers[H(o)]},_updateStyle:function(o){var _=o._stroke,A=o._fill,B=o.options,G=o._container;G.stroked=!!B.stroke,G.filled=!!B.fill,B.stroke?(_||(_=o._stroke=Hs("stroke")),G.appendChild(_),_.weight=B.weight+"px",_.color=B.color,_.opacity=B.opacity,B.dashArray?_.dashStyle=ne(B.dashArray)?B.dashArray.join(" "):B.dashArray.replace(/( *, *)/g," "):_.dashStyle="",_.endcap=B.lineCap.replace("butt","flat"),_.joinstyle=B.lineJoin):_&&(G.removeChild(_),o._stroke=null),B.fill?(A||(A=o._fill=Hs("fill")),G.appendChild(A),A.color=B.fillColor||B.color,A.opacity=B.fillOpacity):A&&(G.removeChild(A),o._fill=null)},_updateCircle:function(o){var _=o._point.round(),A=Math.round(o._radius),B=Math.round(o._radiusY||A);this._setPath(o,o._empty()?"M0 0":"AL "+_.x+","+_.y+" "+A+","+B+" 0,"+65535*360)},_setPath:function(o,_){o._path.v=_},_bringToFront:function(o){wo(o._container)},_bringToBack:function(o){_l(o._container)}},Al=Ie.vml?Hs:Os,Pa=Hr.extend({_initContainer:function(){this._container=Al("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Al("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){mn(this._container),ti(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Hr.prototype._update.call(this);var o=this._bounds,_=o.getSize(),A=this._container;(!this._svgSize||!this._svgSize.equals(_))&&(this._svgSize=_,A.setAttribute("width",_.x),A.setAttribute("height",_.y)),Zn(A,o.min),A.setAttribute("viewBox",[o.min.x,o.min.y,_.x,_.y].join(" ")),this.fire("update")}},_initPath:function(o){var _=o._path=Al("path");o.options.className&&Si(_,o.options.className),o.options.interactive&&Si(_,"leaflet-interactive"),this._updateStyle(o),this._layers[H(o)]=o},_addPath:function(o){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(o._path),o.addInteractiveTarget(o._path)},_removePath:function(o){mn(o._path),o.removeInteractiveTarget(o._path),delete this._layers[H(o)]},_updatePath:function(o){o._project(),o._update()},_updateStyle:function(o){var _=o._path,A=o.options;_&&(A.stroke?(_.setAttribute("stroke",A.color),_.setAttribute("stroke-opacity",A.opacity),_.setAttribute("stroke-width",A.weight),_.setAttribute("stroke-linecap",A.lineCap),_.setAttribute("stroke-linejoin",A.lineJoin),A.dashArray?_.setAttribute("stroke-dasharray",A.dashArray):_.removeAttribute("stroke-dasharray"),A.dashOffset?_.setAttribute("stroke-dashoffset",A.dashOffset):_.removeAttribute("stroke-dashoffset")):_.setAttribute("stroke","none"),A.fill?(_.setAttribute("fill",A.fillColor||A.color),_.setAttribute("fill-opacity",A.fillOpacity),_.setAttribute("fill-rule",A.fillRule||"evenodd")):_.setAttribute("fill","none"))},_updatePoly:function(o,_){this._setPath(o,Ks(o._parts,_))},_updateCircle:function(o){var _=o._point,A=Math.max(Math.round(o._radius),1),B=Math.max(Math.round(o._radiusY),1)||A,G="a"+A+","+B+" 0 1,0 ",nt=o._empty()?"M0 0":"M"+(_.x-A)+","+_.y+G+A*2+",0 "+G+-A*2+",0 ";this._setPath(o,nt)},_setPath:function(o,_){o._path.setAttribute("d",_)},_bringToFront:function(o){wo(o._path)},_bringToBack:function(o){_l(o._path)}});Ie.vml&&Pa.include(As);function fi(o){return Ie.svg||Ie.vml?new Pa(o):null}Mi.include({getRenderer:function(o){var _=o.options.renderer||this._getPaneRenderer(o.options.pane)||this.options.renderer||this._renderer;return _||(_=this._renderer=this._createRenderer()),this.hasLayer(_)||this.addLayer(_),_},_getPaneRenderer:function(o){if(o==="overlayPane"||o===void 0)return!1;var _=this._paneRenderers[o];return _===void 0&&(_=this._createRenderer({pane:o}),this._paneRenderers[o]=_),_},_createRenderer:function(o){return this.options.preferCanvas&&Pl(o)||fi(o)}});var Cl=Lo.extend({initialize:function(o,_){Lo.prototype.initialize.call(this,this._boundsToLatLngs(o),_)},setBounds:function(o){return this.setLatLngs(this._boundsToLatLngs(o))},_boundsToLatLngs:function(o){return o=ze(o),[o.getSouthWest(),o.getNorthWest(),o.getNorthEast(),o.getSouthEast()]}});function Cs(o,_){return new Cl(o,_)}Pa.create=Al,Pa.pointsToPath=Ks,os.geometryToLayer=Io,os.coordsToLatLng=Li,os.coordsToLatLngs=Ko,os.latLngToCoords=Qo,os.latLngsToCoords=oc,os.getFeature=Ms,os.asFeature=Zs,Mi.mergeOptions({boxZoom:!0});var hc=ra.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane,this._resetStateTimeout=0,o.on("unload",this._destroy,this)},addHooks:function(){Qe(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){ti(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){mn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(o){if(!o.shiftKey||o.which!==1&&o.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ss(),js(),this._startPoint=this._map.mouseEventToContainerPoint(o),Qe(document,{contextmenu:fr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(o){this._moved||(this._moved=!0,this._box=Oi("div","leaflet-zoom-box",this._container),Si(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(o);var _=new Wt(this._point,this._startPoint),A=_.getSize();Zn(this._box,_.min),this._box.style.width=A.x+"px",this._box.style.height=A.y+"px"},_finish:function(){this._moved&&(mn(this._box),on(this._container,"leaflet-crosshair")),Ur(),ea(),ti(document,{contextmenu:fr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(o){if(!(o.which!==1&&o.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(P(this._resetState,this),0);var _=new xe(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(_).fire("boxzoomend",{boxZoomBounds:_})}},_onKeyDown:function(o){o.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Mi.addInitHook("addHandler","boxZoom",hc),Mi.mergeOptions({doubleClickZoom:!0});var Pr=ra.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(o){var _=this._map,A=_.getZoom(),B=_.options.zoomDelta,G=o.originalEvent.shiftKey?A-B:A+B;_.options.doubleClickZoom==="center"?_.setZoom(G):_.setZoomAround(o.containerPoint,G)}});Mi.addInitHook("addHandler","doubleClickZoom",Pr),Mi.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Fc=ra.extend({addHooks:function(){if(!this._draggable){var o=this._map;this._draggable=new Us(o._mapPane,o._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),o.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),o.on("zoomend",this._onZoomEnd,this),o.whenReady(this._onZoomEnd,this))}Si(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){on(this._map._container,"leaflet-grab"),on(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var o=this._map;if(o._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var _=ze(this._map.options.maxBounds);this._offsetLimit=Ce(this._map.latLngToContainerPoint(_.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(_.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;o.fire("movestart").fire("dragstart"),o.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(o){if(this._map.options.inertia){var _=this._lastTime=+new Date,A=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(A),this._times.push(_),this._prunePositions(_)}this._map.fire("move",o).fire("drag",o)},_prunePositions:function(o){for(;this._positions.length>1&&o-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var o=this._map.getSize().divideBy(2),_=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=_.subtract(o).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(o,_){return o-(o-_)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var o=this._draggable._newPos.subtract(this._draggable._startPos),_=this._offsetLimit;o.x<_.min.x&&(o.x=this._viscousLimit(o.x,_.min.x)),o.y<_.min.y&&(o.y=this._viscousLimit(o.y,_.min.y)),o.x>_.max.x&&(o.x=this._viscousLimit(o.x,_.max.x)),o.y>_.max.y&&(o.y=this._viscousLimit(o.y,_.max.y)),this._draggable._newPos=this._draggable._startPos.add(o)}},_onPreDragWrap:function(){var o=this._worldWidth,_=Math.round(o/2),A=this._initialWorldOffset,B=this._draggable._newPos.x,G=(B-_+A)%o+_-A,nt=(B+_+A)%o-_-A,wt=Math.abs(G+A)<Math.abs(nt+A)?G:nt;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=wt},_onDragEnd:function(o){var _=this._map,A=_.options,B=!A.inertia||o.noInertia||this._times.length<2;if(_.fire("dragend",o),B)_.fire("moveend");else{this._prunePositions(+new Date);var G=this._lastPos.subtract(this._positions[0]),nt=(this._lastTime-this._times[0])/1e3,wt=A.easeLinearity,Bt=G.multiplyBy(wt/nt),qt=Bt.distanceTo([0,0]),he=Math.min(A.inertiaMaxSpeed,qt),De=Bt.multiplyBy(he/qt),ke=he/(A.inertiaDeceleration*wt),$e=De.multiplyBy(-ke/2).round();!$e.x&&!$e.y?_.fire("moveend"):($e=_._limitOffset($e,_.options.maxBounds),zi(function(){_.panBy($e,{duration:ke,easeLinearity:wt,noMoveStart:!0,animate:!0})}))}}});Mi.addInitHook("addHandler","dragging",Fc),Mi.mergeOptions({keyboard:!0,keyboardPanDelta:80});var dc=ra.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(o){this._map=o,this._setPanDelta(o.options.keyboardPanDelta),this._setZoomDelta(o.options.zoomDelta)},addHooks:function(){var o=this._map._container;o.tabIndex<=0&&(o.tabIndex="0"),Qe(o,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),ti(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var o=document.body,_=document.documentElement,A=o.scrollTop||_.scrollTop,B=o.scrollLeft||_.scrollLeft;this._map._container.focus(),window.scrollTo(B,A)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(o){var _=this._panKeys={},A=this.keyCodes,B,G;for(B=0,G=A.left.length;B<G;B++)_[A.left[B]]=[-1*o,0];for(B=0,G=A.right.length;B<G;B++)_[A.right[B]]=[o,0];for(B=0,G=A.down.length;B<G;B++)_[A.down[B]]=[0,o];for(B=0,G=A.up.length;B<G;B++)_[A.up[B]]=[0,-1*o]},_setZoomDelta:function(o){var _=this._zoomKeys={},A=this.keyCodes,B,G;for(B=0,G=A.zoomIn.length;B<G;B++)_[A.zoomIn[B]]=o;for(B=0,G=A.zoomOut.length;B<G;B++)_[A.zoomOut[B]]=-o},_addHooks:function(){Qe(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){ti(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(o){if(!(o.altKey||o.ctrlKey||o.metaKey)){var _=o.keyCode,A=this._map,B;if(_ in this._panKeys){if(!A._panAnim||!A._panAnim._inProgress)if(B=this._panKeys[_],o.shiftKey&&(B=yt(B).multiplyBy(3)),A.options.maxBounds&&(B=A._limitOffset(yt(B),A.options.maxBounds)),A.options.worldCopyJump){var G=A.wrapLatLng(A.unproject(A.project(A.getCenter()).add(B)));A.panTo(G)}else A.panBy(B)}else if(_ in this._zoomKeys)A.setZoom(A.getZoom()+(o.shiftKey?3:1)*this._zoomKeys[_]);else if(_===27&&A._popup&&A._popup.options.closeOnEscapeKey)A.closePopup();else return;fr(o)}}});Mi.addInitHook("addHandler","keyboard",dc),Mi.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var no=ra.extend({addHooks:function(){Qe(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){ti(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(o){var _=as(o),A=this._map.options.wheelDebounceTime;this._delta+=_,this._lastMousePos=this._map.mouseEventToContainerPoint(o),this._startTime||(this._startTime=+new Date);var B=Math.max(A-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(P(this._performZoom,this),B),fr(o)},_performZoom:function(){var o=this._map,_=o.getZoom(),A=this._map.options.zoomSnap||0;o._stop();var B=this._delta/(this._map.options.wheelPxPerZoomLevel*4),G=4*Math.log(2/(1+Math.exp(-Math.abs(B))))/Math.LN2,nt=A?Math.ceil(G/A)*A:G,wt=o._limitZoom(_+(this._delta>0?nt:-nt))-_;this._delta=0,this._startTime=null,wt&&(o.options.scrollWheelZoom==="center"?o.setZoom(_+wt):o.setZoomAround(this._lastMousePos,_+wt))}});Mi.addInitHook("addHandler","scrollWheelZoom",no);var vu=600;Mi.mergeOptions({tapHold:Ie.touchNative&&Ie.safari&&Ie.mobile,tapTolerance:15});var El=ra.extend({addHooks:function(){Qe(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){ti(this._map._container,"touchstart",this._onDown,this)},_onDown:function(o){if(clearTimeout(this._holdTimeout),o.touches.length===1){var _=o.touches[0];this._startPos=this._newPos=new fe(_.clientX,_.clientY),this._holdTimeout=setTimeout(P(function(){this._cancel(),this._isTapValid()&&(Qe(document,"touchend",je),Qe(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",_))},this),vu),Qe(document,"touchend touchcancel contextmenu",this._cancel,this),Qe(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function o(){ti(document,"touchend",je),ti(document,"touchend touchcancel",o)},_cancel:function(){clearTimeout(this._holdTimeout),ti(document,"touchend touchcancel contextmenu",this._cancel,this),ti(document,"touchmove",this._onMove,this)},_onMove:function(o){var _=o.touches[0];this._newPos=new fe(_.clientX,_.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(o,_){var A=new MouseEvent(o,{bubbles:!0,cancelable:!0,view:window,screenX:_.screenX,screenY:_.screenY,clientX:_.clientX,clientY:_.clientY});A._simulated=!0,_.target.dispatchEvent(A)}});Mi.addInitHook("addHandler","tapHold",El),Mi.mergeOptions({touchZoom:Ie.touch,bounceAtZoomLimits:!0});var Aa=ra.extend({addHooks:function(){Si(this._map._container,"leaflet-touch-zoom"),Qe(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){on(this._map._container,"leaflet-touch-zoom"),ti(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(o){var _=this._map;if(!(!o.touches||o.touches.length!==2||_._animatingZoom||this._zooming)){var A=_.mouseEventToContainerPoint(o.touches[0]),B=_.mouseEventToContainerPoint(o.touches[1]);this._centerPoint=_.getSize()._divideBy(2),this._startLatLng=_.containerPointToLatLng(this._centerPoint),_.options.touchZoom!=="center"&&(this._pinchStartLatLng=_.containerPointToLatLng(A.add(B)._divideBy(2))),this._startDist=A.distanceTo(B),this._startZoom=_.getZoom(),this._moved=!1,this._zooming=!0,_._stop(),Qe(document,"touchmove",this._onTouchMove,this),Qe(document,"touchend touchcancel",this._onTouchEnd,this),je(o)}},_onTouchMove:function(o){if(!(!o.touches||o.touches.length!==2||!this._zooming)){var _=this._map,A=_.mouseEventToContainerPoint(o.touches[0]),B=_.mouseEventToContainerPoint(o.touches[1]),G=A.distanceTo(B)/this._startDist;if(this._zoom=_.getScaleZoom(G,this._startZoom),!_.options.bounceAtZoomLimits&&(this._zoom<_.getMinZoom()&&G<1||this._zoom>_.getMaxZoom()&&G>1)&&(this._zoom=_._limitZoom(this._zoom)),_.options.touchZoom==="center"){if(this._center=this._startLatLng,G===1)return}else{var nt=A._add(B)._divideBy(2)._subtract(this._centerPoint);if(G===1&&nt.x===0&&nt.y===0)return;this._center=_.unproject(_.project(this._pinchStartLatLng,this._zoom).subtract(nt),this._zoom)}this._moved||(_._moveStart(!0,!1),this._moved=!0),Pi(this._animRequest);var wt=P(_._move,_,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=zi(wt,this,!0),je(o)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Pi(this._animRequest),ti(document,"touchmove",this._onTouchMove,this),ti(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Mi.addInitHook("addHandler","touchZoom",Aa),Mi.BoxZoom=hc,Mi.DoubleClickZoom=Pr,Mi.Drag=Fc,Mi.Keyboard=dc,Mi.ScrollWheelZoom=no,Mi.TapHold=El,Mi.TouchZoom=Aa,w.Bounds=Wt,w.Browser=Ie,w.CRS=rn,w.Canvas=Oo,w.Circle=Nc,w.CircleMarker=ac,w.Class=Rn,w.Control=Sr,w.DivIcon=ko,w.DivOverlay=ls,w.DomEvent=pu,w.DomUtil=ar,w.Draggable=Us,w.Evented=me,w.FeatureGroup=Zr,w.GeoJSON=os,w.GridLayer=Bo,w.Handler=ra,w.Icon=Ka,w.ImageOverlay=Sa,w.LatLng=Fe,w.LatLngBounds=xe,w.Layer=Ts,w.LayerGroup=Yo,w.LineUtil=bl,w.Map=Mi,w.Marker=Do,w.Mixin=yl,w.Path=Ss,w.Point=fe,w.PolyUtil=tc,w.Polygon=Lo,w.Polyline=Ta,w.Popup=Ro,w.PosAnimation=Ya,w.Projection=nc,w.Rectangle=Cl,w.Renderer=Hr,w.SVG=Pa,w.SVGOverlay=to,w.TileLayer=eo,w.Tooltip=Ma,w.Transformation=Ws,w.Util=Ir,w.VideoOverlay=lc,w.bind=P,w.bounds=Ce,w.canvas=Pl,w.circle=kh,w.circleMarker=Sl,w.control=Wa,w.divIcon=Ps,w.extend=I,w.featureGroup=Tl,w.geoJSON=jc,w.geoJson=Ju,w.gridLayer=Gs,w.icon=rc,w.imageOverlay=Ml,w.latLng=Se,w.latLngBounds=ze,w.layerGroup=gu,w.map=Mo,w.marker=sc,w.point=yt,w.polygon=Gr,w.polyline=Qu,w.popup=yu,w.rectangle=Cs,w.setOptions=Jt,w.stamp=H,w.svg=fi,w.svgOverlay=cc,w.tileLayer=cr,w.tooltip=uc,w.transformation=sr,w.version=M,w.videoOverlay=th;var Ca=window.L;w.noConflict=function(){return window.L=Ca,this},window.L=w})}(gp,gp.exports)),gp.exports}var qi=rg();const go=ig(qi);var ce=ng();const E_=ig(ce);function M0(p,m){const w=ce.useRef(m);ce.useEffect(function(){m!==w.current&&p.attributionControl!=null&&(w.current!=null&&p.attributionControl.removeAttribution(w.current),m!=null&&p.attributionControl.addAttribution(m)),w.current=m},[p,m])}var P3=S0();const A3=1;function C3(p){return Object.freeze({__version:A3,map:p})}function E3(p,m){return Object.freeze({...p,...m})}const sg=ce.createContext(null);function Zm(){const p=ce.use(sg);if(p==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return p}function z3(p){function m(w,M){const{instance:I,context:F}=p(w).current;ce.useImperativeHandle(M,()=>I);const{children:P}=w;return P==null?null:E_.createElement(sg,{value:F},P)}return ce.forwardRef(m)}function D3(p){function m(w,M){const[I,F]=ce.useState(!1),{instance:P}=p(w,F).current;ce.useImperativeHandle(M,()=>P),ce.useEffect(function(){I&&P.update()},[P,I,w.children]);const u=P._contentNode;return u?P3.createPortal(w.children,u):null}return ce.forwardRef(m)}function L3(p){function m(w,M){const{instance:I}=p(w).current;return ce.useImperativeHandle(M,()=>I),null}return ce.forwardRef(m)}function I3(p){return function(w){const M=Zm(),I=p(w,M),{instance:F}=I.current,P=ce.useRef(w.position),{position:u}=w;return ce.useEffect(function(){return F.addTo(M.map),function(){F.remove()}},[M.map,F]),ce.useEffect(function(){u!=null&&u!==P.current&&(F.setPosition(u),P.current=u)},[F,u]),I}}function P0(p,m){const w=ce.useRef(void 0);ce.useEffect(function(){return m!=null&&p.instance.on(m),w.current=m,function(){w.current!=null&&p.instance.off(w.current),w.current=null}},[p,m])}function A0(p,m){const w=p.pane??m.pane;return w?{...p,pane:w}:p}function R3(p,m){return function(M,I){const F=Zm(),P=p(A0(M,F),F);return M0(F.map,M.attribution),P0(P.current,M.eventHandlers),m(P.current,F,M,I),P}}function ag(p,m,w){return Object.freeze({instance:p,context:m,container:w})}function og(p,m){return m==null?function(M,I){const F=ce.useRef(void 0);return F.current||(F.current=p(M,I)),F}:function(M,I){const F=ce.useRef(void 0);F.current||(F.current=p(M,I));const P=ce.useRef(M),{instance:u}=F.current;return ce.useEffect(function(){P.current!==M&&(m(u,M,P.current),P.current=M)},[u,M,m]),F}}function k3(p,m){ce.useEffect(function(){return(m.layerContainer??m.map).addLayer(p.instance),function(){m.layerContainer?.removeLayer(p.instance),m.map.removeLayer(p.instance)}},[m,p])}function B3(p){return function(w){const M=Zm(),I=p(A0(w,M),M);return M0(M.map,w.attribution),P0(I.current,w.eventHandlers),k3(I.current,M),I}}function O3(p){function m(I,F){return ag(p(I),F)}const w=og(m),M=I3(w);return L3(M)}function N3(p,m){const w=og(p,m),M=B3(w);return z3(M)}function j3(p,m){const w=og(p),M=R3(w,m);return D3(M)}function bf(){return Zm().map}const F3=O3(function(m){return new qi.Control.Attribution(m)});function V3({bounds:p,boundsOptions:m,center:w,children:M,className:I,id:F,placeholder:P,style:u,whenReady:H,zoom:X,...Q},dt){const[ht]=ce.useState({className:I,id:F,style:u}),[lt,Yt]=ce.useState(null),Jt=ce.useRef(void 0);ce.useImperativeHandle(dt,()=>lt?.map??null,[lt]);const pe=ce.useCallback(de=>{if(de!==null&&!Jt.current){const ne=new qi.Map(de,Q);Jt.current=ne,w!=null&&X!=null?ne.setView(w,X):p!=null&&ne.fitBounds(p,m),H!=null&&ne.whenReady(H),Yt(C3(ne))}},[]);ce.useEffect(()=>()=>{lt?.map.remove()},[lt]);const ge=lt?E_.createElement(sg,{value:lt},M):P??null;return E_.createElement("div",{...ht,ref:pe},ge)}const U3=ce.forwardRef(V3),Z3=N3(function({position:m,...w},M){const I=new qi.Marker(m,w);return ag(I,E3(M,{overlayContainer:I}))},function(m,w,M){w.position!==M.position&&m.setLatLng(w.position),w.icon!=null&&w.icon!==M.icon&&m.setIcon(w.icon),w.zIndexOffset!=null&&w.zIndexOffset!==M.zIndexOffset&&m.setZIndexOffset(w.zIndexOffset),w.opacity!=null&&w.opacity!==M.opacity&&m.setOpacity(w.opacity),m.dragging!=null&&w.draggable!==M.draggable&&(w.draggable===!0?m.dragging.enable():m.dragging.disable())}),G3=j3(function(m,w){const M=new qi.Popup(m,w.overlayContainer);return ag(M,w)},function(m,w,{position:M},I){ce.useEffect(function(){const{instance:P}=m;function u(X){X.popup===P&&(P.update(),I(!0))}function H(X){X.popup===P&&I(!1)}return w.map.on({popupopen:u,popupclose:H}),w.overlayContainer==null?(M!=null&&P.setLatLng(M),P.openOn(w.map)):w.overlayContainer.bindPopup(P),function(){w.map.off({popupopen:u,popupclose:H}),w.overlayContainer?.unbindPopup(),w.map.removeLayer(P)}},[m,w,I,M])});var h_,t1;function H3(){if(t1)return h_;t1=1;var p=typeof Element<"u",m=typeof Map=="function",w=typeof Set=="function",M=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function I(F,P){if(F===P)return!0;if(F&&P&&typeof F=="object"&&typeof P=="object"){if(F.constructor!==P.constructor)return!1;var u,H,X;if(Array.isArray(F)){if(u=F.length,u!=P.length)return!1;for(H=u;H--!==0;)if(!I(F[H],P[H]))return!1;return!0}var Q;if(m&&F instanceof Map&&P instanceof Map){if(F.size!==P.size)return!1;for(Q=F.entries();!(H=Q.next()).done;)if(!P.has(H.value[0]))return!1;for(Q=F.entries();!(H=Q.next()).done;)if(!I(H.value[1],P.get(H.value[0])))return!1;return!0}if(w&&F instanceof Set&&P instanceof Set){if(F.size!==P.size)return!1;for(Q=F.entries();!(H=Q.next()).done;)if(!P.has(H.value[0]))return!1;return!0}if(M&&ArrayBuffer.isView(F)&&ArrayBuffer.isView(P)){if(u=F.length,u!=P.length)return!1;for(H=u;H--!==0;)if(F[H]!==P[H])return!1;return!0}if(F.constructor===RegExp)return F.source===P.source&&F.flags===P.flags;if(F.valueOf!==Object.prototype.valueOf&&typeof F.valueOf=="function"&&typeof P.valueOf=="function")return F.valueOf()===P.valueOf();if(F.toString!==Object.prototype.toString&&typeof F.toString=="function"&&typeof P.toString=="function")return F.toString()===P.toString();if(X=Object.keys(F),u=X.length,u!==Object.keys(P).length)return!1;for(H=u;H--!==0;)if(!Object.prototype.hasOwnProperty.call(P,X[H]))return!1;if(p&&F instanceof Element)return!1;for(H=u;H--!==0;)if(!((X[H]==="_owner"||X[H]==="__v"||X[H]==="__o")&&F.$$typeof)&&!I(F[X[H]],P[X[H]]))return!1;return!0}return F!==F&&P!==P}return h_=function(P,u){try{return I(P,u)}catch(H){if((H.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw H}},h_}var q3=H3();const lg=ig(q3),ml="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAOOklEQVR4nO3df4wcZ33H8XdWp+vpuF4t1zVW6lqWa7WRFbmhuJHrhmKsKEqDAiiKIpQ/EKUVCJEWqUKgBto/ipCbpqhVpfwRVQihtEoRSds0smgIVqAN+WncCKshIQ4xhrrJxZhgX83FOJf+8ezB+Tjf7e7NPM/MfN8v6atz7Ms+39mZ+ezO7swzIEmS4rmkdAPKrreoxvp/dx6YX1QKwgBorilgI7Ae2NCv9cA08HP9n+v6vzcFTPR/TvZrgrSDjy/68zDOA3PAuUV/Ptuv2f5/z/brFeA08Gr/z68AJ5fU7JDjKwMDIL8NwBZgM7AVeCOwCbiUtMMv/OwV6q8u50lBcAKY6f88AbwMHAO+Bxzv/44yMQCqNwn8GrCDtIP/CrAN2E7a8Yd9JY7mPCkIjgLfBr5LCoingWdI7zxUEQNgdNPAFf36ddIOv4P06q36zJDC4GngWeCpfp0u2VRbGQCD2QpcCfwG8Jv9ckdvlhngMHAIOAI8QXrnoBUYAD9rEtgD7AZ+G7iK9Gqv9jkN/AfwOPAY8AjpQ0z1GQDpk/OrgbcA+4CddO8DOP3UYeArwH8CXyb4txNRA2AXcC3wdtIrveJ6DDgA/Dvp8CGUKAEwRtrhrwduJH2fLi11CrgHuJ8UCOfLtqO16AHXAZ8DzgCvW9YQdYa07VyLh4StchnwadIJJqU3Iqsb9TJwO+n8DjXQGHAz6YOd0huL1e36KvBuPKGrEaaAjwIvUX7DsGLV/wIfIW2DymwK+HPgh5TfEKzY9QPgVtL5I6rZGPDHwPcpv+Ita3G9DNyChwa1uRp4jvIr2rJWqmdJJ5SpIuuBuym/Yi1rmLqLNF9DozX9RKDrgM+QrpfvonOkS1zPlW6kkHHS17bjpRupyQng94EvlW6kbXrAbZRP8TrrH/GMREjPwecpvz7qrE/iyUQDWwc8RPmVVmcdobuveqOYAL5J+fVSZz2EV5WuajPw35RfWXXXR6t6wjrkE5RfL3XXEdKUb43RpLclW0ln8u0o3EcOp0o30EAR5gK8nLSNby3cx080JQA2k06x3Fq4D5XTlG2xbtuAg6RtvrgmPOnrgQdJE2ZKEWwDHqABXxOWDoAx0rXXlxXuQ8ptB2nbL7oPlg6A/aT596SIriJ9RVhMyQDYR7qaSorsVmBvqcFLBcAk6Qw/SWlfKHI1YakA+Dh+4i8t2Ab8aYmBSwTApfjWX1rqIxS45qVEAPwZngYrLTVBemecVe4AWA+8L/OYaof50g00wPvIfG5A7gD4Q3z1h+5e3rwWv1y6gQaYBN5buok6df2Kr0HrOZxMcrFp4AXKr5cm1JE1PpeNtYPyT26T6iDp9Ocx0juxiDXWfw4easD6aFJlu/9AzgkM35VxrDbYB3wHOE7cW1AtBIAudAPwlzkGyhkAb8s4Vpu4A2ipt5IpAHLNCdgjzeHvca+0ulngF8jwzUiubwG2484vDWqKTGfK5gqAyzONI3XFzhyD5AoA76oqDWd7jkFyBcAvZhpH6opfyjFIrgDYmGkcqSs25BgkVwD4AaA0nCz3EMgVABOZxpG6Iss1M6XnBJRUkAEgBZbzVOA6eA25Smv1i2hbA2AGuB04BMwV7kVx9UjnuHwYuKJwL412gOoulXyehtxWSeobA+6l2kuC78vReNvevswDHwS+V7oRaZHzwAdIF/G0StsCYBb4cukmpGWcBB4u3cSw2hYAc/jBn5qrdbc4b1sASKqQASAFZgBIgRkAUmAGgBSYASAFZgBIgRkAUmAGgBSYASAFZgBIgRkAUmAGgBSYASAFZgBIgRkAUmAGgBSYASAFZgBIgRkAUmAGgBSYASAFZgBIgRkAUmAGgBSYASAFZgBIgRkAUmAGgBSYASAFNrbKv08AU6weFDPVtCNpCBtX+fd5YBaYu9gvLBcAPWA38AfALmAzML7CID3g5/uDScpjDHiBlfe7c8Bx4DBwJ3Bold9nI3Af8PoQ9Rqrv0M4MORjXqxeWmUcqaS7qGY7f520H65kjLTvDfOY97LkXcPiHXcb8CjwjiEXWlI73EDax7cu/MVCAEwDD5BCQFJ3bQMeJH2295MA2A9sL9WRpKy2k/Z5eqRjgvcXbUdSbu8H1veAm1j960BJ3TIO3NQD3ly6E0lF/FaP9D2/pHg29/DtvxRVz2sBpMAMACkwA0AKzACQAjMApMAMACkwA0AKzACQAjMApMAMACkwA0AKzACQAjMApMAMACkwA0AKzACQAjMApMAMACkwA0AKzACQAjMApMAMACkwA0AKzACQAjMApMAMACmuXg84V7oLSUXM9YBjpbuQVMTxHvB46S4kFfF4D7gHmCvdiaSszgL39IDTwF8XbkZSXrcBswvfAnwKOFywGUn5HAb+Cn76NeAc8HbgG6U6kpTFU8Dv0T/sX3wewIvAW4G/A2bz9yWpRrPA3wJvA2YW/nJsyS+9AnwYuBO4sf/LG4DxPD1KGsLRVf79HGlnPwj8M/DM0l9YGgALngb+ol/jK/zegvlV/l1Stc4Dbxrgd1Y80W+1HZv+A3i2oNQ8Z9f6AF4LIAVmAEiBGQBSYAaAFJgBIAVmAEiBGQBSYAaAFJgBIAVmAEiBtS0ABjl1WSqldRfNtS0ApoHtpZuQltEDdpduYlhtC4Ax4JOlm5CWcQuwpXQTTXUAeL3C+ixwWdYlkJa3EbgVeJVqt/H7cjTf1mPq95ImLDmOcxGorA3AptJNjKqtAQAwBewo3YTUZm37DEBShQwAKTADQArMAJACMwCkwAwAKTADQArMAJACMwCkwAwAKTADQArMAJACMwCkwAwAKTADQAqszfMBjOoQ8AjwNeAoMEuaVGQS2Ay8BdgF/C4tnORRy5oHHgaeAL5KmkjmLOkFcIo0z+TvAHtI614Vq3pKsFHqXtLKHWSn7gHbgE8DP2xA79Zo9Srw96SJYwZ5sRsnbSNfaEDvWaYEy6VkADwH7FtD79uBgwX7t0arrwNXLLM+B7WXtO2U6t8AqKAeJE0lvlbjwP5Cy2ANX3eSDunWah3lwt8AWGPdB0xUvBy3FlgOa7i6jWo/3J6g3PbbGbmfwCep5hVgOXdkXhZr8Pos9XyzNUk6pMi5LAbAiHWGeu8eNAkcybg81mD1Tao53LuY7aRtK9fyZAmALp4HcDvp6726nAU+VOPjazQfBE7X+PhHSYcXGkGudwDfJ32vm8MXMy2TtXo9sMq6qsokaRvLsUy+AxjBP5FO7MnhzkzjaHV3ZBrnLPAPmcbKoksBME96Vc7lYfKFjS7uNGld5HI/HbodXZcCYI68G8Ip0qmlKusJ4JWM4z1C2tY6oUsBcJq8G8I8cCzjeFreMfK+Ip8FXsw4Xq26FAAzBcY8VWBMXehkgTENgAYq8bbsbIExdaEzBcb0EKCBqj7tt6lj6kJvKDBmZ9Z7lwJgY4ExNxQYUxcqsd43FRizFl0KgGlgfcbxesCWjONpeVvIux1PUCZ0atGlAJggzeiSy3rgyozjaXm7SZft5nIV9V1oll2XAqAHXJ9xvL3Ue/GJBjNNWhe5XE+H9pvOLEjfu8lzGDBGuvhEzfBH5Jnfch3wngzjZNO1AJgGPpZhnH2sbZoxVWsvcE2GcT5G3sONzsg5H8CPgJ01Lss08HzG5bEGqxeod+fcSdq2ci2PVwOOaII0A3Adn9T2SLPObKvhsbU2W4HPU8+hwEbSNtWZ7/8XdDEAIM3e8i9U/4pwB3BDxY+p6lwD3EW1IbCBdAVgnbNMdV6pWYH/i/TKsFaTwN2FlsEavr5INR8GbyVtQyWWwTkBK6qXgZvX0Pse0nxzpTdqa7j6LnDtMutzUDeTtp1S/RsAFdejwI0Mfhy3j3Tc9+MG9G6NVq+R7g1xHYMd7k4ANwGPN6D3LAEQ6d6Au0m3fDpJmjjka6TLOk+RriefJn3Y82bSzn8psZ6fLuoBV5PW54vAV0g794uk+SN6pEOFTaR7Qu4h2PUdl2Qa5wAphSUN5t+Ad9Y9SFe/BZA0AANACswAkAIzAKTADAApMANACswAkAIzAKTADAApMANACswAkAIzAKTADAApMANACswAkAIzAKTADAApMANACswAkAIzAKTADAApMANACixXABg00nCy7DO5bnzxGeCBEf/fXwVuqbCXXA6RblRp+K3NBPBxYKp0I0M6Cewn3XRmFMcr7KXV9lD+Nk2j1OfqeDICmgZeovz6HLaepQXh3/gGFV6bt9HG9974BiXVxwCQAjMApMAMACkwA0AKzACQAjMApMAMACkwA0AKzACQAjMApMAMACkwA0AKzACQAjMApMAMACkwA0AKzACQAmtDALShR6mV2rBznSvdwIja2nfTnC/dwIhGnQ04qzYEwMnSDYxopnQDHTELzJVuYgQztCC82hAAJ2jnq+mzpRvokBOlGxjBM6UbGEQbAmAOeKR0E0OaA54q3USHfKl0AyN4snQDg2hDAADcX7qBIX0b+EbpJjrkIC14O73IPPCvpZvokvXA/1H+bi+DVhtvZdZ0T1J+vQ5ad9f0HIS2n/IrdpB6gfbdx64NrgNeo/z6HaQur+k5CG0KeJ7yK3eleg14R11PgPgC5dfxanVbbUsvdgGvUn4lX6z+pr5FF7CR9A6r9Hq+WH0dGK9t6QXAu4AfU35lLy3vBpzHduB/KL++l9YR0mdVymAvzbpl9O21Lq2W2kp6tS293hfqIWBdnQusn7UJuJeyK/554Jq6F1TLGgc+RdlDwjPAn9S9oFrZLuAu4EfkW/GPAu8BxjIsn1a2ifQOLOc7wu8An6ADb/kvKd1AhcaAPcBO4I3ABNVdkDEP/AD4FvAw7b0+oet2AFcCW4A3VPzYZ4BjwGPA0YofW5IkKaP/B72QCHEdYf2iAAAAAElFTkSuQmCC",uf={"hct blue2":"hsl(200, 100%, 50%)","hct blue1":"hsl(200, 100%, 50%)","hct gold2":"hsl(44, 96%, 59%)","hct Gold1":"hsl(44, 96%, 59%)","hct green":"hsl(112, 63%, 52%)","hct brown":"hsl(17, 74%, 37%)","hct purple":"hsl(250, 100%, 77%)","hct red":"hsl(12, 82%, 50%)","hct orange":"hsl(27, 100%, 50%)"},$3=(p,m)=>{const M=`
        <div style="
            background-color: ${uf[p]};
            border-radius: 0 50% 50%;
            height: 25px;
            width: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid white;
            box-shadow: 3px -3px 3px #00000045;
            transform: rotate(45deg) rotate(${m}deg);
        ">
            <img src="${ml}" style="
                width: 70%;
                height: 70%;
                object-fit: contain;
                position: absolute;
                transform: rotate(-45deg) rotate(${-m}deg);
            "/>
        </div>
    `;return go.divIcon({html:M,className:"custom-bus-icon",iconSize:[24,24],iconAnchor:[12,12],popupAnchor:[0,-12]})};function e1(p){return p?p.split(" ").map(m=>m.length===0?"":m.charAt(0).toUpperCase()+m.slice(1).toLowerCase()).join(" "):""}var pl=63710088e-1,X3={centimeters:pl*100,centimetres:pl*100,degrees:360/(2*Math.PI),feet:pl*3.28084,inches:pl*39.37,kilometers:pl/1e3,kilometres:pl/1e3,meters:pl,metres:pl,miles:pl/1609.344,millimeters:pl*1e3,millimetres:pl*1e3,nauticalmiles:pl/1852,radians:1,yards:pl*1.0936};function z_(p,m,w={}){const M={type:"Feature"};return(w.id===0||w.id)&&(M.id=w.id),w.bbox&&(M.bbox=w.bbox),M.properties=m||{},M.geometry=p,M}function Pm(p,m,w={}){if(!p)throw new Error("coordinates is required");if(!Array.isArray(p))throw new Error("coordinates must be an Array");if(p.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!n1(p[0])||!n1(p[1]))throw new Error("coordinates must contain numbers");return z_({type:"Point",coordinates:p},m,w)}function Y3(p,m="kilometers"){const w=X3[m];if(!w)throw new Error(m+" units is invalid");return p*w}function i1(p){return p%(2*Math.PI)*180/Math.PI}function hf(p){return p%360*Math.PI/180}function n1(p){return!isNaN(p)&&p!==null&&!Array.isArray(p)}function df(p){if(!p)throw new Error("coord is required");if(!Array.isArray(p)){if(p.type==="Feature"&&p.geometry!==null&&p.geometry.type==="Point")return[...p.geometry.coordinates];if(p.type==="Point")return[...p.coordinates]}if(Array.isArray(p)&&p.length>=2&&!Array.isArray(p[0])&&!Array.isArray(p[1]))return[...p];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function W3(p){if(Array.isArray(p))return p;if(p.type==="Feature"){if(p.geometry!==null)return p.geometry.coordinates}else if(p.coordinates)return p.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Td(p,m,w={}){var M=df(p),I=df(m),F=hf(I[1]-M[1]),P=hf(I[0]-M[0]),u=hf(M[1]),H=hf(I[1]),X=Math.pow(Math.sin(F/2),2)+Math.pow(Math.sin(P/2),2)*Math.cos(u)*Math.cos(H);return Y3(2*Math.atan2(Math.sqrt(X),Math.sqrt(1-X)),w.units)}function K3(p,m){var w,M,I,F,P,u,H,X,Q,dt,ht=0,lt=p.type==="FeatureCollection",Yt=p.type==="Feature",Jt=lt?p.features.length:1;for(w=0;w<Jt;w++){for(u=lt?p.features[w].geometry:Yt?p.geometry:p,X=lt?p.features[w].properties:Yt?p.properties:{},Q=lt?p.features[w].bbox:Yt?p.bbox:void 0,dt=lt?p.features[w].id:Yt?p.id:void 0,H=u?u.type==="GeometryCollection":!1,P=H?u.geometries.length:1,I=0;I<P;I++){if(F=H?u.geometries[I]:u,F===null){if(m(null,ht,X,Q,dt)===!1)return!1;continue}switch(F.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(m(F,ht,X,Q,dt)===!1)return!1;break}case"GeometryCollection":{for(M=0;M<F.geometries.length;M++)if(m(F.geometries[M],ht,X,Q,dt)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}ht++}}function Q3(p,m){K3(p,function(w,M,I,F,P){var u=w===null?null:w.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return m(z_(w,I,{bbox:F,id:P}),M,0)===!1?!1:void 0}var H;switch(u){case"MultiPoint":H="Point";break;case"MultiLineString":H="LineString";break;case"MultiPolygon":H="Polygon";break}for(var X=0;X<w.coordinates.length;X++){var Q=w.coordinates[X],dt={type:H,coordinates:Q};if(m(z_(dt,I),M,X)===!1)return!1}})}var J3=Object.defineProperty,tv=Object.defineProperties,ev=Object.getOwnPropertyDescriptors,r1=Object.getOwnPropertySymbols,iv=Object.prototype.hasOwnProperty,nv=Object.prototype.propertyIsEnumerable,s1=(p,m,w)=>m in p?J3(p,m,{enumerable:!0,configurable:!0,writable:!0,value:w}):p[m]=w,a1=(p,m)=>{for(var w in m||(m={}))iv.call(m,w)&&s1(p,w,m[w]);if(r1)for(var w of r1(m))nv.call(m,w)&&s1(p,w,m[w]);return p},o1=(p,m)=>tv(p,ev(m));function C0(p,m,w={}){if(!p||!m)throw new Error("lines and pt are required arguments");const M=df(m);let I=Pm([1/0,1/0],{dist:1/0,index:-1,multiFeatureIndex:-1,location:-1}),F=0;return Q3(p,function(P,u,H){const X=W3(P);for(let Q=0;Q<X.length-1;Q++){const dt=Pm(X[Q]);dt.properties.dist=Td(m,dt,w);const ht=df(dt),lt=Pm(X[Q+1]);lt.properties.dist=Td(m,lt,w);const Yt=df(lt),Jt=Td(dt,lt,w);let pe,ge;ht[0]===M[0]&&ht[1]===M[1]?[pe,,ge]=[ht,void 0,!1]:Yt[0]===M[0]&&Yt[1]===M[1]?[pe,,ge]=[Yt,void 0,!0]:[pe,,ge]=av(dt.geometry.coordinates,lt.geometry.coordinates,df(m));let de;pe&&(de=Pm(pe,{dist:Td(m,pe,w),multiFeatureIndex:H,location:F+Td(dt,pe,w)})),de&&de.properties.dist<I.properties.dist&&(I=o1(a1({},de),{properties:o1(a1({},de.properties),{index:ge?Q+1:Q})})),F+=Jt}}),I}function rv(p,m){const[w,M,I]=p,[F,P,u]=m;return w*F+M*P+I*u}function sv(p,m){const[w,M,I]=p,[F,P,u]=m;return[M*u-I*P,I*F-w*u,w*P-M*F]}function l1(p){return Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2)+Math.pow(p[2],2))}function _d(p,m){const w=rv(p,m)/(l1(p)*l1(m));return Math.acos(Math.min(Math.max(w,-1),1))}function d_(p){const m=hf(p[1]),w=hf(p[0]);return[Math.cos(m)*Math.cos(w),Math.cos(m)*Math.sin(w),Math.sin(m)]}function gd(p){const[m,w,M]=p,I=i1(Math.asin(M));return[i1(Math.atan2(w,m)),I]}function av(p,m,w){const M=d_(p),I=d_(m),F=d_(w),[P,u,H]=F,[X,Q,dt]=sv(M,I),ht=Q*H-dt*u,lt=dt*P-X*H,Yt=X*u-Q*P,Jt=Yt*Q-lt*dt,pe=ht*dt-Yt*X,ge=lt*X-ht*Q,de=1/Math.sqrt(Math.pow(Jt,2)+Math.pow(pe,2)+Math.pow(ge,2)),ne=[Jt*de,pe*de,ge*de],Ne=[-1*Jt*de,-1*pe*de,-1*ge*de],we=_d(M,I),Ve=_d(M,ne),Je=_d(I,ne),Ue=_d(M,Ne),Ei=_d(I,Ne);let Ti;return Ve<Ue&&Ve<Ei||Je<Ue&&Je<Ei?Ti=ne:Ti=Ne,_d(M,Ti)>we||_d(I,Ti)>we?Td(gd(Ti),gd(M))<=Td(gd(Ti),gd(I))?[gd(M),!0,!1]:[gd(I),!1,!0]:[gd(Ti),!1,!1]}const ov="FeatureCollection",lv=JSON.parse(`[{"type":"Feature","properties":{"agency":{"agency_id":null,"agency_name":"Hub City Transit","id":1890805,"onestop_id":""},"continuous_drop_off":null,"continuous_pickup":null,"feed_version":{"feed":{"id":8455,"onestop_id":"f-hattiesburg~mi~us"},"fetched_at":"2025-05-05T23:01:08.61939Z","id":519462,"sha1":"90988e5e23049b2c4856de4c2ea055d91a8e2e80"},"id":75585139,"onestop_id":"r-dj86p-blueline","route_color":"0080ff","route_desc":"Serves Hardy Street starting at the Train Depot 6:00 AM - 6:00 PM M-F","route_id":"35780","route_long_name":"Hardy Street","route_short_name":"Blue Line","route_sort_order":null,"route_stops":[{"stop":{"geometry":{"coordinates":[-89.2917251586914,31.3279244999389],"type":"Point"},"id":1356560848,"stop_id":"1366015","stop_name":"Main St and New Orleans St"}},{"stop":{"geometry":{"coordinates":[-89.293624162674,31.3280894631537],"type":"Point"},"id":1356560849,"stop_id":"1366016","stop_name":"On McLeod St  By Fire Station No.1"}},{"stop":{"geometry":{"coordinates":[-89.2969485848976,31.3248792283969],"type":"Point"},"id":1356560850,"stop_id":"1366021","stop_name":"On Hardy St @ Main Library"}},{"stop":{"geometry":{"coordinates":[-89.3099194469252,31.3248300709717],"type":"Point"},"id":1356560851,"stop_id":"1366023","stop_name":"Hardy St and Hutchinson Ave."}},{"stop":{"geometry":{"coordinates":[-89.3143514597885,31.3247706530846],"type":"Point"},"id":1356560852,"stop_id":"1366024","stop_name":"Hardy and 17th St. (Across Zoo)"}},{"stop":{"geometry":{"coordinates":[-89.3177549149992,31.3248168980694],"type":"Point"},"id":1356560853,"stop_id":"1366026","stop_name":"Hardy St and Park Ave."}},{"stop":{"geometry":{"coordinates":[-89.3215543842679,31.3247803985083],"type":"Point"},"id":1356560854,"stop_id":"1366027","stop_name":"Hardy St and 20th Ave"}},{"stop":{"geometry":{"coordinates":[-89.3276399511115,31.3248628829067],"type":"Point"},"id":1356560855,"stop_id":"1366029","stop_name":"Hardy St and 25th Ave"}},{"stop":{"geometry":{"coordinates":[-89.3310889967776,31.3249276496711],"type":"Point"},"id":1356560856,"stop_id":"1366030","stop_name":"Hardy St and USM Rose Garden"}},{"stop":{"geometry":{"coordinates":[-89.3356357283762,31.324897528937],"type":"Point"},"id":1356560857,"stop_id":"1366031","stop_name":"Hardy St and 30th St  (JR Gas Station)"}},{"stop":{"geometry":{"coordinates":[-89.3394710484662,31.3249911918272],"type":"Point"},"id":1356560858,"stop_id":"1366032","stop_name":"Hardy St and Ross S t(34h St)"}},{"stop":{"geometry":{"coordinates":[-89.3431169016236,31.3250469078409],"type":"Point"},"id":1356560859,"stop_id":"1366033","stop_name":"Hardy St and 36th St"}},{"stop":{"geometry":{"coordinates":[-89.3454425389668,31.3250743430848],"type":"Point"},"id":1356560860,"stop_id":"1366034","stop_name":"Hardy St and  38th St"}},{"stop":{"geometry":{"coordinates":[-89.3478181958199,31.3251154986045],"type":"Point"},"id":1356560861,"stop_id":"1366035","stop_name":"Hardy St and  N 40th Ave"}},{"stop":{"geometry":{"coordinates":[-89.3592139589124,31.3244428079746],"type":"Point"},"id":1356560862,"stop_id":"1366036","stop_name":"Hardy St and Coco Cola Ave"}},{"stop":{"geometry":{"coordinates":[-89.3637474529591,31.3235596242789],"type":"Point"},"id":1356560863,"stop_id":"1366042","stop_name":"Hardy St (Across from McDonalds)"}},{"stop":{"geometry":{"coordinates":[-89.3660555213708,31.3244178983553],"type":"Point"},"id":1356560864,"stop_id":"1366050","stop_name":"Wesley (Green Eye Institute)"}},{"stop":{"geometry":{"coordinates":[-89.3669149638396,31.3255762657781],"type":"Point"},"id":1356560865,"stop_id":"1366051","stop_name":"Wesley (Front Entrance)"}},{"stop":{"geometry":{"coordinates":[-89.3676838506019,31.3238843699063],"type":"Point"},"id":1356560866,"stop_id":"1366052","stop_name":"Wesley (Millsaps Dr)"}},{"stop":{"geometry":{"coordinates":[-89.3743229976758,31.3244266683696],"type":"Point"},"id":1356560867,"stop_id":"1366054","stop_name":"Turtle Creek mall 1"}},{"stop":{"geometry":{"coordinates":[-89.3757027944251,31.3233572391489],"type":"Point"},"id":1356560868,"stop_id":"1366055","stop_name":"Turtle Creek Mall 2"}},{"stop":{"geometry":{"coordinates":[-89.3780642720896,31.3276013919222],"type":"Point"},"id":1356560869,"stop_id":"1366066","stop_name":"Turtle Creek Mall 3"}},{"stop":{"geometry":{"coordinates":[-89.381220537599,31.3234770538021],"type":"Point"},"id":1356560870,"stop_id":"1366067","stop_name":"Cross Creek Parkway (Across Bed Bath and Beyond)"}},{"stop":{"geometry":{"coordinates":[-89.3793087249463,31.3204869024957],"type":"Point"},"id":1356560871,"stop_id":"1366068","stop_name":"Walmart"}},{"stop":{"geometry":{"coordinates":[-89.375219643116,31.3220085446966],"type":"Point"},"id":1356560872,"stop_id":"1366069","stop_name":"Hardy St (Lowes)"}},{"stop":{"geometry":{"coordinates":[-89.371622800827,31.3222835005052],"type":"Point"},"id":1356560873,"stop_id":"1366070","stop_name":"Hardy St (TJ Max)"}},{"stop":{"geometry":{"coordinates":[-89.3667116761208,31.3227692538046],"type":"Point"},"id":1356560874,"stop_id":"1366071","stop_name":"Hardy St (Shell Gas station)"}},{"stop":{"geometry":{"coordinates":[-89.3630654335731,31.323267541796],"type":"Point"},"id":1356560875,"stop_id":"1366072","stop_name":"Hardy St (McDonald's)"}},{"stop":{"geometry":{"coordinates":[-89.3580944906547,31.3230393883591],"type":"Point"},"id":1356560876,"stop_id":"1366073","stop_name":"Service Rd (Best Buy)"}},{"stop":{"geometry":{"coordinates":[-89.3558065881091,31.3233303779588],"type":"Point"},"id":1356560877,"stop_id":"1366074","stop_name":"Georgia Blue"}},{"stop":{"geometry":{"coordinates":[-89.3444713409387,31.3248223837688],"type":"Point"},"id":1356560878,"stop_id":"1366075","stop_name":"Hardy St and 38th Ave"}},{"stop":{"geometry":{"coordinates":[-89.3404719602485,31.3247321877362],"type":"Point"},"id":1356560879,"stop_id":"1366076","stop_name":"Hardy St and 34th Ave"}},{"stop":{"geometry":{"coordinates":[-89.3343989492609,31.3246569610849],"type":"Point"},"id":1356560880,"stop_id":"1366077","stop_name":"Hardy St and 30th Ave"}},{"stop":{"geometry":{"coordinates":[-89.3326006661661,31.3238088961898],"type":"Point"},"id":1356560881,"stop_id":"1366078","stop_name":"Hardy St and 29th Ave"}},{"stop":{"geometry":{"coordinates":[-89.3312409799947,31.3213358646253],"type":"Point"},"id":1356560882,"stop_id":"1366079","stop_name":"28th Ave @ Pine Grove Health Center"}},{"stop":{"geometry":{"coordinates":[-89.3311755253479,31.3245465924015],"type":"Point"},"id":1356560883,"stop_id":"1366088","stop_name":"Hardy and 28th Av"}},{"stop":{"geometry":{"coordinates":[-89.3278121485224,31.3246376119648],"type":"Point"},"id":1356560884,"stop_id":"1366089","stop_name":"Hardy St and 25th Ave"}},{"stop":{"geometry":{"coordinates":[-89.3228486807491,31.3246831265938],"type":"Point"},"id":1356560885,"stop_id":"1366090","stop_name":"Hardy and 21st Ave"}},{"stop":{"geometry":{"coordinates":[-89.3178770996677,31.3246779760976],"type":"Point"},"id":1356560886,"stop_id":"1366091","stop_name":"Hardy St and Park Ave(Shelter)"}},{"stop":{"geometry":{"coordinates":[-89.3145070142326,31.3246169814954],"type":"Point"},"id":1356560887,"stop_id":"1366092","stop_name":"Hardy and 17th Ave. (Zoo)"}},{"stop":{"geometry":{"coordinates":[-89.3101181207887,31.3246755685877],"type":"Point"},"id":1356560888,"stop_id":"1366093","stop_name":"Hardy St and Hutchinson Ave."}},{"stop":{"geometry":{"coordinates":[-89.3036226848469,31.3247026565347],"type":"Point"},"id":1356560889,"stop_id":"1366094","stop_name":"Hardy St and Pinehurst St"}},{"stop":{"geometry":{"coordinates":[-89.3000145197159,31.3246711219764],"type":"Point"},"id":1356560890,"stop_id":"1366095","stop_name":"Hardy St and Mamie St"}},{"stop":{"geometry":{"coordinates":[-89.2956576450295,31.324703417997],"type":"Point"},"id":1356560891,"stop_id":"1366097","stop_name":"Hardy St and 1st Ave"}},{"stop":{"geometry":{"coordinates":[-89.2906488930477,31.3254823550539],"type":"Point"},"id":1356560892,"stop_id":"1366117","stop_name":"Front St and Forrest St."}},{"stop":{"geometry":{"coordinates":[-89.2896585267476,31.3264163588242],"type":"Point"},"id":1356560847,"stop_id":"1366014","stop_name":"Main St and W Front"}},{"stop":{"geometry":{"coordinates":[-89.2892369500362,31.3260193257079],"type":"Point"},"id":1356560893,"stop_id":"1366118","stop_name":"Main St and Short St"}},{"stop":{"geometry":{"coordinates":[-89.2856458889954,31.3263737003271],"type":"Point"},"id":1356560894,"stop_id":"1366119","stop_name":"Buschman St and River Av"}},{"stop":{"geometry":{"coordinates":[-89.2856817900802,31.3277713914326],"type":"Point"},"id":1356560846,"stop_id":"1366007","stop_name":"Train Depot"}}],"route_text_color":"ffffff","route_type":3,"route_url":null},"geometry":{"coordinates":[[[-89.28567045655306,31.327728625670197],[-89.2857262595878,31.327661577380397],[-89.28569394410813,31.327558915255302],[-89.2856379233822,31.327499241125174],[-89.28560038250491,31.327452482533594],[-89.28534175779716,31.327229758548313],[-89.2850680132145,31.32699985924143],[-89.28571334093132,31.32642154698199],[-89.28616355402134,31.32603106928508],[-89.28695014958606,31.325347967861816],[-89.2876175114315,31.324766906928183],[-89.288725381038,31.325687962663533],[-89.28910560890516,31.32601615150841],[-89.28963248343705,31.326463941433797],[-89.29020650649149,31.326937361135208],[-89.29098006952597,31.327560071904585],[-89.29118242106638,31.327658419521942],[-89.29175242106638,31.32787841952194],[-89.29282242106638,31.32826841952194],[-89.29323226416567,31.32841351922872],[-89.29431652746592,31.327127622434688],[-89.29441145599006,31.326909378959],[-89.29436152996571,31.325734961943926],[-89.29437200614703,31.324812493998408],[-89.29517489633,31.324799562028804],[-89.29624404463635,31.324795740975695],[-89.29645128659654,31.32481843123942],[-89.29669337367285,31.324831996819682],[-89.29683755190709,31.324813838009486],[-89.29696953338843,31.324770434759117],[-89.29703060937085,31.324757541146365],[-89.2970832751396,31.324767148031263],[-89.29712983379592,31.32478644345411],[-89.29719231078442,31.324790404733328],[-89.29726700199778,31.324780951118324],[-89.2976032043966,31.32480739997036],[-89.29798357368016,31.324814681576065],[-89.29815788716682,31.324788649713884],[-89.30404659512345,31.324777339630778],[-89.30702203891423,31.3247639873506],[-89.31002236952241,31.32476033878016],[-89.3119617242232,31.324752808133866],[-89.31542340902696,31.32473853211735],[-89.31779444476885,31.324737221139497],[-89.32048874705927,31.324738616086098],[-89.32164913151853,31.32473582154086],[-89.32442334312861,31.324734973680375],[-89.32449761928204,31.324779418540377],[-89.32563728092695,31.324786269735107],[-89.32596912344145,31.32474888299963],[-89.32607013927587,31.32472280539545],[-89.32849239676848,31.324717471071917],[-89.32895242106638,31.324743544804072],[-89.32941242106638,31.32475841952194],[-89.32970242106637,31.32476841952194],[-89.33125242106638,31.32477841952194],[-89.33412242106638,31.32482841952194],[-89.33551242106638,31.32481841952194],[-89.34376054012,31.32495309237572],[-89.34674242106638,31.32499841952194],[-89.34864242106637,31.32505841952194],[-89.35086242106638,31.32507841952194],[-89.35165242106638,31.32505841952194],[-89.35169242106637,31.32504841952194],[-89.35348242106637,31.32500841952194],[-89.35382242106638,31.32498841952194],[-89.35449242106638,31.32490841952194],[-89.35594242106637,31.32468841952194],[-89.35635242106638,31.32461841952194],[-89.35681242106638,31.324558419521942],[-89.35763242106638,31.32442841952194],[-89.35940242106638,31.32415841952194],[-89.36212242106637,31.32373841952194],[-89.36383242106638,31.323438419521942],[-89.36489242106637,31.32327841952194],[-89.36591606775818,31.323144724652877],[-89.36603100509936,31.323155475462528],[-89.36613277882697,31.323190588760866],[-89.36621075472011,31.323228470182265],[-89.36627289743953,31.32333733487893],[-89.36629045722641,31.323523639947453],[-89.3662307547197,31.323812758507774],[-89.36586915955999,31.32532210553433],[-89.36611242106638,31.32536841952194],[-89.36617242106638,31.32538841952194],[-89.36616242106638,31.325408419521942],[-89.36616242106638,31.32550841952194],[-89.36617242106638,31.32552841952194],[-89.36622242106638,31.32554841952194],[-89.36630242106638,31.32554841952194],[-89.36632242106639,31.32553841952194],[-89.36635242106638,31.32542841952194],[-89.36705242106638,31.32555841952194],[-89.36741242106638,31.32560841952194],[-89.36759303992828,31.325633368724453],[-89.36760951608518,31.325509822974574],[-89.36763242106638,31.32508841952194],[-89.36762973091015,31.323826133675812],[-89.3676172089012,31.32324368091284],[-89.36764043548405,31.323154659560544],[-89.36767527936725,31.323092346779998],[-89.36769656839613,31.323044666751407],[-89.3677359759207,31.322988950324575],[-89.36779151635774,31.32294537940105],[-89.36803242106637,31.32291841952194],[-89.36997242106638,31.32275841952194],[-89.37191242106638,31.32256841952194],[-89.37278242106638,31.32251841952194],[-89.3730118328129,31.322514378898795],[-89.37325242106638,31.32263841952194],[-89.37340778872453,31.32278211743329],[-89.37343212693946,31.322902323796995],[-89.37345473723693,31.324092314469127],[-89.37349162142846,31.32467721510376],[-89.37348328502512,31.32517841952194],[-89.37429326637573,31.32518114456609],[-89.37428326637573,31.323972056796666],[-89.37431007392755,31.323769329630203],[-89.37438007392751,31.323642965260188],[-89.37447838330812,31.32352751251529],[-89.37459007392754,31.32345569238521],[-89.37469242106638,31.32341841952194],[-89.37483434555055,31.323369329552243],[-89.37520242106638,31.323338419521942],[-89.37654242106638,31.32322841952194],[-89.37689310362329,31.32323079593886],[-89.37699003211709,31.32325523508524],[-89.377075859582,31.323277611496565],[-89.3771792980982,31.323323172335],[-89.37725378618028,31.323373485994235],[-89.377336542139,31.323439046837887],[-89.37740171277794,31.32351492136293],[-89.3774368834169,31.32359904680712],[-89.37746205405695,31.32369079587906],[-89.37749429809794,31.324127231316652],[-89.37751412745871,31.324403799164468],[-89.37755303679155,31.32481987424296],[-89.3776138805743,31.32492696481515],[-89.3776838805743,31.325010055907118],[-89.37779917132632,31.32510914632525],[-89.37791663997864,31.325182419117237],[-89.37800870483875,31.32529411618617],[-89.37806466518272,31.32548601518554],[-89.37807448790201,31.32600652080239],[-89.3780780745346,31.326226156846634],[-89.37807354565724,31.326992141370436],[-89.37807448790201,31.327430025358517],[-89.37808354565725,31.327746813725412],[-89.37843242106638,31.32776841952194],[-89.37888242106638,31.327758419521942],[-89.37931870706839,31.327748587476137],[-89.37930091092375,31.327103040001077],[-89.37928323749546,31.326695645675628],[-89.37928405392498,31.32656758036833],[-89.37931568678319,31.326413967436686],[-89.37952242106638,31.32619841952194],[-89.38018242106638,31.32562841952194],[-89.38093728686985,31.325088834653595],[-89.38116022866569,31.324856948383736],[-89.38125380849304,31.324628754778153],[-89.38126380849262,31.324390430875603],[-89.3812714819209,31.323454807011323],[-89.38125695149387,31.32288841952194],[-89.3812521910148,31.321934118198943],[-89.38121016669436,31.3217311961593],[-89.38119016669363,31.321471759652326],[-89.38008242106638,31.32160841952194],[-89.37905850720644,31.3217136779107],[-89.37813230498196,31.32180254722365],[-89.37817517071659,31.32169979904065],[-89.37816662457091,31.32118544318279],[-89.3781830029673,31.320879492273193],[-89.37827662457092,31.32043606721441],[-89.37899589960718,31.320425476445195],[-89.37937213172378,31.320418419521943],[-89.37940691391229,31.3215646530276],[-89.37941714959743,31.321700066368827],[-89.37907677824451,31.321738214318195],[-89.37887434317514,31.321761006375315],[-89.37739242106638,31.32188841952194],[-89.37727242106638,31.32190841952194],[-89.37670242106638,31.32195841952194],[-89.37598242106638,31.32200841952194],[-89.37441242106638,31.32215841952194],[-89.37346242106638,31.322208419521942],[-89.37303242106638,31.32225841952194],[-89.37210242106637,31.32232841952194],[-89.37180242106638,31.32233841952194],[-89.37152242106637,31.32235841952194],[-89.37141242106638,31.32237841952194],[-89.36934242106638,31.32256841952194],[-89.36757854831056,31.322704534551463],[-89.36486242106638,31.32303841952194],[-89.36418242106637,31.323158419521942],[-89.36267242106638,31.32340841952194],[-89.36063469753147,31.323705430617064],[-89.35928412454241,31.32391967714191],[-89.35925253701569,31.323808868700198],[-89.35924608540084,31.323040636645747],[-89.35747242106638,31.323048419521943],[-89.35632130328395,31.323063016085328],[-89.35632137737292,31.322469728374],[-89.35594172527075,31.32248711066728],[-89.35592776681383,31.323133487730107],[-89.35592138204761,31.323403837691227],[-89.35564723025678,31.323429551063107],[-89.35566242106638,31.32357841952194],[-89.35584791756744,31.323562853745084],[-89.35583570378216,31.323425093849917],[-89.3561052797906,31.32340286556933],[-89.35626861074806,31.323403924863282],[-89.35628285752996,31.32435177213452],[-89.35541242106638,31.32450841952194],[-89.35419242106637,31.32475841952194],[-89.35392242106639,31.32479841952194],[-89.35352242106637,31.324838419521942],[-89.35331242106638,31.32485841952194],[-89.35229242106638,31.32491841952194],[-89.35164242106637,31.32494841952194],[-89.35096242106638,31.32496841952194],[-89.34436112609637,31.324849508452854],[-89.34436504695549,31.324141786228708],[-89.3437092088942,31.32413173393553],[-89.34371224846524,31.32483374666352],[-89.33546242106638,31.32470841952194],[-89.33411351191387,31.32471841952194],[-89.33282123596904,31.32469262574245],[-89.33280436653689,31.324504027827555],[-89.33272631200661,31.32438860497693],[-89.33254242106638,31.324228088222792],[-89.33252242106639,31.32106841952194],[-89.33127847654072,31.3210591626475],[-89.33129425501043,31.322812909935745],[-89.3312915329921,31.32467566458351],[-89.32932439521446,31.3246349764531],[-89.32865742207628,31.32464836569021],[-89.32850775302934,31.324674236314802],[-89.32776814983674,31.324676960908533],[-89.32607449948785,31.324685100910774],[-89.32598837115266,31.324660198769337],[-89.32456113972377,31.32466423010036],[-89.32448603876921,31.324672232949],[-89.32442222677982,31.324695665286068],[-89.321648002623,31.324694472508288],[-89.32015906702213,31.324695622785374],[-89.31921832912595,31.32469286549039],[-89.3179371088375,31.32469141649379],[-89.31552812814002,31.324701279001573],[-89.3121238751541,31.32471109407014],[-89.31014519227313,31.324711672011084],[-89.30695413504296,31.32472236633715],[-89.30457000877581,31.324727047989647],[-89.30109413054379,31.324736156981587],[-89.29812759719663,31.324747002952098],[-89.29795400662532,31.324729601464377],[-89.29771830873048,31.32473875022045],[-89.29754814335985,31.324734724536],[-89.29740406442022,31.32471557761545],[-89.29735287308532,31.324693653719486],[-89.29732719858302,31.3246572933603],[-89.29732015724548,31.324627299840998],[-89.29728591432813,31.324583073489165],[-89.29724237355161,31.324549197748766],[-89.29719672573098,31.32453818415193],[-89.29713707557954,31.32454178432876],[-89.29708985319951,31.324573149286532],[-89.29704947590686,31.324609577993932],[-89.29701567641344,31.324663211443006],[-89.29696087973737,31.3246944367301],[-89.29675362843184,31.32474004382237],[-89.29652190413239,31.324720987877505],[-89.29635422284571,31.32472863706289],[-89.29621017472786,31.324750706439737],[-89.29505462673391,31.324756417788638],[-89.2944049532188,31.324752290877626],[-89.29394040611257,31.32476988428086],[-89.29349837454508,31.324769884279128],[-89.29319242106638,31.32476841952194],[-89.29286242106637,31.324738419521942],[-89.29242242106638,31.32471841952194],[-89.29185242106638,31.32471841952194],[-89.29178242106637,31.32472841952194],[-89.29169242106637,31.32472841952194],[-89.29166242106638,31.324738419521942],[-89.29157242106638,31.32478841952194],[-89.29146242106638,31.32486841952194],[-89.29135242106638,31.32498841952194],[-89.29107242106637,31.325208419521942],[-89.28965472587876,31.32642510259719],[-89.28918723867638,31.326029407930395],[-89.28877217650987,31.32566709257163],[-89.2876145879775,31.32471029979653],[-89.28707412764781,31.325178097552183],[-89.2864959784526,31.32567790867887],[-89.285527732729,31.326538721235764],[-89.28502078437245,31.327000019255028],[-89.28532411821166,31.327259397832147],[-89.28558797237449,31.327485052409063],[-89.28534780848588,31.327700135031357],[-89.28547441695363,31.327799879684957],[-89.28554570488261,31.327804197836308],[-89.28564636042904,31.32774792892497]]],"type":"MultiLineString"}}]`),D_={type:ov,features:lv},cv="FeatureCollection",uv=JSON.parse('[{"type":"Feature","properties":{"agency":{"agency_id":null,"agency_name":"Hub City Transit","id":1890805,"onestop_id":""},"continuous_drop_off":null,"continuous_pickup":null,"feed_version":{"feed":{"id":8455,"onestop_id":"f-hattiesburg~mi~us"},"fetched_at":"2025-05-05T23:01:08.61939Z","id":519462,"sha1":"90988e5e23049b2c4856de4c2ea055d91a8e2e80"},"id":75585140,"onestop_id":"r-dj86p-greenline","route_color":"00ff00","route_desc":"Serves 4th Street starting at Walmart @ 49 6:30 AM - 6:00 PM","route_id":"35781","route_long_name":"4th Street","route_short_name":"Green Line","route_sort_order":null,"route_stops":[{"stop":{"geometry":{"coordinates":[-89.3216235673701,31.310036486425],"type":"Point"},"id":1356560896,"stop_id":"1366202","stop_name":"Mc Innis St and Washington St"}},{"stop":{"geometry":{"coordinates":[-89.3287022928165,31.3282711594418],"type":"Point"},"id":1356560897,"stop_id":"1366203","stop_name":"Service Dr @ Glory Bound"}},{"stop":{"geometry":{"coordinates":[-89.3299200641263,31.3355130907934],"type":"Point"},"id":1356560898,"stop_id":"1366204","stop_name":"Service Rd @ Hillcrest"}},{"stop":{"geometry":{"coordinates":[-89.3305430845882,31.3320470705634],"type":"Point"},"id":1356560899,"stop_id":"1366205","stop_name":"4th St and Eagle Walk"}},{"stop":{"geometry":{"coordinates":[-89.33935177621,31.3324013411453],"type":"Point"},"id":1356560900,"stop_id":"1366206","stop_name":"W 4th St and USM Coliseum"}},{"stop":{"geometry":{"coordinates":[-89.344121506836,31.3347696318612],"type":"Point"},"id":1356560901,"stop_id":"1735415","stop_name":"4th St and Virginia Dr"}},{"stop":{"geometry":{"coordinates":[-89.3492230410342,31.334789866075],"type":"Point"},"id":1356560902,"stop_id":"1366208","stop_name":"Thornhill Dr @ Mark IV Apartments"}},{"stop":{"geometry":{"coordinates":[-89.35036741568,31.3321358838611],"type":"Point"},"id":1356560903,"stop_id":"1366209","stop_name":"Grand Theatre"}},{"stop":{"geometry":{"coordinates":[-89.3473505757136,31.3284809964538],"type":"Point"},"id":1356560904,"stop_id":"1366210","stop_name":"Montague Blvd and 40th Ave"}},{"stop":{"geometry":{"coordinates":[-89.3456253945012,31.3267523076444],"type":"Point"},"id":1356560905,"stop_id":"1366211","stop_name":"Pearl St and 38th Ave"}},{"stop":{"geometry":{"coordinates":[-89.3455412093838,31.3250762239268],"type":"Point"},"id":1356560906,"stop_id":"1366212","stop_name":"N 38th Av and Hardy"}},{"stop":{"geometry":{"coordinates":[-89.3404719602485,31.3247321877362],"type":"Point"},"id":1356560879,"stop_id":"1366076","stop_name":"Hardy St and 34th Ave"}},{"stop":{"geometry":{"coordinates":[-89.3343989492609,31.3246569610849],"type":"Point"},"id":1356560880,"stop_id":"1366077","stop_name":"Hardy St and 30th Ave"}},{"stop":{"geometry":{"coordinates":[-89.3326006661661,31.3238088961898],"type":"Point"},"id":1356560881,"stop_id":"1366078","stop_name":"Hardy St and 29th Ave"}},{"stop":{"geometry":{"coordinates":[-89.3311204944413,31.3209941645266],"type":"Point"},"id":1356560907,"stop_id":"1389534","stop_name":"Midtown stop 28th st"}},{"stop":{"geometry":{"coordinates":[-89.3297061959822,31.319266882983],"type":"Point"},"id":1356560908,"stop_id":"1389535","stop_name":"Mamie St and Hospital Entrance"}},{"stop":{"geometry":{"coordinates":[-89.3194162915476,31.3080127949791],"type":"Point"},"id":1356560895,"stop_id":"1385893","stop_name":"Walmart @ 49"}}],"route_text_color":null,"route_type":3,"route_url":null},"geometry":{"coordinates":[[[-89.31936529545663,31.307958394502464],[-89.31936983859276,31.307628975892953],[-89.31860175524456,31.307631772731213],[-89.31860794946556,31.30824567498891],[-89.318624467388,31.30839914992768],[-89.31864717953144,31.30854733239022],[-89.31872770440329,31.308803122998114],[-89.3188681081115,31.309055384288698],[-89.31894863298383,31.309164756319205],[-89.31912826539065,31.30929529696391],[-89.31926866773162,31.309353510977274],[-89.31947720650287,31.309406432775987],[-89.31963660288494,31.309435856451913],[-89.32134597084082,31.309439837597893],[-89.32147604948041,31.30947159065201],[-89.3215792864957,31.309554501352665],[-89.32161994886411,31.30963022424656],[-89.32163449517824,31.309714154206063],[-89.32163027136255,31.31053870650679],[-89.32162820662234,31.310593391676775],[-89.32159517077753,31.310697469816134],[-89.32152703434721,31.31078567153932],[-89.3213763076976,31.310847411719266],[-89.32116570418616,31.31093914136342],[-89.32059789999603,31.31128488943054],[-89.32395700562695,31.314489437225504],[-89.32689023560876,31.317341732163925],[-89.3272677071322,31.31776673060108],[-89.32767822562536,31.318315658568665],[-89.32804709731472,31.318920492160473],[-89.32844571672119,31.319748955397444],[-89.32866349446338,31.320388102334817],[-89.328830081678,31.32104883017577],[-89.32892527437235,31.321795955303173],[-89.32894312319058,31.324657339549844],[-89.32894312391913,31.326603843561003],[-89.32877653670454,31.326603843561003],[-89.32874679057497,31.328382594278835],[-89.32876640404011,31.330145875464112],[-89.32896273897117,31.330145875464112],[-89.32898245173396,31.334487075449744],[-89.32876231862882,31.334476911892224],[-89.328754974054,31.335601439094447],[-89.328764740789,31.33571290632991],[-89.32972605846155,31.335715420135973],[-89.32973317327769,31.33553572953484],[-89.33001513546665,31.335534337475536],[-89.33000504011694,31.335664523759405],[-89.32932970995098,31.335658543573672],[-89.32933214548919,31.33555751606253],[-89.3293029009173,31.33435003143781],[-89.32929869366417,31.334164401627284],[-89.32935097965242,31.333104879067935],[-89.32933546251581,31.332624541037305],[-89.3293207605923,31.332139232390347],[-89.3294013587951,31.332056709688885],[-89.32950299086679,31.331979863555866],[-89.33211376559233,31.33199232126213],[-89.33473376244346,31.332004269069884],[-89.33529217266376,31.332028390896227],[-89.33657792169609,31.332115311915942],[-89.33849108237554,31.332246901347474],[-89.34023846777026,31.332402610913938],[-89.34050995204925,31.332437101845027],[-89.34074110220814,31.33249172994328],[-89.34124618709336,31.332665583684534],[-89.34150649963604,31.332779632936997],[-89.34185053083273,31.332948738613265],[-89.34238230523118,31.33329183497186],[-89.34273612967475,31.333546840142304],[-89.34377000211501,31.334380592118826],[-89.34448036359942,31.33494369494996],[-89.34466899136036,31.33508493507574],[-89.34494094024821,31.33522509463065],[-89.34593888320265,31.335650647047025],[-89.3462715402534,31.33576780535798],[-89.34642787204413,31.335813841403834],[-89.34657762015918,31.335843896148134],[-89.34671942723507,31.33585083709559],[-89.34910303854738,31.33588755199022],[-89.3491022667059,31.33504917624249],[-89.34911762257319,31.33488134117259],[-89.34916719253003,31.334752128812063],[-89.34928244719735,31.33457345025943],[-89.34942281713242,31.334425970479835],[-89.34962969246811,31.334169912119904],[-89.34969741367765,31.33397227431464],[-89.34971730277536,31.333830737653994],[-89.3497145306813,31.333127312790424],[-89.34972596377213,31.332403601004543],[-89.34974167669439,31.332317308196302],[-89.34978588361774,31.332238455172043],[-89.34983888497187,31.33217030810603],[-89.34992445514973,31.33211294761079],[-89.35002176593159,31.33208193871469],[-89.3501179029582,31.332065974729595],[-89.35138602444079,31.33204176274742],[-89.35149300465098,31.33201831670314],[-89.35156193947451,31.331991308097315],[-89.3516171124766,31.331933697910998],[-89.35164275240952,31.33185999997086],[-89.35165788304616,31.33161608759164],[-89.35167423336482,31.3304891490372],[-89.35064333573604,31.330478573994842],[-89.35055145694632,31.330459965650867],[-89.35050108061442,31.33041958385562],[-89.35047273273172,31.330352089403085],[-89.35047185459294,31.32992084431947],[-89.35045147182007,31.32980885488491],[-89.35038926887745,31.329701333990382],[-89.35013896370496,31.32945865300173],[-89.3500171350692,31.329367125285113],[-89.34989758748075,31.329330387238215],[-89.34973969546543,31.329318287009926],[-89.34854479574942,31.32931530658073],[-89.34852384752456,31.32865421078635],[-89.3485292404298,31.32849082274356],[-89.34800832530777,31.328494968000975],[-89.34785893686805,31.328546737184336],[-89.34671539472528,31.32855092232795],[-89.34553523049917,31.32852382489078],[-89.3455066631346,31.324853343436715],[-89.34053823682473,31.324775972174663],[-89.33281524181967,31.324667930869055],[-89.3327996281133,31.32454233954639],[-89.33272583180957,31.32440062492206],[-89.33260974631624,31.324290307955593],[-89.33253850567945,31.324218238005997],[-89.3325094843065,31.321074032955238],[-89.33068998612731,31.321022703855952],[-89.33051528104015,31.320949265616594],[-89.3303607439909,31.320817586029023],[-89.33024993302797,31.32068966259535],[-89.33016657551543,31.320477654020355],[-89.33014725838426,31.320328669523043],[-89.3301208285995,31.320158662725685],[-89.33012438492632,31.31985397507593],[-89.33006466862001,31.319644322935254],[-89.32997331599776,31.31947741259734],[-89.32978228912337,31.31935097581343],[-89.32960291959101,31.319287757685256],[-89.32863554103598,31.319294355068642],[-89.32837546800972,31.319259447456705],[-89.3280300540169,31.31862333527362],[-89.32739366939893,31.31772266202648],[-89.32704578469986,31.317302466146145],[-89.32526964279366,31.315549944286715],[-89.32332938108644,31.313703265289035],[-89.32184585645874,31.31225523927729],[-89.32098126943963,31.311414006955225],[-89.3209616071997,31.31129654883952],[-89.32098143512508,31.31118973932226],[-89.32110292900502,31.311103471180743],[-89.32136351846842,31.31097930840258],[-89.32144828394344,31.31093369281804],[-89.3215111834119,31.310881283983463],[-89.3216108575172,31.310773452378413],[-89.32165218194085,31.310703860325518],[-89.32168574952742,31.31061694227605],[-89.32169666724103,31.310515347023266],[-89.32168971561629,31.310115525907705],[-89.32168208519342,31.310017369639855],[-89.32167840607094,31.30971347082437],[-89.32165884547764,31.309612288491845],[-89.32162499294459,31.30953294593793],[-89.32155449151918,31.309463346144305],[-89.32147802914557,31.3094267858442],[-89.32136767755277,31.309396182177686],[-89.32060455123079,31.309395369543864],[-89.31983488607663,31.309390366956958],[-89.31983679655478,31.309342906847917],[-89.3198336650241,31.309236774305376],[-89.31983004418775,31.3091922618477],[-89.31980626077757,31.309136213913284],[-89.31977404405596,31.30908284620003],[-89.31938952362388,31.3086821612547],[-89.31937157358294,31.30864940015577],[-89.31936813014454,31.308610570737855],[-89.3193635994408,31.307983400672654]]],"type":"MultiLineString"}}]'),E0={type:cv,features:uv},hv="FeatureCollection",dv=[{type:"Feature",properties:{agency:{agency_id:null,agency_name:"Hub City Transit",id:1890805,onestop_id:""},continuous_drop_off:null,continuous_pickup:null,feed_version:{feed:{id:8455,onestop_id:"f-hattiesburg~mi~us"},fetched_at:"2025-05-05T23:01:08.61939Z",id:519462,sha1:"90988e5e23049b2c4856de4c2ea055d91a8e2e80"},id:75585141,onestop_id:"r-dj86pp-goldline",route_color:"ffff00",route_desc:"Serves USM starting at Hillcrest Lot 7:00 AM - 6:00 PM M-F",route_id:"35782",route_long_name:"USM",route_short_name:"Gold Line",route_sort_order:null,route_stops:[{stop:{geometry:{coordinates:[-89.3294376459942,31.3337616879839],type:"Point"},id:1356560909,stop_id:"1385932",stop_name:"Hillcrest"}},{stop:{geometry:{coordinates:[-89.3305973298611,31.3304136306095],type:"Point"},id:1356560910,stop_id:"1385933",stop_name:"Stadium Ave @ Athletic Center"}},{stop:{geometry:{coordinates:[-89.3305960800593,31.328016244518],type:"Point"},id:1356560911,stop_id:"1385934",stop_name:"Eagle Walk and College Dr"}},{stop:{geometry:{coordinates:[-89.3329976803194,31.3259134650251],type:"Point"},id:1356560912,stop_id:"1385935",stop_name:"Southern Miss Dr and W Memorial Dr"}},{stop:{geometry:{coordinates:[-89.332915382727,31.3249726974673],type:"Point"},id:1356560913,stop_id:"1385936",stop_name:"W Memorial Dr @ Hardy St"}},{stop:{geometry:{coordinates:[-89.3356357283762,31.324897528937],type:"Point"},id:1356560857,stop_id:"1366031",stop_name:"Hardy St and 30th St  (JR Gas Station)"}},{stop:{geometry:{coordinates:[-89.3359390260614,31.3265759212912],type:"Point"},id:1356560914,stop_id:"1385937",stop_name:"North 31st @ Pearl St"}},{stop:{geometry:{coordinates:[-89.3407643344348,31.3268483366073],type:"Point"},id:1356560915,stop_id:"1385938",stop_name:"Pearl St @ N 34th Ave"}},{stop:{geometry:{coordinates:[-89.3419630602387,31.3284074990046],type:"Point"},id:1356560916,stop_id:"1385939",stop_name:"N 35th Ave @ Montague Blvd"}},{stop:{geometry:{coordinates:[-89.3383800675508,31.3283621117267],type:"Point"},id:1356560917,stop_id:"1385940",stop_name:"Montague Blvd @ CuBard School"}},{stop:{geometry:{coordinates:[-89.3348414192998,31.3283127790165],type:"Point"},id:1356560918,stop_id:"1385941",stop_name:"Golden Eagle Ave @ Montague Blvd"}},{stop:{geometry:{coordinates:[-89.3346607337403,31.3293458394024],type:"Point"},id:1356560919,stop_id:"1385942",stop_name:"Golden Eagle Ave @ Charles Lane Dr"}},{stop:{geometry:{coordinates:[-89.3329168123558,31.3318834603729],type:"Point"},id:1356560920,stop_id:"1385943",stop_name:"4th Street @ Moffet Health Center"}},{stop:{geometry:{coordinates:[-89.3299200641263,31.3355130907934],type:"Point"},id:1356560898,stop_id:"1366204",stop_name:"Service Rd @ Hillcrest"}}],route_text_color:null,route_type:3,route_url:null},geometry:{coordinates:[[[-89.32995580356616,31.33553964710769],[-89.33001292205313,31.335537608509366],[-89.3300004017971,31.335670937277115],[-89.32934527286388,31.335663757267838],[-89.32935215475591,31.335557351658558],[-89.32934175220264,31.33530621084038],[-89.32932839393233,31.33463213407118],[-89.32931494694282,31.334369523764632],[-89.32932600726022,31.333959039710347],[-89.32933540789742,31.33378685663315],[-89.32934237306135,31.33366375617459],[-89.32935083853879,31.33337559727097],[-89.32936983203145,31.333084511312215],[-89.32936738615432,31.33290450765178],[-89.32935289300889,31.33263340831611],[-89.32934180346025,31.332356368263913],[-89.32933559428244,31.332155763434653],[-89.32936287535962,31.33209650347544],[-89.32952077236351,31.331999729931056],[-89.33047723945842,31.332006342005386],[-89.33048772010143,31.331416062191465],[-89.330496443673,31.33071604793018],[-89.33052610918388,31.330578595592474],[-89.3305328510205,31.328321038793824],[-89.33053427653095,31.327970798446593],[-89.3305504589326,31.32746708906575],[-89.33054639774137,31.327145354493496],[-89.33053639774138,31.32690057097213],[-89.33053030595522,31.326705354468416],[-89.33043548262462,31.325943253454657],[-89.33043503563829,31.325842034078022],[-89.3304741179078,31.325771360301086],[-89.33054094148957,31.325694365677897],[-89.33066325166479,31.325635145812708],[-89.33108806791071,31.325763704614243],[-89.33151858587753,31.3258324395298],[-89.33196499465986,31.325829469187077],[-89.3330667483352,31.3258123514929],[-89.33307,31.32567055817393],[-89.33303,31.32558055817393],[-89.33284,31.32530055817393],[-89.33283,31.325250558173927],[-89.3328325509666,31.324803632907543],[-89.33398030842953,31.324830170266143],[-89.33471214323266,31.324841065873986],[-89.33538040773392,31.324839782369985],[-89.33597800842972,31.32484357335709],[-89.335987781646,31.325341481564564],[-89.33599792631885,31.326666412242187],[-89.33622384559594,31.32667278726506],[-89.33678632514173,31.32668081138502],[-89.33731726330878,31.326693406708902],[-89.33858548338972,31.326720230645172],[-89.33951680466232,31.326743837961523],[-89.3404685336689,31.3267587289697],[-89.34200599691451,31.326776393020545],[-89.34199252844985,31.328462244484815],[-89.34083650455057,31.32845770847339],[-89.34028841593978,31.32844885966416],[-89.33955285235378,31.32844072200331],[-89.33872505565282,31.328432504620938],[-89.33816063550746,31.328429608435403],[-89.33751033859873,31.328419667031746],[-89.33670209157063,31.328388377691635],[-89.33557903117726,31.328387990553125],[-89.33474915438974,31.32839904553441],[-89.33473900771406,31.329399281601436],[-89.33472923519608,31.329489908637886],[-89.33471122758212,31.330437740584205],[-89.33470402208533,31.331256162075046],[-89.33471795794173,31.331463986342897],[-89.33471457839052,31.331819969902146],[-89.33471576681693,31.33198297921375],[-89.33436200480298,31.33198457370007],[-89.33300189308343,31.33197990185778],[-89.33009217962348,31.33197289936585],[-89.32951736067585,31.331970691992716],[-89.32929856698017,31.331969543659866],[-89.32930420165694,31.332327363675088],[-89.32930875281383,31.33251257989843],[-89.32931744276385,31.332661973739302],[-89.32933436201525,31.332918315692115],[-89.32933594199227,31.33309057740197],[-89.32930107523104,31.333761295801022],[-89.32929149109798,31.33392823596372],[-89.3292835122983,31.33411330579221],[-89.32928343501693,31.334381761893706],[-89.32930014624111,31.33482866130978],[-89.32931694428027,31.335560575182434],[-89.32930468549868,31.335705387464756],[-89.3296588808498,31.33570403364321],[-89.32965792438006,31.335537799594327],[-89.32992327732575,31.335539025903596]]],type:"MultiLineString"}}],L_={type:hv,features:dv},fv="FeatureCollection",pv=JSON.parse(`[{"type":"Feature","properties":{"agency":{"agency_id":null,"agency_name":"Hub City Transit","id":1890805,"onestop_id":""},"continuous_drop_off":null,"continuous_pickup":null,"feed_version":{"feed":{"id":8455,"onestop_id":"f-hattiesburg~mi~us"},"fetched_at":"2025-05-05T23:01:08.61939Z","id":519462,"sha1":"90988e5e23049b2c4856de4c2ea055d91a8e2e80"},"id":75585142,"onestop_id":"r-dj86p-redline","route_color":"e80000","route_desc":"Serves Country Club Rd starting at Walmart@49 6:30 AM - 5:50 PM M-F","route_id":"35783","route_long_name":"Country Club Road","route_short_name":"Red Line","route_sort_order":null,"route_stops":[{"stop":{"geometry":{"coordinates":[-89.3199580907822,31.3109592394346],"type":"Point"},"id":1356560980,"stop_id":"1388487","stop_name":"On Service Rd near Cspire"}},{"stop":{"geometry":{"coordinates":[-89.3181808050625,31.3094381037823],"type":"Point"},"id":1356560981,"stop_id":"1388488","stop_name":"On Service Rd near Popeye's Chicken"}},{"stop":{"geometry":{"coordinates":[-89.3129612542419,31.3113024517434],"type":"Point"},"id":1356560982,"stop_id":"1388489","stop_name":"Bartur St and Broadway St"}},{"stop":{"geometry":{"coordinates":[-89.3136520232979,31.309684236034],"type":"Point"},"id":1356560983,"stop_id":"1388490","stop_name":"S 17th St and Service Rd"}},{"stop":{"geometry":{"coordinates":[-89.3136519799718,31.3053110185915],"type":"Point"},"id":1356560984,"stop_id":"1388491","stop_name":"Service Dr and W Pine St"}},{"stop":{"geometry":{"coordinates":[-89.3179125374082,31.3041869857573],"type":"Point"},"id":1356560985,"stop_id":"1388492","stop_name":"Lincoln Rd and Hill St (Central Sunbelt)"}},{"stop":{"geometry":{"coordinates":[-89.323061216242,31.304200664095],"type":"Point"},"id":1356560986,"stop_id":"1388493","stop_name":"Lincoln Rd and Roosevelt Blvd (dollar general)"}},{"stop":{"geometry":{"coordinates":[-89.3312837828537,31.303346537361],"type":"Point"},"id":1356560987,"stop_id":"1388494","stop_name":"28th Ave at Winn Dixie"}},{"stop":{"geometry":{"coordinates":[-89.3307844482932,31.2990916032449],"type":"Point"},"id":1356560988,"stop_id":"1388495","stop_name":"28th Ave and McInnis Loop"}},{"stop":{"geometry":{"coordinates":[-89.328524457479,31.2991020253653],"type":"Point"},"id":1356560989,"stop_id":"1388496","stop_name":"McInnis Loop at Greenbriar Apts"}},{"stop":{"geometry":{"coordinates":[-89.3240591776676,31.2991339848757],"type":"Point"},"id":1356560990,"stop_id":"1388497","stop_name":"McInnis Loop near Disability office"}},{"stop":{"geometry":{"coordinates":[-89.3169167939798,31.2981148223595],"type":"Point"},"id":1356560991,"stop_id":"1388498","stop_name":"McInnis Loop and Country Club Rd"}},{"stop":{"geometry":{"coordinates":[-89.3142487214891,31.3022114255025],"type":"Point"},"id":1356560992,"stop_id":"1388499","stop_name":"Country Club Rd at Bonhomie Apartments"}},{"stop":{"geometry":{"coordinates":[-89.3110165624761,31.3043749377737],"type":"Point"},"id":1356560993,"stop_id":"1388500","stop_name":"Country Club Rd at Pineview Apartments"}},{"stop":{"geometry":{"coordinates":[-89.3076133998641,31.3073483245198],"type":"Point"},"id":1356560994,"stop_id":"1388501","stop_name":"Country Club Rd at the park"}},{"stop":{"geometry":{"coordinates":[-89.3043791257458,31.3101438395811],"type":"Point"},"id":1356560995,"stop_id":"1388502","stop_name":"Country Club Rd and Killingsworth Dr"}},{"stop":{"geometry":{"coordinates":[-89.2995124213955,31.3117054959385],"type":"Point"},"id":1356560996,"stop_id":"1388503","stop_name":"Dumas Av and Martin Luther King Av"}},{"stop":{"geometry":{"coordinates":[-89.2994924572682,31.3063293115815],"type":"Point"},"id":1356560997,"stop_id":"1388504","stop_name":"Martin Luther king Av and Tuscan Av"}},{"stop":{"geometry":{"coordinates":[-89.2942017345307,31.3061678170059],"type":"Point"},"id":1356560998,"stop_id":"1388505","stop_name":"William Carey Pkwy and Tuscan"}},{"stop":{"geometry":{"coordinates":[-89.2948429954145,31.3001927693353],"type":"Point"},"id":1356560999,"stop_id":"1388506","stop_name":"William Carey Pkwy at Wisteria Apartments Entrance 1"}},{"stop":{"geometry":{"coordinates":[-89.2964797033601,31.2993925210101],"type":"Point"},"id":1356561000,"stop_id":"1388507","stop_name":"William Carey Pkwy at Wisteria Apartments Entrance 3"}},{"stop":{"geometry":{"coordinates":[-89.3014534412177,31.2992089684992],"type":"Point"},"id":1356561001,"stop_id":"1388508","stop_name":"William Carey Pkwy and Dosset St"}},{"stop":{"geometry":{"coordinates":[-89.3077070736567,31.2991945142793],"type":"Point"},"id":1356561002,"stop_id":"1388509","stop_name":"William Carey Pkwy at JR (Just before entering HWY 49)"}},{"stop":{"geometry":{"coordinates":[-89.3146081966283,31.3067914809123],"type":"Point"},"id":1356561003,"stop_id":"1388510","stop_name":"Service Dr and Fred's Pharmacy"}},{"stop":{"geometry":{"coordinates":[-89.3135471469961,31.3095961315695],"type":"Point"},"id":1356561004,"stop_id":"1388511","stop_name":"Service Dr and Carriage Inn"}},{"stop":{"geometry":{"coordinates":[-89.3151330769675,31.3092630674746],"type":"Point"},"id":1356560968,"stop_id":"1385890","stop_name":"On Service Rd at Waffle House"}},{"stop":{"geometry":{"coordinates":[-89.3179970658928,31.3099950212159],"type":"Point"},"id":1356560969,"stop_id":"1385891","stop_name":"On Service Rd near Popeye's Chicken"}},{"stop":{"geometry":{"coordinates":[-89.3183762963819,31.3114651092937],"type":"Point"},"id":1356560970,"stop_id":"1385892","stop_name":"Service Road and Cloverleaf Dr"}},{"stop":{"geometry":{"coordinates":[-89.3194162915476,31.3080127949791],"type":"Point"},"id":1356560971,"stop_id":"1385893","stop_name":"On Service Rd by Walmart"}}],"route_text_color":"ffffff","route_type":3,"route_url":null},"geometry":{"coordinates":[[[-89.3193853904916,31.307936063156948],[-89.31938106027866,31.30761915746049],[-89.31858179126462,31.307615734028825],[-89.31859127255748,31.308239610227332],[-89.31860075385036,31.308392495860083],[-89.31862691072214,31.30854897286261],[-89.31865294912699,31.308642361227825],[-89.31870122430888,31.30879289087172],[-89.31877353375704,31.308945750887155],[-89.31883787676436,31.30905766808877],[-89.31892789025264,31.309163395206483],[-89.31902354898489,31.309246184555704],[-89.3191413174644,31.30932128855502],[-89.31927246955684,31.30937550361858],[-89.31941658732123,31.309409346317306],[-89.31949808736451,31.309424078045307],[-89.3213676451105,31.309437937295005],[-89.3214550825577,31.309458127503728],[-89.3215315632531,31.309499290049345],[-89.32159522281484,31.309565588562734],[-89.32162354249198,31.309623520500118],[-89.3216377396952,31.309710842764158],[-89.32162963995239,31.310610080679893],[-89.32160208815908,31.31068190893942],[-89.32156120184462,31.310747170009112],[-89.32150647269326,31.310802506896454],[-89.321405942605,31.310841466584904],[-89.3212468325453,31.31090321864399],[-89.32097227751511,31.31106071016452],[-89.32075137252754,31.311207115175886],[-89.32059,31.311277115175887],[-89.32045,31.31132711517589],[-89.32036,31.311347115175888],[-89.31993319747497,31.311344845418922],[-89.31986975363222,31.311379234415416],[-89.31986,31.310897115175887],[-89.31981,31.310737115175886],[-89.31874306090891,31.309703272228923],[-89.3187,31.309646181188146],[-89.31853512624714,31.30953021463333],[-89.3183660326691,31.309422040832654],[-89.31788919767293,31.309203081517754],[-89.31768720653342,31.30913494965467],[-89.31748836545032,31.30908066078127],[-89.31710570367711,31.308999812653255],[-89.3168162748096,31.308966250816802],[-89.3165256777419,31.308948176797],[-89.31623914792836,31.308948176796402],[-89.31608069535032,31.30896146690518],[-89.31595414330125,31.308975565332762],[-89.31569216903225,31.30902096208414],[-89.31541629580649,31.30908951643025],[-89.31517418269192,31.309162296250737],[-89.31473314480846,31.309332192847446],[-89.3145494344254,31.309421229166734],[-89.31427407085664,31.309607382031263],[-89.31431536356837,31.30966962814439],[-89.3143166500905,31.309795617772142],[-89.31431,31.310057115175887],[-89.3143,31.311077115175888],[-89.31431,31.31132711517589],[-89.3137,31.31132711517589],[-89.31264176097838,31.311337985029052],[-89.31255961219159,31.31131568084747],[-89.3124437317024,31.311276225297966],[-89.3122594570686,31.311127207876243],[-89.31248,31.31095711517589],[-89.31350445378776,31.310051478060064],[-89.31347053311637,31.310025311906895],[-89.31343278181153,31.30998079655495],[-89.31341852249702,31.30991209290942],[-89.3134704833047,31.30980720246037],[-89.31363197539682,31.309650323013624],[-89.31396061930552,31.309363614580167],[-89.31418278617562,31.309146717723316],[-89.31427279737328,31.309029411989126],[-89.31434576394639,31.30890685086502],[-89.31441662525148,31.308765965844735],[-89.31458621300126,31.308293695668397],[-89.31467324394117,31.308034538962033],[-89.31474137198518,31.30772273020393],[-89.31477448292281,31.307449145073925],[-89.31478126205577,31.307176568456875],[-89.31476855454343,31.30696768415708],[-89.3147488773001,31.306808272076044],[-89.31470000450416,31.306552594494576],[-89.31463709789986,31.30626967153146],[-89.31458010097968,31.30609880887895],[-89.3145153517489,31.305981801972155],[-89.31445298105093,31.30589117076566],[-89.31435034669241,31.305792196595824],[-89.31421784922212,31.305699223235308],[-89.31357556173396,31.305312930286085],[-89.31366600131119,31.30522622939626],[-89.31378076241984,31.3051410128345],[-89.31391608038285,31.305031216323343],[-89.31412,31.304867115175888],[-89.3142,31.304777115175888],[-89.31428,31.304567115175885],[-89.31437,31.304157115175887],[-89.31601,31.304127115175888],[-89.31681,31.304127115175888],[-89.31763,31.30410711517589],[-89.3192,31.304087115175886],[-89.31937,31.304077115175886],[-89.31997,31.304077115175886],[-89.32031,31.304097115175885],[-89.32149,31.30410711517589],[-89.32699,31.304117115175888],[-89.32865,31.304117115175888],[-89.33074,31.304087115175886],[-89.33118,31.304087115175886],[-89.33122,31.302857115175886],[-89.33123,31.299147115175888],[-89.32642,31.299147115175888],[-89.32391,31.299167115175887],[-89.32126,31.299157115175888],[-89.32102,31.29912711517589],[-89.32055,31.299027115175885],[-89.31826,31.298297115175888],[-89.31756,31.298217115175888],[-89.31684,31.29819711517589],[-89.3169,31.298427115175887],[-89.31689,31.298647115175886],[-89.31687,31.298817115175886],[-89.3167,31.29912711517589],[-89.31503,31.301357115175886],[-89.31423,31.30231711517589],[-89.31362,31.302837115175887],[-89.31348,31.302947115175886],[-89.31322,31.303117115175887],[-89.31284546001778,31.303328474786195],[-89.31232,31.303617115175886],[-89.31167,31.303997115175886],[-89.31126,31.304247115175887],[-89.31072,31.304707115175887],[-89.30949,31.305817115175888],[-89.30919,31.306027115175887],[-89.30883,31.306387115175887],[-89.30823,31.306887115175886],[-89.30642,31.308467115175887],[-89.30538,31.309337115175886],[-89.30439,31.310227115175888],[-89.30388,31.309787115175887],[-89.30334,31.309347115175886],[-89.30283,31.30889711517589],[-89.29986,31.31152711517589],[-89.29959,31.311727115175888],[-89.29953,31.311757115175887],[-89.29944,31.311757115175887],[-89.29943,31.311507115175885],[-89.29944,31.310787115175888],[-89.29943,31.310177115175886],[-89.29943,31.309537115175885],[-89.29945,31.308267115175887],[-89.29946,31.306187115175888],[-89.29568,31.306197115175888],[-89.29408,31.306217115175887],[-89.2941,31.305577115175886],[-89.2941,31.304787115175888],[-89.29409,31.304247115175887],[-89.29409,31.303477115175887],[-89.2941,31.302857115175886],[-89.29409,31.302767115175886],[-89.29408,31.301727115175886],[-89.29411,31.301337115175887],[-89.29416,31.301077115175886],[-89.29422,31.30091711517589],[-89.29441,31.300567115175888],[-89.29454,31.300387115175887],[-89.29479,31.300117115175887],[-89.29529,31.299757115175886],[-89.29544,31.299657115175886],[-89.29606,31.299387115175886],[-89.29651,31.299297115175886],[-89.2976,31.299247115175888],[-89.30031,31.299157115175888],[-89.30139,31.29913711517589],[-89.30571,31.299097115175886],[-89.30816,31.299147115175888],[-89.30841,31.299157115175888],[-89.30863,31.29940711517589],[-89.30902,31.299897115175888],[-89.30977,31.300747115175888],[-89.31091,31.301927115175886],[-89.31141,31.302427115175888],[-89.31251319202994,31.30343412515319],[-89.31323232862366,31.30415349015898],[-89.31375,31.304657115175885],[-89.31380393283162,31.304749094058266],[-89.31380757742231,31.304884039998665],[-89.31377810028201,31.30501413199023],[-89.31374071083818,31.30509731397478],[-89.31361658321026,31.30519858077668],[-89.31349221920763,31.305310429843125],[-89.31419471080369,31.305736276421683],[-89.31431642896129,31.30582469529785],[-89.31441029957847,31.30591295315413],[-89.3144721732506,31.305994864877537],[-89.3145344833578,31.306111544782603],[-89.31458994251378,31.30627861909536],[-89.31463152965765,31.30646334905113],[-89.31469125536105,31.306771455869217],[-89.31472160884114,31.306971083437652],[-89.31473418441853,31.307173721731722],[-89.31472820444874,31.3074431896026],[-89.31469756006568,31.307716865760494],[-89.31462449328735,31.308032323439463],[-89.31456712400148,31.308205157967862],[-89.31446545730661,31.308495655005398],[-89.31436876345876,31.308762360843417],[-89.31430197645274,31.308888919534517],[-89.31423193549574,31.309003427138144],[-89.31414380018113,31.30912429029217],[-89.31392970188192,31.309337588526365],[-89.3135745556538,31.30964333357771],[-89.3134247520338,31.309792341603263],[-89.313373360653,31.309909366594038],[-89.3133877045565,31.309996800895274],[-89.31344090421561,31.310050418076678],[-89.31353297443056,31.310097802382046],[-89.31360526816334,31.310120491977873],[-89.31365512111385,31.310123939185477],[-89.31370623248446,31.310117307169232],[-89.31373684239273,31.31009373151419],[-89.31408,31.309807115175886],[-89.31431525792347,31.3096238535058],[-89.31457397140132,31.30945866440347],[-89.31473402112935,31.309377863881135],[-89.31512335609868,31.309219946672943],[-89.31542681165303,31.30912770050732],[-89.31570619016162,31.309059146188993],[-89.31597612178848,31.309012077959512],[-89.31609534767514,31.30899797953176],[-89.31623784402915,31.308988281595358],[-89.31650742315274,31.30899050963725],[-89.3168016224853,31.309002763441022],[-89.3170812831359,31.30903841169804],[-89.31728514119523,31.30907573510654],[-89.3176598217051,31.30917066076757],[-89.31786487375352,31.309239875347732],[-89.31810846954585,31.30934312357355],[-89.31807,31.309427115175886],[-89.31806,31.309617115175886],[-89.31807,31.309747115175888],[-89.31807,31.310257115175887],[-89.3180593789097,31.311073364150623],[-89.31806548805245,31.311400635828882],[-89.31851,31.311417115175885],[-89.31983042535715,31.31142191636357],[-89.31994,31.311458737070165],[-89.32042795518221,31.311455067184383],[-89.3205666361825,31.31139502734597],[-89.32086482742746,31.311266918194516],[-89.32101346789267,31.31117661077488],[-89.3214385938548,31.31091504921615],[-89.32160839754133,31.31076970474295],[-89.32165078113876,31.310702453438697],[-89.32168667749882,31.310613030538565],[-89.32169667749939,31.310522480754603],[-89.3216838253899,31.31010810385648],[-89.32167586448668,31.30970501789498],[-89.32166360569849,31.30961098598926],[-89.32162891420259,31.309541164940626],[-89.32155798032424,31.30947378884946],[-89.32147151595736,31.309423765825297],[-89.32136750040284,31.309401625728515],[-89.31984032508045,31.30939457827574],[-89.31983817980618,31.30920164828046],[-89.31980496290608,31.309141545800664],[-89.31977250706991,31.309080016583465],[-89.319394576056,31.308693522114453],[-89.31936025645352,31.308646161993394],[-89.3193600605135,31.308425177212932],[-89.31936159029672,31.308300956079087],[-89.3193624635129,31.308161783064968],[-89.31936011732648,31.30796574980159]]],"type":"MultiLineString"}}]`),I_={type:fv,features:pv},mv="FeatureCollection",_v=JSON.parse(`[{"type":"Feature","properties":{"agency":{"agency_id":null,"agency_name":"Hub City Transit","id":1890805,"onestop_id":""},"continuous_drop_off":null,"continuous_pickup":null,"feed_version":{"feed":{"id":8455,"onestop_id":"f-hattiesburg~mi~us"},"fetched_at":"2025-05-05T23:01:08.61939Z","id":519462,"sha1":"90988e5e23049b2c4856de4c2ea055d91a8e2e80"},"id":75585143,"onestop_id":"r-dj86p-orangeline","route_color":"ff8000","route_desc":"Serves Broadway Dr starting at the Train Depot 6:30 AM - 5:50 PM M-F","route_id":"35784","route_long_name":"Broadway Drive","route_short_name":"Orange Line","route_sort_order":null,"route_stops":[{"stop":{"geometry":{"coordinates":[-89.2843495315612,31.3251339561727],"type":"Point"},"id":1356560951,"stop_id":"1367944","stop_name":"River Ave and Williams St"}},{"stop":{"geometry":{"coordinates":[-89.2801464352758,31.3240867925993],"type":"Point"},"id":1356560952,"stop_id":"1367945","stop_name":"Mc Innis and Tipton"}},{"stop":{"geometry":{"coordinates":[-89.2800842752982,31.3191557749601],"type":"Point"},"id":1356560953,"stop_id":"1367946","stop_name":"Tipton St and Rebecca St"}},{"stop":{"geometry":{"coordinates":[-89.2800990041954,31.3158285071163],"type":"Point"},"id":1356560954,"stop_id":"1367947","stop_name":"Tipton St and Alcorn St"}},{"stop":{"geometry":{"coordinates":[-89.2829332258647,31.3157536352051],"type":"Point"},"id":1356560955,"stop_id":"1367948","stop_name":"James St and Alcorn St"}},{"stop":{"geometry":{"coordinates":[-89.2852110737369,31.31574095021],"type":"Point"},"id":1356560956,"stop_id":"1385885","stop_name":"Edwards St and Katie St"}},{"stop":{"geometry":{"coordinates":[-89.2851544520811,31.3118933040222],"type":"Point"},"id":1356560957,"stop_id":"1367949","stop_name":"Edwards St and Duke St"}},{"stop":{"geometry":{"coordinates":[-89.2851478150119,31.3063114417649],"type":"Point"},"id":1356560958,"stop_id":"1367950","stop_name":"Edwards St and Tuscan Av"}},{"stop":{"geometry":{"coordinates":[-89.2940443312992,31.3064427550022],"type":"Point"},"id":1356560959,"stop_id":"1385886","stop_name":"William Carey and Tuscan Av"}},{"stop":{"geometry":{"coordinates":[-89.294090185187,31.310146228359],"type":"Point"},"id":1356560960,"stop_id":"1367952","stop_name":"Cypress St and Penton St"}},{"stop":{"geometry":{"coordinates":[-89.2945810246565,31.3126948297318],"type":"Point"},"id":1356560961,"stop_id":"1367953","stop_name":"Wills Av and John St"}},{"stop":{"geometry":{"coordinates":[-89.2953518852317,31.3156559990767],"type":"Point"},"id":1356560962,"stop_id":"1367954","stop_name":"Katie St and Charles St"}},{"stop":{"geometry":{"coordinates":[-89.2931135537024,31.3173725799469],"type":"Point"},"id":1356560963,"stop_id":"1367955","stop_name":"Hall St and Dabbs St"}},{"stop":{"geometry":{"coordinates":[-89.2993402984088,31.3189292075893],"type":"Point"},"id":1356560964,"stop_id":"1367956","stop_name":"6th Av and W Pine St"}},{"stop":{"geometry":{"coordinates":[-89.3037639980992,31.316692613555],"type":"Point"},"id":1356560965,"stop_id":"1385887","stop_name":"Broadway Dr and Corinne St"}},{"stop":{"geometry":{"coordinates":[-89.3091621994972,31.3140132363447],"type":"Point"},"id":1356560966,"stop_id":"1385888","stop_name":"Broadway Dr and Timothy Ln"}},{"stop":{"geometry":{"coordinates":[-89.3129647451053,31.3114047192282],"type":"Point"},"id":1356560967,"stop_id":"1385889","stop_name":"Bartur St and Broadway St"}},{"stop":{"geometry":{"coordinates":[-89.3151330769675,31.3092630674746],"type":"Point"},"id":1356560968,"stop_id":"1385890","stop_name":"On Service Rd at Waffle House"}},{"stop":{"geometry":{"coordinates":[-89.3179970658928,31.3099950212159],"type":"Point"},"id":1356560969,"stop_id":"1385891","stop_name":"On Service Rd near Popeye's Chicken"}},{"stop":{"geometry":{"coordinates":[-89.3183762963819,31.3114651092937],"type":"Point"},"id":1356560970,"stop_id":"1385892","stop_name":"Service Road and Cloverleaf Dr"}},{"stop":{"geometry":{"coordinates":[-89.3194162915476,31.3080127949791],"type":"Point"},"id":1356560971,"stop_id":"1385893","stop_name":"On Service Rd by Walmart"}},{"stop":{"geometry":{"coordinates":[-89.3222510429146,31.3046300422935],"type":"Point"},"id":1356560972,"stop_id":"1385894","stop_name":"Roosevelt Blvd Before Lincoln Rd"}},{"stop":{"geometry":{"coordinates":[-89.3180378425613,31.3040597932265],"type":"Point"},"id":1356560973,"stop_id":"1385895","stop_name":"Lincoln Rd at Central Sunbelt Bank"}},{"stop":{"geometry":{"coordinates":[-89.3132125968914,31.3055613014402],"type":"Point"},"id":1356560974,"stop_id":"1385896","stop_name":"W Pine St by Service Dr"}},{"stop":{"geometry":{"coordinates":[-89.3081012881611,31.3111239317139],"type":"Point"},"id":1356560975,"stop_id":"1385897","stop_name":"W Pine St by Health Dept"}},{"stop":{"geometry":{"coordinates":[-89.3089717626572,31.3138187962352],"type":"Point"},"id":1356560976,"stop_id":"1385898","stop_name":"Timothy Ln and Broadway"}},{"stop":{"geometry":{"coordinates":[-89.3056902858072,31.3160356417566],"type":"Point"},"id":1356560977,"stop_id":"1385899","stop_name":"Broadway Dr and Florence Ave"}},{"stop":{"geometry":{"coordinates":[-89.2994767427444,31.3187477291146],"type":"Point"},"id":1356560978,"stop_id":"1385900","stop_name":"W Pine St and 6th Ave"}},{"stop":{"geometry":{"coordinates":[-89.2940073643773,31.3234807597899],"type":"Point"},"id":1356560979,"stop_id":"1385901","stop_name":"W Pine St and 1st Ave"}},{"stop":{"geometry":{"coordinates":[-89.2906488930477,31.3254823550539],"type":"Point"},"id":1356560892,"stop_id":"1366117","stop_name":"Front St and Forrest St."}},{"stop":{"geometry":{"coordinates":[-89.2892369500362,31.3260193257079],"type":"Point"},"id":1356560893,"stop_id":"1366118","stop_name":"Main St and Short St"}},{"stop":{"geometry":{"coordinates":[-89.2856817900802,31.3277713914326],"type":"Point"},"id":1356560846,"stop_id":"1366007","stop_name":"Train Depot"}}],"route_text_color":null,"route_type":3,"route_url":null},"geometry":{"coordinates":[[[-89.28569180216383,31.32771797066437],[-89.28574326001139,31.327660654651158],[-89.28570299789234,31.32755654216097],[-89.28567,31.32753],[-89.28563291371007,31.32748968761651],[-89.28578956179898,31.327353541303687],[-89.2859655663827,31.327175874688738],[-89.28611617015882,31.32700174413074],[-89.2862949899346,31.326862028619498],[-89.28532,31.326],[-89.28502,31.32572],[-89.28455284805948,31.32537505800087],[-89.28414955711587,31.325097644841026],[-89.28405868157648,31.325054527052508],[-89.28395320689962,31.325036351350747],[-89.28306,31.32505],[-89.28228,31.32505],[-89.28117,31.32507],[-89.28005,31.32507],[-89.28007,31.32413],[-89.28007,31.32319],[-89.28003,31.32121],[-89.28004,31.32042],[-89.28003,31.31911],[-89.28005,31.31836],[-89.28003,31.31752],[-89.28003,31.31575],[-89.28206,31.31572],[-89.28302,31.31569],[-89.28332,31.31609],[-89.28346,31.31614],[-89.28368,31.31619],[-89.28414,31.31619],[-89.28438,31.31623],[-89.28473,31.31635],[-89.28499,31.31647],[-89.28506,31.31641],[-89.28507,31.31635],[-89.28508,31.31548],[-89.28507,31.31514],[-89.28507,31.3124],[-89.28506,31.31201],[-89.28505,31.30991],[-89.28509,31.30891],[-89.28507,31.30622],[-89.28784,31.3062],[-89.2894,31.30622],[-89.29038,31.3062],[-89.29096,31.30621],[-89.29256,31.30621],[-89.29307,31.3062],[-89.29408,31.30622],[-89.29411,31.30755],[-89.2941,31.30889],[-89.29414,31.3102],[-89.2947,31.3102],[-89.29468,31.31148],[-89.29472,31.31353],[-89.29624,31.31352],[-89.29626,31.3143],[-89.29623,31.3154],[-89.29624,31.31575],[-89.29477,31.31577],[-89.29319,31.31576],[-89.29319,31.3175],[-89.29348,31.31751],[-89.29562598826772,31.31752905621943],[-89.29606048942779,31.317532641473957],[-89.2967931703365,31.317487736404328],[-89.29722,31.31751],[-89.29738,31.31751],[-89.2977188061989,31.317543773270412],[-89.29791972595505,31.317592263572184],[-89.2979516438297,31.317701697641233],[-89.29806690802452,31.31780641466949],[-89.29922568400096,31.318796418324656],[-89.29941010599732,31.318961562492326],[-89.29967,31.31872],[-89.30105429157607,31.317513238270784],[-89.30135423404991,31.317256293509875],[-89.30146908710263,31.317185202073752],[-89.30165067345844,31.317113247751887],[-89.30184141105678,31.31706214126821],[-89.30300074191406,31.316795751431606],[-89.30416315493797,31.316516898003524],[-89.30518290890856,31.31628220064735],[-89.30568329232584,31.31617249137621],[-89.30605845869654,31.31606252357286],[-89.3063178399988,31.315974997209473],[-89.30654026980086,31.315890381601825],[-89.3068200754294,31.315752169951573],[-89.30709085550575,31.315614978973432],[-89.30745,31.31537],[-89.30764390884495,31.315220844141823],[-89.30814337579193,31.314798889953785],[-89.30916514872261,31.313893299042206],[-89.31015,31.31301],[-89.31045,31.31273],[-89.31081,31.31241],[-89.31114,31.31213],[-89.31205,31.31132],[-89.31226466393166,31.311126579091898],[-89.3124133899162,31.311271165499285],[-89.31255423925951,31.311335],[-89.31277,31.31135],[-89.3137,31.31133],[-89.31431,31.31133],[-89.31431,31.31006],[-89.31431,31.30962],[-89.31451,31.30949],[-89.31472,31.30938],[-89.31497,31.30927],[-89.31522,31.30918],[-89.31558,31.30908],[-89.31576,31.30904],[-89.31611,31.30898],[-89.31629,31.30897],[-89.3166,31.30897],[-89.31687,31.30899],[-89.31703,31.30901],[-89.31735,31.30907],[-89.31768,31.30916],[-89.31798,31.30927],[-89.31812,31.30933],[-89.31807,31.30943],[-89.31806,31.30962],[-89.31807,31.30981],[-89.31807,31.31026],[-89.31806336920928,31.311082636278307],[-89.31806752111767,31.311411683582698],[-89.31847,31.31142],[-89.31982525907644,31.311427682786885],[-89.31993678059176,31.311389145073385],[-89.32007,31.31139],[-89.32042644979698,31.31137286848467],[-89.3207042938509,31.311249233182714],[-89.3210079041524,31.31108736372185],[-89.32119040654399,31.31097008964701],[-89.32139876596455,31.31088227049396],[-89.32148576258395,31.310842321496047],[-89.32155248497325,31.31078505099723],[-89.3216099314425,31.310728660763754],[-89.32165,31.31065],[-89.32166,31.31056],[-89.32166974351068,31.31007853953176],[-89.32164,31.30965],[-89.32161,31.30957],[-89.32156,31.3095],[-89.3215,31.30945],[-89.32143,31.30942],[-89.31984,31.30942],[-89.31983,31.30924],[-89.3198,31.30912],[-89.31975,31.30905],[-89.31938,31.30868],[-89.31936910140907,31.308646371055847],[-89.31937,31.30861],[-89.31937,31.30763],[-89.31861,31.30763],[-89.31861,31.3067],[-89.31862,31.30655],[-89.31864,31.30637],[-89.3186708018794,31.30624134787834],[-89.31873,31.30611],[-89.31883,31.30593],[-89.31898448427478,31.305689394603775],[-89.31911,31.30553],[-89.31919,31.30543],[-89.31925,31.30537],[-89.31934,31.30532],[-89.31944,31.30528],[-89.32004,31.30526],[-89.32174,31.30523],[-89.32186,31.30522],[-89.32197,31.30519],[-89.32206805188778,31.305123409588557],[-89.32213463737149,31.305043747381877],[-89.32219048901413,31.304876456125555],[-89.32219201886832,31.304473180775492],[-89.32219,31.30411],[-89.31997,31.30408],[-89.31937,31.30408],[-89.31763,31.30411],[-89.31681,31.30413],[-89.31601,31.30413],[-89.31437,31.30416],[-89.31428,31.30457],[-89.3142,31.30478],[-89.31412,31.30487],[-89.31381,31.30508],[-89.31374,31.30515],[-89.31354,31.30531],[-89.31275,31.30623],[-89.3101,31.30937],[-89.30969,31.30982],[-89.30935,31.31015],[-89.30708,31.31214],[-89.3081,31.31301],[-89.30909177942138,31.31387680382899],[-89.30784933293266,31.314960756095736],[-89.30753217936712,31.315227135459175],[-89.30728884409328,31.31541468478436],[-89.30698569810592,31.315600967522542],[-89.3067648257858,31.31572254213417],[-89.30651558336997,31.31583203342516],[-89.30629792993936,31.315922834908896],[-89.30605280180266,31.316008577708494],[-89.30560865678466,31.31612894828385],[-89.30412620564267,31.316468214828845],[-89.30276931734576,31.31678172052393],[-89.30158772865823,31.31706649466785],[-89.30143662936005,31.317127895982118],[-89.30130554743538,31.317209154663633],[-89.30100525977701,31.317469501827595],[-89.29964738064267,31.318671691309888],[-89.29933858981784,31.318966293695972],[-89.29915913560761,31.319121392385743],[-89.29834070853585,31.319819444313374],[-89.29617,31.32177],[-89.2953,31.32251],[-89.29505,31.32271],[-89.29481,31.32293],[-89.29447,31.32321],[-89.29402,31.32362],[-89.2930990531203,31.324396098589478],[-89.29284942963443,31.324614480025414],[-89.29275886486325,31.324726950795004],[-89.29239,31.32473],[-89.29182,31.32473],[-89.29174,31.324734999999997],[-89.2916645324979,31.324743276152184],[-89.29163,31.32475],[-89.29154,31.3248],[-89.29143,31.32488],[-89.29132,31.325],[-89.29104,31.32522],[-89.28965,31.32645],[-89.28916,31.32601],[-89.28897,31.32585],[-89.28884,31.32574],[-89.2882,31.32523],[-89.2866,31.32664],[-89.28648510112389,31.32671058442174],[-89.28630237896033,31.32680120306827],[-89.28607762849225,31.326976110178094],[-89.28600653402032,31.327062121946117],[-89.28592239500512,31.327161710414494],[-89.28577474250469,31.327313261561006],[-89.28534734524298,31.327685435622037],[-89.28547339107097,31.327786822667832],[-89.28554389423263,31.327797103146416],[-89.28560975895779,31.32775644924484],[-89.28565577458224,31.327728698198463],[-89.28566700060487,31.327716034510374]]],"type":"MultiLineString"}}]`),z0={type:mv,features:_v},gv="FeatureCollection",yv=JSON.parse('[{"type":"Feature","properties":{"agency":{"agency_id":null,"agency_name":"Hub City Transit","id":1890805,"onestop_id":""},"continuous_drop_off":null,"continuous_pickup":null,"feed_version":{"feed":{"id":8455,"onestop_id":"f-hattiesburg~mi~us"},"fetched_at":"2025-05-05T23:01:08.61939Z","id":519462,"sha1":"90988e5e23049b2c4856de4c2ea055d91a8e2e80"},"id":75585144,"onestop_id":"r-dj86r-brownline","route_color":"3d0000","route_desc":"Serves 7th Street starting at the Train Depot 6:30 AM - 5:45 PM M-F","route_id":"35785","route_long_name":"7th Street","route_short_name":"Brown Line","route_sort_order":null,"route_stops":[{"stop":{"geometry":{"coordinates":[-89.287445727134,31.3306765777165],"type":"Point"},"id":1356560921,"stop_id":"1385902","stop_name":"Briarfield Apt and E 2nd"}},{"stop":{"geometry":{"coordinates":[-89.2899161896129,31.3300191407249],"type":"Point"},"id":1356560922,"stop_id":"1385903","stop_name":"E 2nd St and Mobile St"}},{"stop":{"geometry":{"coordinates":[-89.2899402738049,31.3319739775249],"type":"Point"},"id":1356560923,"stop_id":"1385904","stop_name":"Mobile St and E 4th St"}},{"stop":{"geometry":{"coordinates":[-89.2899071009577,31.3356230155597],"type":"Point"},"id":1356560924,"stop_id":"1385905","stop_name":"Mobile St and E 7th St"}},{"stop":{"geometry":{"coordinates":[-89.2843948809792,31.3356513886719],"type":"Point"},"id":1356560925,"stop_id":"1385906","stop_name":"E 7th St and Fairley St"}},{"stop":{"geometry":{"coordinates":[-89.2871719364928,31.338446478662],"type":"Point"},"id":1356560926,"stop_id":"1385907","stop_name":"E 9th St and Bouie St"}},{"stop":{"geometry":{"coordinates":[-89.2899459840991,31.3382330287792],"type":"Point"},"id":1356560927,"stop_id":"1385908","stop_name":"E 9th St and Mobile St"}},{"stop":{"geometry":{"coordinates":[-89.2923944559319,31.3382305245324],"type":"Point"},"id":1356560928,"stop_id":"1385909","stop_name":"E 9th St and Memphis"}},{"stop":{"geometry":{"coordinates":[-89.2943723325733,31.3406206205866],"type":"Point"},"id":1356560929,"stop_id":"1385910","stop_name":"Coit St and Lula"}},{"stop":{"geometry":{"coordinates":[-89.2943633894262,31.3429280238037],"type":"Point"},"id":1356560930,"stop_id":"1385911","stop_name":"Coit st and Hwy 42"}},{"stop":{"geometry":{"coordinates":[-89.3012833950347,31.3424593659563],"type":"Point"},"id":1356560931,"stop_id":"1385912","stop_name":"US Hwy 42 and Redus St"}},{"stop":{"geometry":{"coordinates":[-89.3073232061319,31.3425802165947],"type":"Point"},"id":1356560932,"stop_id":"1385913","stop_name":"US Hwy 42 and Glendale Ave"}},{"stop":{"geometry":{"coordinates":[-89.3149678491626,31.3464549941585],"type":"Point"},"id":1356560933,"stop_id":"1385914","stop_name":"US Hwy 42 and Pritchard St"}},{"stop":{"geometry":{"coordinates":[-89.3245017166807,31.3467774975838],"type":"Point"},"id":1356560934,"stop_id":"1385915","stop_name":"US Hwy 42 and Cahal St"}},{"stop":{"geometry":{"coordinates":[-89.3315773893576,31.3473565844473],"type":"Point"},"id":1356560935,"stop_id":"1385916","stop_name":"US Hwy 42 at Health Dept."}},{"stop":{"geometry":{"coordinates":[-89.3351048734133,31.3484846944084],"type":"Point"},"id":1356560936,"stop_id":"1385917","stop_name":"Service Dr and N 31st Ave"}},{"stop":{"geometry":{"coordinates":[-89.3353110551834,31.3476485718187],"type":"Point"},"id":1356560937,"stop_id":"1385918","stop_name":"N 31st and Hwy 49"}},{"stop":{"geometry":{"coordinates":[-89.3376298236491,31.3467463239216],"type":"Point"},"id":1356560938,"stop_id":"1385919","stop_name":"Campbell Dr at Mark Apartment"}},{"stop":{"geometry":{"coordinates":[-89.3432124749506,31.3467173018038],"type":"Point"},"id":1356560939,"stop_id":"1385920","stop_name":"Campbell Dr and Overlook Apartments"}},{"stop":{"geometry":{"coordinates":[-89.3483920709287,31.3455930519952],"type":"Point"},"id":1356560940,"stop_id":"1385921","stop_name":"Beverly Hills Dr and Plantation Apartments"}},{"stop":{"geometry":{"coordinates":[-89.3440178300602,31.3396315328068],"type":"Point"},"id":1356560941,"stop_id":"1385922","stop_name":"Bevelry Hills and 37th"}},{"stop":{"geometry":{"coordinates":[-89.3354965265912,31.3356003565013],"type":"Point"},"id":1356560942,"stop_id":"1385923","stop_name":"W 7th St and N 31st Ave"}},{"stop":{"geometry":{"coordinates":[-89.3294209241867,31.3355903530327],"type":"Point"},"id":1356560943,"stop_id":"1385924","stop_name":"W 7th St and Service Dr"}},{"stop":{"geometry":{"coordinates":[-89.3278738681988,31.3356182030222],"type":"Point"},"id":1356560944,"stop_id":"1385925","stop_name":"W 7th St and 25th Ave"}},{"stop":{"geometry":{"coordinates":[-89.3195438521976,31.3356433916029],"type":"Point"},"id":1356560945,"stop_id":"1385926","stop_name":"W 7th St and 19th St"}},{"stop":{"geometry":{"coordinates":[-89.3136948641916,31.3356492741896],"type":"Point"},"id":1356560946,"stop_id":"1385927","stop_name":"W 7th St and Oliver Av"}},{"stop":{"geometry":{"coordinates":[-89.3058380739027,31.33574448843],"type":"Point"},"id":1356560947,"stop_id":"1385928","stop_name":"W 7th St and North St"}},{"stop":{"geometry":{"coordinates":[-89.2992106032615,31.3356459942324],"type":"Point"},"id":1356560948,"stop_id":"1385929","stop_name":"W 7th St and Main St"}},{"stop":{"geometry":{"coordinates":[-89.2967385556643,31.3321942916169],"type":"Point"},"id":1356560949,"stop_id":"1385930","stop_name":"Main St and 4th St"}},{"stop":{"geometry":{"coordinates":[-89.2916841172962,31.3277841054219],"type":"Point"},"id":1356560950,"stop_id":"1385931","stop_name":"Main St and Eaton St"}},{"stop":{"geometry":{"coordinates":[-89.2892369500362,31.3260193257079],"type":"Point"},"id":1356560893,"stop_id":"1366118","stop_name":"Main St and Short St"}},{"stop":{"geometry":{"coordinates":[-89.2856817900802,31.3277713914326],"type":"Point"},"id":1356560846,"stop_id":"1366007","stop_name":"Train Depot"}}],"route_text_color":"ffffff","route_type":3,"route_url":null},"geometry":{"coordinates":[[[-89.28568253698313,31.327733862308985],[-89.28574414612527,31.327661527404054],[-89.28569268220205,31.327550384383464],[-89.28563554206845,31.327487662720884],[-89.28580512211188,31.327336695364977],[-89.28595179266571,31.32718422849407],[-89.28603671074549,31.327087443516223],[-89.28611607262768,31.32699838584155],[-89.28629094565896,31.326861286283858],[-89.28658132447578,31.32670905001583],[-89.28664092616347,31.326656620588896],[-89.28710277431742,31.326248346136865],[-89.28737,31.32644],[-89.28766,31.32666],[-89.28784,31.32678],[-89.28849,31.32718],[-89.28895,31.32758],[-89.2893609775237,31.327939531184214],[-89.28882342864738,31.328404874968502],[-89.28868078201896,31.328516500004135],[-89.28853039100949,31.328598593781347],[-89.28839097752315,31.328674187493558],[-89.2882275488763,31.328750218852978],[-89.28806627078053,31.32887209374258],[-89.28758710790615,31.32927618019192],[-89.2868737066895,31.32988490721692],[-89.28758,31.33049],[-89.2881,31.33004],[-89.28828908358079,31.329881359539137],[-89.28840248479672,31.329937181701105],[-89.28902,31.32994],[-89.28985,31.32992],[-89.29000700608191,31.32987590849742],[-89.29000241662335,31.3302239268826],[-89.28998,31.3357],[-89.28852,31.33568],[-89.28793,31.33569],[-89.28726,31.33568],[-89.28581,31.33571],[-89.28435,31.33569],[-89.28434,31.33624],[-89.28432,31.33656],[-89.28433302337521,31.338371749873836],[-89.28726151168763,31.338359187678503],[-89.288,31.33833],[-89.28830265765794,31.33831299961058],[-89.2886722274779,31.338233687426715],[-89.2891336313171,31.338213079131137],[-89.2899781054694,31.338209528057188],[-89.29078,31.33818],[-89.2943616859548,31.338174357746684],[-89.29438,31.33939],[-89.29442,31.3398928300044],[-89.29445039914943,31.340083280043658],[-89.29440845738641,31.342146115564667],[-89.2944,31.343],[-89.29506,31.34319],[-89.29552,31.34332],[-89.29581,31.34339],[-89.29614,31.34346],[-89.29642,31.3435],[-89.2967,31.34353],[-89.29692,31.34354],[-89.29715,31.34354],[-89.29797,31.34352],[-89.29849,31.34346],[-89.29882,31.34341],[-89.29918,31.34332],[-89.29973,31.34315],[-89.30008,31.34302],[-89.30137263765171,31.3423257789942],[-89.30255190350876,31.34161222399144],[-89.30285,31.34153],[-89.30326,31.34153],[-89.30388,31.3416],[-89.30532,31.34184],[-89.30601,31.341967776147598],[-89.30650373886644,31.342118668599912],[-89.30688,31.34227],[-89.30726,31.34243],[-89.30809,31.34288],[-89.30854,31.34315],[-89.31005,31.34403],[-89.31099,31.34457],[-89.31166,31.34498],[-89.3124,31.3454],[-89.3131,31.34575],[-89.31377,31.34602],[-89.31405,31.34612],[-89.31434,31.34621],[-89.31458,31.34628],[-89.31492,31.34636],[-89.31609,31.34657],[-89.31675,31.34662],[-89.31739,31.34665],[-89.3194301649938,31.34665316032758],[-89.32142,31.34666],[-89.32196,31.34666],[-89.32275123515859,31.34666212228756],[-89.32458,31.34667],[-89.32766,31.34668],[-89.32894,31.34674],[-89.32983,31.34682],[-89.33081,31.34694],[-89.33089177309976,31.34695931996253],[-89.33087824473742,31.347075480000264],[-89.33088707456184,31.347122466671358],[-89.33094471637469,31.34715246667312],[-89.33103059400598,31.347164933348644],[-89.33137,31.34722],[-89.33176,31.3473],[-89.33215,31.34739],[-89.3332,31.34766],[-89.33376,31.34783],[-89.33431,31.34802],[-89.33476,31.34819],[-89.33520844103143,31.348376338548835],[-89.33519996655592,31.34825048898672],[-89.33522997909728,31.348047103163083],[-89.33526,31.34665],[-89.33773,31.34666],[-89.33947,31.34664],[-89.34177,31.34663],[-89.34219,31.34664],[-89.34555,31.34665],[-89.34862,31.34669],[-89.35065,31.34668],[-89.35065,31.34662],[-89.35062,31.34654],[-89.35054,31.34648],[-89.35048,31.34645],[-89.35029,31.34642],[-89.34974,31.34636],[-89.34946,31.34631],[-89.34931,31.34626],[-89.34907,31.34613],[-89.3486,31.34583],[-89.34776,31.34526],[-89.34755227853093,31.345079729968496],[-89.34701000098413,31.34440648794532],[-89.34691,31.34426],[-89.34672,31.34405],[-89.34651,31.34388],[-89.34633,31.34375],[-89.34605,31.34359],[-89.34577,31.34346],[-89.34567,31.34339],[-89.34559,31.34332],[-89.34553,31.34324],[-89.34542525315162,31.34301945317975],[-89.34527,31.34256],[-89.34473050407148,31.340936312498343],[-89.34461,31.34069],[-89.34449,31.34048],[-89.34438,31.34026],[-89.34425,31.34006],[-89.34386,31.3395],[-89.34379,31.33934],[-89.34377,31.33926],[-89.34375,31.33915],[-89.34375,31.33868],[-89.34375892408147,31.3384],[-89.34377,31.3382],[-89.34385,31.33733],[-89.34384,31.3359],[-89.34359,31.33592],[-89.34261,31.33586],[-89.33577,31.33574],[-89.33543,31.33574],[-89.333761264268,31.335714094433857],[-89.33187,31.3357],[-89.33089,31.3357],[-89.33044,31.33569],[-89.32896,31.33569],[-89.32805,31.33568],[-89.32643,31.3357],[-89.3254,31.33569],[-89.32425,31.3357],[-89.32392,31.33569],[-89.32274,31.3357],[-89.31568,31.3357],[-89.31226456852684,31.335749541664775],[-89.3099,31.33576],[-89.30897,31.33576],[-89.30843,31.33577],[-89.30799,31.33576],[-89.3067,31.33577],[-89.30534,31.33577],[-89.30516,31.33576],[-89.30483,31.33571],[-89.30458,31.33569],[-89.30428,31.33568],[-89.29958,31.33568],[-89.29908,31.33569],[-89.29795,31.3339],[-89.29755,31.33328],[-89.2971,31.33271],[-89.29655,31.3321],[-89.29573,31.33092],[-89.29499,31.32989],[-89.29484,31.3297],[-89.29458,31.32941],[-89.29379,31.32867],[-89.29359,31.32855],[-89.29279,31.32828],[-89.29172,31.32789],[-89.29148,31.32778],[-89.29115,31.32767],[-89.29107,31.32762],[-89.29096,31.32754],[-89.29082,31.32741],[-89.2904,31.32707],[-89.29016,31.32685],[-89.28989,31.32665],[-89.28965,31.32645],[-89.28819309635416,31.325196581954554],[-89.28675776779794,31.326492308891307],[-89.28653168810658,31.32668252646841],[-89.28631615922731,31.32679648158212],[-89.28610320030418,31.32695340325904],[-89.28604236076794,31.32702572523434],[-89.28598616539774,31.327094501640204],[-89.28593233505869,31.327156310861163],[-89.28577091931653,31.32732384918194],[-89.28534256216527,31.327705587791918],[-89.28546766284973,31.3278064604068],[-89.28554938736177,31.32781199358029],[-89.2856708789903,31.327741170651997]]],"type":"MultiLineString"}}]'),D0={type:gv,features:yv},vv="FeatureCollection",xv=JSON.parse(`[{"type":"Feature","properties":{"agency":{"agency_id":null,"agency_name":"Hub City Transit","id":1890805,"onestop_id":""},"continuous_drop_off":null,"continuous_pickup":null,"feed_version":{"feed":{"id":8455,"onestop_id":"f-hattiesburg~mi~us"},"fetched_at":"2025-05-05T23:01:08.61939Z","id":519462,"sha1":"90988e5e23049b2c4856de4c2ea055d91a8e2e80"},"id":75585145,"onestop_id":"r-dj8d0-purpleline","route_color":"aa00aa","route_desc":"Serves Palmer's crossing starting at the Train Depot 7:00 AM - 5:00 PM M-F","route_id":"35786","route_long_name":"Palmer's Crossing","route_short_name":"Purple Line","route_sort_order":null,"route_stops":[{"stop":{"geometry":{"coordinates":[-89.2873560913541,31.3243410204752],"type":"Point"},"id":1356561005,"stop_id":"1388513","stop_name":"Main St and Buschman St"}},{"stop":{"geometry":{"coordinates":[-89.2863872090878,31.319061935676],"type":"Point"},"id":1356561006,"stop_id":"1388514","stop_name":"Bay St and Rebecca Av"}},{"stop":{"geometry":{"coordinates":[-89.2852110737369,31.31574095021],"type":"Point"},"id":1356560956,"stop_id":"1385885","stop_name":"Edwards St and Katie St"}},{"stop":{"geometry":{"coordinates":[-89.2851544520811,31.3118933040222],"type":"Point"},"id":1356560957,"stop_id":"1367949","stop_name":"Edwards St and Duke St"}},{"stop":{"geometry":{"coordinates":[-89.2851478150119,31.3063114417649],"type":"Point"},"id":1356560958,"stop_id":"1367950","stop_name":"Edwards St and Tuscan Av"}},{"stop":{"geometry":{"coordinates":[-89.2828526038566,31.3011928177263],"type":"Point"},"id":1356561007,"stop_id":"1388515","stop_name":"Lilac St and Hattiesburg St"}},{"stop":{"geometry":{"coordinates":[-89.2863200811499,31.2963639702356],"type":"Point"},"id":1356561008,"stop_id":"1388516","stop_name":"Edwards St and Dixie Pine Rd"}},{"stop":{"geometry":{"coordinates":[-89.286836516303,31.2932467472709],"type":"Point"},"id":1356561009,"stop_id":"1388517","stop_name":"Edwards St and Fellowship Center"}},{"stop":{"geometry":{"coordinates":[-89.2857219438383,31.2881210870342],"type":"Point"},"id":1356561010,"stop_id":"1388518","stop_name":"Edwards St and Barkley Rd"}},{"stop":{"geometry":{"coordinates":[-89.2882714522586,31.2808996358166],"type":"Point"},"id":1356561011,"stop_id":"1388519","stop_name":"Edwards St and Central School Rd"}},{"stop":{"geometry":{"coordinates":[-89.2891020452579,31.2774352804826],"type":"Point"},"id":1356561012,"stop_id":"1388520","stop_name":"Old Airport Rd and Edwards St"}},{"stop":{"geometry":{"coordinates":[-89.2830043262504,31.2773639708445],"type":"Point"},"id":1356561013,"stop_id":"1388521","stop_name":"Old Airport Rd at Family Health Center"}},{"stop":{"geometry":{"coordinates":[-89.275734047129,31.2773174821908],"type":"Point"},"id":1356561014,"stop_id":"1388522","stop_name":"Old Airport Rd and Chancellor Rd"}},{"stop":{"geometry":{"coordinates":[-89.2715752031027,31.2772746578441],"type":"Point"},"id":1356561015,"stop_id":"1388523","stop_name":"Old Airport Rd and Hattiesburg Ave"}},{"stop":{"geometry":{"coordinates":[-89.2669631858683,31.2764305658844],"type":"Point"},"id":1356561016,"stop_id":"1388524","stop_name":"Sullivan St at Palmer's Crossing Apartments"}},{"stop":{"geometry":{"coordinates":[-89.2628146150517,31.2781748099523],"type":"Point"},"id":1356561017,"stop_id":"1388525","stop_name":"Tatum Rd and Hood Rd"}},{"stop":{"geometry":{"coordinates":[-89.2587462772665,31.2792721604562],"type":"Point"},"id":1356561018,"stop_id":"1388526","stop_name":"Tatum Rd and Stepts Ave"}},{"stop":{"geometry":{"coordinates":[-89.2561794518019,31.2759994373183],"type":"Point"},"id":1356561019,"stop_id":"1388527","stop_name":"Travillion Rd and Stepts Ave"}},{"stop":{"geometry":{"coordinates":[-89.2657218221788,31.2690429135424],"type":"Point"},"id":1356561020,"stop_id":"1388528","stop_name":"Tatum Industrial Dr  at Georgia Pacific"}},{"stop":{"geometry":{"coordinates":[-89.2698177511688,31.2669115782391],"type":"Point"},"id":1356561021,"stop_id":"1388529","stop_name":"Tatum Industrial Dr at Kohler"}},{"stop":{"geometry":{"coordinates":[-89.2731169904018,31.2619818959055],"type":"Point"},"id":1356561022,"stop_id":"1388530","stop_name":"Woodall Tech Center"}},{"stop":{"geometry":{"coordinates":[-89.2777493420943,31.2663965739042],"type":"Point"},"id":1356561023,"stop_id":"1388531","stop_name":"S Hill Dr and Tatum Industrial Dr"}},{"stop":{"geometry":{"coordinates":[-89.2815492407361,31.2665933874527],"type":"Point"},"id":1356561024,"stop_id":"1388532","stop_name":"JM Tatum Industrial Dr at DMV"}},{"stop":{"geometry":{"coordinates":[-89.2969373921043,31.2859241023798],"type":"Point"},"id":1356561025,"stop_id":"1388533","stop_name":"PRCC"}},{"stop":{"geometry":{"coordinates":[-89.2879886961475,31.2809765409551],"type":"Point"},"id":1356561026,"stop_id":"1388534","stop_name":"Edwards St and Central School Rd"}},{"stop":{"geometry":{"coordinates":[-89.2846861385594,31.28835681579],"type":"Point"},"id":1356561027,"stop_id":"1388535","stop_name":"Edwards St and Barkley Rd"}},{"stop":{"geometry":{"coordinates":[-89.2841320261222,31.2919710548446],"type":"Point"},"id":1356561028,"stop_id":"1388536","stop_name":"McCall St and Collins Rd"}},{"stop":{"geometry":{"coordinates":[-89.2841661713395,31.2956979840823],"type":"Point"},"id":1356561029,"stop_id":"1388537","stop_name":"McCall St and Dixie Pine Rd"}},{"stop":{"geometry":{"coordinates":[-89.2826745103729,31.3011574451286],"type":"Point"},"id":1356561030,"stop_id":"1388538","stop_name":"Lilac St and Hattiesburg St"}},{"stop":{"geometry":{"coordinates":[-89.2849454555252,31.3061329658729],"type":"Point"},"id":1356561031,"stop_id":"1388539","stop_name":"Tuscan St and Edwards St"}},{"stop":{"geometry":{"coordinates":[-89.2849018496125,31.3118940795536],"type":"Point"},"id":1356561032,"stop_id":"1388540","stop_name":"Edwards St and Duke Av"}},{"stop":{"geometry":{"coordinates":[-89.2849667620696,31.3157317440145],"type":"Point"},"id":1356561033,"stop_id":"1388541","stop_name":"Edwards St and Katie St"}},{"stop":{"geometry":{"coordinates":[-89.2860769990501,31.3190966629342],"type":"Point"},"id":1356561034,"stop_id":"1388542","stop_name":"Bay St and Rebecca Av"}},{"stop":{"geometry":{"coordinates":[-89.2871571927993,31.3245124531421],"type":"Point"},"id":1356561035,"stop_id":"1388543","stop_name":"Main St and Buschman St"}},{"stop":{"geometry":{"coordinates":[-89.2856817900802,31.3277713914326],"type":"Point"},"id":1356560846,"stop_id":"1366007","stop_name":"Train Depot"}}],"route_text_color":"ffffff","route_type":3,"route_url":null},"geometry":{"coordinates":[[[-89.2856725105056,31.327738670642713],[-89.28573934998707,31.32765951703084],[-89.28570055568802,31.32755277468467],[-89.28563152453621,31.327493024426122],[-89.28581287482604,31.32733379709214],[-89.28598989124478,31.327152494030933],[-89.2861317221438,31.32698353755531],[-89.28630989567094,31.326857102906146],[-89.2865749167337,31.32670616877197],[-89.28667281483335,31.326629773451234],[-89.28713387994804,31.326229325332314],[-89.2876065764013,31.325784166407956],[-89.28824083098262,31.3252217288703],[-89.28765772147023,31.324738693400967],[-89.2872520164959,31.324386904633748],[-89.28688079999446,31.324056653666005],[-89.28675059923644,31.323925798120957],[-89.28662023574674,31.323705030025064],[-89.2864677842146,31.32326843506562],[-89.28635794210238,31.322946846091916],[-89.28633164083696,31.32273378941384],[-89.28633332590015,31.321937294272303],[-89.28637089724532,31.321797754504964],[-89.28632126427019,31.320440833471757],[-89.28631666704823,31.319103352941397],[-89.2863264897523,31.317565474682013],[-89.2863812119479,31.317533975054275],[-89.28640814966245,31.31750247542654],[-89.28643569747442,31.317458313970594],[-89.28643770012472,31.317404799697034],[-89.28643415761336,31.317361094017127],[-89.2864014206317,31.317314270727824],[-89.28634472340916,31.317265280131764],[-89.2862710225361,31.317234368822508],[-89.28607764723064,31.317081667658112],[-89.28602048655561,31.31706060594811],[-89.2858292135758,31.316907742546917],[-89.28555245998488,31.316740350420417],[-89.2850732462161,31.316473596468416],[-89.28508919889153,31.31641339734408],[-89.2851019559597,31.316347055624615],[-89.28511230478536,31.31587896753996],[-89.28510290899526,31.31511796065459],[-89.28509269803901,31.312435967039182],[-89.28508781355079,31.311976499605635],[-89.2850814720239,31.311356593908773],[-89.28508209206282,31.309907799018998],[-89.2850777490999,31.308909541840325],[-89.28507112948495,31.3062747801906],[-89.28506450987,31.305372000312502],[-89.28505671893036,31.30486954246991],[-89.28507427804624,31.30399630783802],[-89.28506309888597,31.303253851376937],[-89.28504585706689,31.30299314479492],[-89.28495337469639,31.302327132925168],[-89.28489518486272,31.301979233494166],[-89.28473772363203,31.3011928677165],[-89.2846502317124,31.301202131136087],[-89.28279316353665,31.301203518565185],[-89.28281867930828,31.30003652147038],[-89.28293199555658,31.299974169042923],[-89.28423641855389,31.299987799019],[-89.28423641855389,31.300117799019],[-89.2842664185539,31.300217799019],[-89.2843064185539,31.300297799019],[-89.2843964185539,31.300357799019],[-89.2846664185539,31.300417799018998],[-89.28471641855388,31.300237799018998],[-89.28478641855389,31.300057799018997],[-89.2850164185539,31.299527799019],[-89.28540641855389,31.298827799018998],[-89.28552641855389,31.298677799019],[-89.2856864185539,31.298437799019],[-89.2858764185539,31.298187799019],[-89.2860864185539,31.297867799019],[-89.28615641855389,31.297737799019],[-89.28624641855389,31.297467799019],[-89.2862764185539,31.297367799019],[-89.28637641855389,31.296927799019],[-89.28642641855389,31.295817799018998],[-89.2864564185539,31.295477799019],[-89.2866764185539,31.294077799019],[-89.2867664185539,31.293387799018998],[-89.28677641855388,31.292867799019],[-89.2867664185539,31.292457799018997],[-89.28673641855389,31.291977799018998],[-89.28666641855389,31.291497799018998],[-89.2864564185539,31.290767799018997],[-89.28624641855389,31.290207799018997],[-89.2856864185539,31.288447799019],[-89.28564310111351,31.288197615915514],[-89.28561595144501,31.28776576238913],[-89.28562590376674,31.287476818560762],[-89.28566873025886,31.28720321424464],[-89.28579973599429,31.286780935228304],[-89.28610641855389,31.285997799019],[-89.2863664185539,31.285377799019],[-89.28807641855389,31.281097799018998],[-89.28841033565878,31.28021794896938],[-89.28894641855389,31.278707799019],[-89.28905209951492,31.278450712173303],[-89.28914055245812,31.278291699148834],[-89.2892386799413,31.278162978386963],[-89.28935725888513,31.278018720754357],[-89.28950245287787,31.277842994480643],[-89.28910593328257,31.27755581845901],[-89.28889641855389,31.277447799019],[-89.28867641855389,31.277407799019],[-89.28844641855389,31.277397799019],[-89.28562641855389,31.277417799019],[-89.28060641855389,31.277417799019],[-89.2787564185539,31.277387799019],[-89.27434641855389,31.277357799019],[-89.27357641855389,31.277317799019],[-89.2715064185539,31.277327799018998],[-89.2699864185539,31.277437799018998],[-89.26866641855389,31.277547799019],[-89.26833641855389,31.277597799019],[-89.26829641855389,31.276887799019],[-89.2681464185539,31.275797799019],[-89.26783181341513,31.27601389386185],[-89.26750950280602,31.276181777496397],[-89.26709641855389,31.276407799018997],[-89.26658641855389,31.276867799018998],[-89.26618641855389,31.277317799019],[-89.26591623174316,31.277694142475713],[-89.26567950280601,31.27775661642863],[-89.2651395065516,31.27788554278348],[-89.26441641855389,31.278037799019],[-89.2642964185539,31.278067799019],[-89.2638364185539,31.278147799019],[-89.2633464185539,31.278197799018997],[-89.26230641855389,31.278237799019],[-89.26194641855389,31.278267799018998],[-89.2615664185539,31.278317799019],[-89.26105641855389,31.278427799019],[-89.26060362976716,31.2785700084175],[-89.25934641855389,31.279107799019],[-89.25891545722672,31.279335302737934],[-89.2585614203857,31.2789960548228],[-89.25749837076778,31.277739342796966],[-89.25543641855388,31.275257799019],[-89.25494641855389,31.274637799019],[-89.254433800488,31.27404575072595],[-89.2539211227875,31.27344615342156],[-89.25382641855388,31.273257799019],[-89.25410641855389,31.273247799019],[-89.25917641855389,31.273167799019],[-89.25961641855389,31.273147799019],[-89.25992641855389,31.273117799018998],[-89.26028641855389,31.273047799019],[-89.26065641855389,31.272957799019],[-89.26082641855389,31.272897799019],[-89.26109641855389,31.272787799019],[-89.26131641855389,31.272677799019],[-89.26158641855389,31.272527799019],[-89.2617764185539,31.272407799019],[-89.26199641855389,31.272247799019],[-89.2622364185539,31.272037799019],[-89.2639864185539,31.270367799019],[-89.26449641855389,31.269897799019],[-89.2657164185539,31.268807799018997],[-89.26636641855389,31.268307799019],[-89.26663641855389,31.268117799019],[-89.26682641855389,31.267997799019],[-89.26722641855389,31.267777799018997],[-89.26762641855389,31.267567799018998],[-89.26819641855388,31.267317799019],[-89.2685464185539,31.267187799019],[-89.26879641855389,31.267097799018998],[-89.26922641855388,31.266957799019],[-89.26955641855389,31.266867799019],[-89.27000641855389,31.266757799019],[-89.27094641855389,31.266587799019],[-89.27120641855389,31.266557799018997],[-89.2718064185539,31.266517799019],[-89.27250641855389,31.266507799019],[-89.2725664185539,31.266357799018998],[-89.27298641855388,31.265557799019],[-89.2745791425371,31.263074140494265],[-89.2746817635962,31.26278514546724],[-89.2747936480461,31.26248624065086],[-89.27482088195308,31.262387562220372],[-89.27494290343162,31.261821801436803],[-89.27486503308829,31.26181441340241],[-89.27425268288667,31.261725815366578],[-89.27387458419562,31.26166486209673],[-89.27381732521131,31.26166511406632],[-89.27376455958657,31.261674373832232],[-89.27372370099002,31.261693206483905],[-89.27334941689526,31.26195271986898],[-89.27336137799841,31.261964128510783],[-89.27373573013377,31.261704688046645],[-89.27376884440129,31.261691954219405],[-89.27381652358063,31.261680709588923],[-89.27387077922565,31.261680246918466],[-89.27424589769869,31.26173912631351],[-89.27466041209584,31.261800761064084],[-89.27490399708266,31.2618365372351],[-89.27477217448416,31.262425636677108],[-89.27510429912526,31.262485951600414],[-89.27562842390537,31.262603022389744],[-89.27591684910877,31.26263899323867],[-89.2762964185539,31.262787799018998],[-89.27658641855389,31.262837799019],[-89.27699641855389,31.262867799019],[-89.27739641855389,31.262877799018998],[-89.27766641855389,31.262917799019],[-89.27775641855389,31.262997799019],[-89.27779641855389,31.263097799019],[-89.27779220634712,31.26368627713304],[-89.27782641855389,31.266497799019],[-89.27983641855388,31.266527799019],[-89.28284641855389,31.266537799018998],[-89.28369641855389,31.266557799018997],[-89.2841664185539,31.266587799019],[-89.2845364185539,31.266587799019],[-89.28477641855389,31.266547799018998],[-89.28630641855389,31.270227799019],[-89.2872064185539,31.272307799019],[-89.2875764185539,31.273197799018998],[-89.28807641855389,31.274447799019],[-89.28845641855389,31.275307799019],[-89.28863641855389,31.275677799019],[-89.28884641855389,31.276077799019],[-89.28915641855389,31.276557799019],[-89.28928641855389,31.276737799019],[-89.2895064185539,31.277017799019],[-89.28990347776977,31.277493632023827],[-89.29037641855389,31.277977799019],[-89.290534364173,31.278125221944887],[-89.29078396389974,31.278369567851993],[-89.29353370378303,31.281261756877],[-89.29542347072561,31.283260069612695],[-89.29660855196784,31.2844866912607],[-89.29750029589404,31.285414126238436],[-89.29736354072219,31.28545511063011],[-89.29657226432407,31.28600225130387],[-89.2966312079163,31.286069110612022],[-89.29744486301088,31.28553091141365],[-89.29755937458222,31.28538552762112],[-89.29655464013571,31.284344374686302],[-89.29552997252932,31.28329335113824],[-89.29339628065594,31.28103137318106],[-89.29082898151454,31.278343253459138],[-89.29064921613427,31.278119087025498],[-89.29049641855389,31.277917799019],[-89.2902564185539,31.277637799019],[-89.28994891113841,31.27724153815044],[-89.28976626345805,31.27745432168677],[-89.28920952353171,31.278113022452672],[-89.28911140026058,31.278242097881225],[-89.28900487061371,31.278419619839404],[-89.28891578277255,31.278623919696113],[-89.28860031101505,31.279488429553545],[-89.28834338577428,31.280217465638753],[-89.28820237677525,31.280612998077192],[-89.28771149835764,31.28184809628357],[-89.28649070296822,31.284910011429115],[-89.28606410896609,31.285972940962168],[-89.28573179937831,31.286796892201803],[-89.28562410896608,31.287152603123104],[-89.28557006717965,31.28749522600556],[-89.28556600690187,31.287929804899054],[-89.28559208691415,31.28820113114636],[-89.28562555791997,31.28841579329981],[-89.284189214302,31.288419850668557],[-89.28419596164514,31.292036136730985],[-89.284191311114,31.292640186207237],[-89.28419201005119,31.293385746952353],[-89.28422641855389,31.295777799019],[-89.28423018719866,31.29995727224142],[-89.282929001141,31.299939796400917],[-89.28283324024217,31.29998425757067],[-89.28277625770369,31.300016669824362],[-89.28275032601584,31.301242164318207],[-89.28464617242255,31.30123688133734],[-89.28469678045653,31.30123118862695],[-89.28487644885537,31.30221253583732],[-89.28497793408661,31.302978952418922],[-89.28500465846369,31.30327634795188],[-89.28500857262908,31.305060205609998],[-89.28502201115583,31.309021582983082],[-89.28502524418398,31.310128247517962],[-89.28502297905622,31.311285483003815],[-89.28503008523764,31.3122914557536],[-89.28503988066419,31.314453701380955],[-89.28504396679479,31.314969219705347],[-89.28505027671395,31.315509396475036],[-89.28504941118142,31.31598518875942],[-89.2850449616687,31.316342563853226],[-89.28503482367954,31.316401604493368],[-89.28502497085346,31.316440476751264],[-89.28499225596906,31.316490779421574],[-89.28553084748108,31.316788636916367],[-89.2858118469439,31.31695877573605],[-89.28594242901384,31.3170594888619],[-89.2860002531691,31.317109710249696],[-89.28607468474014,31.317242120294612],[-89.28609997438681,31.31730489631439],[-89.28608442105732,31.31735671832727],[-89.28607621308436,31.317428428152272],[-89.2860997170301,31.317486404111026],[-89.28614727141688,31.317536671270066],[-89.28621008702139,31.317563783227],[-89.2862128587962,31.319175892007465],[-89.28621885642173,31.320241589895964],[-89.28625270289382,31.32179400829522],[-89.28628100216764,31.321943126853434],[-89.28628179390904,31.322777640434957],[-89.28630308064027,31.322943134873675],[-89.28638780921123,31.32319083356118],[-89.28657654990221,31.323741825085115],[-89.28670525484505,31.323954938651642],[-89.28678690914641,31.32404450557992],[-89.28689547760132,31.324148409602635],[-89.28723519583144,31.324438886919346],[-89.28762327221953,31.32477255948836],[-89.2881570392362,31.325222388896176],[-89.28744384279105,31.325855425825573],[-89.28694195435914,31.32633034673352],[-89.28654242218876,31.3266712558411],[-89.2863147706161,31.32679374543281],[-89.2862313806044,31.326849686421866],[-89.28610542867818,31.326951053535247],[-89.28600607438057,31.32706688920635],[-89.28587182606599,31.327212532344294],[-89.2857757264434,31.327309686954408],[-89.28533762631763,31.32770232064386],[-89.28546136719143,31.32780612965287],[-89.28554775008718,31.327811940043254],[-89.28566878031515,31.327743235604057]]],"type":"MultiLineString"}}]`),L0={type:vv,features:xv},bv={"hct blue1":D_,"hct blue2":D_,"hct Gold1":L_,"hct gold2":L_,"hct green":E0,"hct brown":D0,"hct purple":L0,"hct red":I_,"hct orange":z0};function R_(p){return bv[p]}function I0(p){return p.features[0].properties.route_stops.map(M=>({type:"Feature",geometry:M.stop.geometry,properties:{id:M.stop.id,stop_id:M.stop.stop_id,stop_name:M.stop.stop_name}})).map(M=>{const I=C0(p,M.geometry.coordinates,{units:"miles"});return{stopName:M.properties.stop_name,stopId:M.properties.stop_id,coordinates:M.geometry.coordinates,distance:I.properties.location}})}function Dm(p,m){const w=R_(p.properties.full_name),M=C0(w,p.geometry.coordinates,{units:"miles"});if(M.properties.dist>.1)return{stopName:"N/A",stopId:null,coordinates:null,distance:null};const I=I0(w);for(stop of I)if(M.properties.location<stop.distance)return m?{...stop,busDistance:M.properties.location}:stop;return I[0]}function wv({busData:p,searchLayers:m}){const{geometry:w,properties:M}=p,I=[w.coordinates[1],w.coordinates[0]],F=$3(M.full_name,M.course),P=bf(),u={hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0},H=new Date(M.location_timestamp);let X="N/A";if(M.eta!==null){const Yt=new Date(H.getTime());Yt.setSeconds(Yt.getSeconds()+M.eta),X=Yt.toLocaleTimeString("en-US",u)}const Q=Dm(p),dt=uf[M.full_name],ht=ce.useRef(null);ce.useEffect(()=>{m&&m.current?m.current.addLayer(ht.current):console.warn("searchLayers ref is not ready or was not passed correctly.")},[p,open]);const lt=()=>{if(Q.stopName!=="N/A"){const Yt=[Q.coordinates[1]-7e-4,Q.coordinates[0]];Yt&&(P.flyTo(Yt,18),P.eachLayer(Jt=>{Jt instanceof go.CircleMarker&&Jt.feature.properties.stop_id===Q.stopId&&setTimeout(()=>Jt.openPopup(),500)}))}};return Tt.jsx(Z3,{position:I,icon:F,searchName:e1(M.full_name),ref:ht,children:Tt.jsx(G3,{className:"popup",children:Tt.jsxs("div",{className:"popup-container",children:[Tt.jsx("div",{className:"bus-marker-popup-name",style:{color:dt},children:e1(M.full_name)}),"Next Stop: ",Tt.jsx("span",{className:"next-stop-link",style:{cursor:"pointer"},onClick:lt,children:Q.stopName==="N/A"?"N/A":Q.stopName}),Tt.jsx("br",{}),"Last Known Time: ",H.toLocaleTimeString("en-US",u),Tt.jsx("br",{}),"ETA: ",X]})})})}function Tv(p,m,w){ce.useEffect(()=>{async function M(F){const u=await(await fetch(F)).json();lg(w.current,u)||(m(u),w.current=u)}M(p);const I=setInterval(()=>M(p),5e3);return()=>clearInterval(I)},[])}function Sv({data:p,searchLayers:m}){return Tt.jsx(Tt.Fragment,{children:p?.features?.map(w=>Tt.jsx(wv,{busData:w,searchLayers:m},w.properties.full_name))})}const Mv="FeatureCollection",Pv=[{type:"Feature",geometry:{type:"Point",coordinates:[-89.3356357283762,31.324897528937]},properties:{type:"Transfer",stopName:"Hardy St and 30th St (JR Gas Station)",stopId:"1366031",routeNames:["Blue Line","Gold Line"]}},{type:"Feature",geometry:{type:"Point",coordinates:[-89.3404719602485,31.3247321877362]},properties:{type:"Transfer",stopName:"Hardy St and 34th Ave",stopId:"1366076",routeNames:["Blue Line","Green Line"]}},{type:"Feature",geometry:{type:"Point",coordinates:[-89.3343989492609,31.3246569610849]},properties:{type:"Transfer",stopName:"Hardy St and 30th Ave",stopId:"1366077",routeNames:["Blue Line","Green Line"]}},{type:"Feature",geometry:{type:"Point",coordinates:[-89.3326006661661,31.3238088961898]},properties:{type:"Transfer",stopName:"Hardy St and 29th Ave",stopId:"1366078",routeNames:["Blue Line","Green Line"]}},{type:"Feature",geometry:{type:"Point",coordinates:[-89.2906488930477,31.3254823550539]},properties:{type:"Transfer",stopName:"Front St and Forrest St.",stopId:"1366117",routeNames:["Blue Line","Orange Line"]}},{type:"Feature",geometry:{type:"Point",coordinates:[-89.2892369500362,31.3260193257079]},properties:{type:"Transfer",stopName:"Main St and Short St",stopId:"1366118",routeNames:["Blue Line","Orange Line","Brown Line"]}},{type:"Feature",geometry:{type:"Point",coordinates:[-89.2856817900802,31.3277713914326]},properties:{type:"Station",stopName:"Train Depot",stopId:"1366007",routeNames:["Blue Line","Orange Line","Brown Line","Purple Line"]}},{type:"Feature",geometry:{type:"Point",coordinates:[-89.3299200641263,31.3355130907934]},properties:{type:"Transfer",stopName:"Service Rd @ Hillcrest",stopId:"1366204",routeNames:["Green Line","Gold Line"]}},{type:"Feature",geometry:{type:"Point",coordinates:[-89.3194162915476,31.3080127949791]},properties:{type:"Station",stopName:"Walmart @ 49",stopId:"1385893",routeNames:["Green Line","Red Line","Orange Line"]}},{type:"Feature",geometry:{type:"Point",coordinates:[-89.3151330769675,31.3092630674746]},properties:{type:"Transfer",stopName:"On Service Rd at Waffle House",stopId:"1385890",routeNames:["Red Line","Orange Line"]}},{type:"Feature",geometry:{type:"Point",coordinates:[-89.3179970658928,31.3099950212159]},properties:{type:"Transfer",stopName:"On Service Rd near Popeye's Chicken",stopId:"1385891",routeNames:["Red Line","Orange Line"]}},{type:"Feature",geometry:{type:"Point",coordinates:[-89.3183762963819,31.3114651092937]},properties:{type:"Transfer",stopName:"Service Road and Cloverleaf Dr",stopId:"1385892",routeNames:["Red Line","Orange Line"]}},{type:"Feature",geometry:{type:"Point",coordinates:[-89.2852110737369,31.31574095021]},properties:{type:"Transfer",stopName:"Edwards St and Katie St",stopId:"1385885",routeNames:["Orange Line","Purple Line"]}},{type:"Feature",geometry:{type:"Point",coordinates:[-89.2851544520811,31.3118933040222]},properties:{type:"Transfer",stopName:"Edwards St and Duke St",stopId:"1367949",routeNames:["Orange Line","Purple Line"]}},{type:"Feature",geometry:{type:"Point",coordinates:[-89.2851478150119,31.3063114417649]},properties:{type:"Transfer",stopName:"Edwards St and Tuscan Av",stopId:"1367950",routeNames:["Orange Line","Purple Line"]}}],Av={type:Mv,features:Pv};function Ch({data:p,routeColor:m,searchLayers:w}){const M=bf(),I=ce.useRef();ce.useEffect(()=>{const F=go.geoJSON(p,{style:function(ht){return{color:m,weight:3.3,opacity:1}},onEachFeature:function(ht,lt){lt.bindPopup(`<div>Route: ${ht.properties.route_short_name} (${ht.properties.route_long_name})<br/>${ht.properties.route_desc}</div>`)}}).addTo(M),u={type:"FeatureCollection",features:p.features[0].properties.route_stops.map(ht=>({type:"Feature",geometry:ht.stop.geometry,properties:{id:ht.stop.id,stop_id:ht.stop.stop_id,stop_name:ht.stop.stop_name}}))},H=go.geoJSON(u,{onEachFeature:function(ht,lt){ht.properties.searchName=ht.properties.stopName},pointToLayer:function(ht,lt){return go.circleMarker(lt,{radius:3,fillColor:"black",color:"white",weight:1,opacity:1,fillOpacity:1,searchName:ht.properties.stop_name,title:ht.properties.stop_name}).bindPopup(`
                    <div class="route-layer">
                        <span style="display: block; text-align: center; margin-bottom: 5px; font-size: 16px; font-weight: 600;">Regular Stop</span>
                        Location: ${ht.properties.stop_name}
                        <br>
                        Serves: ${p.features[0].properties.route_short_name}
                    </div>
                `)}}).addTo(M),X=`
            <div style="
                border-radius: 50%;
                background-color: white;
                height: 16px;
                width: 16px;
                display: flex;
                align-items: center;
                justify-content: center;
                border: 1px solid black;
            ">
                <img src="${ml}" style="
                    width: 70%;
                    height: 70%;
                    object-fit: contain;
                "/>
            </div>   
        `,Q=go.divIcon({html:X,className:"station-icon",iconSize:[16,16],iconAnchor:[8,8],popupAnchor:[0,-8]}),dt=go.geoJSON(Av,{onEachFeature:function(ht,lt){ht.properties.searchName=ht.properties.stop_name},pointToLayer:function(ht,lt){if(ht.properties.type==="Transfer"){const Yt=ht.properties.routeNames.join(", ");return go.circleMarker(lt,{radius:3,fillColor:"white",color:"black",weight:1,opacity:1,fillOpacity:1,searchName:ht.properties.stopName,title:ht.properties.stopName}).bindPopup(`
                        <div class="route-layer">
                            <span style="display: block; text-align: center; margin-bottom: 5px; font-size: 16px; font-weight: 600;">Transfer Stop</span>
                            Location: ${ht.properties.stopName}
                            <br>
                            Serves: ${Yt}
                        </div>`)}else{const Yt=ht.properties.routeNames.join(", ");return go.marker(lt,{icon:Q}).bindPopup(`
                        <div class="route-layer">
                            <span style="display: block; text-align: center; margin-bottom: 5px; font-size: 16px; font-weight: 600;">Bus Station</span>
                            Location: ${ht.properties.stopName}
                            <br>
                            Serves: ${Yt}
                        </div>`)}}}).addTo(M);return w&&w.current?(w.current.addLayer(H),w.current.addLayer(dt)):console.warn("searchLayers ref is not ready or was not passed correctly."),M.on("zoomend",()=>{const ht=M.getZoom();lg(I.current,ht)||(ht>17?(H.eachLayer(function(lt){lt.setStyle({radius:9,weight:3})}),dt.eachLayer(function(lt){lt.feature.properties.type==="Transfer"&&lt.setStyle({radius:9,weight:3})})):ht>14&&ht<=17?(H.eachLayer(function(lt){lt.setStyle({radius:6,weight:2})}),dt.eachLayer(function(lt){lt.feature.properties.type==="Transfer"&&lt.setStyle({radius:6,weight:2})})):ht<=14&&(H.eachLayer(function(lt){lt.setStyle({radius:3,weight:1})}),dt.eachLayer(function(lt){lt.feature.properties.type==="Transfer"&&lt.setStyle({radius:3,weight:1})})),I.current=ht)}),()=>{M.removeLayer(F),M.removeLayer(H),M.removeLayer(dt)}},[p,m,M])}function Cv({searchLayers:p}){return Tt.jsxs(Tt.Fragment,{children:[Tt.jsx(Ch,{searchLayers:p,data:E0,routeColor:"hsl(112, 63%, 52%)"}),Tt.jsx(Ch,{searchLayers:p,data:L_,routeColor:"hsl(44, 96%, 59%)"}),Tt.jsx(Ch,{searchLayers:p,data:D_,routeColor:"hsl(200, 100%, 50%)"}),Tt.jsx(Ch,{searchLayers:p,data:I_,routeColor:"hsl(12, 82%, 50%)"}),Tt.jsx(Ch,{searchLayers:p,data:z0,routeColor:"hsl(27, 100%, 50%)"}),Tt.jsx(Ch,{searchLayers:p,data:I_,routeColor:"hsl(12, 82%, 50%)"}),Tt.jsx(Ch,{searchLayers:p,data:D0,routeColor:"hsl(17, 74%, 37%)"}),Tt.jsx(Ch,{searchLayers:p,data:L0,routeColor:"hsl(250, 100%, 77%)"})]})}function Ev({prop:p,isActive:m,onClick:w}){return Tt.jsxs("button",{className:`bottom-bar-buttons ${m?"active":""}`,onClick:w,children:[Tt.jsx("img",{src:p.icon,height:p.height}),Tt.jsx("label",{children:p.name})]},p.name)}const cg=ce.createContext({});function ug(p){const m=ce.useRef(null);return m.current===null&&(m.current=p()),m.current}const hg=typeof window<"u",R0=hg?ce.useLayoutEffect:ce.useEffect,Gm=ce.createContext(null);function dg(p,m){p.indexOf(m)===-1&&p.push(m)}function fg(p,m){const w=p.indexOf(m);w>-1&&p.splice(w,1)}const qu=(p,m,w)=>w>m?m:w<p?p:w;let pg=()=>{};const $u={},k0=p=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(p);function B0(p){return typeof p=="object"&&p!==null}const O0=p=>/^0[^.\s]+$/u.test(p);function mg(p){let m;return()=>(m===void 0&&(m=p()),m)}const Ql=p=>p,zv=(p,m)=>w=>m(p(w)),zp=(...p)=>p.reduce(zv),Sp=(p,m,w)=>{const M=m-p;return M===0?1:(w-p)/M};class _g{constructor(){this.subscriptions=[]}add(m){return dg(this.subscriptions,m),()=>fg(this.subscriptions,m)}notify(m,w,M){const I=this.subscriptions.length;if(I)if(I===1)this.subscriptions[0](m,w,M);else for(let F=0;F<I;F++){const P=this.subscriptions[F];P&&P(m,w,M)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const hu=p=>p*1e3,du=p=>p/1e3;function N0(p,m){return m?p*(1e3/m):0}const j0=(p,m,w)=>(((1-3*w+3*m)*p+(3*w-6*m))*p+3*m)*p,Dv=1e-7,Lv=12;function Iv(p,m,w,M,I){let F,P,u=0;do P=m+(w-m)/2,F=j0(P,M,I)-p,F>0?w=P:m=P;while(Math.abs(F)>Dv&&++u<Lv);return P}function Dp(p,m,w,M){if(p===m&&w===M)return Ql;const I=F=>Iv(F,0,1,p,w);return F=>F===0||F===1?F:j0(I(F),m,M)}const F0=p=>m=>m<=.5?p(2*m)/2:(2-p(2*(1-m)))/2,V0=p=>m=>1-p(1-m),U0=Dp(.33,1.53,.69,.99),gg=V0(U0),Z0=F0(gg),G0=p=>(p*=2)<1?.5*gg(p):.5*(2-Math.pow(2,-10*(p-1))),yg=p=>1-Math.sin(Math.acos(p)),H0=V0(yg),q0=F0(yg),Rv=Dp(.42,0,1,1),kv=Dp(0,0,.58,1),$0=Dp(.42,0,.58,1),Bv=p=>Array.isArray(p)&&typeof p[0]!="number",X0=p=>Array.isArray(p)&&typeof p[0]=="number",Ov={linear:Ql,easeIn:Rv,easeInOut:$0,easeOut:kv,circIn:yg,circInOut:q0,circOut:H0,backIn:gg,backInOut:Z0,backOut:U0,anticipate:G0},Nv=p=>typeof p=="string",c1=p=>{if(X0(p)){pg(p.length===4);const[m,w,M,I]=p;return Dp(m,w,M,I)}else if(Nv(p))return Ov[p];return p},Am=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function jv(p,m){let w=new Set,M=new Set,I=!1,F=!1;const P=new WeakSet;let u={delta:0,timestamp:0,isProcessing:!1};function H(Q){P.has(Q)&&(X.schedule(Q),p()),Q(u)}const X={schedule:(Q,dt=!1,ht=!1)=>{const Yt=ht&&I?w:M;return dt&&P.add(Q),Yt.has(Q)||Yt.add(Q),Q},cancel:Q=>{M.delete(Q),P.delete(Q)},process:Q=>{if(u=Q,I){F=!0;return}I=!0,[w,M]=[M,w],w.forEach(H),w.clear(),I=!1,F&&(F=!1,X.process(Q))}};return X}const Fv=40;function Y0(p,m){let w=!1,M=!0;const I={delta:0,timestamp:0,isProcessing:!1},F=()=>w=!0,P=Am.reduce((ne,Ne)=>(ne[Ne]=jv(F),ne),{}),{setup:u,read:H,resolveKeyframes:X,preUpdate:Q,update:dt,preRender:ht,render:lt,postRender:Yt}=P,Jt=()=>{const ne=$u.useManualTiming?I.timestamp:performance.now();w=!1,$u.useManualTiming||(I.delta=M?1e3/60:Math.max(Math.min(ne-I.timestamp,Fv),1)),I.timestamp=ne,I.isProcessing=!0,u.process(I),H.process(I),X.process(I),Q.process(I),dt.process(I),ht.process(I),lt.process(I),Yt.process(I),I.isProcessing=!1,w&&m&&(M=!1,p(Jt))},pe=()=>{w=!0,M=!0,I.isProcessing||p(Jt)};return{schedule:Am.reduce((ne,Ne)=>{const we=P[Ne];return ne[Ne]=(Ve,Je=!1,Ue=!1)=>(w||pe(),we.schedule(Ve,Je,Ue)),ne},{}),cancel:ne=>{for(let Ne=0;Ne<Am.length;Ne++)P[Am[Ne]].cancel(ne)},state:I,steps:P}}const{schedule:br,cancel:zh,state:ha,steps:f_}=Y0(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ql,!0);let Lm;function Vv(){Lm=void 0}const Zo={now:()=>(Lm===void 0&&Zo.set(ha.isProcessing||$u.useManualTiming?ha.timestamp:performance.now()),Lm),set:p=>{Lm=p,queueMicrotask(Vv)}},W0=p=>m=>typeof m=="string"&&m.startsWith(p),vg=W0("--"),Uv=W0("var(--"),xg=p=>Uv(p)?Zv.test(p.split("/*")[0].trim()):!1,Zv=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,wf={test:p=>typeof p=="number",parse:parseFloat,transform:p=>p},Mp={...wf,transform:p=>qu(0,1,p)},Cm={...wf,default:1},vp=p=>Math.round(p*1e5)/1e5,bg=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Gv(p){return p==null}const Hv=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,wg=(p,m)=>w=>!!(typeof w=="string"&&Hv.test(w)&&w.startsWith(p)||m&&!Gv(w)&&Object.prototype.hasOwnProperty.call(w,m)),K0=(p,m,w)=>M=>{if(typeof M!="string")return M;const[I,F,P,u]=M.match(bg);return{[p]:parseFloat(I),[m]:parseFloat(F),[w]:parseFloat(P),alpha:u!==void 0?parseFloat(u):1}},qv=p=>qu(0,255,p),p_={...wf,transform:p=>Math.round(qv(p))},Sd={test:wg("rgb","red"),parse:K0("red","green","blue"),transform:({red:p,green:m,blue:w,alpha:M=1})=>"rgba("+p_.transform(p)+", "+p_.transform(m)+", "+p_.transform(w)+", "+vp(Mp.transform(M))+")"};function $v(p){let m="",w="",M="",I="";return p.length>5?(m=p.substring(1,3),w=p.substring(3,5),M=p.substring(5,7),I=p.substring(7,9)):(m=p.substring(1,2),w=p.substring(2,3),M=p.substring(3,4),I=p.substring(4,5),m+=m,w+=w,M+=M,I+=I),{red:parseInt(m,16),green:parseInt(w,16),blue:parseInt(M,16),alpha:I?parseInt(I,16)/255:1}}const k_={test:wg("#"),parse:$v,transform:Sd.transform},Lp=p=>({test:m=>typeof m=="string"&&m.endsWith(p)&&m.split(" ").length===1,parse:parseFloat,transform:m=>`${m}${p}`}),Eh=Lp("deg"),fu=Lp("%"),wi=Lp("px"),Xv=Lp("vh"),Yv=Lp("vw"),u1={...fu,parse:p=>fu.parse(p)/100,transform:p=>fu.transform(p*100)},ff={test:wg("hsl","hue"),parse:K0("hue","saturation","lightness"),transform:({hue:p,saturation:m,lightness:w,alpha:M=1})=>"hsla("+Math.round(p)+", "+fu.transform(vp(m))+", "+fu.transform(vp(w))+", "+vp(Mp.transform(M))+")"},gs={test:p=>Sd.test(p)||k_.test(p)||ff.test(p),parse:p=>Sd.test(p)?Sd.parse(p):ff.test(p)?ff.parse(p):k_.parse(p),transform:p=>typeof p=="string"?p:p.hasOwnProperty("red")?Sd.transform(p):ff.transform(p),getAnimatableNone:p=>{const m=gs.parse(p);return m.alpha=0,gs.transform(m)}},Wv=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Kv(p){return isNaN(p)&&typeof p=="string"&&(p.match(bg)?.length||0)+(p.match(Wv)?.length||0)>0}const Q0="number",J0="color",Qv="var",Jv="var(",h1="${}",t2=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Pp(p){const m=p.toString(),w=[],M={color:[],number:[],var:[]},I=[];let F=0;const u=m.replace(t2,H=>(gs.test(H)?(M.color.push(F),I.push(J0),w.push(gs.parse(H))):H.startsWith(Jv)?(M.var.push(F),I.push(Qv),w.push(H)):(M.number.push(F),I.push(Q0),w.push(parseFloat(H))),++F,h1)).split(h1);return{values:w,split:u,indexes:M,types:I}}function ty(p){return Pp(p).values}function ey(p){const{split:m,types:w}=Pp(p),M=m.length;return I=>{let F="";for(let P=0;P<M;P++)if(F+=m[P],I[P]!==void 0){const u=w[P];u===Q0?F+=vp(I[P]):u===J0?F+=gs.transform(I[P]):F+=I[P]}return F}}const e2=p=>typeof p=="number"?0:gs.test(p)?gs.getAnimatableNone(p):p;function i2(p){const m=ty(p);return ey(p)(m.map(e2))}const Dh={test:Kv,parse:ty,createTransformer:ey,getAnimatableNone:i2};function m_(p,m,w){return w<0&&(w+=1),w>1&&(w-=1),w<1/6?p+(m-p)*6*w:w<1/2?m:w<2/3?p+(m-p)*(2/3-w)*6:p}function n2({hue:p,saturation:m,lightness:w,alpha:M}){p/=360,m/=100,w/=100;let I=0,F=0,P=0;if(!m)I=F=P=w;else{const u=w<.5?w*(1+m):w+m-w*m,H=2*w-u;I=m_(H,u,p+1/3),F=m_(H,u,p),P=m_(H,u,p-1/3)}return{red:Math.round(I*255),green:Math.round(F*255),blue:Math.round(P*255),alpha:M}}function Nm(p,m){return w=>w>0?m:p}const Lr=(p,m,w)=>p+(m-p)*w,__=(p,m,w)=>{const M=p*p,I=w*(m*m-M)+M;return I<0?0:Math.sqrt(I)},r2=[k_,Sd,ff],s2=p=>r2.find(m=>m.test(p));function d1(p){const m=s2(p);if(!m)return!1;let w=m.parse(p);return m===ff&&(w=n2(w)),w}const f1=(p,m)=>{const w=d1(p),M=d1(m);if(!w||!M)return Nm(p,m);const I={...w};return F=>(I.red=__(w.red,M.red,F),I.green=__(w.green,M.green,F),I.blue=__(w.blue,M.blue,F),I.alpha=Lr(w.alpha,M.alpha,F),Sd.transform(I))},B_=new Set(["none","hidden"]);function a2(p,m){return B_.has(p)?w=>w<=0?p:m:w=>w>=1?m:p}function o2(p,m){return w=>Lr(p,m,w)}function Tg(p){return typeof p=="number"?o2:typeof p=="string"?xg(p)?Nm:gs.test(p)?f1:u2:Array.isArray(p)?iy:typeof p=="object"?gs.test(p)?f1:l2:Nm}function iy(p,m){const w=[...p],M=w.length,I=p.map((F,P)=>Tg(F)(F,m[P]));return F=>{for(let P=0;P<M;P++)w[P]=I[P](F);return w}}function l2(p,m){const w={...p,...m},M={};for(const I in w)p[I]!==void 0&&m[I]!==void 0&&(M[I]=Tg(p[I])(p[I],m[I]));return I=>{for(const F in M)w[F]=M[F](I);return w}}function c2(p,m){const w=[],M={color:0,var:0,number:0};for(let I=0;I<m.values.length;I++){const F=m.types[I],P=p.indexes[F][M[F]],u=p.values[P]??0;w[I]=u,M[F]++}return w}const u2=(p,m)=>{const w=Dh.createTransformer(m),M=Pp(p),I=Pp(m);return M.indexes.var.length===I.indexes.var.length&&M.indexes.color.length===I.indexes.color.length&&M.indexes.number.length>=I.indexes.number.length?B_.has(p)&&!I.values.length||B_.has(m)&&!M.values.length?a2(p,m):zp(iy(c2(M,I),I.values),w):Nm(p,m)};function ny(p,m,w){return typeof p=="number"&&typeof m=="number"&&typeof w=="number"?Lr(p,m,w):Tg(p)(p,m)}const h2=p=>{const m=({timestamp:w})=>p(w);return{start:(w=!0)=>br.update(m,w),stop:()=>zh(m),now:()=>ha.isProcessing?ha.timestamp:Zo.now()}},ry=(p,m,w=10)=>{let M="";const I=Math.max(Math.round(m/w),2);for(let F=0;F<I;F++)M+=Math.round(p(F/(I-1))*1e4)/1e4+", ";return`linear(${M.substring(0,M.length-2)})`},jm=2e4;function Sg(p){let m=0;const w=50;let M=p.next(m);for(;!M.done&&m<jm;)m+=w,M=p.next(m);return m>=jm?1/0:m}function d2(p,m=100,w){const M=w({...p,keyframes:[0,m]}),I=Math.min(Sg(M),jm);return{type:"keyframes",ease:F=>M.next(I*F).value/m,duration:du(I)}}const f2=5;function sy(p,m,w){const M=Math.max(m-f2,0);return N0(w-p(M),m-M)}const Vr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},g_=.001;function p2({duration:p=Vr.duration,bounce:m=Vr.bounce,velocity:w=Vr.velocity,mass:M=Vr.mass}){let I,F,P=1-m;P=qu(Vr.minDamping,Vr.maxDamping,P),p=qu(Vr.minDuration,Vr.maxDuration,du(p)),P<1?(I=X=>{const Q=X*P,dt=Q*p,ht=Q-w,lt=O_(X,P),Yt=Math.exp(-dt);return g_-ht/lt*Yt},F=X=>{const dt=X*P*p,ht=dt*w+w,lt=Math.pow(P,2)*Math.pow(X,2)*p,Yt=Math.exp(-dt),Jt=O_(Math.pow(X,2),P);return(-I(X)+g_>0?-1:1)*((ht-lt)*Yt)/Jt}):(I=X=>{const Q=Math.exp(-X*p),dt=(X-w)*p+1;return-g_+Q*dt},F=X=>{const Q=Math.exp(-X*p),dt=(w-X)*(p*p);return Q*dt});const u=5/p,H=_2(I,F,u);if(p=hu(p),isNaN(H))return{stiffness:Vr.stiffness,damping:Vr.damping,duration:p};{const X=Math.pow(H,2)*M;return{stiffness:X,damping:P*2*Math.sqrt(M*X),duration:p}}}const m2=12;function _2(p,m,w){let M=w;for(let I=1;I<m2;I++)M=M-p(M)/m(M);return M}function O_(p,m){return p*Math.sqrt(1-m*m)}const g2=["duration","bounce"],y2=["stiffness","damping","mass"];function p1(p,m){return m.some(w=>p[w]!==void 0)}function v2(p){let m={velocity:Vr.velocity,stiffness:Vr.stiffness,damping:Vr.damping,mass:Vr.mass,isResolvedFromDuration:!1,...p};if(!p1(p,y2)&&p1(p,g2))if(p.visualDuration){const w=p.visualDuration,M=2*Math.PI/(w*1.2),I=M*M,F=2*qu(.05,1,1-(p.bounce||0))*Math.sqrt(I);m={...m,mass:Vr.mass,stiffness:I,damping:F}}else{const w=p2(p);m={...m,...w,mass:Vr.mass},m.isResolvedFromDuration=!0}return m}function Fm(p=Vr.visualDuration,m=Vr.bounce){const w=typeof p!="object"?{visualDuration:p,keyframes:[0,1],bounce:m}:p;let{restSpeed:M,restDelta:I}=w;const F=w.keyframes[0],P=w.keyframes[w.keyframes.length-1],u={done:!1,value:F},{stiffness:H,damping:X,mass:Q,duration:dt,velocity:ht,isResolvedFromDuration:lt}=v2({...w,velocity:-du(w.velocity||0)}),Yt=ht||0,Jt=X/(2*Math.sqrt(H*Q)),pe=P-F,ge=du(Math.sqrt(H/Q)),de=Math.abs(pe)<5;M||(M=de?Vr.restSpeed.granular:Vr.restSpeed.default),I||(I=de?Vr.restDelta.granular:Vr.restDelta.default);let ne;if(Jt<1){const we=O_(ge,Jt);ne=Ve=>{const Je=Math.exp(-Jt*ge*Ve);return P-Je*((Yt+Jt*ge*pe)/we*Math.sin(we*Ve)+pe*Math.cos(we*Ve))}}else if(Jt===1)ne=we=>P-Math.exp(-ge*we)*(pe+(Yt+ge*pe)*we);else{const we=ge*Math.sqrt(Jt*Jt-1);ne=Ve=>{const Je=Math.exp(-Jt*ge*Ve),Ue=Math.min(we*Ve,300);return P-Je*((Yt+Jt*ge*pe)*Math.sinh(Ue)+we*pe*Math.cosh(Ue))/we}}const Ne={calculatedDuration:lt&&dt||null,next:we=>{const Ve=ne(we);if(lt)u.done=we>=dt;else{let Je=we===0?Yt:0;Jt<1&&(Je=we===0?hu(Yt):sy(ne,we,Ve));const Ue=Math.abs(Je)<=M,Ei=Math.abs(P-Ve)<=I;u.done=Ue&&Ei}return u.value=u.done?P:Ve,u},toString:()=>{const we=Math.min(Sg(Ne),jm),Ve=ry(Je=>Ne.next(we*Je).value,we,30);return we+"ms "+Ve},toTransition:()=>{}};return Ne}Fm.applyToOptions=p=>{const m=d2(p,100,Fm);return p.ease=m.ease,p.duration=hu(m.duration),p.type="keyframes",p};function N_({keyframes:p,velocity:m=0,power:w=.8,timeConstant:M=325,bounceDamping:I=10,bounceStiffness:F=500,modifyTarget:P,min:u,max:H,restDelta:X=.5,restSpeed:Q}){const dt=p[0],ht={done:!1,value:dt},lt=Ue=>u!==void 0&&Ue<u||H!==void 0&&Ue>H,Yt=Ue=>u===void 0?H:H===void 0||Math.abs(u-Ue)<Math.abs(H-Ue)?u:H;let Jt=w*m;const pe=dt+Jt,ge=P===void 0?pe:P(pe);ge!==pe&&(Jt=ge-dt);const de=Ue=>-Jt*Math.exp(-Ue/M),ne=Ue=>ge+de(Ue),Ne=Ue=>{const Ei=de(Ue),Ti=ne(Ue);ht.done=Math.abs(Ei)<=X,ht.value=ht.done?ge:Ti};let we,Ve;const Je=Ue=>{lt(ht.value)&&(we=Ue,Ve=Fm({keyframes:[ht.value,Yt(ht.value)],velocity:sy(ne,Ue,ht.value),damping:I,stiffness:F,restDelta:X,restSpeed:Q}))};return Je(0),{calculatedDuration:null,next:Ue=>{let Ei=!1;return!Ve&&we===void 0&&(Ei=!0,Ne(Ue),Je(Ue)),we!==void 0&&Ue>=we?Ve.next(Ue-we):(!Ei&&Ne(Ue),ht)}}}function x2(p,m,w){const M=[],I=w||$u.mix||ny,F=p.length-1;for(let P=0;P<F;P++){let u=I(p[P],p[P+1]);if(m){const H=Array.isArray(m)?m[P]||Ql:m;u=zp(H,u)}M.push(u)}return M}function b2(p,m,{clamp:w=!0,ease:M,mixer:I}={}){const F=p.length;if(pg(F===m.length),F===1)return()=>m[0];if(F===2&&m[0]===m[1])return()=>m[1];const P=p[0]===p[1];p[0]>p[F-1]&&(p=[...p].reverse(),m=[...m].reverse());const u=x2(m,M,I),H=u.length,X=Q=>{if(P&&Q<p[0])return m[0];let dt=0;if(H>1)for(;dt<p.length-2&&!(Q<p[dt+1]);dt++);const ht=Sp(p[dt],p[dt+1],Q);return u[dt](ht)};return w?Q=>X(qu(p[0],p[F-1],Q)):X}function w2(p,m){const w=p[p.length-1];for(let M=1;M<=m;M++){const I=Sp(0,m,M);p.push(Lr(w,1,I))}}function T2(p){const m=[0];return w2(m,p.length-1),m}function S2(p,m){return p.map(w=>w*m)}function M2(p,m){return p.map(()=>m||$0).splice(0,p.length-1)}function xp({duration:p=300,keyframes:m,times:w,ease:M="easeInOut"}){const I=Bv(M)?M.map(c1):c1(M),F={done:!1,value:m[0]},P=S2(w&&w.length===m.length?w:T2(m),p),u=b2(P,m,{ease:Array.isArray(I)?I:M2(m,I)});return{calculatedDuration:p,next:H=>(F.value=u(H),F.done=H>=p,F)}}const P2=p=>p!==null;function Mg(p,{repeat:m,repeatType:w="loop"},M,I=1){const F=p.filter(P2),u=I<0||m&&w!=="loop"&&m%2===1?0:F.length-1;return!u||M===void 0?F[u]:M}const A2={decay:N_,inertia:N_,tween:xp,keyframes:xp,spring:Fm};function ay(p){typeof p.type=="string"&&(p.type=A2[p.type])}class Pg{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(m=>{this.resolve=m})}notifyFinished(){this.resolve()}then(m,w){return this.finished.then(m,w)}}const C2=p=>p/100;class Ag extends Pg{constructor(m){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:w}=this.options;w&&w.updatedAt!==Zo.now()&&this.tick(Zo.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=m,this.initAnimation(),this.play(),m.autoplay===!1&&this.pause()}initAnimation(){const{options:m}=this;ay(m);const{type:w=xp,repeat:M=0,repeatDelay:I=0,repeatType:F,velocity:P=0}=m;let{keyframes:u}=m;const H=w||xp;H!==xp&&typeof u[0]!="number"&&(this.mixKeyframes=zp(C2,ny(u[0],u[1])),u=[0,100]);const X=H({...m,keyframes:u});F==="mirror"&&(this.mirroredGenerator=H({...m,keyframes:[...u].reverse(),velocity:-P})),X.calculatedDuration===null&&(X.calculatedDuration=Sg(X));const{calculatedDuration:Q}=X;this.calculatedDuration=Q,this.resolvedDuration=Q+I,this.totalDuration=this.resolvedDuration*(M+1)-I,this.generator=X}updateTime(m){const w=Math.round(m-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=w}tick(m,w=!1){const{generator:M,totalDuration:I,mixKeyframes:F,mirroredGenerator:P,resolvedDuration:u,calculatedDuration:H}=this;if(this.startTime===null)return M.next(0);const{delay:X=0,keyframes:Q,repeat:dt,repeatType:ht,repeatDelay:lt,type:Yt,onUpdate:Jt,finalKeyframe:pe}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,m):this.speed<0&&(this.startTime=Math.min(m-I/this.speed,this.startTime)),w?this.currentTime=m:this.updateTime(m);const ge=this.currentTime-X*(this.playbackSpeed>=0?1:-1),de=this.playbackSpeed>=0?ge<0:ge>I;this.currentTime=Math.max(ge,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=I);let ne=this.currentTime,Ne=M;if(dt){const Ue=Math.min(this.currentTime,I)/u;let Ei=Math.floor(Ue),Ti=Ue%1;!Ti&&Ue>=1&&(Ti=1),Ti===1&&Ei--,Ei=Math.min(Ei,dt+1),!!(Ei%2)&&(ht==="reverse"?(Ti=1-Ti,lt&&(Ti-=lt/u)):ht==="mirror"&&(Ne=P)),ne=qu(0,1,Ti)*u}const we=de?{done:!1,value:Q[0]}:Ne.next(ne);F&&(we.value=F(we.value));let{done:Ve}=we;!de&&H!==null&&(Ve=this.playbackSpeed>=0?this.currentTime>=I:this.currentTime<=0);const Je=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&Ve);return Je&&Yt!==N_&&(we.value=Mg(Q,this.options,pe,this.speed)),Jt&&Jt(we.value),Je&&this.finish(),we}then(m,w){return this.finished.then(m,w)}get duration(){return du(this.calculatedDuration)}get time(){return du(this.currentTime)}set time(m){m=hu(m),this.currentTime=m,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=m:this.driver&&(this.startTime=this.driver.now()-m/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(m){this.updateTime(Zo.now());const w=this.playbackSpeed!==m;this.playbackSpeed=m,w&&(this.time=du(this.currentTime))}play(){if(this.isStopped)return;const{driver:m=h2,startTime:w}=this.options;this.driver||(this.driver=m(I=>this.tick(I))),this.options.onPlay?.();const M=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=M):this.holdTime!==null?this.startTime=M-this.holdTime:this.startTime||(this.startTime=w??M),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Zo.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(m){return this.startTime=0,this.tick(m,!0)}attachTimeline(m){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),m.observe(this)}}function E2(p){for(let m=1;m<p.length;m++)p[m]??(p[m]=p[m-1])}const Md=p=>p*180/Math.PI,j_=p=>{const m=Md(Math.atan2(p[1],p[0]));return F_(m)},z2={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:p=>(Math.abs(p[0])+Math.abs(p[3]))/2,rotate:j_,rotateZ:j_,skewX:p=>Md(Math.atan(p[1])),skewY:p=>Md(Math.atan(p[2])),skew:p=>(Math.abs(p[1])+Math.abs(p[2]))/2},F_=p=>(p=p%360,p<0&&(p+=360),p),m1=j_,_1=p=>Math.sqrt(p[0]*p[0]+p[1]*p[1]),g1=p=>Math.sqrt(p[4]*p[4]+p[5]*p[5]),D2={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:_1,scaleY:g1,scale:p=>(_1(p)+g1(p))/2,rotateX:p=>F_(Md(Math.atan2(p[6],p[5]))),rotateY:p=>F_(Md(Math.atan2(-p[2],p[0]))),rotateZ:m1,rotate:m1,skewX:p=>Md(Math.atan(p[4])),skewY:p=>Md(Math.atan(p[1])),skew:p=>(Math.abs(p[1])+Math.abs(p[4]))/2};function V_(p){return p.includes("scale")?1:0}function U_(p,m){if(!p||p==="none")return V_(m);const w=p.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let M,I;if(w)M=D2,I=w;else{const u=p.match(/^matrix\(([-\d.e\s,]+)\)$/u);M=z2,I=u}if(!I)return V_(m);const F=M[m],P=I[1].split(",").map(I2);return typeof F=="function"?F(P):P[F]}const L2=(p,m)=>{const{transform:w="none"}=getComputedStyle(p);return U_(w,m)};function I2(p){return parseFloat(p.trim())}const Tf=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Sf=new Set(Tf),y1=p=>p===wf||p===wi,R2=new Set(["x","y","z"]),k2=Tf.filter(p=>!R2.has(p));function B2(p){const m=[];return k2.forEach(w=>{const M=p.getValue(w);M!==void 0&&(m.push([w,M.get()]),M.set(w.startsWith("scale")?1:0))}),m}const Pd={width:({x:p},{paddingLeft:m="0",paddingRight:w="0"})=>p.max-p.min-parseFloat(m)-parseFloat(w),height:({y:p},{paddingTop:m="0",paddingBottom:w="0"})=>p.max-p.min-parseFloat(m)-parseFloat(w),top:(p,{top:m})=>parseFloat(m),left:(p,{left:m})=>parseFloat(m),bottom:({y:p},{top:m})=>parseFloat(m)+(p.max-p.min),right:({x:p},{left:m})=>parseFloat(m)+(p.max-p.min),x:(p,{transform:m})=>U_(m,"x"),y:(p,{transform:m})=>U_(m,"y")};Pd.translateX=Pd.x;Pd.translateY=Pd.y;const Ad=new Set;let Z_=!1,G_=!1,H_=!1;function oy(){if(G_){const p=Array.from(Ad).filter(M=>M.needsMeasurement),m=new Set(p.map(M=>M.element)),w=new Map;m.forEach(M=>{const I=B2(M);I.length&&(w.set(M,I),M.render())}),p.forEach(M=>M.measureInitialState()),m.forEach(M=>{M.render();const I=w.get(M);I&&I.forEach(([F,P])=>{M.getValue(F)?.set(P)})}),p.forEach(M=>M.measureEndState()),p.forEach(M=>{M.suspendedScrollY!==void 0&&window.scrollTo(0,M.suspendedScrollY)})}G_=!1,Z_=!1,Ad.forEach(p=>p.complete(H_)),Ad.clear()}function ly(){Ad.forEach(p=>{p.readKeyframes(),p.needsMeasurement&&(G_=!0)})}function O2(){H_=!0,ly(),oy(),H_=!1}class Cg{constructor(m,w,M,I,F,P=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...m],this.onComplete=w,this.name=M,this.motionValue=I,this.element=F,this.isAsync=P}scheduleResolve(){this.state="scheduled",this.isAsync?(Ad.add(this),Z_||(Z_=!0,br.read(ly),br.resolveKeyframes(oy))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:m,name:w,element:M,motionValue:I}=this;if(m[0]===null){const F=I?.get(),P=m[m.length-1];if(F!==void 0)m[0]=F;else if(M&&w){const u=M.readValue(w,P);u!=null&&(m[0]=u)}m[0]===void 0&&(m[0]=P),I&&F===void 0&&I.set(m[0])}E2(m)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(m=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,m),Ad.delete(this)}cancel(){this.state==="scheduled"&&(Ad.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const N2=p=>p.startsWith("--");function j2(p,m,w){N2(m)?p.style.setProperty(m,w):p.style[m]=w}const F2=mg(()=>window.ScrollTimeline!==void 0),V2={};function U2(p,m){const w=mg(p);return()=>V2[m]??w()}const cy=U2(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),yp=([p,m,w,M])=>`cubic-bezier(${p}, ${m}, ${w}, ${M})`,v1={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:yp([0,.65,.55,1]),circOut:yp([.55,0,1,.45]),backIn:yp([.31,.01,.66,-.59]),backOut:yp([.33,1.53,.69,.99])};function uy(p,m){if(p)return typeof p=="function"?cy()?ry(p,m):"ease-out":X0(p)?yp(p):Array.isArray(p)?p.map(w=>uy(w,m)||v1.easeOut):v1[p]}function Z2(p,m,w,{delay:M=0,duration:I=300,repeat:F=0,repeatType:P="loop",ease:u="easeOut",times:H}={},X=void 0){const Q={[m]:w};H&&(Q.offset=H);const dt=uy(u,I);Array.isArray(dt)&&(Q.easing=dt);const ht={delay:M,duration:I,easing:Array.isArray(dt)?"linear":dt,fill:"both",iterations:F+1,direction:P==="reverse"?"alternate":"normal"};return X&&(ht.pseudoElement=X),p.animate(Q,ht)}function hy(p){return typeof p=="function"&&"applyToOptions"in p}function G2({type:p,...m}){return hy(p)&&cy()?p.applyToOptions(m):(m.duration??(m.duration=300),m.ease??(m.ease="easeOut"),m)}class H2 extends Pg{constructor(m){if(super(),this.finishedTime=null,this.isStopped=!1,!m)return;const{element:w,name:M,keyframes:I,pseudoElement:F,allowFlatten:P=!1,finalKeyframe:u,onComplete:H}=m;this.isPseudoElement=!!F,this.allowFlatten=P,this.options=m,pg(typeof m.type!="string");const X=G2(m);this.animation=Z2(w,M,I,X,F),X.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!F){const Q=Mg(I,this.options,u,this.speed);this.updateMotionValue?this.updateMotionValue(Q):j2(w,M,Q),this.animation.cancel()}H?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:m}=this;m==="idle"||m==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const m=this.animation.effect?.getComputedTiming?.().duration||0;return du(Number(m))}get time(){return du(Number(this.animation.currentTime)||0)}set time(m){this.finishedTime=null,this.animation.currentTime=hu(m)}get speed(){return this.animation.playbackRate}set speed(m){m<0&&(this.finishedTime=null),this.animation.playbackRate=m}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(m){this.animation.startTime=m}attachTimeline({timeline:m,observe:w}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,m&&F2()?(this.animation.timeline=m,Ql):w(this)}}const dy={anticipate:G0,backInOut:Z0,circInOut:q0};function q2(p){return p in dy}function $2(p){typeof p.ease=="string"&&q2(p.ease)&&(p.ease=dy[p.ease])}const x1=10;class X2 extends H2{constructor(m){$2(m),ay(m),super(m),m.startTime&&(this.startTime=m.startTime),this.options=m}updateMotionValue(m){const{motionValue:w,onUpdate:M,onComplete:I,element:F,...P}=this.options;if(!w)return;if(m!==void 0){w.set(m);return}const u=new Ag({...P,autoplay:!1}),H=hu(this.finishedTime??this.time);w.setWithVelocity(u.sample(H-x1).value,u.sample(H).value,x1),u.stop()}}const b1=(p,m)=>m==="zIndex"?!1:!!(typeof p=="number"||Array.isArray(p)||typeof p=="string"&&(Dh.test(p)||p==="0")&&!p.startsWith("url("));function Y2(p){const m=p[0];if(p.length===1)return!0;for(let w=0;w<p.length;w++)if(p[w]!==m)return!0}function W2(p,m,w,M){const I=p[0];if(I===null)return!1;if(m==="display"||m==="visibility")return!0;const F=p[p.length-1],P=b1(I,m),u=b1(F,m);return!P||!u?!1:Y2(p)||(w==="spring"||hy(w))&&M}function q_(p){p.duration=0,p.type}const K2=new Set(["opacity","clipPath","filter","transform"]),Q2=mg(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function J2(p){const{motionValue:m,name:w,repeatDelay:M,repeatType:I,damping:F,type:P}=p;if(!(m?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:H,transformTemplate:X}=m.owner.getProps();return Q2()&&w&&K2.has(w)&&(w!=="transform"||!X)&&!H&&!M&&I!=="mirror"&&F!==0&&P!=="inertia"}const tx=40;class ex extends Pg{constructor({autoplay:m=!0,delay:w=0,type:M="keyframes",repeat:I=0,repeatDelay:F=0,repeatType:P="loop",keyframes:u,name:H,motionValue:X,element:Q,...dt}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Zo.now();const ht={autoplay:m,delay:w,type:M,repeat:I,repeatDelay:F,repeatType:P,name:H,motionValue:X,element:Q,...dt},lt=Q?.KeyframeResolver||Cg;this.keyframeResolver=new lt(u,(Yt,Jt,pe)=>this.onKeyframesResolved(Yt,Jt,ht,!pe),H,X,Q),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(m,w,M,I){this.keyframeResolver=void 0;const{name:F,type:P,velocity:u,delay:H,isHandoff:X,onUpdate:Q}=M;this.resolvedAt=Zo.now(),W2(m,F,P,u)||(($u.instantAnimations||!H)&&Q?.(Mg(m,M,w)),m[0]=m[m.length-1],q_(M),M.repeat=0);const ht={startTime:I?this.resolvedAt?this.resolvedAt-this.createdAt>tx?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:w,...M,keyframes:m},lt=!X&&J2(ht)?new X2({...ht,element:ht.motionValue.owner.current}):new Ag(ht);lt.finished.then(()=>this.notifyFinished()).catch(Ql),this.pendingTimeline&&(this.stopTimeline=lt.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=lt}get finished(){return this._animation?this.animation.finished:this._finished}then(m,w){return this.finished.finally(m).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),O2()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(m){this.animation.time=m}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(m){this.animation.speed=m}get startTime(){return this.animation.startTime}attachTimeline(m){return this._animation?this.stopTimeline=this.animation.attachTimeline(m):this.pendingTimeline=m,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const ix=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function nx(p){const m=ix.exec(p);if(!m)return[,];const[,w,M,I]=m;return[`--${w??M}`,I]}function fy(p,m,w=1){const[M,I]=nx(p);if(!M)return;const F=window.getComputedStyle(m).getPropertyValue(M);if(F){const P=F.trim();return k0(P)?parseFloat(P):P}return xg(I)?fy(I,m,w+1):I}function Eg(p,m){return p?.[m]??p?.default??p}const py=new Set(["width","height","top","left","right","bottom",...Tf]),rx={test:p=>p==="auto",parse:p=>p},my=p=>m=>m.test(p),_y=[wf,wi,fu,Eh,Yv,Xv,rx],w1=p=>_y.find(my(p));function sx(p){return typeof p=="number"?p===0:p!==null?p==="none"||p==="0"||O0(p):!0}const ax=new Set(["brightness","contrast","saturate","opacity"]);function ox(p){const[m,w]=p.slice(0,-1).split("(");if(m==="drop-shadow")return p;const[M]=w.match(bg)||[];if(!M)return p;const I=w.replace(M,"");let F=ax.has(m)?1:0;return M!==w&&(F*=100),m+"("+F+I+")"}const lx=/\b([a-z-]*)\(.*?\)/gu,$_={...Dh,getAnimatableNone:p=>{const m=p.match(lx);return m?m.map(ox).join(" "):p}},T1={...wf,transform:Math.round},cx={rotate:Eh,rotateX:Eh,rotateY:Eh,rotateZ:Eh,scale:Cm,scaleX:Cm,scaleY:Cm,scaleZ:Cm,skew:Eh,skewX:Eh,skewY:Eh,distance:wi,translateX:wi,translateY:wi,translateZ:wi,x:wi,y:wi,z:wi,perspective:wi,transformPerspective:wi,opacity:Mp,originX:u1,originY:u1,originZ:wi},zg={borderWidth:wi,borderTopWidth:wi,borderRightWidth:wi,borderBottomWidth:wi,borderLeftWidth:wi,borderRadius:wi,radius:wi,borderTopLeftRadius:wi,borderTopRightRadius:wi,borderBottomRightRadius:wi,borderBottomLeftRadius:wi,width:wi,maxWidth:wi,height:wi,maxHeight:wi,top:wi,right:wi,bottom:wi,left:wi,padding:wi,paddingTop:wi,paddingRight:wi,paddingBottom:wi,paddingLeft:wi,margin:wi,marginTop:wi,marginRight:wi,marginBottom:wi,marginLeft:wi,backgroundPositionX:wi,backgroundPositionY:wi,...cx,zIndex:T1,fillOpacity:Mp,strokeOpacity:Mp,numOctaves:T1},ux={...zg,color:gs,backgroundColor:gs,outlineColor:gs,fill:gs,stroke:gs,borderColor:gs,borderTopColor:gs,borderRightColor:gs,borderBottomColor:gs,borderLeftColor:gs,filter:$_,WebkitFilter:$_},gy=p=>ux[p];function yy(p,m){let w=gy(p);return w!==$_&&(w=Dh),w.getAnimatableNone?w.getAnimatableNone(m):void 0}const hx=new Set(["auto","none","0"]);function dx(p,m,w){let M=0,I;for(;M<p.length&&!I;){const F=p[M];typeof F=="string"&&!hx.has(F)&&Pp(F).values.length&&(I=p[M]),M++}if(I&&w)for(const F of m)p[F]=yy(w,I)}class fx extends Cg{constructor(m,w,M,I,F){super(m,w,M,I,F,!0)}readKeyframes(){const{unresolvedKeyframes:m,element:w,name:M}=this;if(!w||!w.current)return;super.readKeyframes();for(let H=0;H<m.length;H++){let X=m[H];if(typeof X=="string"&&(X=X.trim(),xg(X))){const Q=fy(X,w.current);Q!==void 0&&(m[H]=Q),H===m.length-1&&(this.finalKeyframe=X)}}if(this.resolveNoneKeyframes(),!py.has(M)||m.length!==2)return;const[I,F]=m,P=w1(I),u=w1(F);if(P!==u)if(y1(P)&&y1(u))for(let H=0;H<m.length;H++){const X=m[H];typeof X=="string"&&(m[H]=parseFloat(X))}else Pd[M]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:m,name:w}=this,M=[];for(let I=0;I<m.length;I++)(m[I]===null||sx(m[I]))&&M.push(I);M.length&&dx(m,M,w)}measureInitialState(){const{element:m,unresolvedKeyframes:w,name:M}=this;if(!m||!m.current)return;M==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Pd[M](m.measureViewportBox(),window.getComputedStyle(m.current)),w[0]=this.measuredOrigin;const I=w[w.length-1];I!==void 0&&m.getValue(M,I).jump(I,!1)}measureEndState(){const{element:m,name:w,unresolvedKeyframes:M}=this;if(!m||!m.current)return;const I=m.getValue(w);I&&I.jump(this.measuredOrigin,!1);const F=M.length-1,P=M[F];M[F]=Pd[w](m.measureViewportBox(),window.getComputedStyle(m.current)),P!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=P),this.removedTransforms?.length&&this.removedTransforms.forEach(([u,H])=>{m.getValue(u).set(H)}),this.resolveNoneKeyframes()}}function px(p,m,w){if(p instanceof EventTarget)return[p];if(typeof p=="string"){let M=document;const I=w?.[p]??M.querySelectorAll(p);return I?Array.from(I):[]}return Array.from(p)}const vy=(p,m)=>m&&typeof p=="number"?m.transform(p):p;function xy(p){return B0(p)&&"offsetHeight"in p}const S1=30,mx=p=>!isNaN(parseFloat(p));class _x{constructor(m,w={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=M=>{const I=Zo.now();if(this.updatedAt!==I&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(M),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const F of this.dependents)F.dirty()},this.hasAnimated=!1,this.setCurrent(m),this.owner=w.owner}setCurrent(m){this.current=m,this.updatedAt=Zo.now(),this.canTrackVelocity===null&&m!==void 0&&(this.canTrackVelocity=mx(this.current))}setPrevFrameValue(m=this.current){this.prevFrameValue=m,this.prevUpdatedAt=this.updatedAt}onChange(m){return this.on("change",m)}on(m,w){this.events[m]||(this.events[m]=new _g);const M=this.events[m].add(w);return m==="change"?()=>{M(),br.read(()=>{this.events.change.getSize()||this.stop()})}:M}clearListeners(){for(const m in this.events)this.events[m].clear()}attach(m,w){this.passiveEffect=m,this.stopPassiveEffect=w}set(m){this.passiveEffect?this.passiveEffect(m,this.updateAndNotify):this.updateAndNotify(m)}setWithVelocity(m,w,M){this.set(w),this.prev=void 0,this.prevFrameValue=m,this.prevUpdatedAt=this.updatedAt-M}jump(m,w=!0){this.updateAndNotify(m),this.prev=m,this.prevUpdatedAt=this.prevFrameValue=void 0,w&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(m){this.dependents||(this.dependents=new Set),this.dependents.add(m)}removeDependent(m){this.dependents&&this.dependents.delete(m)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const m=Zo.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||m-this.updatedAt>S1)return 0;const w=Math.min(this.updatedAt-this.prevUpdatedAt,S1);return N0(parseFloat(this.current)-parseFloat(this.prevFrameValue),w)}start(m){return this.stop(),new Promise(w=>{this.hasAnimated=!0,this.animation=m(w),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function vf(p,m){return new _x(p,m)}const{schedule:Dg}=Y0(queueMicrotask,!1),Ic={x:!1,y:!1};function by(){return Ic.x||Ic.y}function gx(p){return p==="x"||p==="y"?Ic[p]?null:(Ic[p]=!0,()=>{Ic[p]=!1}):Ic.x||Ic.y?null:(Ic.x=Ic.y=!0,()=>{Ic.x=Ic.y=!1})}function wy(p,m){const w=px(p),M=new AbortController,I={passive:!0,...m,signal:M.signal};return[w,I,()=>M.abort()]}function M1(p){return!(p.pointerType==="touch"||by())}function yx(p,m,w={}){const[M,I,F]=wy(p,w),P=u=>{if(!M1(u))return;const{target:H}=u,X=m(H,u);if(typeof X!="function"||!H)return;const Q=dt=>{M1(dt)&&(X(dt),H.removeEventListener("pointerleave",Q))};H.addEventListener("pointerleave",Q,I)};return M.forEach(u=>{u.addEventListener("pointerenter",P,I)}),F}const Ty=(p,m)=>m?p===m?!0:Ty(p,m.parentElement):!1,Lg=p=>p.pointerType==="mouse"?typeof p.button!="number"||p.button<=0:p.isPrimary!==!1,vx=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function xx(p){return vx.has(p.tagName)||p.tabIndex!==-1}const Im=new WeakSet;function P1(p){return m=>{m.key==="Enter"&&p(m)}}function y_(p,m){p.dispatchEvent(new PointerEvent("pointer"+m,{isPrimary:!0,bubbles:!0}))}const bx=(p,m)=>{const w=p.currentTarget;if(!w)return;const M=P1(()=>{if(Im.has(w))return;y_(w,"down");const I=P1(()=>{y_(w,"up")}),F=()=>y_(w,"cancel");w.addEventListener("keyup",I,m),w.addEventListener("blur",F,m)});w.addEventListener("keydown",M,m),w.addEventListener("blur",()=>w.removeEventListener("keydown",M),m)};function A1(p){return Lg(p)&&!by()}function wx(p,m,w={}){const[M,I,F]=wy(p,w),P=u=>{const H=u.currentTarget;if(!A1(u))return;Im.add(H);const X=m(H,u),Q=(lt,Yt)=>{window.removeEventListener("pointerup",dt),window.removeEventListener("pointercancel",ht),Im.has(H)&&Im.delete(H),A1(lt)&&typeof X=="function"&&X(lt,{success:Yt})},dt=lt=>{Q(lt,H===window||H===document||w.useGlobalTarget||Ty(H,lt.target))},ht=lt=>{Q(lt,!1)};window.addEventListener("pointerup",dt,I),window.addEventListener("pointercancel",ht,I)};return M.forEach(u=>{(w.useGlobalTarget?window:u).addEventListener("pointerdown",P,I),xy(u)&&(u.addEventListener("focus",X=>bx(X,I)),!xx(u)&&!u.hasAttribute("tabindex")&&(u.tabIndex=0))}),F}function Sy(p){return B0(p)&&"ownerSVGElement"in p}function Tx(p){return Sy(p)&&p.tagName==="svg"}const Ga=p=>!!(p&&p.getVelocity),Sx=[..._y,gs,Dh],Mx=p=>Sx.find(my(p)),Ig=ce.createContext({transformPagePoint:p=>p,isStatic:!1,reducedMotion:"never"});class Px extends ce.Component{getSnapshotBeforeUpdate(m){const w=this.props.childRef.current;if(w&&m.isPresent&&!this.props.isPresent){const M=w.offsetParent,I=xy(M)&&M.offsetWidth||0,F=this.props.sizeRef.current;F.height=w.offsetHeight||0,F.width=w.offsetWidth||0,F.top=w.offsetTop,F.left=w.offsetLeft,F.right=I-F.width-F.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Ax({children:p,isPresent:m,anchorX:w,root:M}){const I=ce.useId(),F=ce.useRef(null),P=ce.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:u}=ce.useContext(Ig);return ce.useInsertionEffect(()=>{const{width:H,height:X,top:Q,left:dt,right:ht}=P.current;if(m||!F.current||!H||!X)return;const lt=w==="left"?`left: ${dt}`:`right: ${ht}`;F.current.dataset.motionPopId=I;const Yt=document.createElement("style");u&&(Yt.nonce=u);const Jt=M??document.head;return Jt.appendChild(Yt),Yt.sheet&&Yt.sheet.insertRule(`
          [data-motion-pop-id="${I}"] {
            position: absolute !important;
            width: ${H}px !important;
            height: ${X}px !important;
            ${lt}px !important;
            top: ${Q}px !important;
          }
        `),()=>{Jt.contains(Yt)&&Jt.removeChild(Yt)}},[m]),Tt.jsx(Px,{isPresent:m,childRef:F,sizeRef:P,children:ce.cloneElement(p,{ref:F})})}const Cx=({children:p,initial:m,isPresent:w,onExitComplete:M,custom:I,presenceAffectsLayout:F,mode:P,anchorX:u,root:H})=>{const X=ug(Ex),Q=ce.useId();let dt=!0,ht=ce.useMemo(()=>(dt=!1,{id:Q,initial:m,isPresent:w,custom:I,onExitComplete:lt=>{X.set(lt,!0);for(const Yt of X.values())if(!Yt)return;M&&M()},register:lt=>(X.set(lt,!1),()=>X.delete(lt))}),[w,X,M]);return F&&dt&&(ht={...ht}),ce.useMemo(()=>{X.forEach((lt,Yt)=>X.set(Yt,!1))},[w]),ce.useEffect(()=>{!w&&!X.size&&M&&M()},[w]),P==="popLayout"&&(p=Tt.jsx(Ax,{isPresent:w,anchorX:u,root:H,children:p})),Tt.jsx(Gm.Provider,{value:ht,children:p})};function Ex(){return new Map}function My(p=!0){const m=ce.useContext(Gm);if(m===null)return[!0,null];const{isPresent:w,onExitComplete:M,register:I}=m,F=ce.useId();ce.useEffect(()=>{if(p)return I(F)},[p]);const P=ce.useCallback(()=>p&&M&&M(F),[F,M,p]);return!w&&M?[!1,P]:[!0]}const Em=p=>p.key||"";function C1(p){const m=[];return ce.Children.forEach(p,w=>{ce.isValidElement(w)&&m.push(w)}),m}const Py=({children:p,custom:m,initial:w=!0,onExitComplete:M,presenceAffectsLayout:I=!0,mode:F="sync",propagate:P=!1,anchorX:u="left",root:H})=>{const[X,Q]=My(P),dt=ce.useMemo(()=>C1(p),[p]),ht=P&&!X?[]:dt.map(Em),lt=ce.useRef(!0),Yt=ce.useRef(dt),Jt=ug(()=>new Map),[pe,ge]=ce.useState(dt),[de,ne]=ce.useState(dt);R0(()=>{lt.current=!1,Yt.current=dt;for(let Ve=0;Ve<de.length;Ve++){const Je=Em(de[Ve]);ht.includes(Je)?Jt.delete(Je):Jt.get(Je)!==!0&&Jt.set(Je,!1)}},[de,ht.length,ht.join("-")]);const Ne=[];if(dt!==pe){let Ve=[...dt];for(let Je=0;Je<de.length;Je++){const Ue=de[Je],Ei=Em(Ue);ht.includes(Ei)||(Ve.splice(Je,0,Ue),Ne.push(Ue))}return F==="wait"&&Ne.length&&(Ve=Ne),ne(C1(Ve)),ge(dt),null}const{forceRender:we}=ce.useContext(cg);return Tt.jsx(Tt.Fragment,{children:de.map(Ve=>{const Je=Em(Ve),Ue=P&&!X?!1:dt===de||ht.includes(Je),Ei=()=>{if(Jt.has(Je))Jt.set(Je,!0);else return;let Ti=!0;Jt.forEach(zi=>{zi||(Ti=!1)}),Ti&&(we?.(),ne(Yt.current),P&&Q?.(),M&&M())};return Tt.jsx(Cx,{isPresent:Ue,initial:!lt.current||w?void 0:!1,custom:m,presenceAffectsLayout:I,mode:F,root:H,onExitComplete:Ue?void 0:Ei,anchorX:u,children:Ve},Je)})})},Ay=ce.createContext({strict:!1}),E1={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},xf={};for(const p in E1)xf[p]={isEnabled:m=>E1[p].some(w=>!!m[w])};function zx(p){for(const m in p)xf[m]={...xf[m],...p[m]}}const Dx=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Vm(p){return p.startsWith("while")||p.startsWith("drag")&&p!=="draggable"||p.startsWith("layout")||p.startsWith("onTap")||p.startsWith("onPan")||p.startsWith("onLayout")||Dx.has(p)}let Cy=p=>!Vm(p);function Lx(p){typeof p=="function"&&(Cy=m=>m.startsWith("on")?!Vm(m):p(m))}try{Lx(require("@emotion/is-prop-valid").default)}catch{}function Ix(p,m,w){const M={};for(const I in p)I==="values"&&typeof p.values=="object"||(Cy(I)||w===!0&&Vm(I)||!m&&!Vm(I)||p.draggable&&I.startsWith("onDrag"))&&(M[I]=p[I]);return M}const Hm=ce.createContext({});function qm(p){return p!==null&&typeof p=="object"&&typeof p.start=="function"}function Ap(p){return typeof p=="string"||Array.isArray(p)}const Rg=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],kg=["initial",...Rg];function $m(p){return qm(p.animate)||kg.some(m=>Ap(p[m]))}function Ey(p){return!!($m(p)||p.variants)}function Rx(p,m){if($m(p)){const{initial:w,animate:M}=p;return{initial:w===!1||Ap(w)?w:void 0,animate:Ap(M)?M:void 0}}return p.inherit!==!1?m:{}}function kx(p){const{initial:m,animate:w}=Rx(p,ce.useContext(Hm));return ce.useMemo(()=>({initial:m,animate:w}),[z1(m),z1(w)])}function z1(p){return Array.isArray(p)?p.join(" "):p}const Cp={};function Bx(p){for(const m in p)Cp[m]=p[m],vg(m)&&(Cp[m].isCSSVariable=!0)}function zy(p,{layout:m,layoutId:w}){return Sf.has(p)||p.startsWith("origin")||(m||w!==void 0)&&(!!Cp[p]||p==="opacity")}const Ox={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Nx=Tf.length;function jx(p,m,w){let M="",I=!0;for(let F=0;F<Nx;F++){const P=Tf[F],u=p[P];if(u===void 0)continue;let H=!0;if(typeof u=="number"?H=u===(P.startsWith("scale")?1:0):H=parseFloat(u)===0,!H||w){const X=vy(u,zg[P]);if(!H){I=!1;const Q=Ox[P]||P;M+=`${Q}(${X}) `}w&&(m[P]=X)}}return M=M.trim(),w?M=w(m,I?"":M):I&&(M="none"),M}function Bg(p,m,w){const{style:M,vars:I,transformOrigin:F}=p;let P=!1,u=!1;for(const H in m){const X=m[H];if(Sf.has(H)){P=!0;continue}else if(vg(H)){I[H]=X;continue}else{const Q=vy(X,zg[H]);H.startsWith("origin")?(u=!0,F[H]=Q):M[H]=Q}}if(m.transform||(P||w?M.transform=jx(m,p.transform,w):M.transform&&(M.transform="none")),u){const{originX:H="50%",originY:X="50%",originZ:Q=0}=F;M.transformOrigin=`${H} ${X} ${Q}`}}const Og=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Dy(p,m,w){for(const M in m)!Ga(m[M])&&!zy(M,w)&&(p[M]=m[M])}function Fx({transformTemplate:p},m){return ce.useMemo(()=>{const w=Og();return Bg(w,m,p),Object.assign({},w.vars,w.style)},[m])}function Vx(p,m){const w=p.style||{},M={};return Dy(M,w,p),Object.assign(M,Fx(p,m)),M}function Ux(p,m){const w={},M=Vx(p,m);return p.drag&&p.dragListener!==!1&&(w.draggable=!1,M.userSelect=M.WebkitUserSelect=M.WebkitTouchCallout="none",M.touchAction=p.drag===!0?"none":`pan-${p.drag==="x"?"y":"x"}`),p.tabIndex===void 0&&(p.onTap||p.onTapStart||p.whileTap)&&(w.tabIndex=0),w.style=M,w}const Zx={offset:"stroke-dashoffset",array:"stroke-dasharray"},Gx={offset:"strokeDashoffset",array:"strokeDasharray"};function Hx(p,m,w=1,M=0,I=!0){p.pathLength=1;const F=I?Zx:Gx;p[F.offset]=wi.transform(-M);const P=wi.transform(m),u=wi.transform(w);p[F.array]=`${P} ${u}`}function Ly(p,{attrX:m,attrY:w,attrScale:M,pathLength:I,pathSpacing:F=1,pathOffset:P=0,...u},H,X,Q){if(Bg(p,u,X),H){p.style.viewBox&&(p.attrs.viewBox=p.style.viewBox);return}p.attrs=p.style,p.style={};const{attrs:dt,style:ht}=p;dt.transform&&(ht.transform=dt.transform,delete dt.transform),(ht.transform||dt.transformOrigin)&&(ht.transformOrigin=dt.transformOrigin??"50% 50%",delete dt.transformOrigin),ht.transform&&(ht.transformBox=Q?.transformBox??"fill-box",delete dt.transformBox),m!==void 0&&(dt.x=m),w!==void 0&&(dt.y=w),M!==void 0&&(dt.scale=M),I!==void 0&&Hx(dt,I,F,P,!1)}const Iy=()=>({...Og(),attrs:{}}),Ry=p=>typeof p=="string"&&p.toLowerCase()==="svg";function qx(p,m,w,M){const I=ce.useMemo(()=>{const F=Iy();return Ly(F,m,Ry(M),p.transformTemplate,p.style),{...F.attrs,style:{...F.style}}},[m]);if(p.style){const F={};Dy(F,p.style,p),I.style={...F,...I.style}}return I}const $x=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Ng(p){return typeof p!="string"||p.includes("-")?!1:!!($x.indexOf(p)>-1||/[A-Z]/u.test(p))}function Xx(p,m,w,{latestValues:M},I,F=!1){const u=(Ng(p)?qx:Ux)(m,M,I,p),H=Ix(m,typeof p=="string",F),X=p!==ce.Fragment?{...H,...u,ref:w}:{},{children:Q}=m,dt=ce.useMemo(()=>Ga(Q)?Q.get():Q,[Q]);return ce.createElement(p,{...X,children:dt})}function D1(p){const m=[{},{}];return p?.values.forEach((w,M)=>{m[0][M]=w.get(),m[1][M]=w.getVelocity()}),m}function jg(p,m,w,M){if(typeof m=="function"){const[I,F]=D1(M);m=m(w!==void 0?w:p.custom,I,F)}if(typeof m=="string"&&(m=p.variants&&p.variants[m]),typeof m=="function"){const[I,F]=D1(M);m=m(w!==void 0?w:p.custom,I,F)}return m}function Rm(p){return Ga(p)?p.get():p}function Yx({scrapeMotionValuesFromProps:p,createRenderState:m},w,M,I){return{latestValues:Wx(w,M,I,p),renderState:m()}}function Wx(p,m,w,M){const I={},F=M(p,{});for(const ht in F)I[ht]=Rm(F[ht]);let{initial:P,animate:u}=p;const H=$m(p),X=Ey(p);m&&X&&!H&&p.inherit!==!1&&(P===void 0&&(P=m.initial),u===void 0&&(u=m.animate));let Q=w?w.initial===!1:!1;Q=Q||P===!1;const dt=Q?u:P;if(dt&&typeof dt!="boolean"&&!qm(dt)){const ht=Array.isArray(dt)?dt:[dt];for(let lt=0;lt<ht.length;lt++){const Yt=jg(p,ht[lt]);if(Yt){const{transitionEnd:Jt,transition:pe,...ge}=Yt;for(const de in ge){let ne=ge[de];if(Array.isArray(ne)){const Ne=Q?ne.length-1:0;ne=ne[Ne]}ne!==null&&(I[de]=ne)}for(const de in Jt)I[de]=Jt[de]}}}return I}const ky=p=>(m,w)=>{const M=ce.useContext(Hm),I=ce.useContext(Gm),F=()=>Yx(p,m,M,I);return w?F():ug(F)};function Fg(p,m,w){const{style:M}=p,I={};for(const F in M)(Ga(M[F])||m.style&&Ga(m.style[F])||zy(F,p)||w?.getValue(F)?.liveStyle!==void 0)&&(I[F]=M[F]);return I}const Kx=ky({scrapeMotionValuesFromProps:Fg,createRenderState:Og});function By(p,m,w){const M=Fg(p,m,w);for(const I in p)if(Ga(p[I])||Ga(m[I])){const F=Tf.indexOf(I)!==-1?"attr"+I.charAt(0).toUpperCase()+I.substring(1):I;M[F]=p[I]}return M}const Qx=ky({scrapeMotionValuesFromProps:By,createRenderState:Iy}),Jx=Symbol.for("motionComponentSymbol");function pf(p){return p&&typeof p=="object"&&Object.prototype.hasOwnProperty.call(p,"current")}function t8(p,m,w){return ce.useCallback(M=>{M&&p.onMount&&p.onMount(M),m&&(M?m.mount(M):m.unmount()),w&&(typeof w=="function"?w(M):pf(w)&&(w.current=M))},[m])}const Vg=p=>p.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),e8="framerAppearId",Oy="data-"+Vg(e8),Ny=ce.createContext({});function i8(p,m,w,M,I){const{visualElement:F}=ce.useContext(Hm),P=ce.useContext(Ay),u=ce.useContext(Gm),H=ce.useContext(Ig).reducedMotion,X=ce.useRef(null);M=M||P.renderer,!X.current&&M&&(X.current=M(p,{visualState:m,parent:F,props:w,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:H}));const Q=X.current,dt=ce.useContext(Ny);Q&&!Q.projection&&I&&(Q.type==="html"||Q.type==="svg")&&n8(X.current,w,I,dt);const ht=ce.useRef(!1);ce.useInsertionEffect(()=>{Q&&ht.current&&Q.update(w,u)});const lt=w[Oy],Yt=ce.useRef(!!lt&&!window.MotionHandoffIsComplete?.(lt)&&window.MotionHasOptimisedAnimation?.(lt));return R0(()=>{Q&&(ht.current=!0,window.MotionIsMounted=!0,Q.updateFeatures(),Q.scheduleRenderMicrotask(),Yt.current&&Q.animationState&&Q.animationState.animateChanges())}),ce.useEffect(()=>{Q&&(!Yt.current&&Q.animationState&&Q.animationState.animateChanges(),Yt.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(lt)}),Yt.current=!1),Q.enteringChildren=void 0)}),Q}function n8(p,m,w,M){const{layoutId:I,layout:F,drag:P,dragConstraints:u,layoutScroll:H,layoutRoot:X,layoutCrossfade:Q}=m;p.projection=new w(p.latestValues,m["data-framer-portal-id"]?void 0:jy(p.parent)),p.projection.setOptions({layoutId:I,layout:F,alwaysMeasureLayout:!!P||u&&pf(u),visualElement:p,animationType:typeof F=="string"?F:"both",initialPromotionConfig:M,crossfade:Q,layoutScroll:H,layoutRoot:X})}function jy(p){if(p)return p.options.allowProjection!==!1?p.projection:jy(p.parent)}function v_(p,{forwardMotionProps:m=!1}={},w,M){w&&zx(w);const I=Ng(p)?Qx:Kx;function F(u,H){let X;const Q={...ce.useContext(Ig),...u,layoutId:r8(u)},{isStatic:dt}=Q,ht=kx(u),lt=I(u,dt);if(!dt&&hg){s8();const Yt=a8(Q);X=Yt.MeasureLayout,ht.visualElement=i8(p,lt,Q,M,Yt.ProjectionNode)}return Tt.jsxs(Hm.Provider,{value:ht,children:[X&&ht.visualElement?Tt.jsx(X,{visualElement:ht.visualElement,...Q}):null,Xx(p,u,t8(lt,ht.visualElement,H),lt,dt,m)]})}F.displayName=`motion.${typeof p=="string"?p:`create(${p.displayName??p.name??""})`}`;const P=ce.forwardRef(F);return P[Jx]=p,P}function r8({layoutId:p}){const m=ce.useContext(cg).id;return m&&p!==void 0?m+"-"+p:p}function s8(p,m){ce.useContext(Ay).strict}function a8(p){const{drag:m,layout:w}=xf;if(!m&&!w)return{};const M={...m,...w};return{MeasureLayout:m?.isEnabled(p)||w?.isEnabled(p)?M.MeasureLayout:void 0,ProjectionNode:M.ProjectionNode}}function o8(p,m){if(typeof Proxy>"u")return v_;const w=new Map,M=(F,P)=>v_(F,P,p,m),I=(F,P)=>M(F,P);return new Proxy(I,{get:(F,P)=>P==="create"?M:(w.has(P)||w.set(P,v_(P,void 0,p,m)),w.get(P))})}function Fy({top:p,left:m,right:w,bottom:M}){return{x:{min:m,max:w},y:{min:p,max:M}}}function l8({x:p,y:m}){return{top:m.min,right:p.max,bottom:m.max,left:p.min}}function c8(p,m){if(!m)return p;const w=m({x:p.left,y:p.top}),M=m({x:p.right,y:p.bottom});return{top:w.y,left:w.x,bottom:M.y,right:M.x}}function x_(p){return p===void 0||p===1}function X_({scale:p,scaleX:m,scaleY:w}){return!x_(p)||!x_(m)||!x_(w)}function wd(p){return X_(p)||Vy(p)||p.z||p.rotate||p.rotateX||p.rotateY||p.skewX||p.skewY}function Vy(p){return L1(p.x)||L1(p.y)}function L1(p){return p&&p!=="0%"}function Um(p,m,w){const M=p-w,I=m*M;return w+I}function I1(p,m,w,M,I){return I!==void 0&&(p=Um(p,I,M)),Um(p,w,M)+m}function Y_(p,m=0,w=1,M,I){p.min=I1(p.min,m,w,M,I),p.max=I1(p.max,m,w,M,I)}function Uy(p,{x:m,y:w}){Y_(p.x,m.translate,m.scale,m.originPoint),Y_(p.y,w.translate,w.scale,w.originPoint)}const R1=.999999999999,k1=1.0000000000001;function u8(p,m,w,M=!1){const I=w.length;if(!I)return;m.x=m.y=1;let F,P;for(let u=0;u<I;u++){F=w[u],P=F.projectionDelta;const{visualElement:H}=F.options;H&&H.props.style&&H.props.style.display==="contents"||(M&&F.options.layoutScroll&&F.scroll&&F!==F.root&&_f(p,{x:-F.scroll.offset.x,y:-F.scroll.offset.y}),P&&(m.x*=P.x.scale,m.y*=P.y.scale,Uy(p,P)),M&&wd(F.latestValues)&&_f(p,F.latestValues))}m.x<k1&&m.x>R1&&(m.x=1),m.y<k1&&m.y>R1&&(m.y=1)}function mf(p,m){p.min=p.min+m,p.max=p.max+m}function B1(p,m,w,M,I=.5){const F=Lr(p.min,p.max,I);Y_(p,m,w,F,M)}function _f(p,m){B1(p.x,m.x,m.scaleX,m.scale,m.originX),B1(p.y,m.y,m.scaleY,m.scale,m.originY)}function Zy(p,m){return Fy(c8(p.getBoundingClientRect(),m))}function h8(p,m,w){const M=Zy(p,w),{scroll:I}=m;return I&&(mf(M.x,I.offset.x),mf(M.y,I.offset.y)),M}const O1=()=>({translate:0,scale:1,origin:0,originPoint:0}),gf=()=>({x:O1(),y:O1()}),N1=()=>({min:0,max:0}),Jr=()=>({x:N1(),y:N1()}),W_={current:null},Gy={current:!1};function d8(){if(Gy.current=!0,!!hg)if(window.matchMedia){const p=window.matchMedia("(prefers-reduced-motion)"),m=()=>W_.current=p.matches;p.addEventListener("change",m),m()}else W_.current=!1}const f8=new WeakMap;function p8(p,m,w){for(const M in m){const I=m[M],F=w[M];if(Ga(I))p.addValue(M,I);else if(Ga(F))p.addValue(M,vf(I,{owner:p}));else if(F!==I)if(p.hasValue(M)){const P=p.getValue(M);P.liveStyle===!0?P.jump(I):P.hasAnimated||P.set(I)}else{const P=p.getStaticValue(M);p.addValue(M,vf(P!==void 0?P:I,{owner:p}))}}for(const M in w)m[M]===void 0&&p.removeValue(M);return m}const j1=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class m8{scrapeMotionValuesFromProps(m,w,M){return{}}constructor({parent:m,props:w,presenceContext:M,reducedMotionConfig:I,blockInitialAnimation:F,visualState:P},u={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Cg,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const ht=Zo.now();this.renderScheduledAt<ht&&(this.renderScheduledAt=ht,br.render(this.render,!1,!0))};const{latestValues:H,renderState:X}=P;this.latestValues=H,this.baseTarget={...H},this.initialValues=w.initial?{...H}:{},this.renderState=X,this.parent=m,this.props=w,this.presenceContext=M,this.depth=m?m.depth+1:0,this.reducedMotionConfig=I,this.options=u,this.blockInitialAnimation=!!F,this.isControllingVariants=$m(w),this.isVariantNode=Ey(w),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(m&&m.current);const{willChange:Q,...dt}=this.scrapeMotionValuesFromProps(w,{},this);for(const ht in dt){const lt=dt[ht];H[ht]!==void 0&&Ga(lt)&&lt.set(H[ht])}}mount(m){this.current=m,f8.set(m,this),this.projection&&!this.projection.instance&&this.projection.mount(m),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((w,M)=>this.bindToMotionValue(M,w)),Gy.current||d8(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:W_.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),zh(this.notifyUpdate),zh(this.render),this.valueSubscriptions.forEach(m=>m()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const m in this.events)this.events[m].clear();for(const m in this.features){const w=this.features[m];w&&(w.unmount(),w.isMounted=!1)}this.current=null}addChild(m){this.children.add(m),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(m)}removeChild(m){this.children.delete(m),this.enteringChildren&&this.enteringChildren.delete(m)}bindToMotionValue(m,w){this.valueSubscriptions.has(m)&&this.valueSubscriptions.get(m)();const M=Sf.has(m);M&&this.onBindTransform&&this.onBindTransform();const I=w.on("change",P=>{this.latestValues[m]=P,this.props.onUpdate&&br.preRender(this.notifyUpdate),M&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let F;window.MotionCheckAppearSync&&(F=window.MotionCheckAppearSync(this,m,w)),this.valueSubscriptions.set(m,()=>{I(),F&&F(),w.owner&&w.stop()})}sortNodePosition(m){return!this.current||!this.sortInstanceNodePosition||this.type!==m.type?0:this.sortInstanceNodePosition(this.current,m.current)}updateFeatures(){let m="animation";for(m in xf){const w=xf[m];if(!w)continue;const{isEnabled:M,Feature:I}=w;if(!this.features[m]&&I&&M(this.props)&&(this.features[m]=new I(this)),this.features[m]){const F=this.features[m];F.isMounted?F.update():(F.mount(),F.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Jr()}getStaticValue(m){return this.latestValues[m]}setStaticValue(m,w){this.latestValues[m]=w}update(m,w){(m.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=m,this.prevPresenceContext=this.presenceContext,this.presenceContext=w;for(let M=0;M<j1.length;M++){const I=j1[M];this.propEventSubscriptions[I]&&(this.propEventSubscriptions[I](),delete this.propEventSubscriptions[I]);const F="on"+I,P=m[F];P&&(this.propEventSubscriptions[I]=this.on(I,P))}this.prevMotionValues=p8(this,this.scrapeMotionValuesFromProps(m,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(m){return this.props.variants?this.props.variants[m]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(m){const w=this.getClosestVariantNode();if(w)return w.variantChildren&&w.variantChildren.add(m),()=>w.variantChildren.delete(m)}addValue(m,w){const M=this.values.get(m);w!==M&&(M&&this.removeValue(m),this.bindToMotionValue(m,w),this.values.set(m,w),this.latestValues[m]=w.get())}removeValue(m){this.values.delete(m);const w=this.valueSubscriptions.get(m);w&&(w(),this.valueSubscriptions.delete(m)),delete this.latestValues[m],this.removeValueFromRenderState(m,this.renderState)}hasValue(m){return this.values.has(m)}getValue(m,w){if(this.props.values&&this.props.values[m])return this.props.values[m];let M=this.values.get(m);return M===void 0&&w!==void 0&&(M=vf(w===null?void 0:w,{owner:this}),this.addValue(m,M)),M}readValue(m,w){let M=this.latestValues[m]!==void 0||!this.current?this.latestValues[m]:this.getBaseTargetFromProps(this.props,m)??this.readValueFromInstance(this.current,m,this.options);return M!=null&&(typeof M=="string"&&(k0(M)||O0(M))?M=parseFloat(M):!Mx(M)&&Dh.test(w)&&(M=yy(m,w)),this.setBaseTarget(m,Ga(M)?M.get():M)),Ga(M)?M.get():M}setBaseTarget(m,w){this.baseTarget[m]=w}getBaseTarget(m){const{initial:w}=this.props;let M;if(typeof w=="string"||typeof w=="object"){const F=jg(this.props,w,this.presenceContext?.custom);F&&(M=F[m])}if(w&&M!==void 0)return M;const I=this.getBaseTargetFromProps(this.props,m);return I!==void 0&&!Ga(I)?I:this.initialValues[m]!==void 0&&M===void 0?void 0:this.baseTarget[m]}on(m,w){return this.events[m]||(this.events[m]=new _g),this.events[m].add(w)}notify(m,...w){this.events[m]&&this.events[m].notify(...w)}scheduleRenderMicrotask(){Dg.render(this.render)}}class Hy extends m8{constructor(){super(...arguments),this.KeyframeResolver=fx}sortInstanceNodePosition(m,w){return m.compareDocumentPosition(w)&2?1:-1}getBaseTargetFromProps(m,w){return m.style?m.style[w]:void 0}removeValueFromRenderState(m,{vars:w,style:M}){delete w[m],delete M[m]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:m}=this.props;Ga(m)&&(this.childSubscription=m.on("change",w=>{this.current&&(this.current.textContent=`${w}`)}))}}function qy(p,{style:m,vars:w},M,I){const F=p.style;let P;for(P in m)F[P]=m[P];I?.applyProjectionStyles(F,M);for(P in w)F.setProperty(P,w[P])}function _8(p){return window.getComputedStyle(p)}class g8 extends Hy{constructor(){super(...arguments),this.type="html",this.renderInstance=qy}readValueFromInstance(m,w){if(Sf.has(w))return this.projection?.isProjecting?V_(w):L2(m,w);{const M=_8(m),I=(vg(w)?M.getPropertyValue(w):M[w])||0;return typeof I=="string"?I.trim():I}}measureInstanceViewportBox(m,{transformPagePoint:w}){return Zy(m,w)}build(m,w,M){Bg(m,w,M.transformTemplate)}scrapeMotionValuesFromProps(m,w,M){return Fg(m,w,M)}}const $y=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function y8(p,m,w,M){qy(p,m,void 0,M);for(const I in m.attrs)p.setAttribute($y.has(I)?I:Vg(I),m.attrs[I])}class v8 extends Hy{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Jr}getBaseTargetFromProps(m,w){return m[w]}readValueFromInstance(m,w){if(Sf.has(w)){const M=gy(w);return M&&M.default||0}return w=$y.has(w)?w:Vg(w),m.getAttribute(w)}scrapeMotionValuesFromProps(m,w,M){return By(m,w,M)}build(m,w,M){Ly(m,w,this.isSVGTag,M.transformTemplate,M.style)}renderInstance(m,w,M,I){y8(m,w,M,I)}mount(m){this.isSVGTag=Ry(m.tagName),super.mount(m)}}const x8=(p,m)=>Ng(p)?new v8(m):new g8(m,{allowProjection:p!==ce.Fragment});function yf(p,m,w){const M=p.getProps();return jg(M,m,w!==void 0?w:M.custom,p)}const K_=p=>Array.isArray(p);function b8(p,m,w){p.hasValue(m)?p.getValue(m).set(w):p.addValue(m,vf(w))}function w8(p){return K_(p)?p[p.length-1]||0:p}function T8(p,m){const w=yf(p,m);let{transitionEnd:M={},transition:I={},...F}=w||{};F={...F,...M};for(const P in F){const u=w8(F[P]);b8(p,P,u)}}function S8(p){return!!(Ga(p)&&p.add)}function Q_(p,m){const w=p.getValue("willChange");if(S8(w))return w.add(m);if(!w&&$u.WillChange){const M=new $u.WillChange("auto");p.addValue("willChange",M),M.add(m)}}function Xy(p){return p.props[Oy]}const M8=p=>p!==null;function P8(p,{repeat:m,repeatType:w="loop"},M){const I=p.filter(M8),F=m&&w!=="loop"&&m%2===1?0:I.length-1;return I[F]}const A8={type:"spring",stiffness:500,damping:25,restSpeed:10},C8=p=>({type:"spring",stiffness:550,damping:p===0?2*Math.sqrt(550):30,restSpeed:10}),E8={type:"keyframes",duration:.8},z8={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},D8=(p,{keyframes:m})=>m.length>2?E8:Sf.has(p)?p.startsWith("scale")?C8(m[1]):A8:z8;function L8({when:p,delay:m,delayChildren:w,staggerChildren:M,staggerDirection:I,repeat:F,repeatType:P,repeatDelay:u,from:H,elapsed:X,...Q}){return!!Object.keys(Q).length}const Ug=(p,m,w,M={},I,F)=>P=>{const u=Eg(M,p)||{},H=u.delay||M.delay||0;let{elapsed:X=0}=M;X=X-hu(H);const Q={keyframes:Array.isArray(w)?w:[null,w],ease:"easeOut",velocity:m.getVelocity(),...u,delay:-X,onUpdate:ht=>{m.set(ht),u.onUpdate&&u.onUpdate(ht)},onComplete:()=>{P(),u.onComplete&&u.onComplete()},name:p,motionValue:m,element:F?void 0:I};L8(u)||Object.assign(Q,D8(p,Q)),Q.duration&&(Q.duration=hu(Q.duration)),Q.repeatDelay&&(Q.repeatDelay=hu(Q.repeatDelay)),Q.from!==void 0&&(Q.keyframes[0]=Q.from);let dt=!1;if((Q.type===!1||Q.duration===0&&!Q.repeatDelay)&&(q_(Q),Q.delay===0&&(dt=!0)),($u.instantAnimations||$u.skipAnimations)&&(dt=!0,q_(Q),Q.delay=0),Q.allowFlatten=!u.type&&!u.ease,dt&&!F&&m.get()!==void 0){const ht=P8(Q.keyframes,u);if(ht!==void 0){br.update(()=>{Q.onUpdate(ht),Q.onComplete()});return}}return u.isSync?new Ag(Q):new ex(Q)};function I8({protectedKeys:p,needsAnimating:m},w){const M=p.hasOwnProperty(w)&&m[w]!==!0;return m[w]=!1,M}function Yy(p,m,{delay:w=0,transitionOverride:M,type:I}={}){let{transition:F=p.getDefaultTransition(),transitionEnd:P,...u}=m;M&&(F=M);const H=[],X=I&&p.animationState&&p.animationState.getState()[I];for(const Q in u){const dt=p.getValue(Q,p.latestValues[Q]??null),ht=u[Q];if(ht===void 0||X&&I8(X,Q))continue;const lt={delay:w,...Eg(F||{},Q)},Yt=dt.get();if(Yt!==void 0&&!dt.isAnimating&&!Array.isArray(ht)&&ht===Yt&&!lt.velocity)continue;let Jt=!1;if(window.MotionHandoffAnimation){const ge=Xy(p);if(ge){const de=window.MotionHandoffAnimation(ge,Q,br);de!==null&&(lt.startTime=de,Jt=!0)}}Q_(p,Q),dt.start(Ug(Q,dt,ht,p.shouldReduceMotion&&py.has(Q)?{type:!1}:lt,p,Jt));const pe=dt.animation;pe&&H.push(pe)}return P&&Promise.all(H).then(()=>{br.update(()=>{P&&T8(p,P)})}),H}function Wy(p,m,w,M=0,I=1){const F=Array.from(p).sort((X,Q)=>X.sortNodePosition(Q)).indexOf(m),P=p.size,u=(P-1)*M;return typeof w=="function"?w(F,P):I===1?F*M:u-F*M}function J_(p,m,w={}){const M=yf(p,m,w.type==="exit"?p.presenceContext?.custom:void 0);let{transition:I=p.getDefaultTransition()||{}}=M||{};w.transitionOverride&&(I=w.transitionOverride);const F=M?()=>Promise.all(Yy(p,M,w)):()=>Promise.resolve(),P=p.variantChildren&&p.variantChildren.size?(H=0)=>{const{delayChildren:X=0,staggerChildren:Q,staggerDirection:dt}=I;return R8(p,m,H,X,Q,dt,w)}:()=>Promise.resolve(),{when:u}=I;if(u){const[H,X]=u==="beforeChildren"?[F,P]:[P,F];return H().then(()=>X())}else return Promise.all([F(),P(w.delay)])}function R8(p,m,w=0,M=0,I=0,F=1,P){const u=[];for(const H of p.variantChildren)H.notify("AnimationStart",m),u.push(J_(H,m,{...P,delay:w+(typeof M=="function"?0:M)+Wy(p.variantChildren,H,M,I,F)}).then(()=>H.notify("AnimationComplete",m)));return Promise.all(u)}function k8(p,m,w={}){p.notify("AnimationStart",m);let M;if(Array.isArray(m)){const I=m.map(F=>J_(p,F,w));M=Promise.all(I)}else if(typeof m=="string")M=J_(p,m,w);else{const I=typeof m=="function"?yf(p,m,w.custom):m;M=Promise.all(Yy(p,I,w))}return M.then(()=>{p.notify("AnimationComplete",m)})}function Ky(p,m){if(!Array.isArray(m))return!1;const w=m.length;if(w!==p.length)return!1;for(let M=0;M<w;M++)if(m[M]!==p[M])return!1;return!0}const B8=kg.length;function Qy(p){if(!p)return;if(!p.isControllingVariants){const w=p.parent?Qy(p.parent)||{}:{};return p.props.initial!==void 0&&(w.initial=p.props.initial),w}const m={};for(let w=0;w<B8;w++){const M=kg[w],I=p.props[M];(Ap(I)||I===!1)&&(m[M]=I)}return m}const O8=[...Rg].reverse(),N8=Rg.length;function j8(p){return m=>Promise.all(m.map(({animation:w,options:M})=>k8(p,w,M)))}function F8(p){let m=j8(p),w=F1(),M=!0;const I=H=>(X,Q)=>{const dt=yf(p,Q,H==="exit"?p.presenceContext?.custom:void 0);if(dt){const{transition:ht,transitionEnd:lt,...Yt}=dt;X={...X,...Yt,...lt}}return X};function F(H){m=H(p)}function P(H){const{props:X}=p,Q=Qy(p.parent)||{},dt=[],ht=new Set;let lt={},Yt=1/0;for(let pe=0;pe<N8;pe++){const ge=O8[pe],de=w[ge],ne=X[ge]!==void 0?X[ge]:Q[ge],Ne=Ap(ne),we=ge===H?de.isActive:null;we===!1&&(Yt=pe);let Ve=ne===Q[ge]&&ne!==X[ge]&&Ne;if(Ve&&M&&p.manuallyAnimateOnMount&&(Ve=!1),de.protectedKeys={...lt},!de.isActive&&we===null||!ne&&!de.prevProp||qm(ne)||typeof ne=="boolean")continue;const Je=V8(de.prevProp,ne);let Ue=Je||ge===H&&de.isActive&&!Ve&&Ne||pe>Yt&&Ne,Ei=!1;const Ti=Array.isArray(ne)?ne:[ne];let zi=Ti.reduce(I(ge),{});we===!1&&(zi={});const{prevResolvedValues:Pi={}}=de,Ir={...Pi,...zi},Rn=me=>{Ue=!0,ht.has(me)&&(Ei=!0,ht.delete(me)),de.needsAnimating[me]=!0;const fe=p.getValue(me);fe&&(fe.liveStyle=!1)};for(const me in Ir){const fe=zi[me],Ze=Pi[me];if(lt.hasOwnProperty(me))continue;let yt=!1;K_(fe)&&K_(Ze)?yt=!Ky(fe,Ze):yt=fe!==Ze,yt?fe!=null?Rn(me):ht.add(me):fe!==void 0&&ht.has(me)?Rn(me):de.protectedKeys[me]=!0}de.prevProp=ne,de.prevResolvedValues=zi,de.isActive&&(lt={...lt,...zi}),M&&p.blockInitialAnimation&&(Ue=!1);const dn=Ve&&Je;Ue&&(!dn||Ei)&&dt.push(...Ti.map(me=>{const fe={type:ge};if(typeof me=="string"&&M&&!dn&&p.manuallyAnimateOnMount&&p.parent){const{parent:Ze}=p,yt=yf(Ze,me);if(Ze.enteringChildren&&yt){const{delayChildren:Wt}=yt.transition||{};fe.delay=Wy(Ze.enteringChildren,p,Wt)}}return{animation:me,options:fe}}))}if(ht.size){const pe={};if(typeof X.initial!="boolean"){const ge=yf(p,Array.isArray(X.initial)?X.initial[0]:X.initial);ge&&ge.transition&&(pe.transition=ge.transition)}ht.forEach(ge=>{const de=p.getBaseTarget(ge),ne=p.getValue(ge);ne&&(ne.liveStyle=!0),pe[ge]=de??null}),dt.push({animation:pe})}let Jt=!!dt.length;return M&&(X.initial===!1||X.initial===X.animate)&&!p.manuallyAnimateOnMount&&(Jt=!1),M=!1,Jt?m(dt):Promise.resolve()}function u(H,X){if(w[H].isActive===X)return Promise.resolve();p.variantChildren?.forEach(dt=>dt.animationState?.setActive(H,X)),w[H].isActive=X;const Q=P(H);for(const dt in w)w[dt].protectedKeys={};return Q}return{animateChanges:P,setActive:u,setAnimateFunction:F,getState:()=>w,reset:()=>{w=F1(),M=!0}}}function V8(p,m){return typeof m=="string"?m!==p:Array.isArray(m)?!Ky(m,p):!1}function yd(p=!1){return{isActive:p,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function F1(){return{animate:yd(!0),whileInView:yd(),whileHover:yd(),whileTap:yd(),whileDrag:yd(),whileFocus:yd(),exit:yd()}}class Lh{constructor(m){this.isMounted=!1,this.node=m}update(){}}class U8 extends Lh{constructor(m){super(m),m.animationState||(m.animationState=F8(m))}updateAnimationControlsSubscription(){const{animate:m}=this.node.getProps();qm(m)&&(this.unmountControls=m.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:m}=this.node.getProps(),{animate:w}=this.node.prevProps||{};m!==w&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let Z8=0;class G8 extends Lh{constructor(){super(...arguments),this.id=Z8++}update(){if(!this.node.presenceContext)return;const{isPresent:m,onExitComplete:w}=this.node.presenceContext,{isPresent:M}=this.node.prevPresenceContext||{};if(!this.node.animationState||m===M)return;const I=this.node.animationState.setActive("exit",!m);w&&!m&&I.then(()=>{w(this.id)})}mount(){const{register:m,onExitComplete:w}=this.node.presenceContext||{};w&&w(this.id),m&&(this.unmount=m(this.id))}unmount(){}}const H8={animation:{Feature:U8},exit:{Feature:G8}};function Ep(p,m,w,M={passive:!0}){return p.addEventListener(m,w,M),()=>p.removeEventListener(m,w)}function Ip(p){return{point:{x:p.pageX,y:p.pageY}}}const q8=p=>m=>Lg(m)&&p(m,Ip(m));function bp(p,m,w,M){return Ep(p,m,q8(w),M)}const Jy=1e-4,$8=1-Jy,X8=1+Jy,t3=.01,Y8=0-t3,W8=0+t3;function yo(p){return p.max-p.min}function K8(p,m,w){return Math.abs(p-m)<=w}function V1(p,m,w,M=.5){p.origin=M,p.originPoint=Lr(m.min,m.max,p.origin),p.scale=yo(w)/yo(m),p.translate=Lr(w.min,w.max,p.origin)-p.originPoint,(p.scale>=$8&&p.scale<=X8||isNaN(p.scale))&&(p.scale=1),(p.translate>=Y8&&p.translate<=W8||isNaN(p.translate))&&(p.translate=0)}function wp(p,m,w,M){V1(p.x,m.x,w.x,M?M.originX:void 0),V1(p.y,m.y,w.y,M?M.originY:void 0)}function U1(p,m,w){p.min=w.min+m.min,p.max=p.min+yo(m)}function Q8(p,m,w){U1(p.x,m.x,w.x),U1(p.y,m.y,w.y)}function Z1(p,m,w){p.min=m.min-w.min,p.max=p.min+yo(m)}function Tp(p,m,w){Z1(p.x,m.x,w.x),Z1(p.y,m.y,w.y)}function Kl(p){return[p("x"),p("y")]}const e3=({current:p})=>p?p.ownerDocument.defaultView:null,G1=(p,m)=>Math.abs(p-m);function J8(p,m){const w=G1(p.x,m.x),M=G1(p.y,m.y);return Math.sqrt(w**2+M**2)}class i3{constructor(m,w,{transformPagePoint:M,contextWindow:I=window,dragSnapToOrigin:F=!1,distanceThreshold:P=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const ht=w_(this.lastMoveEventInfo,this.history),lt=this.startEvent!==null,Yt=J8(ht.offset,{x:0,y:0})>=this.distanceThreshold;if(!lt&&!Yt)return;const{point:Jt}=ht,{timestamp:pe}=ha;this.history.push({...Jt,timestamp:pe});const{onStart:ge,onMove:de}=this.handlers;lt||(ge&&ge(this.lastMoveEvent,ht),this.startEvent=this.lastMoveEvent),de&&de(this.lastMoveEvent,ht)},this.handlePointerMove=(ht,lt)=>{this.lastMoveEvent=ht,this.lastMoveEventInfo=b_(lt,this.transformPagePoint),br.update(this.updatePoint,!0)},this.handlePointerUp=(ht,lt)=>{this.end();const{onEnd:Yt,onSessionEnd:Jt,resumeAnimation:pe}=this.handlers;if(this.dragSnapToOrigin&&pe&&pe(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const ge=w_(ht.type==="pointercancel"?this.lastMoveEventInfo:b_(lt,this.transformPagePoint),this.history);this.startEvent&&Yt&&Yt(ht,ge),Jt&&Jt(ht,ge)},!Lg(m))return;this.dragSnapToOrigin=F,this.handlers=w,this.transformPagePoint=M,this.distanceThreshold=P,this.contextWindow=I||window;const u=Ip(m),H=b_(u,this.transformPagePoint),{point:X}=H,{timestamp:Q}=ha;this.history=[{...X,timestamp:Q}];const{onSessionStart:dt}=w;dt&&dt(m,w_(H,this.history)),this.removeListeners=zp(bp(this.contextWindow,"pointermove",this.handlePointerMove),bp(this.contextWindow,"pointerup",this.handlePointerUp),bp(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(m){this.handlers=m}end(){this.removeListeners&&this.removeListeners(),zh(this.updatePoint)}}function b_(p,m){return m?{point:m(p.point)}:p}function H1(p,m){return{x:p.x-m.x,y:p.y-m.y}}function w_({point:p},m){return{point:p,delta:H1(p,n3(m)),offset:H1(p,tb(m)),velocity:eb(m,.1)}}function tb(p){return p[0]}function n3(p){return p[p.length-1]}function eb(p,m){if(p.length<2)return{x:0,y:0};let w=p.length-1,M=null;const I=n3(p);for(;w>=0&&(M=p[w],!(I.timestamp-M.timestamp>hu(m)));)w--;if(!M)return{x:0,y:0};const F=du(I.timestamp-M.timestamp);if(F===0)return{x:0,y:0};const P={x:(I.x-M.x)/F,y:(I.y-M.y)/F};return P.x===1/0&&(P.x=0),P.y===1/0&&(P.y=0),P}function ib(p,{min:m,max:w},M){return m!==void 0&&p<m?p=M?Lr(m,p,M.min):Math.max(p,m):w!==void 0&&p>w&&(p=M?Lr(w,p,M.max):Math.min(p,w)),p}function q1(p,m,w){return{min:m!==void 0?p.min+m:void 0,max:w!==void 0?p.max+w-(p.max-p.min):void 0}}function nb(p,{top:m,left:w,bottom:M,right:I}){return{x:q1(p.x,w,I),y:q1(p.y,m,M)}}function $1(p,m){let w=m.min-p.min,M=m.max-p.max;return m.max-m.min<p.max-p.min&&([w,M]=[M,w]),{min:w,max:M}}function rb(p,m){return{x:$1(p.x,m.x),y:$1(p.y,m.y)}}function sb(p,m){let w=.5;const M=yo(p),I=yo(m);return I>M?w=Sp(m.min,m.max-M,p.min):M>I&&(w=Sp(p.min,p.max-I,m.min)),qu(0,1,w)}function ab(p,m){const w={};return m.min!==void 0&&(w.min=m.min-p.min),m.max!==void 0&&(w.max=m.max-p.min),w}const tg=.35;function ob(p=tg){return p===!1?p=0:p===!0&&(p=tg),{x:X1(p,"left","right"),y:X1(p,"top","bottom")}}function X1(p,m,w){return{min:Y1(p,m),max:Y1(p,w)}}function Y1(p,m){return typeof p=="number"?p:p[m]||0}const lb=new WeakMap;class cb{constructor(m){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Jr(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=m}start(m,{snapToCursor:w=!1,distanceThreshold:M}={}){const{presenceContext:I}=this.visualElement;if(I&&I.isPresent===!1)return;const F=dt=>{const{dragSnapToOrigin:ht}=this.getProps();ht?this.pauseAnimation():this.stopAnimation(),w&&this.snapToCursor(Ip(dt).point)},P=(dt,ht)=>{const{drag:lt,dragPropagation:Yt,onDragStart:Jt}=this.getProps();if(lt&&!Yt&&(this.openDragLock&&this.openDragLock(),this.openDragLock=gx(lt),!this.openDragLock))return;this.latestPointerEvent=dt,this.latestPanInfo=ht,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Kl(ge=>{let de=this.getAxisMotionValue(ge).get()||0;if(fu.test(de)){const{projection:ne}=this.visualElement;if(ne&&ne.layout){const Ne=ne.layout.layoutBox[ge];Ne&&(de=yo(Ne)*(parseFloat(de)/100))}}this.originPoint[ge]=de}),Jt&&br.postRender(()=>Jt(dt,ht)),Q_(this.visualElement,"transform");const{animationState:pe}=this.visualElement;pe&&pe.setActive("whileDrag",!0)},u=(dt,ht)=>{this.latestPointerEvent=dt,this.latestPanInfo=ht;const{dragPropagation:lt,dragDirectionLock:Yt,onDirectionLock:Jt,onDrag:pe}=this.getProps();if(!lt&&!this.openDragLock)return;const{offset:ge}=ht;if(Yt&&this.currentDirection===null){this.currentDirection=ub(ge),this.currentDirection!==null&&Jt&&Jt(this.currentDirection);return}this.updateAxis("x",ht.point,ge),this.updateAxis("y",ht.point,ge),this.visualElement.render(),pe&&pe(dt,ht)},H=(dt,ht)=>{this.latestPointerEvent=dt,this.latestPanInfo=ht,this.stop(dt,ht),this.latestPointerEvent=null,this.latestPanInfo=null},X=()=>Kl(dt=>this.getAnimationState(dt)==="paused"&&this.getAxisMotionValue(dt).animation?.play()),{dragSnapToOrigin:Q}=this.getProps();this.panSession=new i3(m,{onSessionStart:F,onStart:P,onMove:u,onSessionEnd:H,resumeAnimation:X},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:Q,distanceThreshold:M,contextWindow:e3(this.visualElement)})}stop(m,w){const M=m||this.latestPointerEvent,I=w||this.latestPanInfo,F=this.isDragging;if(this.cancel(),!F||!I||!M)return;const{velocity:P}=I;this.startAnimation(P);const{onDragEnd:u}=this.getProps();u&&br.postRender(()=>u(M,I))}cancel(){this.isDragging=!1;const{projection:m,animationState:w}=this.visualElement;m&&(m.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:M}=this.getProps();!M&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),w&&w.setActive("whileDrag",!1)}updateAxis(m,w,M){const{drag:I}=this.getProps();if(!M||!zm(m,I,this.currentDirection))return;const F=this.getAxisMotionValue(m);let P=this.originPoint[m]+M[m];this.constraints&&this.constraints[m]&&(P=ib(P,this.constraints[m],this.elastic[m])),F.set(P)}resolveConstraints(){const{dragConstraints:m,dragElastic:w}=this.getProps(),M=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,I=this.constraints;m&&pf(m)?this.constraints||(this.constraints=this.resolveRefConstraints()):m&&M?this.constraints=nb(M.layoutBox,m):this.constraints=!1,this.elastic=ob(w),I!==this.constraints&&M&&this.constraints&&!this.hasMutatedConstraints&&Kl(F=>{this.constraints!==!1&&this.getAxisMotionValue(F)&&(this.constraints[F]=ab(M.layoutBox[F],this.constraints[F]))})}resolveRefConstraints(){const{dragConstraints:m,onMeasureDragConstraints:w}=this.getProps();if(!m||!pf(m))return!1;const M=m.current,{projection:I}=this.visualElement;if(!I||!I.layout)return!1;const F=h8(M,I.root,this.visualElement.getTransformPagePoint());let P=rb(I.layout.layoutBox,F);if(w){const u=w(l8(P));this.hasMutatedConstraints=!!u,u&&(P=Fy(u))}return P}startAnimation(m){const{drag:w,dragMomentum:M,dragElastic:I,dragTransition:F,dragSnapToOrigin:P,onDragTransitionEnd:u}=this.getProps(),H=this.constraints||{},X=Kl(Q=>{if(!zm(Q,w,this.currentDirection))return;let dt=H&&H[Q]||{};P&&(dt={min:0,max:0});const ht=I?200:1e6,lt=I?40:1e7,Yt={type:"inertia",velocity:M?m[Q]:0,bounceStiffness:ht,bounceDamping:lt,timeConstant:750,restDelta:1,restSpeed:10,...F,...dt};return this.startAxisValueAnimation(Q,Yt)});return Promise.all(X).then(u)}startAxisValueAnimation(m,w){const M=this.getAxisMotionValue(m);return Q_(this.visualElement,m),M.start(Ug(m,M,0,w,this.visualElement,!1))}stopAnimation(){Kl(m=>this.getAxisMotionValue(m).stop())}pauseAnimation(){Kl(m=>this.getAxisMotionValue(m).animation?.pause())}getAnimationState(m){return this.getAxisMotionValue(m).animation?.state}getAxisMotionValue(m){const w=`_drag${m.toUpperCase()}`,M=this.visualElement.getProps(),I=M[w];return I||this.visualElement.getValue(m,(M.initial?M.initial[m]:void 0)||0)}snapToCursor(m){Kl(w=>{const{drag:M}=this.getProps();if(!zm(w,M,this.currentDirection))return;const{projection:I}=this.visualElement,F=this.getAxisMotionValue(w);if(I&&I.layout){const{min:P,max:u}=I.layout.layoutBox[w];F.set(m[w]-Lr(P,u,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:m,dragConstraints:w}=this.getProps(),{projection:M}=this.visualElement;if(!pf(w)||!M||!this.constraints)return;this.stopAnimation();const I={x:0,y:0};Kl(P=>{const u=this.getAxisMotionValue(P);if(u&&this.constraints!==!1){const H=u.get();I[P]=sb({min:H,max:H},this.constraints[P])}});const{transformTemplate:F}=this.visualElement.getProps();this.visualElement.current.style.transform=F?F({},""):"none",M.root&&M.root.updateScroll(),M.updateLayout(),this.resolveConstraints(),Kl(P=>{if(!zm(P,m,null))return;const u=this.getAxisMotionValue(P),{min:H,max:X}=this.constraints[P];u.set(Lr(H,X,I[P]))})}addListeners(){if(!this.visualElement.current)return;lb.set(this.visualElement,this);const m=this.visualElement.current,w=bp(m,"pointerdown",H=>{const{drag:X,dragListener:Q=!0}=this.getProps();X&&Q&&this.start(H)}),M=()=>{const{dragConstraints:H}=this.getProps();pf(H)&&H.current&&(this.constraints=this.resolveRefConstraints())},{projection:I}=this.visualElement,F=I.addEventListener("measure",M);I&&!I.layout&&(I.root&&I.root.updateScroll(),I.updateLayout()),br.read(M);const P=Ep(window,"resize",()=>this.scalePositionWithinConstraints()),u=I.addEventListener("didUpdate",({delta:H,hasLayoutChanged:X})=>{this.isDragging&&X&&(Kl(Q=>{const dt=this.getAxisMotionValue(Q);dt&&(this.originPoint[Q]+=H[Q].translate,dt.set(dt.get()+H[Q].translate))}),this.visualElement.render())});return()=>{P(),w(),F(),u&&u()}}getProps(){const m=this.visualElement.getProps(),{drag:w=!1,dragDirectionLock:M=!1,dragPropagation:I=!1,dragConstraints:F=!1,dragElastic:P=tg,dragMomentum:u=!0}=m;return{...m,drag:w,dragDirectionLock:M,dragPropagation:I,dragConstraints:F,dragElastic:P,dragMomentum:u}}}function zm(p,m,w){return(m===!0||m===p)&&(w===null||w===p)}function ub(p,m=10){let w=null;return Math.abs(p.y)>m?w="y":Math.abs(p.x)>m&&(w="x"),w}class hb extends Lh{constructor(m){super(m),this.removeGroupControls=Ql,this.removeListeners=Ql,this.controls=new cb(m)}mount(){const{dragControls:m}=this.node.getProps();m&&(this.removeGroupControls=m.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ql}unmount(){this.removeGroupControls(),this.removeListeners()}}const W1=p=>(m,w)=>{p&&br.postRender(()=>p(m,w))};class db extends Lh{constructor(){super(...arguments),this.removePointerDownListener=Ql}onPointerDown(m){this.session=new i3(m,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:e3(this.node)})}createPanHandlers(){const{onPanSessionStart:m,onPanStart:w,onPan:M,onPanEnd:I}=this.node.getProps();return{onSessionStart:W1(m),onStart:W1(w),onMove:M,onEnd:(F,P)=>{delete this.session,I&&br.postRender(()=>I(F,P))}}}mount(){this.removePointerDownListener=bp(this.node.current,"pointerdown",m=>this.onPointerDown(m))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const km={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function K1(p,m){return m.max===m.min?0:p/(m.max-m.min)*100}const _p={correct:(p,m)=>{if(!m.target)return p;if(typeof p=="string")if(wi.test(p))p=parseFloat(p);else return p;const w=K1(p,m.target.x),M=K1(p,m.target.y);return`${w}% ${M}%`}},fb={correct:(p,{treeScale:m,projectionDelta:w})=>{const M=p,I=Dh.parse(p);if(I.length>5)return M;const F=Dh.createTransformer(p),P=typeof I[0]!="number"?1:0,u=w.x.scale*m.x,H=w.y.scale*m.y;I[0+P]/=u,I[1+P]/=H;const X=Lr(u,H,.5);return typeof I[2+P]=="number"&&(I[2+P]/=X),typeof I[3+P]=="number"&&(I[3+P]/=X),F(I)}};let T_=!1;class pb extends ce.Component{componentDidMount(){const{visualElement:m,layoutGroup:w,switchLayoutGroup:M,layoutId:I}=this.props,{projection:F}=m;Bx(mb),F&&(w.group&&w.group.add(F),M&&M.register&&I&&M.register(F),T_&&F.root.didUpdate(),F.addEventListener("animationComplete",()=>{this.safeToRemove()}),F.setOptions({...F.options,onExitComplete:()=>this.safeToRemove()})),km.hasEverUpdated=!0}getSnapshotBeforeUpdate(m){const{layoutDependency:w,visualElement:M,drag:I,isPresent:F}=this.props,{projection:P}=M;return P&&(P.isPresent=F,T_=!0,I||m.layoutDependency!==w||w===void 0||m.isPresent!==F?P.willUpdate():this.safeToRemove(),m.isPresent!==F&&(F?P.promote():P.relegate()||br.postRender(()=>{const u=P.getStack();(!u||!u.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:m}=this.props.visualElement;m&&(m.root.didUpdate(),Dg.postRender(()=>{!m.currentAnimation&&m.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:m,layoutGroup:w,switchLayoutGroup:M}=this.props,{projection:I}=m;T_=!0,I&&(I.scheduleCheckAfterUnmount(),w&&w.group&&w.group.remove(I),M&&M.deregister&&M.deregister(I))}safeToRemove(){const{safeToRemove:m}=this.props;m&&m()}render(){return null}}function r3(p){const[m,w]=My(),M=ce.useContext(cg);return Tt.jsx(pb,{...p,layoutGroup:M,switchLayoutGroup:ce.useContext(Ny),isPresent:m,safeToRemove:w})}const mb={borderRadius:{..._p,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:_p,borderTopRightRadius:_p,borderBottomLeftRadius:_p,borderBottomRightRadius:_p,boxShadow:fb};function _b(p,m,w){const M=Ga(p)?p:vf(p);return M.start(Ug("",M,m,w)),M.animation}const gb=(p,m)=>p.depth-m.depth;class yb{constructor(){this.children=[],this.isDirty=!1}add(m){dg(this.children,m),this.isDirty=!0}remove(m){fg(this.children,m),this.isDirty=!0}forEach(m){this.isDirty&&this.children.sort(gb),this.isDirty=!1,this.children.forEach(m)}}function vb(p,m){const w=Zo.now(),M=({timestamp:I})=>{const F=I-w;F>=m&&(zh(M),p(F-m))};return br.setup(M,!0),()=>zh(M)}const s3=["TopLeft","TopRight","BottomLeft","BottomRight"],xb=s3.length,Q1=p=>typeof p=="string"?parseFloat(p):p,J1=p=>typeof p=="number"||wi.test(p);function bb(p,m,w,M,I,F){I?(p.opacity=Lr(0,w.opacity??1,wb(M)),p.opacityExit=Lr(m.opacity??1,0,Tb(M))):F&&(p.opacity=Lr(m.opacity??1,w.opacity??1,M));for(let P=0;P<xb;P++){const u=`border${s3[P]}Radius`;let H=t0(m,u),X=t0(w,u);if(H===void 0&&X===void 0)continue;H||(H=0),X||(X=0),H===0||X===0||J1(H)===J1(X)?(p[u]=Math.max(Lr(Q1(H),Q1(X),M),0),(fu.test(X)||fu.test(H))&&(p[u]+="%")):p[u]=X}(m.rotate||w.rotate)&&(p.rotate=Lr(m.rotate||0,w.rotate||0,M))}function t0(p,m){return p[m]!==void 0?p[m]:p.borderRadius}const wb=a3(0,.5,H0),Tb=a3(.5,.95,Ql);function a3(p,m,w){return M=>M<p?0:M>m?1:w(Sp(p,m,M))}function e0(p,m){p.min=m.min,p.max=m.max}function Wl(p,m){e0(p.x,m.x),e0(p.y,m.y)}function i0(p,m){p.translate=m.translate,p.scale=m.scale,p.originPoint=m.originPoint,p.origin=m.origin}function n0(p,m,w,M,I){return p-=m,p=Um(p,1/w,M),I!==void 0&&(p=Um(p,1/I,M)),p}function Sb(p,m=0,w=1,M=.5,I,F=p,P=p){if(fu.test(m)&&(m=parseFloat(m),m=Lr(P.min,P.max,m/100)-P.min),typeof m!="number")return;let u=Lr(F.min,F.max,M);p===F&&(u-=m),p.min=n0(p.min,m,w,u,I),p.max=n0(p.max,m,w,u,I)}function r0(p,m,[w,M,I],F,P){Sb(p,m[w],m[M],m[I],m.scale,F,P)}const Mb=["x","scaleX","originX"],Pb=["y","scaleY","originY"];function s0(p,m,w,M){r0(p.x,m,Mb,w?w.x:void 0,M?M.x:void 0),r0(p.y,m,Pb,w?w.y:void 0,M?M.y:void 0)}function a0(p){return p.translate===0&&p.scale===1}function o3(p){return a0(p.x)&&a0(p.y)}function o0(p,m){return p.min===m.min&&p.max===m.max}function Ab(p,m){return o0(p.x,m.x)&&o0(p.y,m.y)}function l0(p,m){return Math.round(p.min)===Math.round(m.min)&&Math.round(p.max)===Math.round(m.max)}function l3(p,m){return l0(p.x,m.x)&&l0(p.y,m.y)}function c0(p){return yo(p.x)/yo(p.y)}function u0(p,m){return p.translate===m.translate&&p.scale===m.scale&&p.originPoint===m.originPoint}class Cb{constructor(){this.members=[]}add(m){dg(this.members,m),m.scheduleRender()}remove(m){if(fg(this.members,m),m===this.prevLead&&(this.prevLead=void 0),m===this.lead){const w=this.members[this.members.length-1];w&&this.promote(w)}}relegate(m){const w=this.members.findIndex(I=>m===I);if(w===0)return!1;let M;for(let I=w;I>=0;I--){const F=this.members[I];if(F.isPresent!==!1){M=F;break}}return M?(this.promote(M),!0):!1}promote(m,w){const M=this.lead;if(m!==M&&(this.prevLead=M,this.lead=m,m.show(),M)){M.instance&&M.scheduleRender(),m.scheduleRender(),m.resumeFrom=M,w&&(m.resumeFrom.preserveOpacity=!0),M.snapshot&&(m.snapshot=M.snapshot,m.snapshot.latestValues=M.animationValues||M.latestValues),m.root&&m.root.isUpdating&&(m.isLayoutDirty=!0);const{crossfade:I}=m.options;I===!1&&M.hide()}}exitAnimationComplete(){this.members.forEach(m=>{const{options:w,resumingFrom:M}=m;w.onExitComplete&&w.onExitComplete(),M&&M.options.onExitComplete&&M.options.onExitComplete()})}scheduleRender(){this.members.forEach(m=>{m.instance&&m.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Eb(p,m,w){let M="";const I=p.x.translate/m.x,F=p.y.translate/m.y,P=w?.z||0;if((I||F||P)&&(M=`translate3d(${I}px, ${F}px, ${P}px) `),(m.x!==1||m.y!==1)&&(M+=`scale(${1/m.x}, ${1/m.y}) `),w){const{transformPerspective:X,rotate:Q,rotateX:dt,rotateY:ht,skewX:lt,skewY:Yt}=w;X&&(M=`perspective(${X}px) ${M}`),Q&&(M+=`rotate(${Q}deg) `),dt&&(M+=`rotateX(${dt}deg) `),ht&&(M+=`rotateY(${ht}deg) `),lt&&(M+=`skewX(${lt}deg) `),Yt&&(M+=`skewY(${Yt}deg) `)}const u=p.x.scale*m.x,H=p.y.scale*m.y;return(u!==1||H!==1)&&(M+=`scale(${u}, ${H})`),M||"none"}const S_=["","X","Y","Z"],zb=1e3;let Db=0;function M_(p,m,w,M){const{latestValues:I}=m;I[p]&&(w[p]=I[p],m.setStaticValue(p,0),M&&(M[p]=0))}function c3(p){if(p.hasCheckedOptimisedAppear=!0,p.root===p)return;const{visualElement:m}=p.options;if(!m)return;const w=Xy(m);if(window.MotionHasOptimisedAnimation(w,"transform")){const{layout:I,layoutId:F}=p.options;window.MotionCancelOptimisedAnimation(w,"transform",br,!(I||F))}const{parent:M}=p;M&&!M.hasCheckedOptimisedAppear&&c3(M)}function u3({attachResizeListener:p,defaultParent:m,measureScroll:w,checkIsScrollRoot:M,resetTransform:I}){return class{constructor(P={},u=m?.()){this.id=Db++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Rb),this.nodes.forEach(Nb),this.nodes.forEach(jb),this.nodes.forEach(kb)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=P,this.root=u?u.root||u:this,this.path=u?[...u.path,u]:[],this.parent=u,this.depth=u?u.depth+1:0;for(let H=0;H<this.path.length;H++)this.path[H].shouldResetTransform=!0;this.root===this&&(this.nodes=new yb)}addEventListener(P,u){return this.eventHandlers.has(P)||this.eventHandlers.set(P,new _g),this.eventHandlers.get(P).add(u)}notifyListeners(P,...u){const H=this.eventHandlers.get(P);H&&H.notify(...u)}hasListeners(P){return this.eventHandlers.has(P)}mount(P){if(this.instance)return;this.isSVG=Sy(P)&&!Tx(P),this.instance=P;const{layoutId:u,layout:H,visualElement:X}=this.options;if(X&&!X.current&&X.mount(P),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(H||u)&&(this.isLayoutDirty=!0),p){let Q,dt=0;const ht=()=>this.root.updateBlockedByResize=!1;br.read(()=>{dt=window.innerWidth}),p(P,()=>{const lt=window.innerWidth;lt!==dt&&(dt=lt,this.root.updateBlockedByResize=!0,Q&&Q(),Q=vb(ht,250),km.hasAnimatedSinceResize&&(km.hasAnimatedSinceResize=!1,this.nodes.forEach(f0)))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&X&&(u||H)&&this.addEventListener("didUpdate",({delta:Q,hasLayoutChanged:dt,hasRelativeLayoutChanged:ht,layout:lt})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const Yt=this.options.transition||X.getDefaultTransition()||Gb,{onLayoutAnimationStart:Jt,onLayoutAnimationComplete:pe}=X.getProps(),ge=!this.targetLayout||!l3(this.targetLayout,lt),de=!dt&&ht;if(this.options.layoutRoot||this.resumeFrom||de||dt&&(ge||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const ne={...Eg(Yt,"layout"),onPlay:Jt,onComplete:pe};(X.shouldReduceMotion||this.options.layoutRoot)&&(ne.delay=0,ne.type=!1),this.startAnimation(ne),this.setAnimationOrigin(Q,de)}else dt||f0(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=lt})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const P=this.getStack();P&&P.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),zh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Fb),this.animationId++)}getTransformTemplate(){const{visualElement:P}=this.options;return P&&P.getProps().transformTemplate}willUpdate(P=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&c3(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let Q=0;Q<this.path.length;Q++){const dt=this.path[Q];dt.shouldResetTransform=!0,dt.updateScroll("snapshot"),dt.options.layoutRoot&&dt.willUpdate(!1)}const{layoutId:u,layout:H}=this.options;if(u===void 0&&!H)return;const X=this.getTransformTemplate();this.prevTransformTemplateValue=X?X(this.latestValues,""):void 0,this.updateSnapshot(),P&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(h0);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(d0);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Ob),this.nodes.forEach(Lb),this.nodes.forEach(Ib)):this.nodes.forEach(d0),this.clearAllSnapshots();const u=Zo.now();ha.delta=qu(0,1e3/60,u-ha.timestamp),ha.timestamp=u,ha.isProcessing=!0,f_.update.process(ha),f_.preRender.process(ha),f_.render.process(ha),ha.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Dg.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Bb),this.sharedNodes.forEach(Vb)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,br.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){br.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!yo(this.snapshot.measuredBox.x)&&!yo(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let H=0;H<this.path.length;H++)this.path[H].updateScroll();const P=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Jr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:u}=this.options;u&&u.notify("LayoutMeasure",this.layout.layoutBox,P?P.layoutBox:void 0)}updateScroll(P="measure"){let u=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===P&&(u=!1),u&&this.instance){const H=M(this.instance);this.scroll={animationId:this.root.animationId,phase:P,isRoot:H,offset:w(this.instance),wasRoot:this.scroll?this.scroll.isRoot:H}}}resetTransform(){if(!I)return;const P=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,u=this.projectionDelta&&!o3(this.projectionDelta),H=this.getTransformTemplate(),X=H?H(this.latestValues,""):void 0,Q=X!==this.prevTransformTemplateValue;P&&this.instance&&(u||wd(this.latestValues)||Q)&&(I(this.instance,X),this.shouldResetTransform=!1,this.scheduleRender())}measure(P=!0){const u=this.measurePageBox();let H=this.removeElementScroll(u);return P&&(H=this.removeTransform(H)),Hb(H),{animationId:this.root.animationId,measuredBox:u,layoutBox:H,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:P}=this.options;if(!P)return Jr();const u=P.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(qb))){const{scroll:X}=this.root;X&&(mf(u.x,X.offset.x),mf(u.y,X.offset.y))}return u}removeElementScroll(P){const u=Jr();if(Wl(u,P),this.scroll?.wasRoot)return u;for(let H=0;H<this.path.length;H++){const X=this.path[H],{scroll:Q,options:dt}=X;X!==this.root&&Q&&dt.layoutScroll&&(Q.wasRoot&&Wl(u,P),mf(u.x,Q.offset.x),mf(u.y,Q.offset.y))}return u}applyTransform(P,u=!1){const H=Jr();Wl(H,P);for(let X=0;X<this.path.length;X++){const Q=this.path[X];!u&&Q.options.layoutScroll&&Q.scroll&&Q!==Q.root&&_f(H,{x:-Q.scroll.offset.x,y:-Q.scroll.offset.y}),wd(Q.latestValues)&&_f(H,Q.latestValues)}return wd(this.latestValues)&&_f(H,this.latestValues),H}removeTransform(P){const u=Jr();Wl(u,P);for(let H=0;H<this.path.length;H++){const X=this.path[H];if(!X.instance||!wd(X.latestValues))continue;X_(X.latestValues)&&X.updateSnapshot();const Q=Jr(),dt=X.measurePageBox();Wl(Q,dt),s0(u,X.latestValues,X.snapshot?X.snapshot.layoutBox:void 0,Q)}return wd(this.latestValues)&&s0(u,this.latestValues),u}setTargetDelta(P){this.targetDelta=P,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(P){this.options={...this.options,...P,crossfade:P.crossfade!==void 0?P.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ha.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(P=!1){const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const H=!!this.resumingFrom||this!==u;if(!(P||H&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:Q,layoutId:dt}=this.options;if(!(!this.layout||!(Q||dt))){if(this.resolvedRelativeTargetAt=ha.timestamp,!this.targetDelta&&!this.relativeTarget){const ht=this.getClosestProjectingParent();ht&&ht.layout&&this.animationProgress!==1?(this.relativeParent=ht,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Jr(),this.relativeTargetOrigin=Jr(),Tp(this.relativeTargetOrigin,this.layout.layoutBox,ht.layout.layoutBox),Wl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Jr(),this.targetWithTransforms=Jr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Q8(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Wl(this.target,this.layout.layoutBox),Uy(this.target,this.targetDelta)):Wl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const ht=this.getClosestProjectingParent();ht&&!!ht.resumingFrom==!!this.resumingFrom&&!ht.options.layoutScroll&&ht.target&&this.animationProgress!==1?(this.relativeParent=ht,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Jr(),this.relativeTargetOrigin=Jr(),Tp(this.relativeTargetOrigin,this.target,ht.target),Wl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||X_(this.parent.latestValues)||Vy(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const P=this.getLead(),u=!!this.resumingFrom||this!==P;let H=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(H=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(H=!1),this.resolvedRelativeTargetAt===ha.timestamp&&(H=!1),H)return;const{layout:X,layoutId:Q}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(X||Q))return;Wl(this.layoutCorrected,this.layout.layoutBox);const dt=this.treeScale.x,ht=this.treeScale.y;u8(this.layoutCorrected,this.treeScale,this.path,u),P.layout&&!P.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(P.target=P.layout.layoutBox,P.targetWithTransforms=Jr());const{target:lt}=P;if(!lt){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(i0(this.prevProjectionDelta.x,this.projectionDelta.x),i0(this.prevProjectionDelta.y,this.projectionDelta.y)),wp(this.projectionDelta,this.layoutCorrected,lt,this.latestValues),(this.treeScale.x!==dt||this.treeScale.y!==ht||!u0(this.projectionDelta.x,this.prevProjectionDelta.x)||!u0(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",lt))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(P=!0){if(this.options.visualElement?.scheduleRender(),P){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=gf(),this.projectionDelta=gf(),this.projectionDeltaWithTransform=gf()}setAnimationOrigin(P,u=!1){const H=this.snapshot,X=H?H.latestValues:{},Q={...this.latestValues},dt=gf();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!u;const ht=Jr(),lt=H?H.source:void 0,Yt=this.layout?this.layout.source:void 0,Jt=lt!==Yt,pe=this.getStack(),ge=!pe||pe.members.length<=1,de=!!(Jt&&!ge&&this.options.crossfade===!0&&!this.path.some(Zb));this.animationProgress=0;let ne;this.mixTargetDelta=Ne=>{const we=Ne/1e3;p0(dt.x,P.x,we),p0(dt.y,P.y,we),this.setTargetDelta(dt),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Tp(ht,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Ub(this.relativeTarget,this.relativeTargetOrigin,ht,we),ne&&Ab(this.relativeTarget,ne)&&(this.isProjectionDirty=!1),ne||(ne=Jr()),Wl(ne,this.relativeTarget)),Jt&&(this.animationValues=Q,bb(Q,X,this.latestValues,we,de,ge)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=we},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(P){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(zh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=br.update(()=>{km.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=vf(0)),this.currentAnimation=_b(this.motionValue,[0,1e3],{...P,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),P.onUpdate&&P.onUpdate(u)},onStop:()=>{},onComplete:()=>{P.onComplete&&P.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const P=this.getStack();P&&P.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(zb),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const P=this.getLead();let{targetWithTransforms:u,target:H,layout:X,latestValues:Q}=P;if(!(!u||!H||!X)){if(this!==P&&this.layout&&X&&h3(this.options.animationType,this.layout.layoutBox,X.layoutBox)){H=this.target||Jr();const dt=yo(this.layout.layoutBox.x);H.x.min=P.target.x.min,H.x.max=H.x.min+dt;const ht=yo(this.layout.layoutBox.y);H.y.min=P.target.y.min,H.y.max=H.y.min+ht}Wl(u,H),_f(u,Q),wp(this.projectionDeltaWithTransform,this.layoutCorrected,u,Q)}}registerSharedNode(P,u){this.sharedNodes.has(P)||this.sharedNodes.set(P,new Cb),this.sharedNodes.get(P).add(u);const X=u.options.initialPromotionConfig;u.promote({transition:X?X.transition:void 0,preserveFollowOpacity:X&&X.shouldPreserveFollowOpacity?X.shouldPreserveFollowOpacity(u):void 0})}isLead(){const P=this.getStack();return P?P.lead===this:!0}getLead(){const{layoutId:P}=this.options;return P?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:P}=this.options;return P?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:P}=this.options;if(P)return this.root.sharedNodes.get(P)}promote({needsReset:P,transition:u,preserveFollowOpacity:H}={}){const X=this.getStack();X&&X.promote(this,H),P&&(this.projectionDelta=void 0,this.needsReset=!0),u&&this.setOptions({transition:u})}relegate(){const P=this.getStack();return P?P.relegate(this):!1}resetSkewAndRotation(){const{visualElement:P}=this.options;if(!P)return;let u=!1;const{latestValues:H}=P;if((H.z||H.rotate||H.rotateX||H.rotateY||H.rotateZ||H.skewX||H.skewY)&&(u=!0),!u)return;const X={};H.z&&M_("z",P,X,this.animationValues);for(let Q=0;Q<S_.length;Q++)M_(`rotate${S_[Q]}`,P,X,this.animationValues),M_(`skew${S_[Q]}`,P,X,this.animationValues);P.render();for(const Q in X)P.setStaticValue(Q,X[Q]),this.animationValues&&(this.animationValues[Q]=X[Q]);P.scheduleRender()}applyProjectionStyles(P,u){if(!this.instance||this.isSVG)return;if(!this.isVisible){P.visibility="hidden";return}const H=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,P.visibility="",P.opacity="",P.pointerEvents=Rm(u?.pointerEvents)||"",P.transform=H?H(this.latestValues,""):"none";return}const X=this.getLead();if(!this.projectionDelta||!this.layout||!X.target){this.options.layoutId&&(P.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,P.pointerEvents=Rm(u?.pointerEvents)||""),this.hasProjected&&!wd(this.latestValues)&&(P.transform=H?H({},""):"none",this.hasProjected=!1);return}P.visibility="";const Q=X.animationValues||X.latestValues;this.applyTransformsToTarget();let dt=Eb(this.projectionDeltaWithTransform,this.treeScale,Q);H&&(dt=H(Q,dt)),P.transform=dt;const{x:ht,y:lt}=this.projectionDelta;P.transformOrigin=`${ht.origin*100}% ${lt.origin*100}% 0`,X.animationValues?P.opacity=X===this?Q.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:Q.opacityExit:P.opacity=X===this?Q.opacity!==void 0?Q.opacity:"":Q.opacityExit!==void 0?Q.opacityExit:0;for(const Yt in Cp){if(Q[Yt]===void 0)continue;const{correct:Jt,applyTo:pe,isCSSVariable:ge}=Cp[Yt],de=dt==="none"?Q[Yt]:Jt(Q[Yt],X);if(pe){const ne=pe.length;for(let Ne=0;Ne<ne;Ne++)P[pe[Ne]]=de}else ge?this.options.visualElement.renderState.vars[Yt]=de:P[Yt]=de}this.options.layoutId&&(P.pointerEvents=X===this?Rm(u?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(P=>P.currentAnimation?.stop()),this.root.nodes.forEach(h0),this.root.sharedNodes.clear()}}}function Lb(p){p.updateLayout()}function Ib(p){const m=p.resumeFrom?.snapshot||p.snapshot;if(p.isLead()&&p.layout&&m&&p.hasListeners("didUpdate")){const{layoutBox:w,measuredBox:M}=p.layout,{animationType:I}=p.options,F=m.source!==p.layout.source;I==="size"?Kl(Q=>{const dt=F?m.measuredBox[Q]:m.layoutBox[Q],ht=yo(dt);dt.min=w[Q].min,dt.max=dt.min+ht}):h3(I,m.layoutBox,w)&&Kl(Q=>{const dt=F?m.measuredBox[Q]:m.layoutBox[Q],ht=yo(w[Q]);dt.max=dt.min+ht,p.relativeTarget&&!p.currentAnimation&&(p.isProjectionDirty=!0,p.relativeTarget[Q].max=p.relativeTarget[Q].min+ht)});const P=gf();wp(P,w,m.layoutBox);const u=gf();F?wp(u,p.applyTransform(M,!0),m.measuredBox):wp(u,w,m.layoutBox);const H=!o3(P);let X=!1;if(!p.resumeFrom){const Q=p.getClosestProjectingParent();if(Q&&!Q.resumeFrom){const{snapshot:dt,layout:ht}=Q;if(dt&&ht){const lt=Jr();Tp(lt,m.layoutBox,dt.layoutBox);const Yt=Jr();Tp(Yt,w,ht.layoutBox),l3(lt,Yt)||(X=!0),Q.options.layoutRoot&&(p.relativeTarget=Yt,p.relativeTargetOrigin=lt,p.relativeParent=Q)}}}p.notifyListeners("didUpdate",{layout:w,snapshot:m,delta:u,layoutDelta:P,hasLayoutChanged:H,hasRelativeLayoutChanged:X})}else if(p.isLead()){const{onExitComplete:w}=p.options;w&&w()}p.options.transition=void 0}function Rb(p){p.parent&&(p.isProjecting()||(p.isProjectionDirty=p.parent.isProjectionDirty),p.isSharedProjectionDirty||(p.isSharedProjectionDirty=!!(p.isProjectionDirty||p.parent.isProjectionDirty||p.parent.isSharedProjectionDirty)),p.isTransformDirty||(p.isTransformDirty=p.parent.isTransformDirty))}function kb(p){p.isProjectionDirty=p.isSharedProjectionDirty=p.isTransformDirty=!1}function Bb(p){p.clearSnapshot()}function h0(p){p.clearMeasurements()}function d0(p){p.isLayoutDirty=!1}function Ob(p){const{visualElement:m}=p.options;m&&m.getProps().onBeforeLayoutMeasure&&m.notify("BeforeLayoutMeasure"),p.resetTransform()}function f0(p){p.finishAnimation(),p.targetDelta=p.relativeTarget=p.target=void 0,p.isProjectionDirty=!0}function Nb(p){p.resolveTargetDelta()}function jb(p){p.calcProjection()}function Fb(p){p.resetSkewAndRotation()}function Vb(p){p.removeLeadSnapshot()}function p0(p,m,w){p.translate=Lr(m.translate,0,w),p.scale=Lr(m.scale,1,w),p.origin=m.origin,p.originPoint=m.originPoint}function m0(p,m,w,M){p.min=Lr(m.min,w.min,M),p.max=Lr(m.max,w.max,M)}function Ub(p,m,w,M){m0(p.x,m.x,w.x,M),m0(p.y,m.y,w.y,M)}function Zb(p){return p.animationValues&&p.animationValues.opacityExit!==void 0}const Gb={duration:.45,ease:[.4,0,.1,1]},_0=p=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(p),g0=_0("applewebkit/")&&!_0("chrome/")?Math.round:Ql;function y0(p){p.min=g0(p.min),p.max=g0(p.max)}function Hb(p){y0(p.x),y0(p.y)}function h3(p,m,w){return p==="position"||p==="preserve-aspect"&&!K8(c0(m),c0(w),.2)}function qb(p){return p!==p.root&&p.scroll?.wasRoot}const $b=u3({attachResizeListener:(p,m)=>Ep(p,"resize",m),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),P_={current:void 0},d3=u3({measureScroll:p=>({x:p.scrollLeft,y:p.scrollTop}),defaultParent:()=>{if(!P_.current){const p=new $b({});p.mount(window),p.setOptions({layoutScroll:!0}),P_.current=p}return P_.current},resetTransform:(p,m)=>{p.style.transform=m!==void 0?m:"none"},checkIsScrollRoot:p=>window.getComputedStyle(p).position==="fixed"}),Xb={pan:{Feature:db},drag:{Feature:hb,ProjectionNode:d3,MeasureLayout:r3}};function v0(p,m,w){const{props:M}=p;p.animationState&&M.whileHover&&p.animationState.setActive("whileHover",w==="Start");const I="onHover"+w,F=M[I];F&&br.postRender(()=>F(m,Ip(m)))}class Yb extends Lh{mount(){const{current:m}=this.node;m&&(this.unmount=yx(m,(w,M)=>(v0(this.node,M,"Start"),I=>v0(this.node,I,"End"))))}unmount(){}}class Wb extends Lh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let m=!1;try{m=this.node.current.matches(":focus-visible")}catch{m=!0}!m||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=zp(Ep(this.node.current,"focus",()=>this.onFocus()),Ep(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function x0(p,m,w){const{props:M}=p;if(p.current instanceof HTMLButtonElement&&p.current.disabled)return;p.animationState&&M.whileTap&&p.animationState.setActive("whileTap",w==="Start");const I="onTap"+(w==="End"?"":w),F=M[I];F&&br.postRender(()=>F(m,Ip(m)))}class Kb extends Lh{mount(){const{current:m}=this.node;m&&(this.unmount=wx(m,(w,M)=>(x0(this.node,M,"Start"),(I,{success:F})=>x0(this.node,I,F?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const eg=new WeakMap,A_=new WeakMap,Qb=p=>{const m=eg.get(p.target);m&&m(p)},Jb=p=>{p.forEach(Qb)};function t9({root:p,...m}){const w=p||document;A_.has(w)||A_.set(w,{});const M=A_.get(w),I=JSON.stringify(m);return M[I]||(M[I]=new IntersectionObserver(Jb,{root:p,...m})),M[I]}function e9(p,m,w){const M=t9(m);return eg.set(p,w),M.observe(p),()=>{eg.delete(p),M.unobserve(p)}}const i9={some:0,all:1};class n9 extends Lh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:m={}}=this.node.getProps(),{root:w,margin:M,amount:I="some",once:F}=m,P={root:w?w.current:void 0,rootMargin:M,threshold:typeof I=="number"?I:i9[I]},u=H=>{const{isIntersecting:X}=H;if(this.isInView===X||(this.isInView=X,F&&!X&&this.hasEnteredView))return;X&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",X);const{onViewportEnter:Q,onViewportLeave:dt}=this.node.getProps(),ht=X?Q:dt;ht&&ht(H)};return e9(this.node.current,P,u)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:m,prevProps:w}=this.node;["amount","margin","root"].some(r9(m,w))&&this.startObserver()}unmount(){}}function r9({viewport:p={}},{viewport:m={}}={}){return w=>p[w]!==m[w]}const s9={inView:{Feature:n9},tap:{Feature:Kb},focus:{Feature:Wb},hover:{Feature:Yb}},a9={layout:{ProjectionNode:d3,MeasureLayout:r3}},o9={...H8,...s9,...Xb,...a9},f3=o8(o9,x8);function l9(){return Tt.jsxs("div",{className:"schedule-container",children:["Buses run between ",Tt.jsx("span",{children:"6 a.m. until 6:30 p.m. Monday through Friday."})," Buses ",Tt.jsx("span",{children:"do not run"})," on the following holidays:",Tt.jsx("br",{}),"New Year's Day, Martin Luther King Jr. Day, Good Friday, Memorial Day, Fourth of July, Labor Day, Veteran's Day, Thanksgiving Day and Christmas Day."]})}function c9(p){return{"hct Gold1":{shortName:"Gold Line",longName:"USM"},"hct gold2":{shortName:"Gold Line",longName:"USM"},"hct blue1":{shortName:"Blue Line",longName:"Hardy Street"},"hct blue2":{shortName:"Blue Line",longName:"Hardy Street"},"hct green":{shortName:"Green Line",longName:"4th Street"},"hct brown":{shortName:"Brown Line",longName:"7th Street"},"hct purple":{shortName:"Purple Line",longName:"Palmer's Crossing"},"hct red":{shortName:"Red Line",longName:"Country Club Road"},"hct orange":{shortName:"Orange Line",longName:"Broadway Drive"}}[p]}function u9({stopDataArray:p,busData:m}){const w=Object.keys(m).length,M=bf(),I=X=>{if(X.stopName!=="N/A"){const Q=[X.coordinates[1]-75e-5,X.coordinates[0]];Q&&(M.flyTo(Q,18),M.eachLayer(dt=>{dt instanceof go.CircleMarker&&dt.feature.properties.stop_id===X.stopId&&setTimeout(()=>dt.openPopup(),500)}))}},F=ce.useRef([]),[P,u]=ce.useState([]);ce.useEffect(()=>{u(F.current.map(X=>X.offsetHeight))},[]);const H=ce.useMemo(()=>{if(P.length===0)return[];const X=[];for(let Q=0;Q<P.length-1;Q++)X.push({height:P[Q]/2+25+P[Q+1]/2,stopName:p[Q+1].stopName,stopId:p[Q+1].stopId,stopDistance:p[Q+1].distance-p[Q].distance});return X},[P,p]);return Tt.jsxs("div",{className:"route-stop-container",children:[Tt.jsxs("div",{className:"route-progress-container",children:[P.length!==0&&Tt.jsx("div",{className:"route-progress-stop-icon-container",children:P.map((X,Q)=>Tt.jsx("div",{className:"route-progress-stop-icon",style:{height:`${X}px`},children:Tt.jsx("div",{children:Tt.jsx("div",{style:{backgroundColor:`${uf[w!==2?m.busFullName:m.data2.busFullName]}`}})})},`stop-marker-${Q}`))}),P.length!==0&&Tt.jsx("div",{className:"backdrop",style:{top:`${P[0]/2+25}px`,height:`${H.reduce((X,Q)=>X+Q.height,0)}px`,position:"absolute",width:"4px",zIndex:2,backgroundColor:"hsl(0, 0%, 85%)",border:"solid hsl(0, 0%, 75%)",borderWidth:"0px 1px",marginRight:"18px"}}),P.length!==0&&w!==2?Tt.jsx("div",{className:"route-progress-bar-container",style:{top:`${P[0]/2+25}px`},children:H.map((X,Q)=>Tt.jsx("div",{className:"bus-progress",style:{height:`${X.height}px`,backgroundColor:"transparent",position:"relative"},children:"stopId"in m&&m.stopId===X.stopId&&Tt.jsx("div",{className:"bus-marker",style:{height:"14px",width:"14px",borderRadius:"50%",border:"solid hsl(0, 0%, 75%) 1px",position:"absolute",top:`${(m.busDistance-p[Q].distance)/X.stopDistance*X.height-7.5}px`,backgroundColor:`${uf[m.busFullName]}`,display:"flex",justifyContent:"center",alignItems:"center"},children:Tt.jsx("img",{src:ml})})},`bus-marker-${Q}`))}):Tt.jsxs(Tt.Fragment,{children:[Tt.jsx("div",{className:"route-progress-bar-container",style:{top:`${P[0]/2+25}px`},children:H.map((X,Q)=>Tt.jsx("div",{className:"bus-progress",style:{height:`${X.height}px`,backgroundColor:"transparent",position:"relative"},children:"stopId"in m.data1&&m.data1.stopId===X.stopId&&Tt.jsx("div",{className:"bus-marker",style:{height:"14px",width:"14px",borderRadius:"50%",border:"solid hsl(0, 0%, 75%) 1px",position:"absolute",top:`${(m.data1.busDistance-p[Q].distance)/X.stopDistance*X.height-7.5}px`,backgroundColor:`${uf[m.data1.busFullName]}`,display:"flex",justifyContent:"center",alignItems:"center"},children:Tt.jsx("img",{src:ml})})},`bus-marker-${Q}`))}),Tt.jsx("div",{className:"route-progress-bar-container",style:{top:`${P[0]/2+25}px`},children:H.map((X,Q)=>Tt.jsx("div",{className:"bus-progress",style:{height:`${X.height}px`,backgroundColor:"transparent",position:"relative"},children:"stopId"in m.data2&&m.data2.stopId===X.stopId&&Tt.jsx("div",{className:"bus-marker",style:{height:"14px",width:"14px",borderRadius:"50%",border:"solid hsl(0, 0%, 75%) 1px",position:"absolute",top:`${(m.data2.busDistance-p[Q].distance)/X.stopDistance*X.height-7.5}px`,backgroundColor:`${uf[m.data2.busFullName]}`,display:"flex",justifyContent:"center",alignItems:"center"},children:Tt.jsx("img",{src:ml})})},`bus-marker-${Q}`))})]})]}),Tt.jsx("div",{className:"route-stopname-container",children:p.map((X,Q)=>Tt.jsx("div",{ref:dt=>F.current[Q]=dt,className:"route-stopnames",children:Tt.jsx("span",{style:{cursor:"pointer"},onClick:()=>I(X),children:X.stopName})},`${X.stopName}-${Q}`))})]})}function vd({busName:p,showRoute:m,setShowRoute:w,busData:M}){const I=M?Object.keys(M).length:null;let F=null,P=null;I==2&&(F=M.bus1,P=M.bus2);const u=ce.useRef(null),H=c9(p),[X,Q]=ce.useState(null),dt=ce.useRef(M),ht=ce.useRef(null);function lt(){if(!X){const Jt=R_(p),pe=I0(R_(p));pe.unshift({...pe[pe.length-1],distance:0}),ht.current={route:Jt,stopDataArray:pe}}w(Jt=>Jt===p?null:p)}ce.useEffect(()=>{if(m===p){if(!X||!lg(dt.current,M))if(I==2){const Jt=F?Dm(F,!0):null,pe=F?{busFullName:F.properties.full_name,busDistance:Jt.busDistance,stopName:Jt.stopName,stopDistance:Jt.distance,stopId:Jt.stopId}:{busFullName:p},ge=P?Dm(P,!0):null,de=P?{busFullName:P.properties.full_name,busDistance:ge.busDistance,stopName:ge.stopName,stopDistance:ge.distance,stopId:ge.stopId}:{busFullName:p};dt.current=M,Q({data1:pe,data2:de})}else{const Jt=M?Dm(M,!0):null,pe=M?{busFullName:M.properties.full_name,busDistance:Jt.busDistance,stopName:Jt.stopName,stopDistance:Jt.distance,stopId:Jt.stopId}:{busFullName:p};dt.current=M,Q({busData:pe})}}else Q(null)},[M,m]);const Yt={initial:{height:0,opacity:0},animate:{height:"auto",opacity:1,transition:{height:{type:"spring",stiffness:400,damping:30},opacity:{duration:.2}}},exit:{height:0,opacity:0,transition:{height:{type:"tween",duration:.3},opacity:{duration:.15}}}};return Tt.jsxs("div",{className:"route-container-items",children:[Tt.jsxs("div",{ref:u,className:"route-header",onClick:lt,children:[Tt.jsxs("div",{className:"route-title",children:[Tt.jsx("div",{children:H.shortName}),Tt.jsxs("div",{children:["(",H.longName,")"]})]}),Tt.jsx("div",{children:m===p?"-":"+"})]}),Tt.jsx(Py,{mode:"sync",children:m===p&&X&&Tt.jsxs(f3.div,{className:"route-content",variants:Yt,initial:"initial",animate:"animate",exit:"exit",children:[Tt.jsx("div",{className:"route-desc",children:ht.current.route.features[0].properties.route_desc}),Tt.jsx(u9,{stopDataArray:ht.current.stopDataArray,busData:I!==2?X.busData:X})]},m)})]})}function h9({busData:p}){const[m,w]=ce.useState(null),M=p&&p.status!=="loading"?p.features.reduce((F,P)=>(F[P.properties.full_name]=P,F),{}):{},I=F=>M[F]||null;return Tt.jsxs("div",{className:"route-container",children:[Tt.jsx(vd,{busName:"hct Gold1",showRoute:m,setShowRoute:w,busData:{bus1:I("hct Gold1"),bus2:I("hct gold2")}}),Tt.jsx("hr",{className:"route"}),Tt.jsx(vd,{busName:"hct green",showRoute:m,setShowRoute:w,busData:I("hct green")}),Tt.jsx("hr",{className:"route"}),Tt.jsx(vd,{busName:"hct blue1",showRoute:m,setShowRoute:w,busData:{bus1:I("hct blue1"),bus2:I("hct blue2")}}),Tt.jsx("hr",{className:"route"}),Tt.jsx(vd,{busName:"hct brown",showRoute:m,setShowRoute:w,busData:I("hct brown")}),Tt.jsx("hr",{className:"route"}),Tt.jsx(vd,{busName:"hct red",showRoute:m,setShowRoute:w,busData:I("hct red")}),Tt.jsx("hr",{className:"route"}),Tt.jsx(vd,{busName:"hct purple",showRoute:m,setShowRoute:w,busData:I("hct purple")}),Tt.jsx("hr",{className:"route"}),Tt.jsx(vd,{busName:"hct orange",showRoute:m,setShowRoute:w,busData:I("hct orange")})]})}var C_={exports:{}},b0;function d9(){return b0||(b0=1,function(p){(function(m){p.exports=m(rg())})(function(m){return m.Control.Search=m.Control.extend({includes:m.version[0]==="1"?m.Evented.prototype:m.Mixin.Events,options:{url:"",layer:null,sourceData:null,jsonpParam:null,propertyLoc:"loc",propertyName:"title",formatData:null,filterData:null,moveToLocation:null,buildTip:null,container:"",zoom:null,minLength:1,initial:!0,casesensitive:!1,autoType:!0,delayType:400,tooltipLimit:-1,tipAutoSubmit:!0,firstTipSubmit:!1,autoResize:!0,collapsed:!0,autoCollapse:!1,autoCollapseTime:1200,textErr:"Location not found",textCancel:"Cancel",textPlaceholder:"Search...",hideMarkerOnCollapse:!1,position:"topleft",marker:{icon:!1,animate:!0,circle:{radius:10,weight:3,color:"#e03",stroke:!0,fill:!1}}},_getPath:function(w,M){var I=M.split("."),F=I.pop(),P=I.length,u=I[0],H=1;if(P>0)for(;(w=w[u])&&H<P;)u=I[H++];if(w)return w[F]},_isObject:function(w){return Object.prototype.toString.call(w)==="[object Object]"},initialize:function(w){m.Util.setOptions(this,w||{}),this._inputMinSize=this.options.textPlaceholder?this.options.textPlaceholder.length:10,this._layer=this.options.layer||new m.LayerGroup,this._filterData=this.options.filterData||this._defaultFilterData,this._formatData=this.options.formatData||this._defaultFormatData,this._moveToLocation=this.options.moveToLocation||this._defaultMoveToLocation,this._autoTypeTmp=this.options.autoType,this._countertips=0,this._recordsCache={},this._curReq=null},onAdd:function(w){return this._map=w,this._container=m.DomUtil.create("div","leaflet-control-search"),this._input=this._createInput(this.options.textPlaceholder,"search-input"),this._tooltip=this._createTooltip("search-tooltip"),this._cancel=this._createCancel(this.options.textCancel,"search-cancel"),this._button=this._createButton(this.options.textPlaceholder,"search-button"),this._alert=this._createAlert("search-alert"),this.options.collapsed===!1&&this.expand(this.options.collapsed),this.options.marker&&(this.options.marker instanceof m.Marker||this.options.marker instanceof m.CircleMarker?this._markerSearch=this.options.marker:this._isObject(this.options.marker)&&(this._markerSearch=new m.Control.Search.Marker([0,0],this.options.marker)),this._markerSearch._isMarkerSearch=!0),this.setLayer(this._layer),w.on({resize:this._handleAutoresize},this),this._container},addTo:function(w){return this.options.container?(this._container=this.onAdd(w),this._wrapper=m.DomUtil.get(this.options.container),this._wrapper.style.position="relative",this._wrapper.appendChild(this._container)):m.Control.prototype.addTo.call(this,w),this},onRemove:function(w){this._recordsCache={},w.off({resize:this._handleAutoresize},this)},setLayer:function(w){return this._layer=w,this._layer.addTo(this._map),this},showAlert:function(w){var M=this;return w=w||this.options.textErr,this._alert.style.display="block",this._alert.innerHTML=w,clearTimeout(this.timerAlert),this.timerAlert=setTimeout(function(){M.hideAlert()},this.options.autoCollapseTime),this},hideAlert:function(){return this._alert.style.display="none",this},cancel:function(){return this._input.value="",this._handleKeypress({keyCode:8}),this._input.size=this._inputMinSize,this._input.focus(),this._cancel.style.display="none",this._hideTooltip(),this.fire("search:cancel"),this},expand:function(w){return w=typeof w=="boolean"?w:!0,this._input.style.display="block",m.DomUtil.addClass(this._container,"search-exp"),w!==!1&&(this._input.focus(),this._map.on("dragstart click",this.collapse,this)),this.fire("search:expanded"),this},collapse:function(){return this._hideTooltip(),this.cancel(),this._alert.style.display="none",this._input.blur(),this.options.collapsed&&(this._input.style.display="none",this._cancel.style.display="none",m.DomUtil.removeClass(this._container,"search-exp"),this.options.hideMarkerOnCollapse&&this._map.removeLayer(this._markerSearch),this._map.off("dragstart click",this.collapse,this)),this.fire("search:collapsed"),this},collapseDelayed:function(){var w=this;return this.options.autoCollapse?(clearTimeout(this.timerCollapse),this.timerCollapse=setTimeout(function(){w.collapse()},this.options.autoCollapseTime),this):this},collapseDelayedStop:function(){return clearTimeout(this.timerCollapse),this},_createAlert:function(w){var M=m.DomUtil.create("div",w,this._container);return M.style.display="none",m.DomEvent.on(M,"click",m.DomEvent.stop,this).on(M,"click",this.hideAlert,this),M},_createInput:function(w,M){var I=this,F=m.DomUtil.create("label",M,this._container),P=m.DomUtil.create("input",M,this._container);return P.type="text",P.size=this._inputMinSize,P.value="",P.autocomplete="off",P.autocorrect="off",P.autocapitalize="off",P.placeholder=w,P.style.display="none",P.role="search",P.id=P.role+P.type+P.size,F.htmlFor=P.id,F.style.display="none",F.value=w,m.DomEvent.disableClickPropagation(P).on(P,"keyup",this._handleKeypress,this).on(P,"paste",function(u){setTimeout(function(H){I._handleKeypress(H)},10,u)},this).on(P,"blur",this.collapseDelayed,this).on(P,"focus",this.collapseDelayedStop,this),P},_createCancel:function(w,M){var I=m.DomUtil.create("a",M,this._container);return I.href="#",I.title=w,I.style.display="none",I.innerHTML="<span>&otimes;</span>",m.DomEvent.on(I,"click",m.DomEvent.stop,this).on(I,"click",this.cancel,this),I},_createButton:function(w,M){var I=m.DomUtil.create("a",M,this._container);return I.href="#",I.title=w,m.DomEvent.on(I,"click",m.DomEvent.stop,this).on(I,"click",this._handleSubmit,this).on(I,"focus",this.collapseDelayedStop,this).on(I,"blur",this.collapseDelayed,this),I},_createTooltip:function(w){var M=this,I=m.DomUtil.create("ul",w,this._container);return I.style.display="none",m.DomEvent.disableClickPropagation(I).on(I,"blur",this.collapseDelayed,this).on(I,"wheel",function(F){M.collapseDelayedStop(),m.DomEvent.stopPropagation(F)},this).on(I,"mouseover",function(F){M.collapseDelayedStop()},this),I},_createTip:function(w,M){var I;if(this.options.buildTip){if(I=this.options.buildTip.call(this,w,M),typeof I=="string"){var F=m.DomUtil.create("div");F.innerHTML=I,I=F.firstChild}}else I=m.DomUtil.create("li",""),I.innerHTML=w;return m.DomUtil.addClass(I,"search-tip"),I._text=w,this.options.tipAutoSubmit&&m.DomEvent.disableClickPropagation(I).on(I,"click",m.DomEvent.stop,this).on(I,"click",function(P){this._input.value=w,this._handleAutoresize(),this._input.focus(),this._hideTooltip(),this._handleSubmit()},this),I},_getUrl:function(w){return typeof this.options.url=="function"?this.options.url(w):this.options.url},_defaultFilterData:function(w,M){var I,F,P,u={};if(w=w.replace(/[.*+?^${}()|[\]\\]/g,""),w==="")return[];I=this.options.initial?"^":"",F=this.options.casesensitive?void 0:"i",P=new RegExp(I+w,F);for(let H in M)P.test(H)&&(u[H]=M[H]);return u},showTooltip:function(w){if(this._countertips=0,this._tooltip.innerHTML="",this._tooltip.currentSelection=-1,this.options.tooltipLimit)for(let M in w){if(this._countertips===this.options.tooltipLimit)break;this._countertips++,this._tooltip.appendChild(this._createTip(M,w[M]))}return this._countertips>0?(this._tooltip.style.display="block",this._autoTypeTmp&&this._autoType(),this._autoTypeTmp=this.options.autoType):this._hideTooltip(),this._tooltip.scrollTop=0,this._countertips},_hideTooltip:function(){return this._tooltip.style.display="none",this._tooltip.innerHTML="",0},_defaultFormatData:function(w){var M=this,I=this.options.propertyName,F=this.options.propertyLoc,P={};if(m.Util.isArray(F))for(let u in w)P[M._getPath(w[u],I)]=m.latLng(M._getPath(w[u],F[0]),M._getPath(w[u],F[1]));else for(let u in w)P[M._getPath(w[u],I)]=m.latLng(M._getPath(w[u],F));return P},_recordsFromJsonp:function(w,M){m.Control.Search.callJsonp=M;var I=m.DomUtil.create("script","leaflet-search-jsonp",document.getElementsByTagName("body")[0]),F=m.Util.template(this._getUrl(w)+"&"+this.options.jsonpParam+"=L.Control.Search.callJsonp",{s:w});return I.type="text/javascript",I.src=F,{abort:function(){I.parentNode.removeChild(I)}}},_recordsFromAjax:function(w,M){window.XMLHttpRequest===void 0&&(window.XMLHttpRequest=function(){try{return new ActiveXObject("Microsoft.XMLHTTP.6.0")}catch{try{return new ActiveXObject("Microsoft.XMLHTTP.3.0")}catch{throw new Error("XMLHttpRequest is not supported")}}});var I=m.Browser.ie&&!window.atob&&document.querySelector,F=I?new XDomainRequest:new XMLHttpRequest,P=m.Util.template(this._getUrl(w),{s:w});return F.open("GET",P),F.onload=function(){M(JSON.parse(F.responseText))},F.onreadystatechange=function(){F.readyState===4&&F.status===200&&this.onload()},F.send(),F},_searchInLayer:function(w,M,I){var F=this,P;w instanceof m.Control.Search.Marker||(w instanceof m.Marker||w instanceof m.CircleMarker?F._getPath(w.options,I)?(P=w.getLatLng(),P.layer=w,M[F._getPath(w.options,I)]=P):F._getPath(w.feature.properties,I)&&(P=w.getLatLng(),P.layer=w,M[F._getPath(w.feature.properties,I)]=P):w instanceof m.Path||w instanceof m.Polyline||w instanceof m.Polygon?F._getPath(w.options,I)?(P=w.getBounds().getCenter(),P.layer=w,M[F._getPath(w.options,I)]=P):F._getPath(w.feature.properties,I)&&(P=w.getBounds().getCenter(),P.layer=w,M[F._getPath(w.feature.properties,I)]=P):w.hasOwnProperty("feature")?w.feature.properties.hasOwnProperty(I)&&(w.getLatLng&&typeof w.getLatLng=="function"?(P=w.getLatLng(),P.layer=w,M[w.feature.properties[I]]=P):w.getBounds&&typeof w.getBounds=="function"&&(P=w.getBounds().getCenter(),P.layer=w,M[w.feature.properties[I]]=P)):w instanceof m.LayerGroup&&w.eachLayer(function(u){F._searchInLayer(u,M,I)}))},_recordsFromLayer:function(){var w=this,M={},I=this.options.propertyName;return this._layer.eachLayer(function(F){w._searchInLayer(F,M,I)}),M},_autoType:function(){var w=this._input.value.length,M=this._tooltip.firstChild?this._tooltip.firstChild._text:"",I=M.length;if(M.indexOf(this._input.value)===0)if(this._input.value=M,this._handleAutoresize(),this._input.createTextRange){var F=this._input.createTextRange();F.collapse(!0),F.moveStart("character",w),F.moveEnd("character",I),F.select()}else this._input.setSelectionRange?this._input.setSelectionRange(w,I):this._input.selectionStart&&(this._input.selectionStart=w,this._input.selectionEnd=I)},_hideAutoType:function(){var w;if((w=this._input.selection)&&w.empty)w.empty();else if(this._input.createTextRange){w=this._input.createTextRange(),w.collapse(!0);var M=this._input.value.length;w.moveStart("character",M),w.moveEnd("character",M),w.select()}else this._input.getSelection&&this._input.getSelection().removeAllRanges(),this._input.selectionStart=this._input.selectionEnd},_handleKeypress:function(w){var M=this;switch(w.keyCode){case 27:this.collapse();break;case 13:(this._countertips==1||this.options.firstTipSubmit&&this._countertips>0)&&this._tooltip.currentSelection==-1&&this._handleArrowSelect(1),this._handleSubmit();break;case 38:this._handleArrowSelect(-1);break;case 40:this._handleArrowSelect(1);break;case 8:case 45:case 46:this._autoTypeTmp=!1;break;case 37:case 39:case 16:case 17:case 35:case 36:break;default:this._input.value.length?this._cancel.style.display="block":this._cancel.style.display="none",this._input.value.length>=this.options.minLength?(clearTimeout(this.timerKeypress),this.timerKeypress=setTimeout(function(){M._fillRecordsCache()},this.options.delayType)):this._hideTooltip()}this._handleAutoresize()},searchText:function(w){var M=w.charCodeAt(w.length);this._input.value=w,this._input.style.display="block",m.DomUtil.addClass(this._container,"search-exp"),this._autoTypeTmp=!1,this._handleKeypress({keyCode:M})},_fillRecordsCache:function(){var w=this,M=this._input.value,I;this._curReq&&this._curReq.abort&&this._curReq.abort(),m.DomUtil.addClass(this._container,"search-load"),this.options.layer?(this._recordsCache=this._recordsFromLayer(),I=this._filterData(this._input.value,this._recordsCache),this.showTooltip(I),m.DomUtil.removeClass(this._container,"search-load")):(this.options.sourceData?this._retrieveData=this.options.sourceData:this.options.url&&(this._retrieveData=this.options.jsonpParam?this._recordsFromJsonp:this._recordsFromAjax),this._curReq=this._retrieveData.call(this,M,function(F){w._recordsCache=w._formatData.call(w,F),w.options.sourceData?I=w._filterData(w._input.value,w._recordsCache):I=w._recordsCache,w.showTooltip(I),m.DomUtil.removeClass(w._container,"search-load")}))},_handleAutoresize:function(){var w;this._input.style.maxWidth!==this._map._container.offsetWidth&&(w=this._map._container.clientWidth,w-=83,this._input.style.maxWidth=w.toString()+"px"),this.options.autoResize&&this._container.offsetWidth+20<this._map._container.offsetWidth&&(this._input.size=this._input.value.length<this._inputMinSize?this._inputMinSize:this._input.value.length)},_handleArrowSelect:function(w){var M=this._tooltip.hasChildNodes()?this._tooltip.childNodes:[];for(let F=0;F<M.length;F++)m.DomUtil.removeClass(M[F],"search-tip-select");if(w==1&&this._tooltip.currentSelection>=M.length-1)m.DomUtil.addClass(M[this._tooltip.currentSelection],"search-tip-select");else if(w==-1&&this._tooltip.currentSelection<=0)this._tooltip.currentSelection=-1;else if(this._tooltip.style.display!="none"){this._tooltip.currentSelection+=w,m.DomUtil.addClass(M[this._tooltip.currentSelection],"search-tip-select"),this._input.value=M[this._tooltip.currentSelection]._text;var I=M[this._tooltip.currentSelection].offsetTop;I+M[this._tooltip.currentSelection].clientHeight>=this._tooltip.scrollTop+this._tooltip.clientHeight?this._tooltip.scrollTop=I-this._tooltip.clientHeight+M[this._tooltip.currentSelection].clientHeight:I<=this._tooltip.scrollTop&&(this._tooltip.scrollTop=I)}},_handleSubmit:function(){if(this._hideAutoType(),this.hideAlert(),this._hideTooltip(),this._input.style.display=="none")this.expand();else if(this._input.value==="")this.collapse();else{var w=this._getLocation(this._input.value);w?(this.showLocation(w,this._input.value),this.fire("search:locationfound",{latlng:w,text:this._input.value,layer:w.layer?w.layer:null})):this.showAlert()}},_getLocation:function(w){return this._recordsCache.hasOwnProperty(w)?this._recordsCache[w]:!1},_defaultMoveToLocation:function(w,M,I){this.options.zoom?this._map.setView(w,this.options.zoom):this._map.panTo(w)},showLocation:function(w,M){var I=this;return I._map.once("moveend zoomend",function(F){I._markerSearch&&I._markerSearch.addTo(I._map).setLatLng(w)}),I._moveToLocation(w,M,I._map),I.options.autoCollapse&&I.collapse(),I}}),m.Control.Search.Marker=m.Marker.extend({includes:m.version[0]==="1"?m.Evented.prototype:m.Mixin.Events,options:{icon:new m.Icon.Default,animate:!0,circle:{radius:10,weight:3,color:"#e03",stroke:!0,fill:!1}},initialize:function(w,M){m.setOptions(this,M),M.icon===!0&&(M.icon=new m.Icon.Default),m.Marker.prototype.initialize.call(this,w,M),m.Control.Search.prototype._isObject(this.options.circle)&&(this._circleLoc=new m.CircleMarker(w,this.options.circle))},onAdd:function(w){m.Marker.prototype.onAdd.call(this,w),this._circleLoc&&(w.addLayer(this._circleLoc),this.options.animate&&this.animate())},onRemove:function(w){m.Marker.prototype.onRemove.call(this,w),this._circleLoc&&w.removeLayer(this._circleLoc)},setLatLng:function(w){return m.Marker.prototype.setLatLng.call(this,w),this._circleLoc&&this._circleLoc.setLatLng(w),this},_initIcon:function(){this.options.icon&&m.Marker.prototype._initIcon.call(this)},_removeIcon:function(){this.options.icon&&m.Marker.prototype._removeIcon.call(this)},animate:function(){if(this._circleLoc){var w=this._circleLoc,M=200,I=5,F=parseInt(w._radius/I),P=this.options.circle.radius,u=w._radius*2,H=0;w._timerAnimLoc=setInterval(function(){H+=.5,F+=H,u-=F,w.setRadius(u),u<P&&(clearInterval(w._timerAnimLoc),w.setRadius(P))},M)}return this}}),m.Map.addInitHook(function(){this.options.searchControl&&(this.searchControl=m.control.search(this.options.searchControl),this.addControl(this.searchControl))}),m.control.search=function(w){return new m.Control.Search(w)},m.Control.Search})}(C_)),C_.exports}d9();function f9({searchLayers:p}){const m=bf(),w=ce.useRef(null);return ce.useEffect(()=>{const M=p.current;if(!M||M.getLayers().length===0){console.log("Search layers not ready or empty.");return}const I=new go.control.search({container:"search-box",layer:M,propertyName:"searchName",tooltipLimit:10,marker:!1,initial:!1,collapsed:!1,moveToLocation:function(P,u,H){H.flyTo(P,17)}}).on("search:locationfound",function(P){setTimeout(()=>P.layer.openPopup(),500)}),F=I._handleKeypress;return I._handleKeypress=function(P){F.call(this,P),(P.keyCode===8||P.keyCode===45||P.keyCode===46)&&(this._input.value.length>=this.options.minLength?(clearTimeout(this.timerKeypress),this._fillRecordsCache()):this._hideTooltip(),this._input.value.length?this._cancel.style.display="block":this._cancel.style.display="none"),this._handleAutoresize()},w.current=I,m.addControl(I),()=>{m.removeControl(I)}},[m,p]),null}function p9({searchLayers:p}){return Tt.jsx("div",{id:"search-box",className:"search-container",children:Tt.jsx(f9,{searchLayers:p})})}function m9(){return Tt.jsx("div",{className:"fare-element-container",children:Tt.jsxs("ul",{className:"fare-list",children:[Tt.jsx("li",{className:"fare-items",children:Tt.jsxs("div",{children:[Tt.jsx("div",{children:"Regular Fare"}),Tt.jsx("span",{className:"list-span",children:"$0.50"})]})}),Tt.jsx("li",{className:"fare-items",children:Tt.jsxs("div",{children:[Tt.jsx("div",{children:"Children (Ages 5 - High School)"}),Tt.jsx("span",{className:"list-span",children:"$0.25"})]})}),Tt.jsx("li",{className:"fare-items",children:Tt.jsxs("div",{children:[Tt.jsx("div",{children:"Senior Citizens (62 yrs and up)"}),Tt.jsx("span",{className:"list-span",children:"$0.25"})]})}),Tt.jsx("li",{className:"fare-items",children:Tt.jsxs("div",{children:[Tt.jsx("div",{children:"Disabled with ID"}),Tt.jsx("span",{className:"list-span",children:"$0.25"})]})}),Tt.jsx("li",{className:"fare-items",children:Tt.jsxs("div",{children:[Tt.jsx("div",{children:"HCT ID and Medicare"}),Tt.jsx("span",{className:"list-span",children:"$0.25"})]})}),Tt.jsx("li",{className:"fare-items",children:Tt.jsxs("div",{children:[Tt.jsx("div",{children:"Southern Miss ID"}),Tt.jsx("span",{className:"list-span",children:"FREE"})]})}),Tt.jsx("li",{className:"fare-items",children:Tt.jsxs("div",{children:[Tt.jsx("div",{children:"City of Hattiesburg Employees"}),Tt.jsx("span",{className:"list-span",children:"FREE"})]})})]})})}function _9(){return Tt.jsxs("div",{className:"legend-container",children:[Tt.jsxs("div",{className:"legend-item",children:[Tt.jsx("div",{children:"Regular Stop"}),Tt.jsx("div",{className:"regular-stop-icon",children:Tt.jsx("div",{})})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsx("div",{children:"Transfer Stop"}),Tt.jsx("div",{className:"transfer-stop-icon",children:Tt.jsx("div",{})})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsx("div",{children:"Bus Station"}),Tt.jsx("div",{className:"bus-station-icon",children:Tt.jsx("img",{src:ml})})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsx("div",{children:"Gold Bus Marker"}),Tt.jsx("div",{className:"legend-bus-icon-container",style:{backgroundColor:"hsl(44, 96%, 59%)"},children:Tt.jsx("div",{className:"legend-bus-icon",children:Tt.jsx("img",{src:ml})})})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsx("div",{children:"Green Bus Marker"}),Tt.jsx("div",{className:"legend-bus-icon-container",style:{backgroundColor:"hsl(112, 63%, 52%)"},children:Tt.jsx("div",{className:"legend-bus-icon",children:Tt.jsx("img",{src:ml})})})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsx("div",{children:"Blue Bus Marker"}),Tt.jsx("div",{className:"legend-bus-icon-container",style:{backgroundColor:"hsl(200, 100%, 50%)"},children:Tt.jsx("div",{className:"legend-bus-icon",children:Tt.jsx("img",{src:ml})})})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsx("div",{children:"Brown Bus Marker"}),Tt.jsx("div",{className:"legend-bus-icon-container",style:{backgroundColor:"hsl(17, 74%, 37%)"},children:Tt.jsx("div",{className:"legend-bus-icon",children:Tt.jsx("img",{src:ml})})})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsx("div",{children:"Red Bus Marker"}),Tt.jsx("div",{className:"legend-bus-icon-container",style:{backgroundColor:"hsl(12, 82%, 50%)"},children:Tt.jsx("div",{className:"legend-bus-icon",children:Tt.jsx("img",{src:ml})})})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsx("div",{children:"Purple Bus Marker"}),Tt.jsx("div",{className:"legend-bus-icon-container",style:{backgroundColor:"hsl(250, 100%, 77%)"},children:Tt.jsx("div",{className:"legend-bus-icon",children:Tt.jsx("img",{src:ml})})})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsx("div",{children:"Orange Bus Marker"}),Tt.jsx("div",{className:"legend-bus-icon-container",style:{backgroundColor:"hsl(27, 100%, 50%)"},children:Tt.jsx("div",{className:"legend-bus-icon",children:Tt.jsx("img",{src:ml})})})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsxs("div",{className:"legend-route-name-container",children:[Tt.jsx("div",{className:"line-name",children:"Gold Line"}),Tt.jsx("div",{className:"street-name",children:"(USM)"})]}),Tt.jsx("div",{className:"legend-route-icon",style:{backgroundColor:"hsl(44, 96%, 59%)"}})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsxs("div",{className:"legend-route-name-container",children:[Tt.jsx("div",{className:"line-name",children:"Green Line"}),Tt.jsx("div",{className:"street-name",children:"(4th Street)"})]}),Tt.jsx("div",{className:"legend-route-icon",style:{backgroundColor:"hsl(112, 63%, 52%)"}})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsxs("div",{className:"legend-route-name-container",children:[Tt.jsx("div",{className:"line-name",children:"Blue Line"}),Tt.jsx("div",{className:"street-name",children:"(Hardy Street)"})]}),Tt.jsx("div",{className:"legend-route-icon",style:{backgroundColor:"hsl(200, 100%, 50%)"}})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsxs("div",{className:"legend-route-name-container",children:[Tt.jsx("div",{className:"line-name",children:"Brown Line"}),Tt.jsx("div",{className:"street-name",children:"(7th Street)"})]}),Tt.jsx("div",{className:"legend-route-icon",style:{backgroundColor:"hsl(17, 74%, 37%)"}})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsxs("div",{className:"legend-route-name-container",children:[Tt.jsx("div",{className:"line-name",children:"Red Line"}),Tt.jsx("div",{className:"street-name",children:"(Country Club Road)"})]}),Tt.jsx("div",{className:"legend-route-icon",style:{backgroundColor:"hsl(12, 82%, 50%)"}})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsxs("div",{className:"legend-route-name-container",children:[Tt.jsx("div",{className:"line-name",children:"Purple Line"}),Tt.jsx("div",{className:"street-name",children:"(Palmer's Crossing)"})]}),Tt.jsx("div",{className:"legend-route-icon",style:{backgroundColor:"hsl(250, 100%, 77%)"}})]}),Tt.jsx("hr",{className:"legend-hr"}),Tt.jsxs("div",{className:"legend-item",children:[Tt.jsxs("div",{className:"legend-route-name-container",children:[Tt.jsx("div",{className:"line-name",children:"Orange Line"}),Tt.jsx("div",{className:"street-name",children:"(Broadway Drive)"})]}),Tt.jsx("div",{className:"legend-route-icon",style:{backgroundColor:"hsl(27, 100%, 50%)"}})]})]})}const g9="/hub-city-transit-v2/assets/schedule-icon2-We-67mP6.png",y9="/hub-city-transit-v2/assets/route-icon-Ce2DI5Xj.png",v9="/hub-city-transit-v2/assets/search-icon2-CqoNze7d.png",x9="/hub-city-transit-v2/assets/fare-icon-Bd6mD4Ju.png",b9="/hub-city-transit-v2/assets/legend-icon-hyF_9eu4.png";function w9({busData:p,searchLayers:m}){const[w,M]=ce.useState(null),I=ce.useRef(null),F=[{name:"Schedule",icon:g9,height:"30px"},{name:"Routes",icon:y9,height:"30px"},{name:"Search",icon:v9,height:"30px"},{name:"Fare",icon:x9,height:"30px"},{name:"Legend",icon:b9,height:"30px"}];function P(X){M(Q=>Q===X?null:X)}ce.useEffect(()=>{I.current&&(go.DomEvent.disableClickPropagation(I.current),go.DomEvent.disableScrollPropagation(I.current))},[]);const u=()=>{switch(w){case"Schedule":return Tt.jsx(l9,{});case"Routes":return Tt.jsx(h9,{busData:p});case"Search":return Tt.jsx(p9,{searchLayers:m});case"Fare":return Tt.jsx(m9,{});case"Legend":return Tt.jsx(_9,{});default:return null}},H={initial:{height:0,opacity:0},animate:{height:"auto",opacity:1,transition:{height:{type:"spring",stiffness:400,damping:30},opacity:{duration:.2}}},exit:{height:0,opacity:0,transition:{height:{type:"tween",duration:.3},opacity:{duration:.15}}}};return Tt.jsxs("div",{ref:I,children:[Tt.jsx("div",{className:"bottom-bar",children:F.map(X=>Tt.jsx(Ev,{prop:X,isActive:w===X.name,onClick:()=>P(X.name)},X.name))}),Tt.jsx(Py,{mode:"sync",children:w&&Tt.jsx(f3.div,{className:"function-box",variants:H,initial:"initial",animate:"animate",exit:"exit",style:{overflow:"hidden"},children:u()},w)})]})}var Bm={exports:{}},Om={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.6.2/LICENSE.txt
 */var T9=Om.exports,w0;function S9(){return w0||(w0=1,function(p,m){(function(w,M){p.exports=M()})(T9,function(){var w={},M={};function I(P,u,H){if(M[P]=H,P==="index"){var X="var sharedModule = {}; ("+M.shared+")(sharedModule); ("+M.worker+")(sharedModule);",Q={};return M.shared(Q),M.index(w,Q),typeof window<"u"&&w.setWorkerUrl(window.URL.createObjectURL(new Blob([X],{type:"text/javascript"}))),w}}I("shared",["exports"],function(P){function u(r,e,n,l){return new(n||(n=Promise))(function(d,x){function b(k){try{E(l.next(k))}catch(N){x(N)}}function S(k){try{E(l.throw(k))}catch(N){x(N)}}function E(k){var N;k.done?d(k.value):(N=k.value,N instanceof n?N:new n(function(V){V(N)})).then(b,S)}E((l=l.apply(r,e||[])).next())})}function H(r,e){this.x=r,this.y=e}function X(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Q,dt;typeof SuppressedError=="function"&&SuppressedError,H.prototype={clone(){return new H(this.x,this.y)},add(r){return this.clone()._add(r)},sub(r){return this.clone()._sub(r)},multByPoint(r){return this.clone()._multByPoint(r)},divByPoint(r){return this.clone()._divByPoint(r)},mult(r){return this.clone()._mult(r)},div(r){return this.clone()._div(r)},rotate(r){return this.clone()._rotate(r)},rotateAround(r,e){return this.clone()._rotateAround(r,e)},matMult(r){return this.clone()._matMult(r)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(r){return this.x===r.x&&this.y===r.y},dist(r){return Math.sqrt(this.distSqr(r))},distSqr(r){const e=r.x-this.x,n=r.y-this.y;return e*e+n*n},angle(){return Math.atan2(this.y,this.x)},angleTo(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith(r){return this.angleWithSep(r.x,r.y)},angleWithSep(r,e){return Math.atan2(this.x*e-this.y*r,this.x*r+this.y*e)},_matMult(r){const e=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=e,this},_add(r){return this.x+=r.x,this.y+=r.y,this},_sub(r){return this.x-=r.x,this.y-=r.y,this},_mult(r){return this.x*=r,this.y*=r,this},_div(r){return this.x/=r,this.y/=r,this},_multByPoint(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint(r){return this.x/=r.x,this.y/=r.y,this},_unit(){return this._div(this.mag()),this},_perp(){const r=this.y;return this.y=this.x,this.x=-r,this},_rotate(r){const e=Math.cos(r),n=Math.sin(r),l=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=l,this},_rotateAround(r,e){const n=Math.cos(r),l=Math.sin(r),d=e.y+l*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-l*(this.y-e.y),this.y=d,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:H},H.convert=function(r){if(r instanceof H)return r;if(Array.isArray(r))return new H(+r[0],+r[1]);if(r.x!==void 0&&r.y!==void 0)return new H(+r.x,+r.y);throw new Error("Expected [x, y] or {x, y} point format")};var ht=function(){if(dt)return Q;function r(e,n,l,d){this.cx=3*e,this.bx=3*(l-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(d-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=l,this.p2y=d}return dt=1,Q=r,r.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,n){if(n===void 0&&(n=1e-6),e<0)return 0;if(e>1)return 1;for(var l=e,d=0;d<8;d++){var x=this.sampleCurveX(l)-e;if(Math.abs(x)<n)return l;var b=this.sampleCurveDerivativeX(l);if(Math.abs(b)<1e-6)break;l-=x/b}var S=0,E=1;for(l=e,d=0;d<20&&(x=this.sampleCurveX(l),!(Math.abs(x-e)<n));d++)e>x?S=l:E=l,l=.5*(E-S)+S;return l},solve:function(e,n){return this.sampleCurveY(this.solveCurveX(e,n))}},Q}(),lt=X(ht);let Yt,Jt;function pe(){return Yt==null&&(Yt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Yt}function ge(){if(Jt==null&&(Jt=!1,pe())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let l=0;l<25;l++){const d=4*l;e.fillStyle=`rgb(${d},${d+1},${d+2})`,e.fillRect(l%5,Math.floor(l/5),1,1)}const n=e.getImageData(0,0,5,5).data;for(let l=0;l<100;l++)if(l%4!=3&&n[l]!==l){Jt=!0;break}}}return Jt||!1}var de=1e-6,ne=typeof Float32Array<"u"?Float32Array:Array;function Ne(){var r=new ne(9);return ne!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function we(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Ve(){var r=new ne(3);return ne!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function Je(r){return Math.hypot(r[0],r[1],r[2])}function Ue(r,e,n){var l=new ne(3);return l[0]=r,l[1]=e,l[2]=n,l}function Ei(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r}function Ti(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r}function zi(r,e,n){var l=e[0],d=e[1],x=e[2],b=n[0],S=n[1],E=n[2];return r[0]=d*E-x*S,r[1]=x*b-l*E,r[2]=l*S-d*b,r}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var Pi,Ir=Je;function Rn(r,e,n){var l=e[0],d=e[1],x=e[2],b=e[3];return r[0]=n[0]*l+n[4]*d+n[8]*x+n[12]*b,r[1]=n[1]*l+n[5]*d+n[9]*x+n[13]*b,r[2]=n[2]*l+n[6]*d+n[10]*x+n[14]*b,r[3]=n[3]*l+n[7]*d+n[11]*x+n[15]*b,r}function dn(){var r=new ne(4);return ne!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function Qt(r,e,n,l){var d=.5*Math.PI/180;e*=d,n*=d,l*=d;var x=Math.sin(e),b=Math.cos(e),S=Math.sin(n),E=Math.cos(n),k=Math.sin(l),N=Math.cos(l);return r[0]=x*E*N-b*S*k,r[1]=b*S*N+x*E*k,r[2]=b*E*k-x*S*N,r[3]=b*E*N+x*S*k,r}function me(){var r=new ne(2);return ne!=Float32Array&&(r[0]=0,r[1]=0),r}function fe(r,e){var n=new ne(2);return n[0]=r,n[1]=e,n}Ve(),Pi=new ne(4),ne!=Float32Array&&(Pi[0]=0,Pi[1]=0,Pi[2]=0,Pi[3]=0),Ve(),Ue(1,0,0),Ue(0,1,0),dn(),dn(),Ne(),me();const Ze=8192;function yt(r,e,n){return e*(Ze/(r.tileSize*Math.pow(2,n-r.tileID.overscaledZ)))}function Wt(r,e){return(r%e+e)%e}function Ce(r,e,n){return r*(1-n)+e*n}function xe(r){if(r<=0)return 0;if(r>=1)return 1;const e=r*r,n=e*r;return 4*(r<.5?n:3*(r-e)+n-.75)}function ze(r,e,n,l){const d=new lt(r,e,n,l);return x=>d.solve(x)}const Fe=ze(.25,.1,.25,1);function Se(r,e,n){return Math.min(n,Math.max(e,r))}function rn(r,e,n){const l=n-e,d=((r-e)%l+l)%l+e;return d===e?n:d}function xi(r,...e){for(const n of e)for(const l in n)r[l]=n[l];return r}let rr=1;function da(r,e,n){const l={};for(const d in r)l[d]=e.call(this,r[d],d,r);return l}function Ws(r,e,n){const l={};for(const d in r)e.call(this,r[d],d,r)&&(l[d]=r[d]);return l}function sr(r){return Array.isArray(r)?r.map(sr):typeof r=="object"&&r?da(r,sr):r}const sn={};function An(r){sn[r]||(typeof console<"u"&&console.warn(r),sn[r]=!0)}function Os(r,e,n){return(n.y-r.y)*(e.x-r.x)>(e.y-r.y)*(n.x-r.x)}function Ks(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let dr=null;function ys(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const Qs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function vo(r,e,n,l,d){return u(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const x=new VideoFrame(r,{timestamp:0});try{const b=x?.format;if(!b||!b.startsWith("BGR")&&!b.startsWith("RGB"))throw new Error(`Unrecognized format ${b}`);const S=b.startsWith("BGR"),E=new Uint8ClampedArray(l*d*4);if(yield x.copyTo(E,function(k,N,V,q,W){const K=4*Math.max(-N,0),et=(Math.max(0,V)-V)*q*4+K,at=4*q,ft=Math.max(0,N),Dt=Math.max(0,V);return{rect:{x:ft,y:Dt,width:Math.min(k.width,N+q)-ft,height:Math.min(k.height,V+W)-Dt},layout:[{offset:et,stride:at}]}}(r,e,n,l,d)),S)for(let k=0;k<E.length;k+=4){const N=E[k];E[k]=E[k+2],E[k+2]=N}return E}finally{x.close()}})}let vs,Ha;function fa(r,e,n,l){return r.addEventListener(e,n,l),{unsubscribe:()=>{r.removeEventListener(e,n,l)}}}function Go(r){return r*Math.PI/180}function xo(r){return r/Math.PI*180}const ts={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Vn={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},es="AbortError";function Ct(){return new Error(es)}const tt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function it(r){return tt.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}const st="global-dispatcher";class _t extends Error{constructor(e,n,l,d){super(`AJAXError: ${n} (${e}): ${l}`),this.status=e,this.statusText=n,this.url=l,this.body=d}}const Pt=()=>Ks(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Et=function(r,e){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){const l=it(r.url);if(l)return l(r,e);if(Ks(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,targetMapId:st},e)}if(!(/^file:/.test(n=r.url)||/^file:/.test(Pt())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(l,d){return u(this,void 0,void 0,function*(){const x=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:Pt(),signal:d.signal});let b,S;l.type!=="json"||x.headers.has("Accept")||x.headers.set("Accept","application/json");try{b=yield fetch(x)}catch(k){throw new _t(0,k.message,l.url,new Blob)}if(!b.ok){const k=yield b.blob();throw new _t(b.status,b.statusText,l.url,k)}S=l.type==="arrayBuffer"||l.type==="image"?b.arrayBuffer():l.type==="json"?b.json():b.text();const E=yield S;if(d.signal.aborted)throw Ct();return{data:E,cacheControl:b.headers.get("Cache-Control"),expires:b.headers.get("Expires")}})}(r,e);if(Ks(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,mustQueue:!0,targetMapId:st},e)}var n;return function(l,d){return new Promise((x,b)=>{var S;const E=new XMLHttpRequest;E.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(E.responseType="arraybuffer");for(const k in l.headers)E.setRequestHeader(k,l.headers[k]);l.type==="json"&&(E.responseType="text",!((S=l.headers)===null||S===void 0)&&S.Accept||E.setRequestHeader("Accept","application/json")),E.withCredentials=l.credentials==="include",E.onerror=()=>{b(new Error(E.statusText))},E.onload=()=>{if(!d.signal.aborted)if((E.status>=200&&E.status<300||E.status===0)&&E.response!==null){let k=E.response;if(l.type==="json")try{k=JSON.parse(E.response)}catch(N){return void b(N)}x({data:k,cacheControl:E.getResponseHeader("Cache-Control"),expires:E.getResponseHeader("Expires")})}else{const k=new Blob([E.response],{type:E.getResponseHeader("Content-Type")});b(new _t(E.status,E.statusText,l.url,k))}},d.signal.addEventListener("abort",()=>{E.abort(),b(Ct())}),E.send(l.body)})}(r,e)};function Ft(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;const e=new URL(r),n=window.location;return e.protocol===n.protocol&&e.host===n.host}function zt(r,e,n){n[r]&&n[r].indexOf(e)!==-1||(n[r]=n[r]||[],n[r].push(e))}function Kt(r,e,n){if(n&&n[r]){const l=n[r].indexOf(e);l!==-1&&n[r].splice(l,1)}}class oe{constructor(e,n={}){xi(this,n),this.type=e}}class ee extends oe{constructor(e,n={}){super("error",xi({error:e},n))}}class Le{on(e,n){return this._listeners=this._listeners||{},zt(e,n,this._listeners),{unsubscribe:()=>{this.off(e,n)}}}off(e,n){return Kt(e,n,this._listeners),Kt(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},zt(e,n,this._oneTimeListeners),this):new Promise(l=>this.once(e,l))}fire(e,n){typeof e=="string"&&(e=new oe(e,n||{}));const l=e.type;if(this.listens(l)){e.target=this;const d=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const S of d)S.call(this,e);const x=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const S of x)Kt(l,S,this._oneTimeListeners),S.call(this,e);const b=this._eventedParent;b&&(xi(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(e))}else e instanceof ee&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var It={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ri=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function bi(r,e){const n={};for(const l in r)l!=="ref"&&(n[l]=r[l]);return ri.forEach(l=>{l in e&&(n[l]=e[l])}),n}function Ge(r,e){if(Array.isArray(r)){if(!Array.isArray(e)||r.length!==e.length)return!1;for(let n=0;n<r.length;n++)if(!Ge(r[n],e[n]))return!1;return!0}if(typeof r=="object"&&r!==null&&e!==null){if(typeof e!="object"||Object.keys(r).length!==Object.keys(e).length)return!1;for(const n in r)if(!Ge(r[n],e[n]))return!1;return!0}return r===e}function li(r,e){r.push(e)}function Zi(r,e,n){li(n,{command:"addSource",args:[r,e[r]]})}function qn(r,e,n){li(e,{command:"removeSource",args:[r]}),n[r]=!0}function Un(r,e,n,l){qn(r,n,l),Zi(r,e,n)}function $i(r,e,n){let l;for(l in r[n])if(Object.prototype.hasOwnProperty.call(r[n],l)&&l!=="data"&&!Ge(r[n][l],e[n][l]))return!1;for(l in e[n])if(Object.prototype.hasOwnProperty.call(e[n],l)&&l!=="data"&&!Ge(r[n][l],e[n][l]))return!1;return!0}function ii(r,e,n,l,d,x){r=r||{},e=e||{};for(const b in r)Object.prototype.hasOwnProperty.call(r,b)&&(Ge(r[b],e[b])||n.push({command:x,args:[l,b,e[b],d]}));for(const b in e)Object.prototype.hasOwnProperty.call(e,b)&&!Object.prototype.hasOwnProperty.call(r,b)&&(Ge(r[b],e[b])||n.push({command:x,args:[l,b,e[b],d]}))}function si(r){return r.id}function fn(r,e){return r[e.id]=e,r}class ue{constructor(e,n,l,d){this.message=(e?`${e}: `:"")+l,d&&(this.identifier=d),n!=null&&n.__line__&&(this.line=n.__line__)}}function Ie(r,...e){for(const n of e)for(const l in n)r[l]=n[l];return r}class vn extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}class pa{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[l,d]of n)this.bindings[l]=d}concat(e){return new pa(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Js={kind:"null"},Me={kind:"number"},ci={kind:"string"},ai={kind:"boolean"},an={kind:"color"},xs={kind:"projectionDefinition"},pn={kind:"object"},hi={kind:"value"},Jl={kind:"collator"},is={kind:"formatted"},ma={kind:"padding"},_a={kind:"colorArray"},ga={kind:"numberArray"},Cn={kind:"resolvedImage"},Rc={kind:"variableAnchorOffsetCollection"};function wr(r,e){return{kind:"array",itemType:r,N:e}}function Vi(r){if(r.kind==="array"){const e=Vi(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}return r.kind}const ya=[Js,Me,ci,ai,an,xs,is,pn,wr(hi),ma,ga,_a,Cn,Rc];function qa(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!qa(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const n of ya)if(!qa(n,e))return null}}return`Expected ${Vi(r)} but found ${Vi(e)} instead.`}function bo(r,e){return e.some(n=>n.kind===r.kind)}function ns(r,e){return e.some(n=>n==="null"?r===null:n==="array"?Array.isArray(r):n==="object"?r&&!Array.isArray(r)&&typeof r=="object":n===typeof r)}function ta(r,e){return r.kind==="array"&&e.kind==="array"?r.itemType.kind===e.itemType.kind&&typeof r.N=="number":r.kind===e.kind}const $a=.96422,Oi=.82521,mn=4/29,$n=6/29,wo=3*$n*$n,_l=$n*$n*$n,gl=Math.PI/180,Si=180/Math.PI;function on(r){return(r%=360)<0&&(r+=360),r}function To([r,e,n,l]){let d,x;const b=Rr((.2225045*(r=Tr(r))+.7168786*(e=Tr(e))+.0606169*(n=Tr(n)))/1);r===e&&e===n?d=x=b:(d=Rr((.4360747*r+.3850649*e+.1430804*n)/$a),x=Rr((.0139322*r+.0971045*e+.7141733*n)/Oi));const S=116*b-16;return[S<0?0:S,500*(d-b),200*(b-x),l]}function Tr(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Rr(r){return r>_l?Math.pow(r,1/3):r/wo+mn}function Ho([r,e,n,l]){let d=(r+16)/116,x=isNaN(e)?d:d+e/500,b=isNaN(n)?d:d-n/200;return d=1*rs(d),x=$a*rs(x),b=Oi*rs(b),[So(3.1338561*x-1.6168667*d-.4906146*b),So(-.9787684*x+1.9161415*d+.033454*b),So(.0719453*x-.2289914*d+1.4052427*b),l]}function So(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function rs(r){return r>$n?r*r*r:wo*(r-mn)}const Zn=Object.hasOwn||function(r,e){return Object.prototype.hasOwnProperty.call(r,e)};function bs(r,e){return Zn(r,e)?r[e]:void 0}function ss(r){return parseInt(r.padEnd(2,r),16)/255}function Ur(r,e){return gi(e?r/100:r,0,1)}function gi(r,e,n){return Math.min(Math.max(e,r),n)}function Ns(r){return!r.some(Number.isNaN)}const js={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function ea(r,e,n){return r+n*(e-r)}function va(r,e,n){return r.map((l,d)=>ea(l,e[d],n))}class di{constructor(e,n,l,d=1,x=!0){this.r=e,this.g=n,this.b=l,this.a=d,x||(this.r*=d,this.g*=d,this.b*=d,d||this.overwriteGetter("rgb",[e,n,l,d]))}static parse(e){if(e instanceof di)return e;if(typeof e!="string")return;const n=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const d=bs(js,l);if(d){const[b,S,E]=d;return[b/255,S/255,E/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const b=l.length<6?1:2;let S=1;return[ss(l.slice(S,S+=b)),ss(l.slice(S,S+=b)),ss(l.slice(S,S+=b)),ss(l.slice(S,S+b)||"ff")]}if(l.startsWith("rgb")){const b=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[S,E,k,N,V,q,W,K,et,at,ft,Dt]=b,xt=[N||" ",W||" ",at].join("");if(xt==="  "||xt==="  /"||xt===",,"||xt===",,,"){const Mt=[k,q,et].join(""),jt=Mt==="%%%"?100:Mt===""?255:0;if(jt){const $t=[gi(+E/jt,0,1),gi(+V/jt,0,1),gi(+K/jt,0,1),ft?Ur(+ft,Dt):1];if(Ns($t))return $t}}return}}const x=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[b,S,E,k,N,V,q,W,K]=x,et=[E||" ",N||" ",q].join("");if(et==="  "||et==="  /"||et===",,"||et===",,,"){const at=[+S,gi(+k,0,100),gi(+V,0,100),W?Ur(+W,K):1];if(Ns(at))return function([ft,Dt,xt,Mt]){function jt($t){const se=($t+ft/30)%12,Pe=Dt*Math.min(xt,1-xt);return xt-Pe*Math.max(-1,Math.min(se-3,9-se,1))}return ft=on(ft),Dt/=100,xt/=100,[jt(0),jt(8),jt(4),Mt]}(at)}}}(e);return n?new di(...n,!1):void 0}get rgb(){const{r:e,g:n,b:l,a:d}=this,x=d||1/0;return this.overwriteGetter("rgb",[e/x,n/x,l/x,d])}get hcl(){return this.overwriteGetter("hcl",function(e){const[n,l,d,x]=To(e),b=Math.sqrt(l*l+d*d);return[Math.round(1e4*b)?on(Math.atan2(d,l)*Si):NaN,b,n,x]}(this.rgb))}get lab(){return this.overwriteGetter("lab",To(this.rgb))}overwriteGetter(e,n){return Object.defineProperty(this,e,{value:n}),n}toString(){const[e,n,l,d]=this.rgb;return`rgba(${[e,n,l].map(x=>Math.round(255*x)).join(",")},${d})`}static interpolate(e,n,l,d="rgb"){switch(d){case"rgb":{const[x,b,S,E]=va(e.rgb,n.rgb,l);return new di(x,b,S,E,!1)}case"hcl":{const[x,b,S,E]=e.hcl,[k,N,V,q]=n.hcl;let W,K;if(isNaN(x)||isNaN(k))isNaN(x)?isNaN(k)?W=NaN:(W=k,S!==1&&S!==0||(K=N)):(W=x,V!==1&&V!==0||(K=b));else{let xt=k-x;k>x&&xt>180?xt-=360:k<x&&x-k>180&&(xt+=360),W=x+l*xt}const[et,at,ft,Dt]=function([xt,Mt,jt,$t]){return xt=isNaN(xt)?0:xt*gl,Ho([jt,Math.cos(xt)*Mt,Math.sin(xt)*Mt,$t])}([W,K??ea(b,N,l),ea(S,V,l),ea(E,q,l)]);return new di(et,at,ft,Dt,!1)}case"lab":{const[x,b,S,E]=Ho(va(e.lab,n.lab,l));return new di(x,b,S,E,!1)}}}}di.black=new di(0,0,0,1),di.white=new di(1,1,1,1),di.transparent=new di(0,0,0,0),di.red=new di(1,0,0,1);class ia{constructor(e,n,l){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Xa=["bottom","center","top"];class xa{constructor(e,n,l,d,x,b){this.text=e,this.image=n,this.scale=l,this.fontStack=d,this.textColor=x,this.verticalAlign=b}}class kn{constructor(e){this.sections=e}static fromString(e){return new kn([new xa(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof kn?e:kn.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class ar{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof ar)return e;if(typeof e=="number")return new ar([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const n of e)if(typeof n!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new ar(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,n,l){return new ar(va(e.values,n.values,l))}}class Qe{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Qe)return e;if(typeof e=="number")return new Qe([e]);if(Array.isArray(e)){for(const n of e)if(typeof n!="number")return;return new Qe(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,n,l){return new Qe(va(e.values,n.values,l))}}class Ui{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Ui)return e;if(typeof e=="string"){const l=di.parse(e);return l?new Ui([l]):void 0}if(!Array.isArray(e))return;const n=[];for(const l of e){if(typeof l!="string")return;const d=di.parse(l);if(!d)return;n.push(d)}return new Ui(n)}toString(){return JSON.stringify(this.values)}static interpolate(e,n,l,d="rgb"){const x=[];if(e.values.length!=n.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${n.values.length}), cannot interpolate.`);for(let b=0;b<e.values.length;b++)x.push(di.interpolate(e.values[b],n.values[b],l,d));return new Ui(x)}}class ti extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const na=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class or{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof or)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let n=0;n<e.length;n+=2){const l=e[n],d=e[n+1];if(typeof l!="string"||!na.has(l)||!Array.isArray(d)||d.length!==2||typeof d[0]!="number"||typeof d[1]!="number")return}return new or(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,n,l){const d=e.values,x=n.values;if(d.length!==x.length)throw new ti(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${n.toString()}`);const b=[];for(let S=0;S<d.length;S+=2){if(d[S]!==x[S])throw new ti(`Cannot interpolate values containing mismatched anchors. from[${S}]: ${d[S]}, to[${S}]: ${x[S]}`);b.push(d[S]);const[E,k]=d[S+1],[N,V]=x[S+1];b.push([ea(E,N,l),ea(k,V,l)])}return new or(b)}}class lr{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new lr({name:e,available:!1}):null}}class _n{constructor(e,n,l){this.from=e,this.to=n,this.transition=l}static interpolate(e,n,l){return new _n(e,n,l)}static parse(e){return e instanceof _n?e:Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number"?new _n(e[0],e[1],e[2]):typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number"?new _n(e.from,e.to,e.transition):typeof e=="string"?new _n(e,e,1):void 0}}function Ri(r,e,n,l){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[r,e,n,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[r,e,n,l]:[r,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Fs(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof _n||r instanceof di||r instanceof ia||r instanceof kn||r instanceof ar||r instanceof Qe||r instanceof Ui||r instanceof or||r instanceof lr)return!0;if(Array.isArray(r)){for(const e of r)if(!Fs(e))return!1;return!0}if(typeof r=="object"){for(const e in r)if(!Fs(r[e]))return!1;return!0}return!1}function Ye(r){if(r===null)return Js;if(typeof r=="string")return ci;if(typeof r=="boolean")return ai;if(typeof r=="number")return Me;if(r instanceof di)return an;if(r instanceof _n)return xs;if(r instanceof ia)return Jl;if(r instanceof kn)return is;if(r instanceof ar)return ma;if(r instanceof Qe)return ga;if(r instanceof Ui)return _a;if(r instanceof or)return Rc;if(r instanceof lr)return Cn;if(Array.isArray(r)){const e=r.length;let n;for(const l of r){const d=Ye(l);if(n){if(n===d)continue;n=hi;break}n=d}return wr(n||hi,e)}return pn}function je(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof di||r instanceof _n||r instanceof kn||r instanceof ar||r instanceof Qe||r instanceof Ui||r instanceof or||r instanceof lr?r.toString():JSON.stringify(r)}class fr{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Fs(e[1]))return n.error("invalid value");const l=e[1];let d=Ye(l);const x=n.expectedType;return d.kind!=="array"||d.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(d=x),new fr(d,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Ai={string:ci,number:Me,boolean:ai,object:pn};class Ji{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let l,d=1;const x=e[0];if(x==="array"){let S,E;if(e.length>2){const k=e[1];if(typeof k!="string"||!(k in Ai)||k==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);S=Ai[k],d++}else S=hi;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);E=e[2],d++}l=wr(S,E)}else{if(!Ai[x])throw new Error(`Types doesn't contain name = ${x}`);l=Ai[x]}const b=[];for(;d<e.length;d++){const S=n.parse(e[d],d,hi);if(!S)return null;b.push(S)}return new Ji(l,b)}evaluate(e){for(let n=0;n<this.args.length;n++){const l=this.args[n].evaluate(e);if(!qa(this.type,Ye(l)))return l;if(n===this.args.length-1)throw new ti(`Expected value to be of type ${Vi(this.type)}, but found ${Vi(Ye(l))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const kr={"to-boolean":ai,"to-color":an,"to-number":Me,"to-string":ci};class as{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const l=e[0];if(!kr[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&e.length!==2)return n.error("Expected one argument.");const d=kr[l],x=[];for(let b=1;b<e.length;b++){const S=n.parse(e[b],b,hi);if(!S)return null;x.push(S)}return new as(d,x)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let n,l;for(const d of this.args){if(n=d.evaluate(e),l=null,n instanceof di)return n;if(typeof n=="string"){const x=e.parseColor(n);if(x)return x}else if(Array.isArray(n)&&(l=n.length<3||n.length>4?`Invalid rgba value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:Ri(n[0],n[1],n[2],n[3]),!l))return new di(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new ti(l||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const l of this.args){n=l.evaluate(e);const d=ar.parse(n);if(d)return d}throw new ti(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"numberArray":{let n;for(const l of this.args){n=l.evaluate(e);const d=Qe.parse(n);if(d)return d}throw new ti(`Could not parse numberArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"colorArray":{let n;for(const l of this.args){n=l.evaluate(e);const d=Ui.parse(n);if(d)return d}throw new ti(`Could not parse colorArray from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const l of this.args){n=l.evaluate(e);const d=or.parse(n);if(d)return d}throw new ti(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const l of this.args){if(n=l.evaluate(e),n===null)return 0;const d=Number(n);if(!isNaN(d))return d}throw new ti(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return kn.fromString(je(this.args[0].evaluate(e)));case"resolvedImage":return lr.fromString(je(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return je(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const ba=["Unknown","Point","LineString","Polygon"];class pu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ba[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let n=this._parseColorCache.get(e);return n||(n=di.parse(e),this._parseColorCache.set(e,n)),n}}class Ya{constructor(e,n,l=[],d,x=new pa,b=[]){this.registry=e,this.path=l,this.key=l.map(S=>`[${S}]`).join(""),this.scope=x,this.errors=b,this.expectedType=d,this._isConstant=n}parse(e,n,l,d,x={}){return n?this.concat(n,l,d)._parse(e,x):this._parse(e,x)}_parse(e,n){function l(d,x,b){return b==="assert"?new Ji(x,[d]):b==="coerce"?new as(x,[d]):d}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=e[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[d];if(x){let b=x.parse(e,this);if(!b)return null;if(this.expectedType){const S=this.expectedType,E=b.type;if(S.kind!=="string"&&S.kind!=="number"&&S.kind!=="boolean"&&S.kind!=="object"&&S.kind!=="array"||E.kind!=="value"){if(S.kind==="projectionDefinition"&&["string","array"].includes(E.kind)||["color","formatted","resolvedImage"].includes(S.kind)&&["value","string"].includes(E.kind)||["padding","numberArray"].includes(S.kind)&&["value","number","array"].includes(E.kind)||S.kind==="colorArray"&&["value","string","array"].includes(E.kind)||S.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(E.kind))b=l(b,S,n.typeAnnotation||"coerce");else if(this.checkSubtype(S,E))return null}else b=l(b,S,n.typeAnnotation||"assert")}if(!(b instanceof fr)&&b.type.kind!=="resolvedImage"&&this._isConstant(b)){const S=new pu;try{b=new fr(b.type,b.evaluate(S))}catch(E){return this.error(E.message),null}}return b}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,l){const d=typeof e=="number"?this.path.concat(e):this.path,x=l?this.scope.concat(l):this.scope;return new Ya(this.registry,this._isConstant,d,n||null,x,this.errors)}error(e,...n){const l=`${this.key}${n.map(d=>`[${d}]`).join("")}`;this.errors.push(new vn(l,e))}checkSubtype(e,n){const l=qa(e,n);return l&&this.error(l),l}}class Mi{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const l=[];for(let x=1;x<e.length-1;x+=2){const b=e[x];if(typeof b!="string")return n.error(`Expected string, but found ${typeof b} instead.`,x);if(/[^a-zA-Z0-9_]/.test(b))return n.error("Variable names must contain only alphanumeric characters or '_'.",x);const S=n.parse(e[x+1],x+1);if(!S)return null;l.push([b,S])}const d=n.parse(e[e.length-1],e.length-1,n.expectedType,l);return d?new Mi(l,d):null}outputDefined(){return this.result.outputDefined()}}class Mo{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const l=e[1];return n.scope.has(l)?new Mo(l,n.scope.get(l)):n.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Sr{constructor(e,n,l){this.type=e,this.index=n,this.input=l}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=n.parse(e[1],1,Me),d=n.parse(e[2],2,wr(n.expectedType||hi));return l&&d?new Sr(d.type.itemType,l,d):null}evaluate(e){const n=this.index.evaluate(e),l=this.input.evaluate(e);if(n<0)throw new ti(`Array index out of bounds: ${n} < 0.`);if(n>=l.length)throw new ti(`Array index out of bounds: ${n} > ${l.length-1}.`);if(n!==Math.floor(n))throw new ti(`Array index must be an integer, but found ${n} instead.`);return l[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class Wa{constructor(e,n){this.type=ai,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const l=n.parse(e[1],1,hi),d=n.parse(e[2],2,hi);return l&&d?bo(l.type,[ai,ci,Me,Js,hi])?new Wa(l,d):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Vi(l.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!l)return!1;if(!ns(n,["boolean","string","number","null"]))throw new ti(`Expected first argument to be of type boolean, string, number or null, but found ${Vi(Ye(n))} instead.`);if(!ns(l,["string","array"]))throw new ti(`Expected second argument to be of type array or string, but found ${Vi(Ye(l))} instead.`);return l.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class Vs{constructor(e,n,l){this.type=Me,this.needle=e,this.haystack=n,this.fromIndex=l}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=n.parse(e[1],1,hi),d=n.parse(e[2],2,hi);if(!l||!d)return null;if(!bo(l.type,[ai,ci,Me,Js,hi]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Vi(l.type)} instead`);if(e.length===4){const x=n.parse(e[3],3,Me);return x?new Vs(l,d,x):null}return new Vs(l,d)}evaluate(e){const n=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!ns(n,["boolean","string","number","null"]))throw new ti(`Expected first argument to be of type boolean, string, number or null, but found ${Vi(Ye(n))} instead.`);let d;if(this.fromIndex&&(d=this.fromIndex.evaluate(e)),ns(l,["string"])){const x=l.indexOf(n,d);return x===-1?-1:[...l.slice(0,x)].length}if(ns(l,["array"]))return l.indexOf(n,d);throw new ti(`Expected second argument to be of type array or string, but found ${Vi(Ye(l))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class pr{constructor(e,n,l,d,x,b){this.inputType=e,this.type=n,this.input=l,this.cases=d,this.outputs=x,this.otherwise=b}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let l,d;n.expectedType&&n.expectedType.kind!=="value"&&(d=n.expectedType);const x={},b=[];for(let k=2;k<e.length-1;k+=2){let N=e[k];const V=e[k+1];Array.isArray(N)||(N=[N]);const q=n.concat(k);if(N.length===0)return q.error("Expected at least one branch label.");for(const K of N){if(typeof K!="number"&&typeof K!="string")return q.error("Branch labels must be numbers or strings.");if(typeof K=="number"&&Math.abs(K)>Number.MAX_SAFE_INTEGER)return q.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof K=="number"&&Math.floor(K)!==K)return q.error("Numeric branch labels must be integer values.");if(l){if(q.checkSubtype(l,Ye(K)))return null}else l=Ye(K);if(x[String(K)]!==void 0)return q.error("Branch labels must be unique.");x[String(K)]=b.length}const W=n.parse(V,k,d);if(!W)return null;d=d||W.type,b.push(W)}const S=n.parse(e[1],1,hi);if(!S)return null;const E=n.parse(e[e.length-1],e.length-1,d);return E?S.type.kind!=="value"&&n.concat(1).checkSubtype(l,S.type)?null:new pr(l,d,S,x,b,E):null}evaluate(e){const n=this.input.evaluate(e);return(Ye(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class Po{constructor(e,n,l){this.type=e,this.branches=n,this.otherwise=l}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let l;n.expectedType&&n.expectedType.kind!=="value"&&(l=n.expectedType);const d=[];for(let b=1;b<e.length-1;b+=2){const S=n.parse(e[b],b,ai);if(!S)return null;const E=n.parse(e[b+1],b+1,l);if(!E)return null;d.push([S,E]),l=l||E.type}const x=n.parse(e[e.length-1],e.length-1,l);if(!x)return null;if(!l)throw new Error("Can't infer output type");return new Po(l,d,x)}evaluate(e){for(const[n,l]of this.branches)if(n.evaluate(e))return l.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,l]of this.branches)e(n),e(l);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}}class qo{constructor(e,n,l,d){this.type=e,this.input=n,this.beginIndex=l,this.endIndex=d}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const l=n.parse(e[1],1,hi),d=n.parse(e[2],2,Me);if(!l||!d)return null;if(!bo(l.type,[wr(hi),ci,hi]))return n.error(`Expected first argument to be of type array or string, but found ${Vi(l.type)} instead`);if(e.length===4){const x=n.parse(e[3],3,Me);return x?new qo(l.type,l,d,x):null}return new qo(l.type,l,d)}evaluate(e){const n=this.input.evaluate(e),l=this.beginIndex.evaluate(e);let d;if(this.endIndex&&(d=this.endIndex.evaluate(e)),ns(n,["string"]))return[...n].slice(l,d).join("");if(ns(n,["array"]))return n.slice(l,d);throw new ti(`Expected first argument to be of type array or string, but found ${Vi(Ye(n))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function Ao(r,e){const n=r.length-1;let l,d,x=0,b=n,S=0;for(;x<=b;)if(S=Math.floor((x+b)/2),l=r[S],d=r[S+1],l<=e){if(S===n||e<d)return S;x=S+1}else{if(!(l>e))throw new ti("Input is not a number.");b=S-1}return 0}class Bn{constructor(e,n,l){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[d,x]of l)this.labels.push(d),this.outputs.push(x)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const l=n.parse(e[1],1,Me);if(!l)return null;const d=[];let x=null;n.expectedType&&n.expectedType.kind!=="value"&&(x=n.expectedType);for(let b=1;b<e.length;b+=2){const S=b===1?-1/0:e[b],E=e[b+1],k=b,N=b+1;if(typeof S!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(d.length&&d[d.length-1][0]>=S)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const V=n.parse(E,N,x);if(!V)return null;x=x||V.type,d.push([S,V])}return new Bn(x,l,d)}evaluate(e){const n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(e);const d=this.input.evaluate(e);if(d<=n[0])return l[0].evaluate(e);const x=n.length;return d>=n[x-1]?l[x-1].evaluate(e):l[Ao(n,d)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Xu(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var $o,mu,ra=function(){if(mu)return $o;function r(e,n,l,d){this.cx=3*e,this.bx=3*(l-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(d-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=l,this.p2y=d}return mu=1,$o=r,r.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,n){if(n===void 0&&(n=1e-6),e<0)return 0;if(e>1)return 1;for(var l=e,d=0;d<8;d++){var x=this.sampleCurveX(l)-e;if(Math.abs(x)<n)return l;var b=this.sampleCurveDerivativeX(l);if(Math.abs(b)<1e-6)break;l-=x/b}var S=0,E=1;for(l=e,d=0;d<20&&(x=this.sampleCurveX(l),!(Math.abs(x-e)<n));d++)e>x?S=l:E=l,l=.5*(E-S)+S;return l},solve:function(e,n){return this.sampleCurveY(this.solveCurveX(e,n))}},$o}(),yl=Xu(ra);class mr{constructor(e,n,l,d,x){this.type=e,this.operator=n,this.interpolation=l,this.input=d,this.labels=[],this.outputs=[];for(const[b,S]of x)this.labels.push(b),this.outputs.push(S)}static interpolationFactor(e,n,l,d){let x=0;if(e.name==="exponential")x=Us(n,e.base,l,d);else if(e.name==="linear")x=Us(n,1,l,d);else if(e.name==="cubic-bezier"){const b=e.controlPoints;x=new yl(b[0],b[1],b[2],b[3]).solve(Us(n,1,l,d))}return x}static parse(e,n){let[l,d,x,...b]=e;if(!Array.isArray(d)||d.length===0)return n.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const k=d[1];if(typeof k!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:k}}else{if(d[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const k=d.slice(1);if(k.length!==4||k.some(N=>typeof N!="number"||N<0||N>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:k}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(x=n.parse(x,2,Me),!x)return null;const S=[];let E=null;l!=="interpolate-hcl"&&l!=="interpolate-lab"||n.expectedType==_a?n.expectedType&&n.expectedType.kind!=="value"&&(E=n.expectedType):E=an;for(let k=0;k<b.length;k+=2){const N=b[k],V=b[k+1],q=k+3,W=k+4;if(typeof N!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(S.length&&S[S.length-1][0]>=N)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',q);const K=n.parse(V,W,E);if(!K)return null;E=E||K.type,S.push([N,K])}return ta(E,Me)||ta(E,xs)||ta(E,an)||ta(E,ma)||ta(E,ga)||ta(E,_a)||ta(E,Rc)||ta(E,wr(Me))?new mr(E,l,d,x,S):n.error(`Type ${Vi(E)} is not interpolatable.`)}evaluate(e){const n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(e);const d=this.input.evaluate(e);if(d<=n[0])return l[0].evaluate(e);const x=n.length;if(d>=n[x-1])return l[x-1].evaluate(e);const b=Ao(n,d),S=mr.interpolationFactor(this.interpolation,d,n[b],n[b+1]),E=l[b].evaluate(e),k=l[b+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return ea(E,k,S);case"color":return di.interpolate(E,k,S);case"padding":return ar.interpolate(E,k,S);case"colorArray":return Ui.interpolate(E,k,S);case"numberArray":return Qe.interpolate(E,k,S);case"variableAnchorOffsetCollection":return or.interpolate(E,k,S);case"array":return va(E,k,S);case"projectionDefinition":return _n.interpolate(E,k,S)}case"interpolate-hcl":switch(this.type.kind){case"color":return di.interpolate(E,k,S,"hcl");case"colorArray":return Ui.interpolate(E,k,S,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return di.interpolate(E,k,S,"lab");case"colorArray":return Ui.interpolate(E,k,S,"lab")}}}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Us(r,e,n,l){const d=l-n,x=r-n;return d===0?0:e===1?x/d:(Math.pow(e,x)-1)/(Math.pow(e,d)-1)}const sa={color:di.interpolate,number:ea,padding:ar.interpolate,numberArray:Qe.interpolate,colorArray:Ui.interpolate,variableAnchorOffsetCollection:or.interpolate,array:va};class Co{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let l=null;const d=n.expectedType;d&&d.kind!=="value"&&(l=d);const x=[];for(const S of e.slice(1)){const E=n.parse(S,1+x.length,l,void 0,{typeAnnotation:"omit"});if(!E)return null;l=l||E.type,x.push(E)}if(!l)throw new Error("No output type");const b=d&&x.some(S=>qa(d,S.type));return new Co(b?hi:l,x)}evaluate(e){let n,l=null,d=0;for(const x of this.args)if(d++,l=x.evaluate(e),l&&l instanceof lr&&!l.available&&(n||(n=l.name),l=null,d===this.args.length&&(l=n)),l!==null)break;return l}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}function Xo(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function tc(r,e,n,l){return l.compare(e,n)===0}function Mr(r,e,n){const l=r!=="=="&&r!=="!=";return class p3{constructor(x,b,S){this.type=ai,this.lhs=x,this.rhs=b,this.collator=S,this.hasUntypedArgument=x.type.kind==="value"||b.type.kind==="value"}static parse(x,b){if(x.length!==3&&x.length!==4)return b.error("Expected two or three arguments.");const S=x[0];let E=b.parse(x[1],1,hi);if(!E)return null;if(!Xo(S,E.type))return b.concat(1).error(`"${S}" comparisons are not supported for type '${Vi(E.type)}'.`);let k=b.parse(x[2],2,hi);if(!k)return null;if(!Xo(S,k.type))return b.concat(2).error(`"${S}" comparisons are not supported for type '${Vi(k.type)}'.`);if(E.type.kind!==k.type.kind&&E.type.kind!=="value"&&k.type.kind!=="value")return b.error(`Cannot compare types '${Vi(E.type)}' and '${Vi(k.type)}'.`);l&&(E.type.kind==="value"&&k.type.kind!=="value"?E=new Ji(k.type,[E]):E.type.kind!=="value"&&k.type.kind==="value"&&(k=new Ji(E.type,[k])));let N=null;if(x.length===4){if(E.type.kind!=="string"&&k.type.kind!=="string"&&E.type.kind!=="value"&&k.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(N=b.parse(x[3],3,Jl),!N)return null}return new p3(E,k,N)}evaluate(x){const b=this.lhs.evaluate(x),S=this.rhs.evaluate(x);if(l&&this.hasUntypedArgument){const E=Ye(b),k=Ye(S);if(E.kind!==k.kind||E.kind!=="string"&&E.kind!=="number")throw new ti(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${E.kind}, ${k.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const E=Ye(b),k=Ye(S);if(E.kind!=="string"||k.kind!=="string")return e(x,b,S)}return this.collator?n(x,b,S,this.collator.evaluate(x)):e(x,b,S)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}}}const kc=Mr("==",function(r,e,n){return e===n},tc),Bc=Mr("!=",function(r,e,n){return e!==n},function(r,e,n,l){return!tc(0,e,n,l)}),Ih=Mr("<",function(r,e,n){return e<n},function(r,e,n,l){return l.compare(e,n)<0}),ec=Mr(">",function(r,e,n){return e>n},function(r,e,n,l){return l.compare(e,n)>0}),Rh=Mr("<=",function(r,e,n){return e<=n},function(r,e,n,l){return l.compare(e,n)<=0}),Yu=Mr(">=",function(r,e,n){return e>=n},function(r,e,n,l){return l.compare(e,n)>=0});class ic{constructor(e,n,l){this.type=Jl,this.locale=l,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const l=e[1];if(typeof l!="object"||Array.isArray(l))return n.error("Collator options argument must be an object.");const d=n.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,ai);if(!d)return null;const x=n.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,ai);if(!x)return null;let b=null;return l.locale&&(b=n.parse(l.locale,1,ci),!b)?null:new ic(d,x,b)}evaluate(e){return new ia(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class vl{constructor(e,n,l,d,x){this.type=ci,this.number=e,this.locale=n,this.currency=l,this.minFractionDigits=d,this.maxFractionDigits=x}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const l=n.parse(e[1],1,Me);if(!l)return null;const d=e[2];if(typeof d!="object"||Array.isArray(d))return n.error("NumberFormat options argument must be an object.");let x=null;if(d.locale&&(x=n.parse(d.locale,1,ci),!x))return null;let b=null;if(d.currency&&(b=n.parse(d.currency,1,ci),!b))return null;let S=null;if(d["min-fraction-digits"]&&(S=n.parse(d["min-fraction-digits"],1,Me),!S))return null;let E=null;return d["max-fraction-digits"]&&(E=n.parse(d["max-fraction-digits"],1,Me),!E)?null:new vl(l,x,b,S,E)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class ws{constructor(e){this.type=is,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const l=e[1];if(!Array.isArray(l)&&typeof l=="object")return n.error("First argument must be an image or text section.");const d=[];let x=!1;for(let b=1;b<=e.length-1;++b){const S=e[b];if(x&&typeof S=="object"&&!Array.isArray(S)){x=!1;let E=null;if(S["font-scale"]&&(E=n.parse(S["font-scale"],1,Me),!E))return null;let k=null;if(S["text-font"]&&(k=n.parse(S["text-font"],1,wr(ci)),!k))return null;let N=null;if(S["text-color"]&&(N=n.parse(S["text-color"],1,an),!N))return null;let V=null;if(S["vertical-align"]){if(typeof S["vertical-align"]=="string"&&!Xa.includes(S["vertical-align"]))return n.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${S["vertical-align"]}' instead.`);if(V=n.parse(S["vertical-align"],1,ci),!V)return null}const q=d[d.length-1];q.scale=E,q.font=k,q.textColor=N,q.verticalAlign=V}else{const E=n.parse(e[b],1,hi);if(!E)return null;const k=E.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,d.push({content:E,scale:null,font:null,textColor:null,verticalAlign:null})}}return new ws(d)}evaluate(e){return new kn(this.sections.map(n=>{const l=n.content.evaluate(e);return Ye(l)===Cn?new xa("",l,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(e):null):new xa(je(l),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null,n.verticalAlign?n.verticalAlign.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor),n.verticalAlign&&e(n.verticalAlign)}outputDefined(){return!1}}class _u{constructor(e){this.type=Cn,this.input=e}static parse(e,n){if(e.length!==2)return n.error("Expected two arguments.");const l=n.parse(e[1],1,ci);return l?new _u(l):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),l=lr.fromString(n);return l&&e.availableImages&&(l.available=e.availableImages.indexOf(n)>-1),l}eachChild(e){e(this.input)}outputDefined(){return!1}}class wa{constructor(e){this.type=Me,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const l=n.parse(e[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Vi(l.type)} instead.`):new wa(l):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new ti(`Expected value to be of type string or array, but found ${Vi(Ye(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const ln=8192;function Wu(r,e){const n=(180+r[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,d=Math.pow(2,e.z);return[Math.round(n*d*ln),Math.round(l*d*ln)]}function xl(r,e){const n=Math.pow(2,e.z);return[(d=(r[0]/ln+e.x)/n,360*d-180),(l=(r[1]/ln+e.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,d}function bl(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function Eo(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function Oc(r,e,n){const l=r[0]-e[0],d=r[1]-e[1],x=r[0]-n[0],b=r[1]-n[1];return l*b-x*d==0&&l*x<=0&&d*b<=0}function nc(r,e,n,l){return(d=[l[0]-n[0],l[1]-n[1]])[0]*(x=[e[0]-r[0],e[1]-r[1]])[1]-d[1]*x[0]!=0&&!(!gu(r,e,n,l)||!gu(n,l,r,e));var d,x}function wl(r,e,n){for(const l of n)for(let d=0;d<l.length-1;++d)if(nc(r,e,l[d],l[d+1]))return!0;return!1}function zo(r,e,n=!1){let l=!1;for(const S of e)for(let E=0;E<S.length-1;E++){if(Oc(r,S[E],S[E+1]))return n;(x=S[E])[1]>(d=r)[1]!=(b=S[E+1])[1]>d[1]&&d[0]<(b[0]-x[0])*(d[1]-x[1])/(b[1]-x[1])+x[0]&&(l=!l)}var d,x,b;return l}function Ku(r,e){for(const n of e)if(zo(r,n))return!0;return!1}function Ts(r,e){for(const n of r)if(!zo(n,e))return!1;for(let n=0;n<r.length-1;++n)if(wl(r[n],r[n+1],e))return!1;return!0}function Yo(r,e){for(const n of e)if(Ts(r,n))return!0;return!1}function gu(r,e,n,l){const d=l[0]-n[0],x=l[1]-n[1],b=(r[0]-n[0])*x-d*(r[1]-n[1]),S=(e[0]-n[0])*x-d*(e[1]-n[1]);return b>0&&S<0||b<0&&S>0}function Zr(r,e,n){const l=[];for(let d=0;d<r.length;d++){const x=[];for(let b=0;b<r[d].length;b++){const S=Wu(r[d][b],n);bl(e,S),x.push(S)}l.push(x)}return l}function Tl(r,e,n){const l=[];for(let d=0;d<r.length;d++){const x=Zr(r[d],e,n);l.push(x)}return l}function Ka(r,e,n,l){if(r[0]<n[0]||r[0]>n[2]){const d=.5*l;let x=r[0]-n[0]>d?-l:n[0]-r[0]>d?l:0;x===0&&(x=r[0]-n[2]>d?-l:n[2]-r[0]>d?l:0),r[0]+=x}bl(e,r)}function rc(r,e,n,l){const d=Math.pow(2,l.z)*ln,x=[l.x*ln,l.y*ln],b=[];for(const S of r)for(const E of S){const k=[E.x+x[0],E.y+x[1]];Ka(k,e,n,d),b.push(k)}return b}function Wo(r,e,n,l){const d=Math.pow(2,l.z)*ln,x=[l.x*ln,l.y*ln],b=[];for(const E of r){const k=[];for(const N of E){const V=[N.x+x[0],N.y+x[1]];bl(e,V),k.push(V)}b.push(k)}if(e[2]-e[0]<=d/2){(S=e)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const E of b)for(const k of E)Ka(k,e,n,d)}var S;return b}class Qa{constructor(e,n){this.type=ai,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Fs(e[1])){const l=e[1];if(l.type==="FeatureCollection"){const d=[];for(const x of l.features){const{type:b,coordinates:S}=x.geometry;b==="Polygon"&&d.push(S),b==="MultiPolygon"&&d.push(...S)}if(d.length)return new Qa(l,{type:"MultiPolygon",coordinates:d})}else if(l.type==="Feature"){const d=l.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Qa(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Qa(l,l)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,l){const d=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],b=n.canonicalID();if(l.type==="Polygon"){const S=Zr(l.coordinates,x,b),E=rc(n.geometry(),d,x,b);if(!Eo(d,x))return!1;for(const k of E)if(!zo(k,S))return!1}if(l.type==="MultiPolygon"){const S=Tl(l.coordinates,x,b),E=rc(n.geometry(),d,x,b);if(!Eo(d,x))return!1;for(const k of E)if(!Ku(k,S))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,l){const d=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],b=n.canonicalID();if(l.type==="Polygon"){const S=Zr(l.coordinates,x,b),E=Wo(n.geometry(),d,x,b);if(!Eo(d,x))return!1;for(const k of E)if(!Ts(k,S))return!1}if(l.type==="MultiPolygon"){const S=Tl(l.coordinates,x,b),E=Wo(n.geometry(),d,x,b);if(!Eo(d,x))return!1;for(const k of E)if(!Yo(k,S))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Do=class{constructor(r=[],e=(n,l)=>n<l?-1:n>l?1:0){if(this.data=r,this.length=this.data.length,this.compare=e,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:e,compare:n}=this,l=e[r];for(;r>0;){const d=r-1>>1,x=e[d];if(n(l,x)>=0)break;e[r]=x,r=d}e[r]=l}_down(r){const{data:e,compare:n}=this,l=this.length>>1,d=e[r];for(;r<l;){let x=1+(r<<1);const b=x+1;if(b<this.length&&n(e[b],e[x])<0&&(x=b),n(e[x],d)>=0)break;e[r]=e[x],r=x}e[r]=d}};function sc(r,e,n=0,l=r.length-1,d=ac){for(;l>n;){if(l-n>600){const E=l-n+1,k=e-n+1,N=Math.log(E),V=.5*Math.exp(2*N/3),q=.5*Math.sqrt(N*V*(E-V)/E)*(k-E/2<0?-1:1);sc(r,e,Math.max(n,Math.floor(e-k*V/E+q)),Math.min(l,Math.floor(e+(E-k)*V/E+q)),d)}const x=r[e];let b=n,S=l;for(Ss(r,n,e),d(r[l],x)>0&&Ss(r,n,l);b<S;){for(Ss(r,b,S),b++,S--;d(r[b],x)<0;)b++;for(;d(r[S],x)>0;)S--}d(r[n],x)===0?Ss(r,n,S):(S++,Ss(r,S,l)),S<=e&&(n=S+1),e<=S&&(l=S-1)}}function Ss(r,e,n){const l=r[e];r[e]=r[n],r[n]=l}function ac(r,e){return r<e?-1:r>e?1:0}function Sl(r,e){if(r.length<=1)return[r];const n=[];let l,d;for(const x of r){const b=kh(x);b!==0&&(x.area=Math.abs(b),d===void 0&&(d=b<0),d===b<0?(l&&n.push(l),l=[x]):l.push(x))}if(l&&n.push(l),e>1)for(let x=0;x<n.length;x++)n[x].length<=e||(sc(n[x],e,1,n[x].length-1,Nc),n[x]=n[x].slice(0,e));return n}function Nc(r,e){return e.area-r.area}function kh(r){let e=0;for(let n,l,d=0,x=r.length,b=x-1;d<x;b=d++)n=r[d],l=r[b],e+=(l.x-n.x)*(n.y+l.y);return e}const Ta=1/298.257223563,Qu=Ta*(2-Ta),Lo=Math.PI/180;class Gr{constructor(e){const n=6378.137*Lo*1e3,l=Math.cos(e*Lo),d=1/(1-Qu*(1-l*l)),x=Math.sqrt(d);this.kx=n*x*l,this.ky=n*x*d*(1-Qu)}distance(e,n){const l=this.wrap(e[0]-n[0])*this.kx,d=(e[1]-n[1])*this.ky;return Math.sqrt(l*l+d*d)}pointOnLine(e,n){let l,d,x,b,S=1/0;for(let E=0;E<e.length-1;E++){let k=e[E][0],N=e[E][1],V=this.wrap(e[E+1][0]-k)*this.kx,q=(e[E+1][1]-N)*this.ky,W=0;V===0&&q===0||(W=(this.wrap(n[0]-k)*this.kx*V+(n[1]-N)*this.ky*q)/(V*V+q*q),W>1?(k=e[E+1][0],N=e[E+1][1]):W>0&&(k+=V/this.kx*W,N+=q/this.ky*W)),V=this.wrap(n[0]-k)*this.kx,q=(n[1]-N)*this.ky;const K=V*V+q*q;K<S&&(S=K,l=k,d=N,x=E,b=W)}return{point:[l,d],index:x,t:Math.max(0,Math.min(1,b))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function os(r,e){return e[0]-r[0]}function Io(r){return r[1]-r[0]+1}function aa(r,e){return r[1]>=r[0]&&r[1]<e}function Li(r,e){if(r[0]>r[1])return[null,null];const n=Io(r);if(e){if(n===2)return[r,null];const d=Math.floor(n/2);return[[r[0],r[0]+d],[r[0]+d,r[1]]]}if(n===1)return[r,null];const l=Math.floor(n/2)-1;return[[r[0],r[0]+l],[r[0]+l+1,r[1]]]}function Ko(r,e){if(!aa(e,r.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let l=e[0];l<=e[1];++l)bl(n,r[l]);return n}function Qo(r){const e=[1/0,1/0,-1/0,-1/0];for(const n of r)for(const l of n)bl(e,l);return e}function oc(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function Ms(r,e,n){if(!oc(r)||!oc(e))return NaN;let l=0,d=0;return r[2]<e[0]&&(l=e[0]-r[2]),r[0]>e[2]&&(l=r[0]-e[2]),r[1]>e[3]&&(d=r[1]-e[3]),r[3]<e[1]&&(d=e[1]-r[3]),n.distance([0,0],[l,d])}function Zs(r,e,n){const l=n.pointOnLine(e,r);return n.distance(r,l.point)}function Ja(r,e,n,l,d){const x=Math.min(Zs(r,[n,l],d),Zs(e,[n,l],d)),b=Math.min(Zs(n,[r,e],d),Zs(l,[r,e],d));return Math.min(x,b)}function jc(r,e,n,l,d){if(!aa(e,r.length)||!aa(l,n.length))return 1/0;let x=1/0;for(let b=e[0];b<e[1];++b){const S=r[b],E=r[b+1];for(let k=l[0];k<l[1];++k){const N=n[k],V=n[k+1];if(nc(S,E,N,V))return 0;x=Math.min(x,Ja(S,E,N,V,d))}}return x}function Ju(r,e,n,l,d){if(!aa(e,r.length)||!aa(l,n.length))return NaN;let x=1/0;for(let b=e[0];b<=e[1];++b)for(let S=l[0];S<=l[1];++S)if(x=Math.min(x,d.distance(r[b],n[S])),x===0)return x;return x}function Sa(r,e,n){if(zo(r,e,!0))return 0;let l=1/0;for(const d of e){const x=d[0],b=d[d.length-1];if(x!==b&&(l=Math.min(l,Zs(r,[b,x],n)),l===0))return l;const S=n.pointOnLine(d,r);if(l=Math.min(l,n.distance(r,S.point)),l===0)return l}return l}function Ml(r,e,n,l){if(!aa(e,r.length))return NaN;for(let x=e[0];x<=e[1];++x)if(zo(r[x],n,!0))return 0;let d=1/0;for(let x=e[0];x<e[1];++x){const b=r[x],S=r[x+1];for(const E of n)for(let k=0,N=E.length,V=N-1;k<N;V=k++){const q=E[V],W=E[k];if(nc(b,S,q,W))return 0;d=Math.min(d,Ja(b,S,q,W,l))}}return d}function lc(r,e){for(const n of r)for(const l of n)if(zo(l,e,!0))return!0;return!1}function th(r,e,n,l=1/0){const d=Qo(r),x=Qo(e);if(l!==1/0&&Ms(d,x,n)>=l)return l;if(Eo(d,x)){if(lc(r,e))return 0}else if(lc(e,r))return 0;let b=1/0;for(const S of r)for(let E=0,k=S.length,N=k-1;E<k;N=E++){const V=S[N],q=S[E];for(const W of e)for(let K=0,et=W.length,at=et-1;K<et;at=K++){const ft=W[at],Dt=W[K];if(nc(V,q,ft,Dt))return 0;b=Math.min(b,Ja(V,q,ft,Dt,n))}}return b}function to(r,e,n,l,d,x){if(!x)return;const b=Ms(Ko(l,x),d,n);b<e&&r.push([b,x,[0,0]])}function cc(r,e,n,l,d,x,b){if(!x||!b)return;const S=Ms(Ko(l,x),Ko(d,b),n);S<e&&r.push([S,x,b])}function ls(r,e,n,l,d=1/0){let x=Math.min(l.distance(r[0],n[0][0]),d);if(x===0)return x;const b=new Do([[0,[0,r.length-1],[0,0]]],os),S=Qo(n);for(;b.length>0;){const E=b.pop();if(E[0]>=x)continue;const k=E[1],N=e?50:100;if(Io(k)<=N){if(!aa(k,r.length))return NaN;if(e){const V=Ml(r,k,n,l);if(isNaN(V)||V===0)return V;x=Math.min(x,V)}else for(let V=k[0];V<=k[1];++V){const q=Sa(r[V],n,l);if(x=Math.min(x,q),x===0)return 0}}else{const V=Li(k,e);to(b,x,l,r,S,V[0]),to(b,x,l,r,S,V[1])}}return x}function Ro(r,e,n,l,d,x=1/0){let b=Math.min(x,d.distance(r[0],n[0]));if(b===0)return b;const S=new Do([[0,[0,r.length-1],[0,n.length-1]]],os);for(;S.length>0;){const E=S.pop();if(E[0]>=b)continue;const k=E[1],N=E[2],V=e?50:100,q=l?50:100;if(Io(k)<=V&&Io(N)<=q){if(!aa(k,r.length)&&aa(N,n.length))return NaN;let W;if(e&&l)W=jc(r,k,n,N,d),b=Math.min(b,W);else if(e&&!l){const K=r.slice(k[0],k[1]+1);for(let et=N[0];et<=N[1];++et)if(W=Zs(n[et],K,d),b=Math.min(b,W),b===0)return b}else if(!e&&l){const K=n.slice(N[0],N[1]+1);for(let et=k[0];et<=k[1];++et)if(W=Zs(r[et],K,d),b=Math.min(b,W),b===0)return b}else W=Ju(r,k,n,N,d),b=Math.min(b,W)}else{const W=Li(k,e),K=Li(N,l);cc(S,b,d,r,n,W[0],K[0]),cc(S,b,d,r,n,W[0],K[1]),cc(S,b,d,r,n,W[1],K[0]),cc(S,b,d,r,n,W[1],K[1])}}return b}function yu(r){return r.type==="MultiPolygon"?r.coordinates.map(e=>({type:"Polygon",coordinates:e})):r.type==="MultiLineString"?r.coordinates.map(e=>({type:"LineString",coordinates:e})):r.type==="MultiPoint"?r.coordinates.map(e=>({type:"Point",coordinates:e})):[r]}class Ma{constructor(e,n){this.type=Me,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Fs(e[1])){const l=e[1];if(l.type==="FeatureCollection")return new Ma(l,l.features.map(d=>yu(d.geometry)).flat());if(l.type==="Feature")return new Ma(l,yu(l.geometry));if("type"in l&&"coordinates"in l)return new Ma(l,yu(l))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,l){const d=n.geometry(),x=d.flat().map(E=>xl([E.x,E.y],n.canonical));if(d.length===0)return NaN;const b=new Gr(x[0][1]);let S=1/0;for(const E of l){switch(E.type){case"Point":S=Math.min(S,Ro(x,!1,[E.coordinates],!1,b,S));break;case"LineString":S=Math.min(S,Ro(x,!1,E.coordinates,!0,b,S));break;case"Polygon":S=Math.min(S,ls(x,!1,E.coordinates,b,S))}if(S===0)return S}return S}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,l){const d=n.geometry(),x=d.flat().map(E=>xl([E.x,E.y],n.canonical));if(d.length===0)return NaN;const b=new Gr(x[0][1]);let S=1/0;for(const E of l){switch(E.type){case"Point":S=Math.min(S,Ro(x,!0,[E.coordinates],!1,b,S));break;case"LineString":S=Math.min(S,Ro(x,!0,E.coordinates,!0,b,S));break;case"Polygon":S=Math.min(S,ls(x,!0,E.coordinates,b,S))}if(S===0)return S}return S}(e,this.geometries);if(e.geometryType()==="Polygon")return function(n,l){const d=n.geometry();if(d.length===0||d[0].length===0)return NaN;const x=Sl(d,0).map(E=>E.map(k=>k.map(N=>xl([N.x,N.y],n.canonical)))),b=new Gr(x[0][0][0][1]);let S=1/0;for(const E of l)for(const k of x){switch(E.type){case"Point":S=Math.min(S,ls([E.coordinates],!1,k,b,S));break;case"LineString":S=Math.min(S,ls(E.coordinates,!0,k,b,S));break;case"Polygon":S=Math.min(S,th(k,E.coordinates,b,S))}if(S===0)return S}return S}(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class uc{constructor(e){this.type=hi,this.key=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const l=e[1];return l==null?n.error("Global state property must be defined."):typeof l!="string"?n.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new uc(l)}evaluate(e){var n;const l=(n=e.globals)===null||n===void 0?void 0:n.globalState;return l&&Object.keys(l).length!==0?bs(l,this.key):null}eachChild(){}outputDefined(){return!1}}const ko={"==":kc,"!=":Bc,">":ec,"<":Ih,">=":Yu,"<=":Rh,array:Ji,at:Sr,boolean:Ji,case:Po,coalesce:Co,collator:ic,format:ws,image:_u,in:Wa,"index-of":Vs,interpolate:mr,"interpolate-hcl":mr,"interpolate-lab":mr,length:wa,let:Mi,literal:fr,match:pr,number:Ji,"number-format":vl,object:Ji,slice:qo,step:Bn,string:Ji,"to-boolean":as,"to-color":as,"to-number":as,"to-string":as,var:Mo,within:Qa,distance:Ma,"global-state":uc};class Ps{constructor(e,n,l,d){this.name=e,this.type=n,this._evaluate=l,this.args=d}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,n){const l=e[0],d=Ps.definitions[l];if(!d)return n.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(d)?d[0]:d.type,b=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,S=b.filter(([k])=>!Array.isArray(k)||k.length===e.length-1);let E=null;for(const[k,N]of S){E=new Ya(n.registry,Br,n.path,null,n.scope);const V=[];let q=!1;for(let W=1;W<e.length;W++){const K=e[W],et=Array.isArray(k)?k[W-1]:k.type,at=E.parse(K,1+V.length,et);if(!at){q=!0;break}V.push(at)}if(!q)if(Array.isArray(k)&&k.length!==V.length)E.error(`Expected ${k.length} arguments, but found ${V.length} instead.`);else{for(let W=0;W<V.length;W++){const K=Array.isArray(k)?k[W]:k.type,et=V[W];E.concat(W+1).checkSubtype(K,et.type)}if(E.errors.length===0)return new Ps(l,x,N,V)}}if(S.length===1)n.errors.push(...E.errors);else{const k=(S.length?S:b).map(([V])=>{return q=V,Array.isArray(q)?`(${q.map(Vi).join(", ")})`:`(${Vi(q.type)}...)`;var q}).join(" | "),N=[];for(let V=1;V<e.length;V++){const q=n.parse(e[V],1+N.length);if(!q)return null;N.push(Vi(q.type))}n.error(`Expected arguments of type ${k}, but found (${N.join(", ")}) instead.`)}return null}static register(e,n){Ps.definitions=n;for(const l in n)e[l]=Ps}}function Bo(r,[e,n,l,d]){e=e.evaluate(r),n=n.evaluate(r),l=l.evaluate(r);const x=d?d.evaluate(r):1,b=Ri(e,n,l,x);if(b)throw new ti(b);return new di(e/255,n/255,l/255,x,!1)}function Gs(r,e){return r in e}function eo(r,e){const n=e[r];return n===void 0?null:n}function cr(r){return{type:r}}function Br(r){if(r instanceof Mo)return Br(r.boundExpression);if(r instanceof Ps&&r.name==="error"||r instanceof ic||r instanceof Qa||r instanceof Ma||r instanceof uc)return!1;const e=r instanceof as||r instanceof Ji;let n=!0;return r.eachChild(l=>{n=e?n&&Br(l):n&&l instanceof fr}),!!n&&io(r)&&Oo(r,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function io(r){if(r instanceof Ps&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof Qa||r instanceof Ma)return!1;let e=!0;return r.eachChild(n=>{e&&!io(n)&&(e=!1)}),e}function Hr(r){if(r instanceof Ps&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(n=>{e&&!Hr(n)&&(e=!1)}),e}function Oo(r,e){if(r instanceof Ps&&e.indexOf(r.name)>=0)return!1;let n=!0;return r.eachChild(l=>{n&&!Oo(l,e)&&(n=!1)}),n}function Pl(r){return{result:"success",value:r}}function Hs(r){return{result:"error",value:r}}function As(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function Al(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function Pa(r){return!!r.expression&&r.expression.interpolated}function fi(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function Cl(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)&&Ye(r)===pn}function Cs(r){return r}function hc(r,e){const n=r.stops&&typeof r.stops[0][0]=="object",l=n||!(n||r.property!==void 0),d=r.type||(Pa(e)?"exponential":"interval"),x=function(N){switch(N.type){case"color":return di.parse;case"padding":return ar.parse;case"numberArray":return Qe.parse;case"colorArray":return Ui.parse;default:return null}}(e);if(x&&((r=Ie({},r)).stops&&(r.stops=r.stops.map(N=>[N[0],x(N[1])])),r.default=x(r.default?r.default:e.default)),r.colorSpace&&(b=r.colorSpace)!=="rgb"&&b!=="hcl"&&b!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var b;const S=function(N){switch(N){case"exponential":return no;case"interval":return dc;case"categorical":return Fc;case"identity":return vu;default:throw new Error(`Unknown function type "${N}"`)}}(d);let E,k;if(d==="categorical"){E=Object.create(null);for(const N of r.stops)E[N[0]]=N[1];k=typeof r.stops[0][0]}if(n){const N={},V=[];for(let K=0;K<r.stops.length;K++){const et=r.stops[K],at=et[0].zoom;N[at]===void 0&&(N[at]={zoom:at,type:r.type,property:r.property,default:r.default,stops:[]},V.push(at)),N[at].stops.push([et[0].value,et[1]])}const q=[];for(const K of V)q.push([N[K].zoom,hc(N[K],e)]);const W={name:"linear"};return{kind:"composite",interpolationType:W,interpolationFactor:mr.interpolationFactor.bind(void 0,W),zoomStops:q.map(K=>K[0]),evaluate:({zoom:K},et)=>no({stops:q,base:r.base},e,K).evaluate(K,et)}}if(l){const N=d==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:N,interpolationFactor:mr.interpolationFactor.bind(void 0,N),zoomStops:r.stops.map(V=>V[0]),evaluate:({zoom:V})=>S(r,e,V,E,k)}}return{kind:"source",evaluate(N,V){const q=V&&V.properties?V.properties[r.property]:void 0;return q===void 0?Pr(r.default,e.default):S(r,e,q,E,k)}}}function Pr(r,e,n){return r!==void 0?r:e!==void 0?e:n!==void 0?n:void 0}function Fc(r,e,n,l,d){return Pr(typeof n===d?l[n]:void 0,r.default,e.default)}function dc(r,e,n){if(fi(n)!=="number")return Pr(r.default,e.default);const l=r.stops.length;if(l===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[l-1][0])return r.stops[l-1][1];const d=Ao(r.stops.map(x=>x[0]),n);return r.stops[d][1]}function no(r,e,n){const l=r.base!==void 0?r.base:1;if(fi(n)!=="number")return Pr(r.default,e.default);const d=r.stops.length;if(d===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[d-1][0])return r.stops[d-1][1];const x=Ao(r.stops.map(N=>N[0]),n),b=function(N,V,q,W){const K=W-q,et=N-q;return K===0?0:V===1?et/K:(Math.pow(V,et)-1)/(Math.pow(V,K)-1)}(n,l,r.stops[x][0],r.stops[x+1][0]),S=r.stops[x][1],E=r.stops[x+1][1],k=sa[e.type]||Cs;return typeof S.evaluate=="function"?{evaluate(...N){const V=S.evaluate.apply(void 0,N),q=E.evaluate.apply(void 0,N);if(V!==void 0&&q!==void 0)return k(V,q,b,r.colorSpace)}}:k(S,E,b,r.colorSpace)}function vu(r,e,n){switch(e.type){case"color":n=di.parse(n);break;case"formatted":n=kn.fromString(n.toString());break;case"resolvedImage":n=lr.fromString(n.toString());break;case"padding":n=ar.parse(n);break;case"colorArray":n=Ui.parse(n);break;case"numberArray":n=Qe.parse(n);break;default:fi(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0)}return Pr(n,r.default,e.default)}Ps.register(ko,{error:[{kind:"error"},[ci],(r,[e])=>{throw new ti(e.evaluate(r))}],typeof:[ci,[hi],(r,[e])=>Vi(Ye(e.evaluate(r)))],"to-rgba":[wr(Me,4),[an],(r,[e])=>{const[n,l,d,x]=e.evaluate(r).rgb;return[255*n,255*l,255*d,x]}],rgb:[an,[Me,Me,Me],Bo],rgba:[an,[Me,Me,Me,Me],Bo],has:{type:ai,overloads:[[[ci],(r,[e])=>Gs(e.evaluate(r),r.properties())],[[ci,pn],(r,[e,n])=>Gs(e.evaluate(r),n.evaluate(r))]]},get:{type:hi,overloads:[[[ci],(r,[e])=>eo(e.evaluate(r),r.properties())],[[ci,pn],(r,[e,n])=>eo(e.evaluate(r),n.evaluate(r))]]},"feature-state":[hi,[ci],(r,[e])=>eo(e.evaluate(r),r.featureState||{})],properties:[pn,[],r=>r.properties()],"geometry-type":[ci,[],r=>r.geometryType()],id:[hi,[],r=>r.id()],zoom:[Me,[],r=>r.globals.zoom],"heatmap-density":[Me,[],r=>r.globals.heatmapDensity||0],elevation:[Me,[],r=>r.globals.elevation||0],"line-progress":[Me,[],r=>r.globals.lineProgress||0],accumulated:[hi,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Me,cr(Me),(r,e)=>{let n=0;for(const l of e)n+=l.evaluate(r);return n}],"*":[Me,cr(Me),(r,e)=>{let n=1;for(const l of e)n*=l.evaluate(r);return n}],"-":{type:Me,overloads:[[[Me,Me],(r,[e,n])=>e.evaluate(r)-n.evaluate(r)],[[Me],(r,[e])=>-e.evaluate(r)]]},"/":[Me,[Me,Me],(r,[e,n])=>e.evaluate(r)/n.evaluate(r)],"%":[Me,[Me,Me],(r,[e,n])=>e.evaluate(r)%n.evaluate(r)],ln2:[Me,[],()=>Math.LN2],pi:[Me,[],()=>Math.PI],e:[Me,[],()=>Math.E],"^":[Me,[Me,Me],(r,[e,n])=>Math.pow(e.evaluate(r),n.evaluate(r))],sqrt:[Me,[Me],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[Me,[Me],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[Me,[Me],(r,[e])=>Math.log(e.evaluate(r))],log2:[Me,[Me],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[Me,[Me],(r,[e])=>Math.sin(e.evaluate(r))],cos:[Me,[Me],(r,[e])=>Math.cos(e.evaluate(r))],tan:[Me,[Me],(r,[e])=>Math.tan(e.evaluate(r))],asin:[Me,[Me],(r,[e])=>Math.asin(e.evaluate(r))],acos:[Me,[Me],(r,[e])=>Math.acos(e.evaluate(r))],atan:[Me,[Me],(r,[e])=>Math.atan(e.evaluate(r))],min:[Me,cr(Me),(r,e)=>Math.min(...e.map(n=>n.evaluate(r)))],max:[Me,cr(Me),(r,e)=>Math.max(...e.map(n=>n.evaluate(r)))],abs:[Me,[Me],(r,[e])=>Math.abs(e.evaluate(r))],round:[Me,[Me],(r,[e])=>{const n=e.evaluate(r);return n<0?-Math.round(-n):Math.round(n)}],floor:[Me,[Me],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[Me,[Me],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[ai,[ci,hi],(r,[e,n])=>r.properties()[e.value]===n.value],"filter-id-==":[ai,[hi],(r,[e])=>r.id()===e.value],"filter-type-==":[ai,[ci],(r,[e])=>r.geometryType()===e.value],"filter-<":[ai,[ci,hi],(r,[e,n])=>{const l=r.properties()[e.value],d=n.value;return typeof l==typeof d&&l<d}],"filter-id-<":[ai,[hi],(r,[e])=>{const n=r.id(),l=e.value;return typeof n==typeof l&&n<l}],"filter->":[ai,[ci,hi],(r,[e,n])=>{const l=r.properties()[e.value],d=n.value;return typeof l==typeof d&&l>d}],"filter-id->":[ai,[hi],(r,[e])=>{const n=r.id(),l=e.value;return typeof n==typeof l&&n>l}],"filter-<=":[ai,[ci,hi],(r,[e,n])=>{const l=r.properties()[e.value],d=n.value;return typeof l==typeof d&&l<=d}],"filter-id-<=":[ai,[hi],(r,[e])=>{const n=r.id(),l=e.value;return typeof n==typeof l&&n<=l}],"filter->=":[ai,[ci,hi],(r,[e,n])=>{const l=r.properties()[e.value],d=n.value;return typeof l==typeof d&&l>=d}],"filter-id->=":[ai,[hi],(r,[e])=>{const n=r.id(),l=e.value;return typeof n==typeof l&&n>=l}],"filter-has":[ai,[hi],(r,[e])=>e.value in r.properties()],"filter-has-id":[ai,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[ai,[wr(ci)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[ai,[wr(hi)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[ai,[ci,wr(hi)],(r,[e,n])=>n.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[ai,[ci,wr(hi)],(r,[e,n])=>function(l,d,x,b){for(;x<=b;){const S=x+b>>1;if(d[S]===l)return!0;d[S]>l?b=S-1:x=S+1}return!1}(r.properties()[e.value],n.value,0,n.value.length-1)],all:{type:ai,overloads:[[[ai,ai],(r,[e,n])=>e.evaluate(r)&&n.evaluate(r)],[cr(ai),(r,e)=>{for(const n of e)if(!n.evaluate(r))return!1;return!0}]]},any:{type:ai,overloads:[[[ai,ai],(r,[e,n])=>e.evaluate(r)||n.evaluate(r)],[cr(ai),(r,e)=>{for(const n of e)if(n.evaluate(r))return!0;return!1}]]},"!":[ai,[ai],(r,[e])=>!e.evaluate(r)],"is-supported-script":[ai,[ci],(r,[e])=>{const n=r.globals&&r.globals.isSupportedScript;return!n||n(e.evaluate(r))}],upcase:[ci,[ci],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[ci,[ci],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[ci,cr(hi),(r,e)=>e.map(n=>je(n.evaluate(r))).join("")],"resolved-locale":[ci,[Jl],(r,[e])=>e.evaluate(r).resolvedLocale()]});class El{constructor(e,n){this.expression=e,this._warningHistory={},this._evaluator=new pu,this._defaultValue=n?function(l){if(l.type==="color"&&Cl(l.default))return new di(0,0,0,0);switch(l.type){case"color":return di.parse(l.default)||null;case"padding":return ar.parse(l.default)||null;case"numberArray":return Qe.parse(l.default)||null;case"colorArray":return Ui.parse(l.default)||null;case"variableAnchorOffsetCollection":return or.parse(l.default)||null;case"projectionDefinition":return _n.parse(l.default)||null;default:return l.default===void 0?null:l.default}}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(e,n,l,d,x,b){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=l,this._evaluator.canonical=d,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)}evaluate(e,n,l,d,x,b){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=l||null,this._evaluator.canonical=d,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=b||null;try{const S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new ti(`Expected value to be one of ${Object.keys(this._enumValues).map(E=>JSON.stringify(E)).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}}}function Aa(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in ko}function Ca(r,e){const n=new Ya(ko,Br,[],e?function(d){const x={color:an,string:ci,number:Me,enum:ci,boolean:ai,formatted:is,padding:ma,numberArray:ga,colorArray:_a,projectionDefinition:xs,resolvedImage:Cn,variableAnchorOffsetCollection:Rc};return d.type==="array"?wr(x[d.value]||hi,d.length):x[d.type]}(e):void 0),l=n.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Pl(new El(l,e)):Hs(n.errors)}class o{constructor(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!Hr(n.expression),this.globalStateRefs=nt(n.expression)}evaluateWithoutErrorHandling(e,n,l,d,x,b){return this._styleExpression.evaluateWithoutErrorHandling(e,n,l,d,x,b)}evaluate(e,n,l,d,x,b){return this._styleExpression.evaluate(e,n,l,d,x,b)}}class _{constructor(e,n,l,d){this.kind=e,this.zoomStops=l,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!Hr(n.expression),this.globalStateRefs=nt(n.expression),this.interpolationType=d}evaluateWithoutErrorHandling(e,n,l,d,x,b){return this._styleExpression.evaluateWithoutErrorHandling(e,n,l,d,x,b)}evaluate(e,n,l,d,x,b){return this._styleExpression.evaluate(e,n,l,d,x,b)}interpolationFactor(e,n,l){return this.interpolationType?mr.interpolationFactor(this.interpolationType,e,n,l):0}}function A(r,e){const n=Ca(r,e);if(n.result==="error")return n;const l=n.value.expression,d=io(l);if(!d&&!As(e))return Hs([new vn("","data expressions not supported")]);const x=Oo(l,["zoom"]);if(!x&&!Al(e))return Hs([new vn("","zoom expressions not supported")]);const b=G(l);return b||x?b instanceof vn?Hs([b]):b instanceof mr&&!Pa(e)?Hs([new vn("",'"interpolate" expressions cannot be used with this property')]):Pl(b?new _(d?"camera":"composite",n.value,b.labels,b instanceof mr?b.interpolation:void 0):new o(d?"constant":"source",n.value)):Hs([new vn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class B{constructor(e,n){this._parameters=e,this._specification=n,Ie(this,hc(this._parameters,this._specification))}static deserialize(e){return new B(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function G(r){let e=null;if(r instanceof Mi)e=G(r.result);else if(r instanceof Co){for(const n of r.args)if(e=G(n),e)break}else(r instanceof Bn||r instanceof mr)&&r.input instanceof Ps&&r.input.name==="zoom"&&(e=r);return e instanceof vn||r.eachChild(n=>{const l=G(n);l instanceof vn?e=l:!e&&l?e=new vn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&l&&e!==l&&(e=new vn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function nt(r,e=new Set){return r instanceof uc&&e.add(r.key),r.eachChild(n=>{nt(n,e)}),e}function wt(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!wt(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const Bt={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function qt(r){if(r==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};wt(r)||(r=ke(r));const e=Ca(r,Bt);if(e.result==="error")throw new Error(e.value.map(n=>`${n.key}: ${n.message}`).join(", "));return{filter:(n,l,d)=>e.value.evaluate(n,l,{},d),needGeometry:De(r),getGlobalStateRefs:()=>nt(e.value.expression)}}function he(r,e){return r<e?-1:r>e?1:0}function De(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let e=1;e<r.length;e++)if(De(r[e]))return!0;return!1}function ke(r){if(!r)return!0;const e=r[0];return r.length<=1?e!=="any":e==="=="?$e(r[1],r[2],"=="):e==="!="?xn($e(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?$e(r[1],r[2],e):e==="any"?(n=r.slice(1),["any"].concat(n.map(ke))):e==="all"?["all"].concat(r.slice(1).map(ke)):e==="none"?["all"].concat(r.slice(1).map(ke).map(xn)):e==="in"?pi(r[1],r.slice(2)):e==="!in"?xn(pi(r[1],r.slice(2))):e==="has"?gn(r[1]):e!=="!has"||xn(gn(r[1]));var n}function $e(r,e,n){switch(r){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,r,e]}}function pi(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",r,["literal",e.sort(he)]]:["filter-in-small",r,["literal",e]]}}function gn(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function xn(r){return["!",r]}function _r(r){const e=typeof r;if(e==="number"||e==="boolean"||e==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let d="[";for(const x of r)d+=`${_r(x)},`;return`${d}]`}const n=Object.keys(r).sort();let l="{";for(let d=0;d<n.length;d++)l+=`${JSON.stringify(n[d])}:${_r(r[n[d]])},`;return`${l}}`}function qs(r){let e="";for(const n of ri)e+=`/${_r(r[n])}`;return e}function Vc(r){const e=r.value;return e?[new ue(r.key,e,"constants have been deprecated as of v8")]:[]}function bn(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function cs(r){if(Array.isArray(r))return r.map(cs);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const n in r)e[n]=cs(r[n]);return e}return bn(r)}function Ar(r){const e=r.key,n=r.value,l=r.valueSpec||{},d=r.objectElementValidators||{},x=r.style,b=r.styleSpec,S=r.validateSpec;let E=[];const k=fi(n);if(k!=="object")return[new ue(e,n,`object expected, ${k} found`)];for(const N in n){const V=N.split(".")[0],q=bs(l,V)||l["*"];let W;if(bs(d,V))W=d[V];else if(bs(l,V))W=S;else if(d["*"])W=d["*"];else{if(!l["*"]){E.push(new ue(e,n[N],`unknown property "${N}"`));continue}W=S}E=E.concat(W({key:(e&&`${e}.`)+N,value:n[N],valueSpec:q,style:x,styleSpec:b,object:n,objectKey:N,validateSpec:S},n))}for(const N in l)d[N]||l[N].required&&l[N].default===void 0&&n[N]===void 0&&E.push(new ue(e,n,`missing required property "${N}"`));return E}function fc(r){const e=r.value,n=r.valueSpec,l=r.style,d=r.styleSpec,x=r.key,b=r.arrayElementValidator||r.validateSpec;if(fi(e)!=="array")return[new ue(x,e,`array expected, ${fi(e)} found`)];if(n.length&&e.length!==n.length)return[new ue(x,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new ue(x,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let S={type:n.value,values:n.values};d.$version<7&&(S.function=n.function),fi(n.value)==="object"&&(S=n.value);let E=[];for(let k=0;k<e.length;k++)E=E.concat(b({array:e,arrayIndex:k,value:e[k],valueSpec:S,validateSpec:r.validateSpec,style:l,styleSpec:d,key:`${x}[${k}]`}));return E}function Ea(r){const e=r.key,n=r.value,l=r.valueSpec;let d=fi(n);return d==="number"&&n!=n&&(d="NaN"),d!=="number"?[new ue(e,n,`number expected, ${d} found`)]:"minimum"in l&&n<l.minimum?[new ue(e,n,`${n} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&n>l.maximum?[new ue(e,n,`${n} is greater than the maximum value ${l.maximum}`)]:[]}function En(r){const e=r.valueSpec,n=bn(r.value.type);let l,d,x,b={};const S=n!=="categorical"&&r.value.property===void 0,E=!S,k=fi(r.value.stops)==="array"&&fi(r.value.stops[0])==="array"&&fi(r.value.stops[0][0])==="object",N=Ar({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(W){if(n==="identity")return[new ue(W.key,W.value,'identity function may not have a "stops" property')];let K=[];const et=W.value;return K=K.concat(fc({key:W.key,value:et,valueSpec:W.valueSpec,validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec,arrayElementValidator:V})),fi(et)==="array"&&et.length===0&&K.push(new ue(W.key,et,"array must have at least one stop")),K},default:function(W){return W.validateSpec({key:W.key,value:W.value,valueSpec:e,validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec})}}});return n==="identity"&&S&&N.push(new ue(r.key,r.value,'missing required property "property"')),n==="identity"||r.value.stops||N.push(new ue(r.key,r.value,'missing required property "stops"')),n==="exponential"&&r.valueSpec.expression&&!Pa(r.valueSpec)&&N.push(new ue(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(E&&!As(r.valueSpec)?N.push(new ue(r.key,r.value,"property functions not supported")):S&&!Al(r.valueSpec)&&N.push(new ue(r.key,r.value,"zoom functions not supported"))),n!=="categorical"&&!k||r.value.property!==void 0||N.push(new ue(r.key,r.value,'"property" property is required')),N;function V(W){let K=[];const et=W.value,at=W.key;if(fi(et)!=="array")return[new ue(at,et,`array expected, ${fi(et)} found`)];if(et.length!==2)return[new ue(at,et,`array length 2 expected, length ${et.length} found`)];if(k){if(fi(et[0])!=="object")return[new ue(at,et,`object expected, ${fi(et[0])} found`)];if(et[0].zoom===void 0)return[new ue(at,et,"object stop key must have zoom")];if(et[0].value===void 0)return[new ue(at,et,"object stop key must have value")];if(x&&x>bn(et[0].zoom))return[new ue(at,et[0].zoom,"stop zoom values must appear in ascending order")];bn(et[0].zoom)!==x&&(x=bn(et[0].zoom),d=void 0,b={}),K=K.concat(Ar({key:`${at}[0]`,value:et[0],valueSpec:{zoom:{}},validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec,objectElementValidators:{zoom:Ea,value:q}}))}else K=K.concat(q({key:`${at}[0]`,value:et[0],validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec},et));return Aa(cs(et[1]))?K.concat([new ue(`${at}[1]`,et[1],"expressions are not allowed in function stops.")]):K.concat(W.validateSpec({key:`${at}[1]`,value:et[1],valueSpec:e,validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec}))}function q(W,K){const et=fi(W.value),at=bn(W.value),ft=W.value!==null?W.value:K;if(l){if(et!==l)return[new ue(W.key,ft,`${et} stop domain type must match previous stop domain type ${l}`)]}else l=et;if(et!=="number"&&et!=="string"&&et!=="boolean")return[new ue(W.key,ft,"stop domain value must be a number, string, or boolean")];if(et!=="number"&&n!=="categorical"){let Dt=`number expected, ${et} found`;return As(e)&&n===void 0&&(Dt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ue(W.key,ft,Dt)]}return n!=="categorical"||et!=="number"||isFinite(at)&&Math.floor(at)===at?n!=="categorical"&&et==="number"&&d!==void 0&&at<d?[new ue(W.key,ft,"stop domain values must appear in ascending order")]:(d=at,n==="categorical"&&at in b?[new ue(W.key,ft,"stop domain values must be unique")]:(b[at]=!0,[])):[new ue(W.key,ft,`integer expected, found ${at}`)]}}function Or(r){const e=(r.expressionContext==="property"?A:Ca)(cs(r.value),r.valueSpec);if(e.result==="error")return e.value.map(l=>new ue(`${r.key}${l.key}`,r.value,l.message));const n=e.value.expression||e.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!n.outputDefined())return[new ue(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Hr(n))return[new ue(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!Hr(n))return[new ue(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!Oo(n,["zoom","feature-state"]))return[new ue(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!io(n))return[new ue(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function $s(r){const e=r.key,n=r.value,l=fi(n);return l!=="string"?[new ue(e,n,`color expected, ${l} found`)]:di.parse(String(n))?[]:[new ue(e,n,`color expected, "${n}" found`)]}function Nr(r){const e=r.key,n=r.value,l=r.valueSpec,d=[];return Array.isArray(l.values)?l.values.indexOf(bn(n))===-1&&d.push(new ue(e,n,`expected one of [${l.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(l.values).indexOf(bn(n))===-1&&d.push(new ue(e,n,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(n)} found`)),d}function oa(r){return wt(cs(r.value))?Or(Ie({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):zl(r)}function zl(r){const e=r.value,n=r.key;if(fi(e)!=="array")return[new ue(n,e,`array expected, ${fi(e)} found`)];const l=r.styleSpec;let d,x=[];if(e.length<1)return[new ue(n,e,"filter array must have at least 1 element")];switch(x=x.concat(Nr({key:`${n}[0]`,value:e[0],valueSpec:l.filter_operator,style:r.style,styleSpec:r.styleSpec})),bn(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&bn(e[1])==="$type"&&x.push(new ue(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&x.push(new ue(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(d=fi(e[1]),d!=="string"&&x.push(new ue(`${n}[1]`,e[1],`string expected, ${d} found`)));for(let b=2;b<e.length;b++)d=fi(e[b]),bn(e[1])==="$type"?x=x.concat(Nr({key:`${n}[${b}]`,value:e[b],valueSpec:l.geometry_type,style:r.style,styleSpec:r.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&x.push(new ue(`${n}[${b}]`,e[b],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let b=1;b<e.length;b++)x=x.concat(zl({key:`${n}[${b}]`,value:e[b],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":d=fi(e[1]),e.length!==2?x.push(new ue(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="string"&&x.push(new ue(`${n}[1]`,e[1],`string expected, ${d} found`))}return x}function pc(r,e){const n=r.key,l=r.validateSpec,d=r.style,x=r.styleSpec,b=r.value,S=r.objectKey,E=x[`${e}_${r.layerType}`];if(!E)return[];const k=S.match(/^(.*)-transition$/);if(e==="paint"&&k&&E[k[1]]&&E[k[1]].transition)return l({key:n,value:b,valueSpec:x.transition,style:d,styleSpec:x});const N=r.valueSpec||E[S];if(!N)return[new ue(n,b,`unknown property "${S}"`)];let V;if(fi(b)==="string"&&As(N)&&!N.tokens&&(V=/^{([^}]+)}$/.exec(b)))return[new ue(n,b,`"${S}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(V[1])} }\`.`)];const q=[];return r.layerType==="symbol"&&(S==="text-field"&&d&&!d.glyphs&&q.push(new ue(n,b,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&Cl(cs(b))&&bn(b.type)==="identity"&&q.push(new ue(n,b,'"text-font" does not support identity functions'))),q.concat(l({key:r.key,value:b,valueSpec:N,style:d,styleSpec:x,expressionContext:"property",propertyType:e,propertyKey:S}))}function Dl(r){return pc(r,"paint")}function xu(r){return pc(r,"layout")}function Ll(r){let e=[];const n=r.value,l=r.key,d=r.style,x=r.styleSpec;if(fi(n)!=="object")return[new ue(l,n,`object expected, ${fi(n)} found`)];n.type||n.ref||e.push(new ue(l,n,'either "type" or "ref" is required'));let b=bn(n.type);const S=bn(n.ref);if(n.id){const E=bn(n.id);for(let k=0;k<r.arrayIndex;k++){const N=d.layers[k];bn(N.id)===E&&e.push(new ue(l,n.id,`duplicate layer id "${n.id}", previously used at line ${N.id.__line__}`))}}if("ref"in n){let E;["type","source","source-layer","filter","layout"].forEach(k=>{k in n&&e.push(new ue(l,n[k],`"${k}" is prohibited for ref layers`))}),d.layers.forEach(k=>{bn(k.id)===S&&(E=k)}),E?E.ref?e.push(new ue(l,n.ref,"ref cannot reference another ref layer")):b=bn(E.type):e.push(new ue(l,n.ref,`ref layer "${S}" not found`))}else if(b!=="background")if(n.source){const E=d.sources&&d.sources[n.source],k=E&&bn(E.type);E?k==="vector"&&b==="raster"?e.push(new ue(l,n.source,`layer "${n.id}" requires a raster source`)):k!=="raster-dem"&&b==="hillshade"||k!=="raster-dem"&&b==="color-relief"?e.push(new ue(l,n.source,`layer "${n.id}" requires a raster-dem source`)):k==="raster"&&b!=="raster"?e.push(new ue(l,n.source,`layer "${n.id}" requires a vector source`)):k!=="vector"||n["source-layer"]?k==="raster-dem"&&b!=="hillshade"&&b!=="color-relief"?e.push(new ue(l,n.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):b!=="line"||!n.paint||!n.paint["line-gradient"]||k==="geojson"&&E.lineMetrics||e.push(new ue(l,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new ue(l,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new ue(l,n.source,`source "${n.source}" not found`))}else e.push(new ue(l,n,'missing required property "source"'));return e=e.concat(Ar({key:l,value:n,valueSpec:x.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${l}.type`,value:n.type,valueSpec:x.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:n,objectKey:"type"}),filter:oa,layout:E=>Ar({layer:n,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":k=>xu(Ie({layerType:b},k))}}),paint:E=>Ar({layer:n,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":k=>Dl(Ie({layerType:b},k))}})}})),e}function wn(r){const e=r.value,n=r.key,l=fi(e);return l!=="string"?[new ue(n,e,`string expected, ${l} found`)]:[]}const Jo={promoteId:function({key:r,value:e}){if(fi(e)==="string")return wn({key:r,value:e});{const n=[];for(const l in e)n.push(...wn({key:`${r}.${l}`,value:e[l]}));return n}}};function Es(r){const e=r.value,n=r.key,l=r.styleSpec,d=r.style,x=r.validateSpec;if(!e.type)return[new ue(n,e,'"type" is required')];const b=bn(e.type);let S;switch(b){case"vector":case"raster":return S=Ar({key:n,value:e,valueSpec:l[`source_${b.replace("-","_")}`],style:r.style,styleSpec:l,objectElementValidators:Jo,validateSpec:x}),S;case"raster-dem":return S=function(E){var k;const N=(k=E.sourceName)!==null&&k!==void 0?k:"",V=E.value,q=E.styleSpec,W=q.source_raster_dem,K=E.style;let et=[];const at=fi(V);if(V===void 0)return et;if(at!=="object")return et.push(new ue("source_raster_dem",V,`object expected, ${at} found`)),et;const ft=bn(V.encoding)==="custom",Dt=["redFactor","greenFactor","blueFactor","baseShift"],xt=E.value.encoding?`"${E.value.encoding}"`:"Default";for(const Mt in V)!ft&&Dt.includes(Mt)?et.push(new ue(Mt,V[Mt],`In "${N}": "${Mt}" is only valid when "encoding" is set to "custom". ${xt} encoding found`)):W[Mt]?et=et.concat(E.validateSpec({key:Mt,value:V[Mt],valueSpec:W[Mt],validateSpec:E.validateSpec,style:K,styleSpec:q})):et.push(new ue(Mt,V[Mt],`unknown property "${Mt}"`));return et}({sourceName:n,value:e,style:r.style,styleSpec:l,validateSpec:x}),S;case"geojson":if(S=Ar({key:n,value:e,valueSpec:l.source_geojson,style:d,styleSpec:l,validateSpec:x,objectElementValidators:Jo}),e.cluster)for(const E in e.clusterProperties){const[k,N]=e.clusterProperties[E],V=typeof k=="string"?[k,["accumulated"],["get",E]]:k;S.push(...Or({key:`${n}.${E}.map`,value:N,expressionContext:"cluster-map"})),S.push(...Or({key:`${n}.${E}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return S;case"video":return Ar({key:n,value:e,valueSpec:l.source_video,style:d,validateSpec:x,styleSpec:l});case"image":return Ar({key:n,value:e,valueSpec:l.source_image,style:d,validateSpec:x,styleSpec:l});case"canvas":return[new ue(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Nr({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Uc(r){const e=r.value,n=r.styleSpec,l=n.light,d=r.style;let x=[];const b=fi(e);if(e===void 0)return x;if(b!=="object")return x=x.concat([new ue("light",e,`object expected, ${b} found`)]),x;for(const S in e){const E=S.match(/^(.*)-transition$/);x=x.concat(E&&l[E[1]]&&l[E[1]].transition?r.validateSpec({key:S,value:e[S],valueSpec:n.transition,validateSpec:r.validateSpec,style:d,styleSpec:n}):l[S]?r.validateSpec({key:S,value:e[S],valueSpec:l[S],validateSpec:r.validateSpec,style:d,styleSpec:n}):[new ue(S,e[S],`unknown property "${S}"`)])}return x}function Bh(r){const e=r.value,n=r.styleSpec,l=n.sky,d=r.style,x=fi(e);if(e===void 0)return[];if(x!=="object")return[new ue("sky",e,`object expected, ${x} found`)];let b=[];for(const S in e)b=b.concat(l[S]?r.validateSpec({key:S,value:e[S],valueSpec:l[S],style:d,styleSpec:n}):[new ue(S,e[S],`unknown property "${S}"`)]);return b}function Cd(r){const e=r.value,n=r.styleSpec,l=n.terrain,d=r.style;let x=[];const b=fi(e);if(e===void 0)return x;if(b!=="object")return x=x.concat([new ue("terrain",e,`object expected, ${b} found`)]),x;for(const S in e)x=x.concat(l[S]?r.validateSpec({key:S,value:e[S],valueSpec:l[S],validateSpec:r.validateSpec,style:d,styleSpec:n}):[new ue(S,e[S],`unknown property "${S}"`)]);return x}function gr(r){let e=[];const n=r.value,l=r.key;if(Array.isArray(n)){const d=[],x=[];for(const b in n)n[b].id&&d.includes(n[b].id)&&e.push(new ue(l,n,`all the sprites' ids must be unique, but ${n[b].id} is duplicated`)),d.push(n[b].id),n[b].url&&x.includes(n[b].url)&&e.push(new ue(l,n,`all the sprites' URLs must be unique, but ${n[b].url} is duplicated`)),x.push(n[b].url),e=e.concat(Ar({key:`${l}[${b}]`,value:n[b],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return e}return wn({key:l,value:n})}function Il(r){return e=r.value,e&&e.constructor===Object?[]:[new ue(r.key,r.value,`object expected, ${fi(r.value)} found`)];var e}const mc={"*":()=>[],array:fc,boolean:function(r){const e=r.value,n=r.key,l=fi(e);return l!=="boolean"?[new ue(n,e,`boolean expected, ${l} found`)]:[]},number:Ea,color:$s,constants:Vc,enum:Nr,filter:oa,function:En,layer:Ll,object:Ar,source:Es,light:Uc,sky:Bh,terrain:Cd,projection:function(r){const e=r.value,n=r.styleSpec,l=n.projection,d=r.style,x=fi(e);if(e===void 0)return[];if(x!=="object")return[new ue("projection",e,`object expected, ${x} found`)];let b=[];for(const S in e)b=b.concat(l[S]?r.validateSpec({key:S,value:e[S],valueSpec:l[S],style:d,styleSpec:n}):[new ue(S,e[S],`unknown property "${S}"`)]);return b},projectionDefinition:function(r){const e=r.key;let n=r.value;n=n instanceof String?n.valueOf():n;const l=fi(n);return l!=="array"||function(d){return Array.isArray(d)&&d.length===3&&typeof d[0]=="string"&&typeof d[1]=="string"&&typeof d[2]=="number"}(n)||function(d){return!!["interpolate","step","literal"].includes(d[0])}(n)?["array","string"].includes(l)?[]:[new ue(e,n,`projection expected, invalid type "${l}" found`)]:[new ue(e,n,`projection expected, invalid array ${JSON.stringify(n)} found`)]},string:wn,formatted:function(r){return wn(r).length===0?[]:Or(r)},resolvedImage:function(r){return wn(r).length===0?[]:Or(r)},padding:function(r){const e=r.key,n=r.value;if(fi(n)==="array"){if(n.length<1||n.length>4)return[new ue(e,n,`padding requires 1 to 4 values; ${n.length} values found`)];const l={type:"number"};let d=[];for(let x=0;x<n.length;x++)d=d.concat(r.validateSpec({key:`${e}[${x}]`,value:n[x],validateSpec:r.validateSpec,valueSpec:l}));return d}return Ea({key:e,value:n,valueSpec:{}})},numberArray:function(r){const e=r.key,n=r.value;if(fi(n)==="array"){const l={type:"number"};if(n.length<1)return[new ue(e,n,"array length at least 1 expected, length 0 found")];let d=[];for(let x=0;x<n.length;x++)d=d.concat(r.validateSpec({key:`${e}[${x}]`,value:n[x],validateSpec:r.validateSpec,valueSpec:l}));return d}return Ea({key:e,value:n,valueSpec:{}})},colorArray:function(r){const e=r.key,n=r.value;if(fi(n)==="array"){if(n.length<1)return[new ue(e,n,"array length at least 1 expected, length 0 found")];let l=[];for(let d=0;d<n.length;d++)l=l.concat($s({key:`${e}[${d}]`,value:n[d]}));return l}return $s({key:e,value:n})},variableAnchorOffsetCollection:function(r){const e=r.key,n=r.value,l=fi(n),d=r.styleSpec;if(l!=="array"||n.length<1||n.length%2!=0)return[new ue(e,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let x=[];for(let b=0;b<n.length;b+=2)x=x.concat(Nr({key:`${e}[${b}]`,value:n[b],valueSpec:d.layout_symbol["text-anchor"]})),x=x.concat(fc({key:`${e}[${b+1}]`,value:n[b+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:d}));return x},sprite:gr,state:Il};function No(r){const e=r.value,n=r.valueSpec,l=r.styleSpec;return r.validateSpec=No,n.expression&&Cl(bn(e))?En(r):n.expression&&Aa(cs(e))?Or(r):n.type&&mc[n.type]?mc[n.type](r):Ar(Ie({},r,{valueSpec:n.type?l[n.type]:n}))}function eh(r){const e=r.value,n=r.key,l=wn(r);return l.length||(e.indexOf("{fontstack}")===-1&&l.push(new ue(n,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&l.push(new ue(n,e,'"glyphs" url must include a "{range}" token'))),l}function Cr(r,e=It){let n=[];return n=n.concat(No({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,validateSpec:No,objectElementValidators:{glyphs:eh,"*":()=>[]}})),r.constants&&(n=n.concat(Vc({key:"constants",value:r.constants}))),Zc(n)}function us(r){return function(e){return r({...e,validateSpec:No})}}function Zc(r){return[].concat(r).sort((e,n)=>e.line-n.line)}function za(r){return function(...e){return Zc(r.apply(this,e))}}Cr.source=za(us(Es)),Cr.sprite=za(us(gr)),Cr.glyphs=za(us(eh)),Cr.light=za(us(Uc)),Cr.sky=za(us(Bh)),Cr.terrain=za(us(Cd)),Cr.state=za(us(Il)),Cr.layer=za(us(Ll)),Cr.filter=za(us(oa)),Cr.paintProperty=za(us(Dl)),Cr.layoutProperty=za(us(xu));const Gc=Cr,Ed=Gc.light,ro=Gc.sky,Oh=Gc.paintProperty,ih=Gc.layoutProperty;function Hc(r,e){let n=!1;if(e&&e.length)for(const l of e)r.fire(new ee(new Error(l.message))),n=!0;return n}class tl{constructor(e,n,l){const d=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const b=new Int32Array(this.arrayBuffer);e=b[0],this.d=(n=b[1])+2*(l=b[2]);for(let E=0;E<this.d*this.d;E++){const k=b[3+E],N=b[3+E+1];d.push(k===N?null:b.subarray(k,N))}const S=b[3+d.length+1];this.keys=b.subarray(b[3+d.length],S),this.bboxes=b.subarray(S),this.insert=this._insertReadonly}else{this.d=n+2*l;for(let b=0;b<this.d*this.d;b++)d.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=e,this.padding=l,this.scale=n/e,this.uid=0;const x=l/n*e;this.min=-x,this.max=e+x}insert(e,n,l,d,x){this._forEachCell(n,l,d,x,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(x)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,n,l,d,x,b){this.cells[x].push(b)}query(e,n,l,d,x){const b=this.min,S=this.max;if(e<=b&&n<=b&&S<=l&&S<=d&&!x)return Array.prototype.slice.call(this.keys);{const E=[];return this._forEachCell(e,n,l,d,this._queryCell,E,{},x),E}}_queryCell(e,n,l,d,x,b,S,E){const k=this.cells[x];if(k!==null){const N=this.keys,V=this.bboxes;for(let q=0;q<k.length;q++){const W=k[q];if(S[W]===void 0){const K=4*W;(E?E(V[K+0],V[K+1],V[K+2],V[K+3]):e<=V[K+2]&&n<=V[K+3]&&l>=V[K+0]&&d>=V[K+1])?(S[W]=!0,b.push(N[W])):S[W]=!1}}}}_forEachCell(e,n,l,d,x,b,S,E){const k=this._convertToCellCoord(e),N=this._convertToCellCoord(n),V=this._convertToCellCoord(l),q=this._convertToCellCoord(d);for(let W=k;W<=V;W++)for(let K=N;K<=q;K++){const et=this.d*K+W;if((!E||E(this._convertFromCellCoord(W),this._convertFromCellCoord(K),this._convertFromCellCoord(W+1),this._convertFromCellCoord(K+1)))&&x.call(this,e,n,l,d,et,b,S,E))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,n=3+this.cells.length+1+1;let l=0;for(let b=0;b<this.cells.length;b++)l+=this.cells[b].length;const d=new Int32Array(n+l+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let x=n;for(let b=0;b<e.length;b++){const S=e[b];d[3+b]=x,d.set(S,x),x+=S.length}return d[3+e.length]=x,d.set(this.keys,x),x+=this.keys.length,d[3+e.length+1]=x,d.set(this.bboxes,x),x+=this.bboxes.length,d.buffer}static serialize(e,n){const l=e.toArrayBuffer();return n&&n.push(l),{buffer:l}}static deserialize(e){return new tl(e.buffer)}}const Da={};function Ee(r,e,n={}){if(Da[r])throw new Error(`${r} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:r,writeable:!1}),Da[r]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}Ee("Object",Object),Ee("Set",Set),Ee("TransferableGridIndex",tl),Ee("Color",di),Ee("Error",Error),Ee("AJAXError",_t),Ee("ResolvedImage",lr),Ee("StylePropertyFunction",B),Ee("StyleExpression",El,{omit:["_evaluator"]}),Ee("ZoomDependentExpression",_),Ee("ZoomConstantExpression",o),Ee("CompoundExpression",Ps,{omit:["_evaluate"]});for(const r in ko)ko[r]._classRegistryKey||Ee(`Expression_${r}`,ko[r]);function bu(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function wu(r){return r.$name||r.constructor._classRegistryKey}function qc(r){return!function(e){if(e===null||typeof e!="object")return!1;const n=wu(e);return!(!n||n==="Object")}(r)&&(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||bu(r)||ys(r)||ArrayBuffer.isView(r)||r instanceof ImageData)}function _c(r,e){if(qc(r))return(bu(r)||ys(r))&&e&&e.push(r),ArrayBuffer.isView(r)&&e&&e.push(r.buffer),r instanceof ImageData&&e&&e.push(r.data.buffer),r;if(Array.isArray(r)){const x=[];for(const b of r)x.push(_c(b,e));return x}if(typeof r!="object")throw new Error("can't serialize object of type "+typeof r);const n=wu(r);if(!n)throw new Error(`can't serialize object of unregistered class ${r.constructor.name}`);if(!Da[n])throw new Error(`${n} is not registered.`);const{klass:l}=Da[n],d=l.serialize?l.serialize(r,e):{};if(l.serialize){if(e&&d===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const x in r){if(!r.hasOwnProperty(x)||Da[n].omit.indexOf(x)>=0)continue;const b=r[x];d[x]=Da[n].shallow.indexOf(x)>=0?b:_c(b,e)}r instanceof Error&&(d.message=r.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(d.$name=n),d}function so(r){if(qc(r))return r;if(Array.isArray(r))return r.map(so);if(typeof r!="object")throw new Error("can't deserialize object of type "+typeof r);const e=wu(r)||"Object";if(!Da[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:n}=Da[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(r);const l=Object.create(n.prototype);for(const d of Object.keys(r)){if(d==="$name")continue;const x=r[d];l[d]=Da[e].shallow.indexOf(d)>=0?x:so(x)}return l}class Tu{constructor(){this.first=!0}update(e,n){const l=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=l,!0))}}const Di={"Latin-1 Supplement":r=>r>=128&&r<=255,"Hangul Jamo":r=>r>=4352&&r<=4607,Khmer:r=>r>=6016&&r<=6143,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Kanbun:r=>r>=12688&&r<=12703,"CJK Strokes":r=>r>=12736&&r<=12783,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Hangul Syllables":r=>r>=44032&&r<=55215,"Private Use Area":r=>r>=57344&&r<=63743,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function ao(r){for(const e of r)if(Su(e.charCodeAt(0)))return!0;return!1}function Nh(r){for(const e of r)if(!el(e.charCodeAt(0)))return!1;return!0}function $c(r){const e=r.map(n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}}).filter(n=>n);return new RegExp(e.join("|"),"u")}const Rl=$c(["Arab","Dupl","Mong","Ougr","Syrc"]);function el(r){return!Rl.test(String.fromCodePoint(r))}const gc=$c(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Su(r){return!(r!==746&&r!==747&&(r<4352||!(Di["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||Di["CJK Compatibility"](r)||Di["CJK Strokes"](r)||!(!Di["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||Di["Enclosed CJK Letters and Months"](r)||Di["Ideographic Description Characters"](r)||Di.Kanbun(r)||Di.Katakana(r)&&r!==12540||!(!Di["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!Di["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||Di["Vertical Forms"](r)||Di["Yijing Hexagram Symbols"](r)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(r))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(r))||gc.test(String.fromCodePoint(r)))))}function nh(r){return!(Su(r)||function(e){return!!(Di["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||Di["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||Di["Letterlike Symbols"](e)||Di["Number Forms"](e)||Di["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||Di["Control Pictures"](e)&&e!==9251||Di["Optical Character Recognition"](e)||Di["Enclosed Alphanumerics"](e)||Di["Geometric Shapes"](e)||Di["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Di["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Di["CJK Symbols and Punctuation"](e)||Di.Katakana(e)||Di["Private Use Area"](e)||Di["CJK Compatibility Forms"](e)||Di["Small Form Variants"](e)||Di["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(r))}const Xc=$c(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function yc(r){return Xc.test(String.fromCodePoint(r))}function jh(r,e){return!(!e&&yc(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||Di.Khmer(r))}function Fh(r){for(const e of r)if(yc(e.charCodeAt(0)))return!0;return!1}const hs=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(r){if(hs.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(r,e){return u(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(r.pluginStatus!=="loading")return this.setState(r),r;const n=r.pluginURL,l=new Promise(x=>{this.loadScriptResolve=x});e(n);const d=new Promise(x=>setTimeout(()=>x(),this.TIMEOUT));if(yield Promise.race([l,d]),this.isParsed()){const x={pluginStatus:"loaded",pluginURL:n};return this.setState(x),x}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)})}};class cn{constructor(e,n){this.zoom=e,n?(this.now=n.now||0,this.fadeDuration=n.fadeDuration||0,this.zoomHistory=n.zoomHistory||new Tu,this.transition=n.transition||{},this.globalState=n.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Tu,this.transition={},this.globalState={})}isSupportedScript(e){return function(n,l){for(const d of n)if(!jh(d.charCodeAt(0),l))return!1;return!0}(e,hs.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,n=e-Math.floor(e),l=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*n}}}class vc{constructor(e,n){this.property=e,this.value=n,this.expression=function(l,d){if(Cl(l))return new B(l,d);if(Aa(l)){const x=A(l,d);if(x.result==="error")throw new Error(x.value.map(b=>`${b.key}: ${b.message}`).join(", "));return x.value}{let x=l;return d.type==="color"&&typeof l=="string"?x=di.parse(l):d.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?d.type!=="numberArray"||typeof l!="number"&&!Array.isArray(l)?d.type!=="colorArray"||typeof l!="string"&&!Array.isArray(l)?d.type==="variableAnchorOffsetCollection"&&Array.isArray(l)?x=or.parse(l):d.type==="projectionDefinition"&&typeof l=="string"&&(x=_n.parse(l)):x=Ui.parse(l):x=Qe.parse(l):x=ar.parse(l),{globalStateRefs:new Set,kind:"constant",evaluate:()=>x}}}(n===void 0?e.specification.default:n,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(e,n,l){return this.property.possiblyEvaluate(this,e,n,l)}}class Mu{constructor(e){this.property=e,this.value=new vc(e,void 0)}transitioned(e,n){return new jo(this.property,this.value,n,xi({},e.transition,this.transition),e.now)}untransitioned(){return new jo(this.property,this.value,null,{},0)}}class rh{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return sr(this._values[e].value.value)}setValue(e,n){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Mu(this._values[e].property)),this._values[e].value=new vc(this._values[e].property,n===null?void 0:sr(n))}getTransition(e){return sr(this._values[e].transition)}setTransition(e,n){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Mu(this._values[e].property)),this._values[e].transition=sr(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const l=this.getValue(n);l!==void 0&&(e[n]=l);const d=this.getTransition(n);d!==void 0&&(e[`${n}-transition`]=d)}return e}transitioned(e,n){const l=new Ci(this._properties);for(const d of Object.keys(this._values))l._values[d]=this._values[d].transitioned(e,n._values[d]);return l}untransitioned(){const e=new Ci(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class jo{constructor(e,n,l,d,x){this.property=e,this.value=n,this.begin=x+d.delay||0,this.end=this.begin+d.duration||0,e.specification.transition&&(d.delay||d.duration)&&(this.prior=l)}possiblyEvaluate(e,n,l){const d=e.now||0,x=this.value.possiblyEvaluate(e,n,l),b=this.prior;if(b){if(d>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(d<this.begin)return b.possiblyEvaluate(e,n,l);{const S=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(e,n,l),x,xe(S))}}return x}}class Ci{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,l){const d=new xc(this._properties);for(const x of Object.keys(this._values))d._values[x]=this._values[x].possiblyEvaluate(e,n,l);return d}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class tn{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return sr(this._values[e].value)}setValue(e,n){this._values[e]=new vc(this._values[e].property,n===null?void 0:sr(n))}serialize(){const e={};for(const n of Object.keys(this._values)){const l=this.getValue(n);l!==void 0&&(e[n]=l)}return e}possiblyEvaluate(e,n,l){const d=new xc(this._properties);for(const x of Object.keys(this._values))d._values[x]=this._values[x].possiblyEvaluate(e,n,l);return d}}class en{constructor(e,n,l){this.property=e,this.value=n,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,l,d){return this.property.evaluate(this.value,this.parameters,e,n,l,d)}}class xc{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Re{constructor(e){this.specification=e}possiblyEvaluate(e,n){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(n)}interpolate(e,n,l){const d=sa[this.specification.type];return d?d(e,n,l):e}}class Xe{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,l,d){return new en(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},l,d)}:e.expression,n)}interpolate(e,n,l){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new en(this,{kind:"constant",value:void 0},e.parameters);const d=sa[this.specification.type];if(d){const x=d(e.value.value,n.value.value,l);return new en(this,{kind:"constant",value:x},e.parameters)}return e}evaluate(e,n,l,d,x,b){return e.kind==="constant"?e.value:e.evaluate(n,l,d,x,b)}}class bc extends Xe{possiblyEvaluate(e,n,l,d){if(e.value===void 0)return new en(this,{kind:"constant",value:void 0},n);if(e.expression.kind==="constant"){const x=e.expression.evaluate(n,null,{},l,d),b=e.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,S=this._calculate(b,b,b,n);return new en(this,{kind:"constant",value:S},n)}if(e.expression.kind==="camera"){const x=this._calculate(e.expression.evaluate({zoom:n.zoom-1}),e.expression.evaluate({zoom:n.zoom}),e.expression.evaluate({zoom:n.zoom+1}),n);return new en(this,{kind:"constant",value:x},n)}return new en(this,e.expression,n)}evaluate(e,n,l,d,x,b){if(e.kind==="source"){const S=e.evaluate(n,l,d,x,b);return this._calculate(S,S,S,n)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(n.zoom)-1},l,d),e.evaluate({zoom:Math.floor(n.zoom)},l,d),e.evaluate({zoom:Math.floor(n.zoom)+1},l,d),n):e.value}_calculate(e,n,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:l,to:n}}interpolate(e){return e}}class La{constructor(e){this.specification=e}possiblyEvaluate(e,n,l,d){if(e.value!==void 0){if(e.expression.kind==="constant"){const x=e.expression.evaluate(n,null,{},l,d);return this._calculate(x,x,x,n)}return this._calculate(e.expression.evaluate(new cn(Math.floor(n.zoom-1),n)),e.expression.evaluate(new cn(Math.floor(n.zoom),n)),e.expression.evaluate(new cn(Math.floor(n.zoom+1),n)),n)}}_calculate(e,n,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:l,to:n}}interpolate(e){return e}}class il{constructor(e){this.specification=e}possiblyEvaluate(e,n,l,d){return!!e.expression.evaluate(n,null,{},l,d)}interpolate(){return!1}}class zs{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in e){const l=e[n];l.specification.overridable&&this.overridableProperties.push(n);const d=this.defaultPropertyValues[n]=new vc(l,void 0),x=this.defaultTransitionablePropertyValues[n]=new Mu(l);this.defaultTransitioningPropertyValues[n]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=d.possiblyEvaluate({})}}}Ee("DataDrivenProperty",Xe),Ee("DataConstantProperty",Re),Ee("CrossFadedDataDrivenProperty",bc),Ee("CrossFadedProperty",La),Ee("ColorRampProperty",il);const Xn="-transition";class Xs extends Le{constructor(e,n){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter,this._featureFilter=qt(e.filter)),n.layout&&(this._unevaluatedLayout=new tn(n.layout)),n.paint)){this._transitionablePaint=new rh(n.paint);for(const l in e.paint)this.setPaintProperty(l,e.paint[l],{validate:!1});for(const l in e.layout)this.setLayoutProperty(l,e.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new xc(n.paint)}}setFilter(e){this.filter=e,this._featureFilter=qt(e)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}getLayoutAffectingGlobalStateRefs(){const e=new Set;if(this._unevaluatedLayout)for(const n in this._unevaluatedLayout._values){const l=this._unevaluatedLayout._values[n];for(const d of l.getGlobalStateRefs())e.add(d)}for(const n of this._featureFilter.getGlobalStateRefs())e.add(n);return e}setLayoutProperty(e,n,l={}){n!=null&&this._validate(ih,`layers.${this.id}.layout.${e}`,e,n,l)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,n):this.visibility=n)}getPaintProperty(e){return e.endsWith(Xn)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,l={}){if(n!=null&&this._validate(Oh,`layers.${this.id}.paint.${e}`,e,n,l))return!1;if(e.endsWith(Xn))return this._transitionablePaint.setTransition(e.slice(0,-11),n||void 0),!1;{const d=this._transitionablePaint._values[e],x=d.property.specification["property-type"]==="cross-faded-data-driven",b=d.value.isDataDriven(),S=d.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const E=this._transitionablePaint._values[e].value;return E.isDataDriven()||b||x||this._handleOverridablePaintPropertyUpdate(e,S,E)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,n,l){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Ws(e,(n,l)=>!(n===void 0||l==="layout"&&!Object.keys(n).length||l==="paint"&&!Object.keys(n).length))}_validate(e,n,l,d,x={}){return(!x||x.validate!==!1)&&Hc(this,e.call(Gc,{key:n,layerType:this.type,objectKey:l,value:d,styleSpec:It,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof en&&As(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}const Vh={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Yc{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Xi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Yn(r,e=1){let n=0,l=0;return{members:r.map(d=>{const x=Vh[d.type].BYTES_PER_ELEMENT,b=n=Wc(n,Math.max(e,x)),S=d.components||1;return l=Math.max(l,x),n+=x*S,{name:d.name,type:d.type,components:S,offset:b}}),size:Wc(n,Math.max(l,e)),alignment:e}}function Wc(r,e){return Math.ceil(r/e)*e}class kl extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const l=this.length;return this.resize(l+1),this.emplace(l,e,n)}emplace(e,n,l){const d=2*e;return this.int16[d+0]=n,this.int16[d+1]=l,e}}kl.prototype.bytesPerElement=4,Ee("StructArrayLayout2i4",kl);class Bl extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,l)}emplace(e,n,l,d){const x=3*e;return this.int16[x+0]=n,this.int16[x+1]=l,this.int16[x+2]=d,e}}Bl.prototype.bytesPerElement=6,Ee("StructArrayLayout3i6",Bl);class ds extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,l,d){const x=this.length;return this.resize(x+1),this.emplace(x,e,n,l,d)}emplace(e,n,l,d,x){const b=4*e;return this.int16[b+0]=n,this.int16[b+1]=l,this.int16[b+2]=d,this.int16[b+3]=x,e}}ds.prototype.bytesPerElement=8,Ee("StructArrayLayout4i8",ds);class zn extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,l,d,x,b){const S=this.length;return this.resize(S+1),this.emplace(S,e,n,l,d,x,b)}emplace(e,n,l,d,x,b,S){const E=6*e;return this.int16[E+0]=n,this.int16[E+1]=l,this.int16[E+2]=d,this.int16[E+3]=x,this.int16[E+4]=b,this.int16[E+5]=S,e}}zn.prototype.bytesPerElement=12,Ee("StructArrayLayout2i4i12",zn);class nl extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,l,d,x,b){const S=this.length;return this.resize(S+1),this.emplace(S,e,n,l,d,x,b)}emplace(e,n,l,d,x,b,S){const E=4*e,k=8*e;return this.int16[E+0]=n,this.int16[E+1]=l,this.uint8[k+4]=d,this.uint8[k+5]=x,this.uint8[k+6]=b,this.uint8[k+7]=S,e}}nl.prototype.bytesPerElement=8,Ee("StructArrayLayout2i4ub8",nl);class rl extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const l=this.length;return this.resize(l+1),this.emplace(l,e,n)}emplace(e,n,l){const d=2*e;return this.float32[d+0]=n,this.float32[d+1]=l,e}}rl.prototype.bytesPerElement=8,Ee("StructArrayLayout2f8",rl);class wc extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,l,d,x,b,S,E,k,N){const V=this.length;return this.resize(V+1),this.emplace(V,e,n,l,d,x,b,S,E,k,N)}emplace(e,n,l,d,x,b,S,E,k,N,V){const q=10*e;return this.uint16[q+0]=n,this.uint16[q+1]=l,this.uint16[q+2]=d,this.uint16[q+3]=x,this.uint16[q+4]=b,this.uint16[q+5]=S,this.uint16[q+6]=E,this.uint16[q+7]=k,this.uint16[q+8]=N,this.uint16[q+9]=V,e}}wc.prototype.bytesPerElement=20,Ee("StructArrayLayout10ui20",wc);class sl extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,l,d,x,b,S,E,k,N,V,q){const W=this.length;return this.resize(W+1),this.emplace(W,e,n,l,d,x,b,S,E,k,N,V,q)}emplace(e,n,l,d,x,b,S,E,k,N,V,q,W){const K=12*e;return this.int16[K+0]=n,this.int16[K+1]=l,this.int16[K+2]=d,this.int16[K+3]=x,this.uint16[K+4]=b,this.uint16[K+5]=S,this.uint16[K+6]=E,this.uint16[K+7]=k,this.int16[K+8]=N,this.int16[K+9]=V,this.int16[K+10]=q,this.int16[K+11]=W,e}}sl.prototype.bytesPerElement=24,Ee("StructArrayLayout4i4ui4i24",sl);class oo extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,l)}emplace(e,n,l,d){const x=3*e;return this.float32[x+0]=n,this.float32[x+1]=l,this.float32[x+2]=d,e}}oo.prototype.bytesPerElement=12,Ee("StructArrayLayout3f12",oo);class Kc extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}Kc.prototype.bytesPerElement=4,Ee("StructArrayLayout1ul4",Kc);class Qc extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,l,d,x,b,S,E,k){const N=this.length;return this.resize(N+1),this.emplace(N,e,n,l,d,x,b,S,E,k)}emplace(e,n,l,d,x,b,S,E,k,N){const V=10*e,q=5*e;return this.int16[V+0]=n,this.int16[V+1]=l,this.int16[V+2]=d,this.int16[V+3]=x,this.int16[V+4]=b,this.int16[V+5]=S,this.uint32[q+3]=E,this.uint16[V+8]=k,this.uint16[V+9]=N,e}}Qc.prototype.bytesPerElement=20,Ee("StructArrayLayout6i1ul2ui20",Qc);class Pu extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,l,d,x,b){const S=this.length;return this.resize(S+1),this.emplace(S,e,n,l,d,x,b)}emplace(e,n,l,d,x,b,S){const E=6*e;return this.int16[E+0]=n,this.int16[E+1]=l,this.int16[E+2]=d,this.int16[E+3]=x,this.int16[E+4]=b,this.int16[E+5]=S,e}}Pu.prototype.bytesPerElement=12,Ee("StructArrayLayout2i2i2i12",Pu);class g extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,l,d,x){const b=this.length;return this.resize(b+1),this.emplace(b,e,n,l,d,x)}emplace(e,n,l,d,x,b){const S=4*e,E=8*e;return this.float32[S+0]=n,this.float32[S+1]=l,this.float32[S+2]=d,this.int16[E+6]=x,this.int16[E+7]=b,e}}g.prototype.bytesPerElement=16,Ee("StructArrayLayout2f1f2i16",g);class t extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,l,d,x,b){const S=this.length;return this.resize(S+1),this.emplace(S,e,n,l,d,x,b)}emplace(e,n,l,d,x,b,S){const E=16*e,k=4*e,N=8*e;return this.uint8[E+0]=n,this.uint8[E+1]=l,this.float32[k+1]=d,this.float32[k+2]=x,this.int16[N+6]=b,this.int16[N+7]=S,e}}t.prototype.bytesPerElement=16,Ee("StructArrayLayout2ub2f2i16",t);class s extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,l)}emplace(e,n,l,d){const x=3*e;return this.uint16[x+0]=n,this.uint16[x+1]=l,this.uint16[x+2]=d,e}}s.prototype.bytesPerElement=6,Ee("StructArrayLayout3ui6",s);class c extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,l,d,x,b,S,E,k,N,V,q,W,K,et,at,ft){const Dt=this.length;return this.resize(Dt+1),this.emplace(Dt,e,n,l,d,x,b,S,E,k,N,V,q,W,K,et,at,ft)}emplace(e,n,l,d,x,b,S,E,k,N,V,q,W,K,et,at,ft,Dt){const xt=24*e,Mt=12*e,jt=48*e;return this.int16[xt+0]=n,this.int16[xt+1]=l,this.uint16[xt+2]=d,this.uint16[xt+3]=x,this.uint32[Mt+2]=b,this.uint32[Mt+3]=S,this.uint32[Mt+4]=E,this.uint16[xt+10]=k,this.uint16[xt+11]=N,this.uint16[xt+12]=V,this.float32[Mt+7]=q,this.float32[Mt+8]=W,this.uint8[jt+36]=K,this.uint8[jt+37]=et,this.uint8[jt+38]=at,this.uint32[Mt+10]=ft,this.int16[xt+22]=Dt,e}}c.prototype.bytesPerElement=48,Ee("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",c);class f extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,l,d,x,b,S,E,k,N,V,q,W,K,et,at,ft,Dt,xt,Mt,jt,$t,se,Pe,ye,be,He,Ae){const Te=this.length;return this.resize(Te+1),this.emplace(Te,e,n,l,d,x,b,S,E,k,N,V,q,W,K,et,at,ft,Dt,xt,Mt,jt,$t,se,Pe,ye,be,He,Ae)}emplace(e,n,l,d,x,b,S,E,k,N,V,q,W,K,et,at,ft,Dt,xt,Mt,jt,$t,se,Pe,ye,be,He,Ae,Te){const te=32*e,ei=16*e;return this.int16[te+0]=n,this.int16[te+1]=l,this.int16[te+2]=d,this.int16[te+3]=x,this.int16[te+4]=b,this.int16[te+5]=S,this.int16[te+6]=E,this.int16[te+7]=k,this.uint16[te+8]=N,this.uint16[te+9]=V,this.uint16[te+10]=q,this.uint16[te+11]=W,this.uint16[te+12]=K,this.uint16[te+13]=et,this.uint16[te+14]=at,this.uint16[te+15]=ft,this.uint16[te+16]=Dt,this.uint16[te+17]=xt,this.uint16[te+18]=Mt,this.uint16[te+19]=jt,this.uint16[te+20]=$t,this.uint16[te+21]=se,this.uint16[te+22]=Pe,this.uint32[ei+12]=ye,this.float32[ei+13]=be,this.float32[ei+14]=He,this.uint16[te+30]=Ae,this.uint16[te+31]=Te,e}}f.prototype.bytesPerElement=64,Ee("StructArrayLayout8i15ui1ul2f2ui64",f);class y extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}y.prototype.bytesPerElement=4,Ee("StructArrayLayout1f4",y);class T extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,l)}emplace(e,n,l,d){const x=3*e;return this.uint16[6*e+0]=n,this.float32[x+1]=l,this.float32[x+2]=d,e}}T.prototype.bytesPerElement=12,Ee("StructArrayLayout1ui2f12",T);class z extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,l){const d=this.length;return this.resize(d+1),this.emplace(d,e,n,l)}emplace(e,n,l,d){const x=4*e;return this.uint32[2*e+0]=n,this.uint16[x+2]=l,this.uint16[x+3]=d,e}}z.prototype.bytesPerElement=8,Ee("StructArrayLayout1ul2ui8",z);class D extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const l=this.length;return this.resize(l+1),this.emplace(l,e,n)}emplace(e,n,l){const d=2*e;return this.uint16[d+0]=n,this.uint16[d+1]=l,e}}D.prototype.bytesPerElement=4,Ee("StructArrayLayout2ui4",D);class O extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}O.prototype.bytesPerElement=2,Ee("StructArrayLayout1ui2",O);class j extends Xi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,l,d){const x=this.length;return this.resize(x+1),this.emplace(x,e,n,l,d)}emplace(e,n,l,d,x){const b=4*e;return this.float32[b+0]=n,this.float32[b+1]=l,this.float32[b+2]=d,this.float32[b+3]=x,e}}j.prototype.bytesPerElement=16,Ee("StructArrayLayout4f16",j);class Z extends Yc{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new H(this.anchorPointX,this.anchorPointY)}}Z.prototype.size=20;class U extends Qc{get(e){return new Z(this,e)}}Ee("CollisionBoxArray",U);class $ extends Yc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}$.prototype.size=48;class J extends c{get(e){return new $(this,e)}}Ee("PlacedSymbolArray",J);class ct extends Yc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ct.prototype.size=64;class ot extends f{get(e){return new ct(this,e)}}Ee("SymbolInstanceArray",ot);class ut extends y{getoffsetX(e){return this.float32[1*e+0]}}Ee("GlyphOffsetArray",ut);class pt extends Bl{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Ee("SymbolLineVertexArray",pt);class vt extends Yc{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}vt.prototype.size=12;class mt extends T{get(e){return new vt(this,e)}}Ee("TextAnchorOffsetArray",mt);class bt extends Yc{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}bt.prototype.size=8;class At extends z{get(e){return new bt(this,e)}}Ee("FeatureIndexArray",At);class gt extends kl{}class Lt extends kl{}class Gt extends kl{}class Ot extends zn{}class Nt extends nl{}class Ut extends rl{}class _e extends wc{}class ve extends sl{}class re extends oo{}class Oe extends Kc{}class yi extends Pu{}class Ni extends t{}class Yi extends s{}class Gi extends D{}const On=Yn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Dn}=On;class mi{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=e}prepareSegment(e,n,l,d){const x=this.segments[this.segments.length-1];return e>mi.MAX_VERTEX_ARRAY_LENGTH&&An(`Max vertices per segment is ${mi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${mi.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!x||x.vertexLength+e>mi.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==d?this.createNewSegment(n,l,d):x}createNewSegment(e,n,l){const d={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0,vaos:{}};return l!==void 0&&(d.sortKey=l),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(d),d}getOrCreateLatestSegment(e,n,l){return this.prepareSegment(0,e,n,l)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,l,d){return new mi([{vertexOffset:e,primitiveOffset:n,vertexLength:l,primitiveLength:d,vaos:{},sortKey:0}])}}function Wi(r,e){return 256*(r=Se(Math.floor(r),0,255))+Se(Math.floor(e),0,255)}mi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ee("SegmentVector",mi);const Wn=Yn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var yr,Er,Ds,lo={exports:{}},al={exports:{}},Ia={exports:{}},Ol=function(){if(Ds)return lo.exports;Ds=1;var r=(yr||(yr=1,al.exports=function(n,l){var d,x,b,S,E,k,N,V;for(x=n.length-(d=3&n.length),b=l,E=3432918353,k=461845907,V=0;V<x;)N=255&n.charCodeAt(V)|(255&n.charCodeAt(++V))<<8|(255&n.charCodeAt(++V))<<16|(255&n.charCodeAt(++V))<<24,++V,b=27492+(65535&(S=5*(65535&(b=(b^=N=(65535&(N=(N=(65535&N)*E+(((N>>>16)*E&65535)<<16)&4294967295)<<15|N>>>17))*k+(((N>>>16)*k&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(N=0,d){case 3:N^=(255&n.charCodeAt(V+2))<<16;case 2:N^=(255&n.charCodeAt(V+1))<<8;case 1:b^=N=(65535&(N=(N=(65535&(N^=255&n.charCodeAt(V)))*E+(((N>>>16)*E&65535)<<16)&4294967295)<<15|N>>>17))*k+(((N>>>16)*k&65535)<<16)&4294967295}return b^=n.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}),al.exports),e=(Er||(Er=1,Ia.exports=function(n,l){for(var d,x=n.length,b=l^x,S=0;x>=4;)d=1540483477*(65535&(d=255&n.charCodeAt(S)|(255&n.charCodeAt(++S))<<8|(255&n.charCodeAt(++S))<<16|(255&n.charCodeAt(++S))<<24))+((1540483477*(d>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),x-=4,++S;switch(x){case 3:b^=(255&n.charCodeAt(S+2))<<16;case 2:b^=(255&n.charCodeAt(S+1))<<8;case 1:b=1540483477*(65535&(b^=255&n.charCodeAt(S)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}),Ia.exports);return lo.exports=r,lo.exports.murmur3=r,lo.exports.murmur2=e,lo.exports}(),ol=X(Ol);class Nl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,l,d){this.ids.push(jl(e)),this.positions.push(n,l,d)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=jl(e);let l=0,d=this.ids.length-1;for(;l<d;){const b=l+d>>1;this.ids[b]>=n?d=b:l=b+1}const x=[];for(;this.ids[l]===n;)x.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return x}static serialize(e,n){const l=new Float64Array(e.ids),d=new Uint32Array(e.positions);return qr(l,d,0,l.length-1),n&&n.push(l.buffer,d.buffer),{ids:l,positions:d}}static deserialize(e){const n=new Nl;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function jl(r){const e=+r;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:ol(String(r))}function qr(r,e,n,l){for(;n<l;){const d=r[n+l>>1];let x=n-1,b=l+1;for(;;){do x++;while(r[x]<d);do b--;while(r[b]>d);if(x>=b)break;Ra(r,x,b),Ra(e,3*x,3*b),Ra(e,3*x+1,3*b+1),Ra(e,3*x+2,3*b+2)}b-n<l-b?(qr(r,e,n,b),n=b+1):(qr(r,e,b+1,l),l=b)}}function Ra(r,e,n){const l=r[e];r[e]=r[n],r[n]=l}Ee("FeaturePositionMap",Nl);class fs{constructor(e,n){this.gl=e.gl,this.location=n}}class Fl extends fs{constructor(e,n){super(e,n),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Ln extends fs{constructor(e,n){super(e,n),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Gn extends fs{constructor(e,n){super(e,n),this.current=di.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Ls=new Float32Array(16);function Nn(r){return[Wi(255*r.r,255*r.g),Wi(255*r.b,255*r.a)]}class Vl{constructor(e,n,l){this.value=e,this.uniformNames=n.map(d=>`u_${d}`),this.type=l}setUniform(e,n,l){e.set(l.constantOr(this.value))}getBinding(e,n,l){return this.type==="color"?new Gn(e,n):new Fl(e,n)}}class Tc{constructor(e,n){this.uniformNames=n.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=e.tlbr}setUniform(e,n,l,d){const x=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;x&&e.set(x)}getBinding(e,n,l){return l.substr(0,9)==="u_pattern"?new Ln(e,n):new Fl(e,n)}}class Fo{constructor(e,n,l,d){this.expression=e,this.type=l,this.maxValue=0,this.paintVertexAttributes=n.map(x=>({name:`a_${x}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(e,n,l,d,x){const b=this.paintVertexArray.length,S=this.expression.evaluate(new cn(0),n,{},d,[],x);this.paintVertexArray.resize(e),this._setPaintValue(b,e,S)}updatePaintArray(e,n,l,d){const x=this.expression.evaluate({zoom:0},l,d);this._setPaintValue(e,n,x)}_setPaintValue(e,n,l){if(this.type==="color"){const d=Nn(l);for(let x=e;x<n;x++)this.paintVertexArray.emplace(x,d[0],d[1])}else{for(let d=e;d<n;d++)this.paintVertexArray.emplace(d,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ps{constructor(e,n,l,d,x,b){this.expression=e,this.uniformNames=n.map(S=>`u_${S}_t`),this.type=l,this.useIntegerZoom=d,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=n.map(S=>({name:`a_${S}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(e,n,l,d,x){const b=this.expression.evaluate(new cn(this.zoom),n,{},d,[],x),S=this.expression.evaluate(new cn(this.zoom+1),n,{},d,[],x),E=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(E,e,b,S)}updatePaintArray(e,n,l,d){const x=this.expression.evaluate({zoom:this.zoom},l,d),b=this.expression.evaluate({zoom:this.zoom+1},l,d);this._setPaintValue(e,n,x,b)}_setPaintValue(e,n,l,d){if(this.type==="color"){const x=Nn(l),b=Nn(d);for(let S=e;S<n;S++)this.paintVertexArray.emplace(S,x[0],x[1],b[0],b[1])}else{for(let x=e;x<n;x++)this.paintVertexArray.emplace(x,l,d);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(d))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n){const l=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,d=Se(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);e.set(d)}getBinding(e,n,l){return new Fl(e,n)}}class ll{constructor(e,n,l,d,x,b){this.expression=e,this.type=n,this.useIntegerZoom=l,this.zoom=d,this.layerId=b,this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(e,n,l){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(d,e,n.patterns&&n.patterns[this.layerId],l)}updatePaintArray(e,n,l,d,x){this._setPaintValues(e,n,l.patterns&&l.patterns[this.layerId],x)}_setPaintValues(e,n,l,d){if(!d||!l)return;const{min:x,mid:b,max:S}=l,E=d[x],k=d[b],N=d[S];if(E&&k&&N)for(let V=e;V<n;V++)this.zoomInPaintVertexArray.emplace(V,k.tl[0],k.tl[1],k.br[0],k.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],k.pixelRatio,E.pixelRatio),this.zoomOutPaintVertexArray.emplace(V,k.tl[0],k.tl[1],k.br[0],k.br[1],N.tl[0],N.tl[1],N.br[0],N.br[1],k.pixelRatio,N.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Wn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Wn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class la{constructor(e,n,l){this.binders={},this._buffers=[];const d=[];for(const x in e.paint._values){if(!l(x))continue;const b=e.paint.get(x);if(!(b instanceof en&&As(b.property.specification)))continue;const S=cl(x,e.type),E=b.value,k=b.property.specification.type,N=b.property.useIntegerZoom,V=b.property.specification["property-type"],q=V==="cross-faded"||V==="cross-faded-data-driven";if(E.kind==="constant")this.binders[x]=q?new Tc(E.value,S):new Vl(E.value,S,k),d.push(`/u_${x}`);else if(E.kind==="source"||q){const W=sh(x,k,"source");this.binders[x]=q?new ll(E,k,N,n,W,e.id):new Fo(E,S,k,W),d.push(`/a_${x}`)}else{const W=sh(x,k,"composite");this.binders[x]=new ps(E,S,k,N,n,W),d.push(`/z_${x}`)}}this.cacheKey=d.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof Fo||n instanceof ps?n.maxValue:0}populatePaintArrays(e,n,l,d,x){for(const b in this.binders){const S=this.binders[b];(S instanceof Fo||S instanceof ps||S instanceof ll)&&S.populatePaintArray(e,n,l,d,x)}}setConstantPatternPositions(e,n){for(const l in this.binders){const d=this.binders[l];d instanceof Tc&&d.setConstantPatternPositions(e,n)}}updatePaintArrays(e,n,l,d,x){let b=!1;for(const S in e){const E=n.getPositions(S);for(const k of E){const N=l.feature(k.index);for(const V in this.binders){const q=this.binders[V];if((q instanceof Fo||q instanceof ps||q instanceof ll)&&q.expression.isStateDependent===!0){const W=d.paint.get(V);q.expression=W.value,q.updatePaintArray(k.start,k.end,N,e[S],x),b=!0}}}}return b}defines(){const e=[];for(const n in this.binders){const l=this.binders[n];(l instanceof Vl||l instanceof Tc)&&e.push(...l.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const l=this.binders[n];if(l instanceof Fo||l instanceof ps)for(let d=0;d<l.paintVertexAttributes.length;d++)e.push(l.paintVertexAttributes[d].name);else if(l instanceof ll)for(let d=0;d<Wn.members.length;d++)e.push(Wn.members[d].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const l=this.binders[n];if(l instanceof Vl||l instanceof Tc||l instanceof ps)for(const d of l.uniformNames)e.push(d)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,n){const l=[];for(const d in this.binders){const x=this.binders[d];if(x instanceof Vl||x instanceof Tc||x instanceof ps){for(const b of x.uniformNames)if(n[b]){const S=x.getBinding(e,n[b],b);l.push({name:b,property:d,binding:S})}}}return l}setUniforms(e,n,l,d){for(const{name:x,property:b,binding:S}of n)this.binders[b].setUniform(S,d,l.get(b),x)}updatePaintBuffers(e){this._buffers=[];for(const n in this.binders){const l=this.binders[n];if(e&&l instanceof ll){const d=e.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(l instanceof Fo||l instanceof ps)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(e){for(const n in this.binders){const l=this.binders[n];(l instanceof Fo||l instanceof ps||l instanceof ll)&&l.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof Fo||n instanceof ps||n instanceof ll)&&n.destroy()}}}class Kn{constructor(e,n,l=()=>!0){this.programConfigurations={};for(const d of e)this.programConfigurations[d.id]=new la(d,n,l);this.needsUpload=!1,this._featureMap=new Nl,this._bufferOffset=0}populatePaintArrays(e,n,l,d,x,b){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(e,n,d,x,b);n.id!==void 0&&this._featureMap.add(n.id,l,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,l,d){for(const x of l)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(e,this._featureMap,n,x,d)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function cl(r,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${e}-`,"").replace(/-/g,"_")]}function sh(r,e,n){const l={color:{source:rl,composite:j},number:{source:y,composite:rl}},d=function(x){return{"line-pattern":{source:_e,composite:_e},"fill-pattern":{source:_e,composite:_e},"fill-extrusion-pattern":{source:_e,composite:_e}}[x]}(r);return d&&d[n]||l[e][n]}Ee("ConstantBinder",Vl),Ee("CrossFadedConstantBinder",Tc),Ee("SourceExpressionBinder",Fo),Ee("CrossFadedCompositeBinder",ll),Ee("CompositeExpressionBinder",ps),Ee("ProgramConfiguration",la,{omit:["_buffers"]}),Ee("ProgramConfigurationSet",Kn);const co=Math.pow(2,14)-1,ka=-co-1;function Tn(r){const e=Ze/r.extent,n=r.loadGeometry();for(let l=0;l<n.length;l++){const d=n[l];for(let x=0;x<d.length;x++){const b=d[x],S=Math.round(b.x*e),E=Math.round(b.y*e);b.x=Se(S,ka,co),b.y=Se(E,ka,co),(S<b.x||S>b.x+1||E<b.y||E>b.y+1)&&An("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function Ba(r,e){return{type:r.type,id:r.id,properties:r.properties,geometry:e?Tn(r):[]}}const zd=-32768;function Mf(r,e,n,l,d){r.emplaceBack(zd+8*e+l,zd+8*n+d)}class Dd{constructor(e){this.zoom=e.zoom,this.globalState=e.globalState,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Lt,this.indexArray=new Yi,this.segments=new mi,this.programConfigurations=new Kn(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,l){const d=this.layers[0],x=[];let b=null,S=!1,E=d.type==="heatmap";if(d.type==="circle"){const N=d;b=N.layout.get("circle-sort-key"),S=!b.isConstant(),E=E||N.paint.get("circle-pitch-alignment")==="map"}const k=E?n.subdivisionGranularity.circle:1;for(const{feature:N,id:V,index:q,sourceLayerIndex:W}of e){const K=this.layers[0]._featureFilter.needGeometry,et=Ba(N,K);if(!this.layers[0]._featureFilter.filter(new cn(this.zoom,{globalState:this.globalState}),et,l))continue;const at=S?b.evaluate(et,{},l):void 0,ft={id:V,properties:N.properties,type:N.type,sourceLayerIndex:W,index:q,geometry:K?et.geometry:Tn(N),patterns:{},sortKey:at};x.push(ft)}S&&x.sort((N,V)=>N.sortKey-V.sortKey);for(const N of x){const{geometry:V,index:q,sourceLayerIndex:W}=N,K=e[q].feature;this.addFeature(N,V,q,l,k),n.featureIndex.insert(K,V,q,W,this.index)}}update(e,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Dn),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,l,d,x=1){let b;switch(x){case 1:b=[0,7];break;case 3:b=[0,2,5,7];break;case 5:b=[0,1,3,4,6,7];break;case 7:b=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${x}; valid values are 1, 3, 5, 7.`)}const S=b.length;for(const E of n)for(const k of E){const N=k.x,V=k.y;if(N<0||N>=Ze||V<0||V>=Ze)continue;const q=this.segments.prepareSegment(S*S,this.layoutVertexArray,this.indexArray,e.sortKey),W=q.vertexLength;for(let K=0;K<S;K++)for(let et=0;et<S;et++)Mf(this.layoutVertexArray,N,V,b[et],b[K]);for(let K=0;K<S-1;K++)for(let et=0;et<S-1;et++){const at=W+K*S+et,ft=W+(K+1)*S+et;this.indexArray.emplaceBack(at,ft+1,at+1),this.indexArray.emplaceBack(at,ft,ft+1)}q.vertexLength+=S*S,q.primitiveLength+=(S-1)*(S-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,{},d)}}function Pf(r,e){for(let n=0;n<r.length;n++)if(Cu(e,r[n]))return!0;for(let n=0;n<e.length;n++)if(Cu(r,e[n]))return!0;return!!Ld(r,e)}function Au(r,e,n){return!!Cu(r,e)||!!ah(e,r,n)}function Uh(r,e){if(r.length===1)return Id(e,r[0]);for(let n=0;n<e.length;n++){const l=e[n];for(let d=0;d<l.length;d++)if(Cu(r,l[d]))return!0}for(let n=0;n<r.length;n++)if(Id(e,r[n]))return!0;for(let n=0;n<e.length;n++)if(Ld(r,e[n]))return!0;return!1}function Rp(r,e,n){if(r.length>1){if(Ld(r,e))return!0;for(let l=0;l<e.length;l++)if(ah(e[l],r,n))return!0}for(let l=0;l<r.length;l++)if(ah(r[l],e,n))return!0;return!1}function Ld(r,e){if(r.length===0||e.length===0)return!1;for(let n=0;n<r.length-1;n++){const l=r[n],d=r[n+1];for(let x=0;x<e.length-1;x++)if(kp(l,d,e[x],e[x+1]))return!0}return!1}function kp(r,e,n,l){return Os(r,n,l)!==Os(e,n,l)&&Os(r,e,n)!==Os(r,e,l)}function ah(r,e,n){const l=n*n;if(e.length===1)return r.distSqr(e[0])<l;for(let d=1;d<e.length;d++)if(Af(r,e[d-1],e[d])<l)return!0;return!1}function Af(r,e,n){const l=e.distSqr(n);if(l===0)return r.distSqr(e);const d=((r.x-e.x)*(n.x-e.x)+(r.y-e.y)*(n.y-e.y))/l;return r.distSqr(d<0?e:d>1?n:n.sub(e)._mult(d)._add(e))}function Id(r,e){let n,l,d,x=!1;for(let b=0;b<r.length;b++){n=r[b];for(let S=0,E=n.length-1;S<n.length;E=S++)l=n[S],d=n[E],l.y>e.y!=d.y>e.y&&e.x<(d.x-l.x)*(e.y-l.y)/(d.y-l.y)+l.x&&(x=!x)}return x}function Cu(r,e){let n=!1;for(let l=0,d=r.length-1;l<r.length;d=l++){const x=r[l],b=r[d];x.y>e.y!=b.y>e.y&&e.x<(b.x-x.x)*(e.y-x.y)/(b.y-x.y)+x.x&&(n=!n)}return n}function Bp(r,e,n){const l=n[0],d=n[2];if(r.x<l.x&&e.x<l.x||r.x>d.x&&e.x>d.x||r.y<l.y&&e.y<l.y||r.y>d.y&&e.y>d.y)return!1;const x=Os(r,e,n[0]);return x!==Os(r,e,n[1])||x!==Os(r,e,n[2])||x!==Os(r,e,n[3])}function Zh(r,e,n){const l=e.paint.get(r).value;return l.kind==="constant"?l.value:n.programConfigurations.get(e.id).getMaxValue(r)}function Gh(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function zr(r,e,n,l,d){if(!e[0]&&!e[1])return r;const x=H.convert(e)._mult(d);n==="viewport"&&x._rotate(-l);const b=[];for(let S=0;S<r.length;S++)b.push(r[S].sub(x));return b}let ms,Cf;Ee("CircleBucket",Dd,{omit:["layers"]});var Op={get paint(){return Cf=Cf||new zs({"circle-radius":new Xe(It.paint_circle["circle-radius"]),"circle-color":new Xe(It.paint_circle["circle-color"]),"circle-blur":new Xe(It.paint_circle["circle-blur"]),"circle-opacity":new Xe(It.paint_circle["circle-opacity"]),"circle-translate":new Re(It.paint_circle["circle-translate"]),"circle-translate-anchor":new Re(It.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Re(It.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Re(It.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Xe(It.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Xe(It.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Xe(It.paint_circle["circle-stroke-opacity"])})},get layout(){return ms=ms||new zs({"circle-sort-key":new Xe(It.layout_circle["circle-sort-key"])})}};class Np extends Xs{constructor(e){super(e,Op)}createBucket(e){return new Dd(e)}queryRadius(e){const n=e;return Zh("circle-radius",this,n)+Zh("circle-stroke-width",this,n)+Gh(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:n,featureState:l,geometry:d,transform:x,pixelsToTileUnits:b,unwrappedTileID:S,getElevation:E}){const k=zr(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-x.bearingInRadians,b),N=this.paint.get("circle-radius").evaluate(n,l)+this.paint.get("circle-stroke-width").evaluate(n,l),V=this.paint.get("circle-pitch-alignment")==="map",q=V?k:function(K,et,at,ft){return K.map(Dt=>Ef(Dt,et,at,ft))}(k,x,S,E),W=V?N*b:N;for(const K of d)for(const et of K){const at=V?et:Ef(et,x,S,E);let ft=W;const Dt=x.projectTileCoordinates(et.x,et.y,S,E).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ft*=Dt/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ft*=x.cameraToCenterDistance/Dt),Au(q,at,ft))return!0}return!1}}function Ef(r,e,n,l){const d=e.projectTileCoordinates(r.x,r.y,n,l).point;return new H((.5*d.x+.5)*e.width,(.5*-d.y+.5)*e.height)}class zf extends Dd{}let Hh;Ee("HeatmapBucket",zf,{omit:["layers"]});var Df={get paint(){return Hh=Hh||new zs({"heatmap-radius":new Xe(It.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Xe(It.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Re(It.paint_heatmap["heatmap-intensity"]),"heatmap-color":new il(It.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Re(It.paint_heatmap["heatmap-opacity"])})}};function Rd(r,{width:e,height:n},l,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==e*n*l)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${e*n*l}`)}else d=new Uint8Array(e*n*l);return r.width=e,r.height=n,r.data=d,r}function Lf(r,{width:e,height:n},l){if(e===r.width&&n===r.height)return;const d=Rd({},{width:e,height:n},l);kd(r,d,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,e),height:Math.min(r.height,n)},l),r.width=e,r.height=n,r.data=d.data}function kd(r,e,n,l,d,x){if(d.width===0||d.height===0)return e;if(d.width>r.width||d.height>r.height||n.x>r.width-d.width||n.y>r.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>e.width||d.height>e.height||l.x>e.width-d.width||l.y>e.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const b=r.data,S=e.data;if(b===S)throw new Error("srcData equals dstData, so image is already copied");for(let E=0;E<d.height;E++){const k=((n.y+E)*r.width+n.x)*x,N=((l.y+E)*e.width+l.x)*x;for(let V=0;V<d.width*x;V++)S[N+V]=b[k+V]}return e}class Eu{constructor(e,n){Rd(this,e,1,n)}resize(e){Lf(this,e,1)}clone(){return new Eu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,l,d,x){kd(e,n,l,d,x,1)}}class Is{constructor(e,n){Rd(this,e,4,n)}resize(e){Lf(this,e,4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Is({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,l,d,x){kd(e,n,l,d,x,4)}setPixel(e,n,l){const d=4*(e*this.width+n);this.data[d+0]=Math.round(255*l.r/l.a),this.data[d+1]=Math.round(255*l.g/l.a),this.data[d+2]=Math.round(255*l.b/l.a),this.data[d+3]=Math.round(255*l.a)}}function Bd(r){const e={},n=r.resolution||256,l=r.clips?r.clips.length:1,d=r.image||new Is({width:n,height:l});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const x=(b,S,E)=>{e[r.evaluationKey]=E;const k=r.expression.evaluate(e);d.setPixel(b/4/n,S/4,k)};if(r.clips)for(let b=0,S=0;b<l;++b,S+=4*n)for(let E=0,k=0;E<n;E++,k+=4){const N=E/(n-1),{start:V,end:q}=r.clips[b];x(S,k,V*(1-N)+q*N)}else for(let b=0,S=0;b<n;b++,S+=4)x(0,S,b/(n-1));return d}Ee("AlphaImage",Eu),Ee("RGBAImage",Is);const Od="big-fb";class If extends Xs{createBucket(e){return new zf(e)}constructor(e){super(e,Df),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Bd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Od)&&this.heatmapFbos.delete(Od)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let qh;var Rf={get paint(){return qh=qh||new zs({"hillshade-illumination-direction":new Re(It.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Re(It.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Re(It.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Re(It.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Re(It.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Re(It.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Re(It.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Re(It.paint_hillshade["hillshade-method"])})}};class jp extends Xs{constructor(e){super(e,Rf),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let e=this.paint.get("hillshade-illumination-direction").values,n=this.paint.get("hillshade-illumination-altitude").values,l=this.paint.get("hillshade-highlight-color").values,d=this.paint.get("hillshade-shadow-color").values;const x=Math.max(e.length,n.length,l.length,d.length);e=e.concat(Array(x-e.length).fill(e.at(-1))),n=n.concat(Array(x-n.length).fill(n.at(-1))),l=l.concat(Array(x-l.length).fill(l.at(-1))),d=d.concat(Array(x-d.length).fill(d.at(-1)));const b=n.map(Go);return{directionRadians:e.map(Go),altitudeRadians:b,shadowColor:d,highlightColor:l}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Nd;var Fp={get paint(){return Nd=Nd||new zs({"color-relief-opacity":new Re(It["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new il(It["paint_color-relief"]["color-relief-color"])})}};class ul{constructor(e,n,l,d){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(n,d)}update(e,n,l){const{width:d,height:x}=e,b=!(this.size&&this.size[0]===d&&this.size[1]===x||l),{context:S}=this,{gl:E}=S;if(this.useMipmap=!!(n&&n.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!n||n.premultiply!==!1)),b)this.size=[d,x],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ys(e)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,e):E.texImage2D(E.TEXTURE_2D,0,this.format,d,x,0,this.format,E.UNSIGNED_BYTE,e.data);else{const{x:k,y:N}=l||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ys(e)?E.texSubImage2D(E.TEXTURE_2D,0,k,N,E.RGBA,E.UNSIGNED_BYTE,e):E.texSubImage2D(E.TEXTURE_2D,0,k,N,d,x,E.RGBA,E.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D),S.pixelStoreUnpackFlipY.setDefault(),S.pixelStoreUnpack.setDefault(),S.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,n,l){const{context:d}=this,{gl:x}=d;x.bindTexture(x.TEXTURE_2D,this.texture),l!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=x.LINEAR),e!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,e),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,l||e),this.filter=e),n!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,n),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class jd{constructor(e,n,l,d=1,x=1,b=1,S=0){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void An(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const E=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=d,this.greenFactor=x,this.blueFactor=b,this.baseShift=S;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let k=0;k<E;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(E,k)]=this.data[this._idx(E-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,E)]=this.data[this._idx(k,E-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(E,-1)]=this.data[this._idx(E-1,0)],this.data[this._idx(-1,E)]=this.data[this._idx(0,E-1)],this.data[this._idx(E,E)]=this.data[this._idx(E-1,E-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<E;k++)for(let N=0;N<E;N++){const V=this.get(k,N);V>this.max&&(this.max=V),V<this.min&&(this.min=V)}}get(e,n){const l=new Uint8Array(this.data.buffer),d=4*this._idx(e,n);return this.unpack(l[d],l[d+1],l[d+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}unpack(e,n,l){return e*this.redFactor+n*this.greenFactor+l*this.blueFactor-this.baseShift}pack(e){return Vp(e,this.getUnpackVector())}getPixels(){return new Is({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,n,l){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let d=n*this.dim,x=n*this.dim+this.dim,b=l*this.dim,S=l*this.dim+this.dim;switch(n){case-1:d=x-1;break;case 1:x=d+1}switch(l){case-1:b=S-1;break;case 1:S=b+1}const E=-n*this.dim,k=-l*this.dim;for(let N=b;N<S;N++)for(let V=d;V<x;V++)this.data[this._idx(V,N)]=e.data[this._idx(V+E,N+k)]}}function Vp(r,e){const n=e[0],l=e[1],d=e[2],x=e[3],b=Math.min(n,l,d),S=Math.round((r+x)/b);return{r:Math.floor(S*b/n)%256,g:Math.floor(S*b/l)%256,b:Math.floor(S*b/d)%256}}Ee("DEMData",jd);class Up extends Xs{constructor(e){super(e,Fp)}_createColorRamp(e){const n={elevationStops:[],colorStops:[]},l=this._transitionablePaint._values["color-relief-color"].value.expression;if(l instanceof o&&l._styleExpression.expression instanceof mr){this.colorRampExpression=l;const b=l._styleExpression.expression;n.elevationStops=b.labels,n.colorStops=[];for(const S of n.elevationStops)n.colorStops.push(b.evaluate({globals:{elevation:S}}))}if(n.elevationStops.length<1&&(n.elevationStops=[0],n.colorStops=[di.transparent]),n.elevationStops.length<2&&(n.elevationStops.push(n.elevationStops[0]+1),n.colorStops.push(n.colorStops[0])),n.elevationStops.length<=e)return n;const d={elevationStops:[],colorStops:[]},x=(n.elevationStops.length-1)/(e-1);for(let b=0;b<n.elevationStops.length-.5;b+=x)d.elevationStops.push(n.elevationStops[Math.round(b)]),d.colorStops.push(n.colorStops[Math.round(b)]);return An(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),d}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(e,n,l){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const d=this._createColorRamp(n),x=new Is({width:d.colorStops.length,height:1}),b=new Is({width:d.colorStops.length,height:1});for(let S=0;S<d.elevationStops.length;S++){const E=Vp(d.elevationStops[S],l);b.setPixel(0,S,new di(E.r/255,E.g/255,E.b/255,1)),x.setPixel(0,S,d.colorStops[S])}return this.colorRampTextures={elevationTexture:new ul(e,b,e.gl.RGBA),colorTexture:new ul(e,x,e.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const Sc=Yn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Zp}=Sc;function oh(r,e,n){const l=n.patternDependencies;let d=!1;for(const x of e){const b=x.paint.get(`${r}-pattern`);b.isConstant()||(d=!0);const S=b.constantOr(null);S&&(d=!0,l[S.to]=!0,l[S.from]=!0)}return d}function zu(r,e,n,l,d){const x=d.patternDependencies;for(const b of e){const S=b.paint.get(`${r}-pattern`).value;if(S.kind!=="constant"){let E=S.evaluate({zoom:l-1},n,{},d.availableImages),k=S.evaluate({zoom:l},n,{},d.availableImages),N=S.evaluate({zoom:l+1},n,{},d.availableImages);E=E&&E.name?E.name:E,k=k&&k.name?k.name:k,N=N&&N.name?N.name:N,x[E]=!0,x[k]=!0,x[N]=!0,n.patterns[b.id]={min:E,mid:k,max:N}}}return n}function Qn(r,e,n,l,d){let x;if(d===function(b,S,E,k){let N=0;for(let V=S,q=E-k;V<E;V+=k)N+=(b[q]-b[V])*(b[V+1]+b[q+1]),q=V;return N}(r,e,n,l)>0)for(let b=e;b<n;b+=l)x=$p(b/l|0,r[b],r[b+1],x);else for(let b=n-l;b>=e;b-=l)x=$p(b/l|0,r[b],r[b+1],x);return x&&Iu(x,x.next)&&(uh(x),x=x.next),x}function Du(r,e){if(!r)return r;e||(e=r);let n,l=r;do if(n=!1,l.steiner||!Iu(l,l.next)&&jn(l.prev,l,l.next)!==0)l=l.next;else{if(uh(l),l=e=l.prev,l===l.next)break;n=!0}while(n||l!==e);return e}function $h(r,e,n,l,d,x,b){if(!r)return;!b&&x&&function(E,k,N,V){let q=E;do q.z===0&&(q.z=Fd(q.x,q.y,k,N,V)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==E);q.prevZ.nextZ=null,q.prevZ=null,function(W){let K,et=1;do{let at,ft=W;W=null;let Dt=null;for(K=0;ft;){K++;let xt=ft,Mt=0;for(let $t=0;$t<et&&(Mt++,xt=xt.nextZ,xt);$t++);let jt=et;for(;Mt>0||jt>0&&xt;)Mt!==0&&(jt===0||!xt||ft.z<=xt.z)?(at=ft,ft=ft.nextZ,Mt--):(at=xt,xt=xt.nextZ,jt--),Dt?Dt.nextZ=at:W=at,at.prevZ=Dt,Dt=at;ft=xt}Dt.nextZ=null,et*=2}while(K>1)}(q)}(r,l,d,x);let S=r;for(;r.prev!==r.next;){const E=r.prev,k=r.next;if(x?Xh(r,l,d,x):Gp(r))e.push(E.i,r.i,k.i),uh(r),r=k.next,S=k.next;else if((r=k)===S){b?b===1?$h(r=Jc(Du(r),e),e,n,l,d,x,2):b===2&&Hp(r,e,n,l,d,x):$h(Du(r),e,n,l,d,x,1);break}}}function Gp(r){const e=r.prev,n=r,l=r.next;if(jn(e,n,l)>=0)return!1;const d=e.x,x=n.x,b=l.x,S=e.y,E=n.y,k=l.y,N=Math.min(d,x,b),V=Math.min(S,E,k),q=Math.max(d,x,b),W=Math.max(S,E,k);let K=l.next;for(;K!==e;){if(K.x>=N&&K.x<=q&&K.y>=V&&K.y<=W&&Lu(d,S,x,E,b,k,K.x,K.y)&&jn(K.prev,K,K.next)>=0)return!1;K=K.next}return!0}function Xh(r,e,n,l){const d=r.prev,x=r,b=r.next;if(jn(d,x,b)>=0)return!1;const S=d.x,E=x.x,k=b.x,N=d.y,V=x.y,q=b.y,W=Math.min(S,E,k),K=Math.min(N,V,q),et=Math.max(S,E,k),at=Math.max(N,V,q),ft=Fd(W,K,e,n,l),Dt=Fd(et,at,e,n,l);let xt=r.prevZ,Mt=r.nextZ;for(;xt&&xt.z>=ft&&Mt&&Mt.z<=Dt;){if(xt.x>=W&&xt.x<=et&&xt.y>=K&&xt.y<=at&&xt!==d&&xt!==b&&Lu(S,N,E,V,k,q,xt.x,xt.y)&&jn(xt.prev,xt,xt.next)>=0||(xt=xt.prevZ,Mt.x>=W&&Mt.x<=et&&Mt.y>=K&&Mt.y<=at&&Mt!==d&&Mt!==b&&Lu(S,N,E,V,k,q,Mt.x,Mt.y)&&jn(Mt.prev,Mt,Mt.next)>=0))return!1;Mt=Mt.nextZ}for(;xt&&xt.z>=ft;){if(xt.x>=W&&xt.x<=et&&xt.y>=K&&xt.y<=at&&xt!==d&&xt!==b&&Lu(S,N,E,V,k,q,xt.x,xt.y)&&jn(xt.prev,xt,xt.next)>=0)return!1;xt=xt.prevZ}for(;Mt&&Mt.z<=Dt;){if(Mt.x>=W&&Mt.x<=et&&Mt.y>=K&&Mt.y<=at&&Mt!==d&&Mt!==b&&Lu(S,N,E,V,k,q,Mt.x,Mt.y)&&jn(Mt.prev,Mt,Mt.next)>=0)return!1;Mt=Mt.nextZ}return!0}function Jc(r,e){let n=r;do{const l=n.prev,d=n.next.next;!Iu(l,d)&&Zl(l,n,n.next,d)&&ch(l,d)&&ch(d,l)&&(e.push(l.i,n.i,d.i),uh(n),uh(n.next),n=r=d),n=n.next}while(n!==r);return Du(n)}function Hp(r,e,n,l,d,x){let b=r;do{let S=b.next.next;for(;S!==b.prev;){if(b.i!==S.i&&Of(b,S)){let E=$r(b,S);return b=Du(b,b.next),E=Du(E,E.next),$h(b,e,n,l,d,x,0),void $h(E,e,n,l,d,x,0)}S=S.next}b=b.next}while(b!==r)}function qp(r,e){let n=r.x-e.x;return n===0&&(n=r.y-e.y,n===0)&&(n=(r.next.y-r.y)/(r.next.x-r.x)-(e.next.y-e.y)/(e.next.x-e.x)),n}function Yh(r,e){const n=function(d,x){let b=x;const S=d.x,E=d.y;let k,N=-1/0;if(Iu(d,b))return b;do{if(Iu(d,b.next))return b.next;if(E<=b.y&&E>=b.next.y&&b.next.y!==b.y){const et=b.x+(E-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(et<=S&&et>N&&(N=et,k=b.x<b.next.x?b:b.next,et===S))return k}b=b.next}while(b!==x);if(!k)return null;const V=k,q=k.x,W=k.y;let K=1/0;b=k;do{if(S>=b.x&&b.x>=q&&S!==b.x&&Bf(E<W?S:N,E,q,W,E<W?N:S,E,b.x,b.y)){const et=Math.abs(E-b.y)/(S-b.x);ch(b,d)&&(et<K||et===K&&(b.x>k.x||b.x===k.x&&Ul(k,b)))&&(k=b,K=et)}b=b.next}while(b!==V);return k}(r,e);if(!n)return e;const l=$r(n,r);return Du(l,l.next),Du(n,n.next)}function Ul(r,e){return jn(r.prev,r,e.prev)<0&&jn(e.next,r,r.next)<0}function Fd(r,e,n,l,d){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-n)*d|0)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-l)*d|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function kf(r){let e=r,n=r;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==r);return n}function Bf(r,e,n,l,d,x,b,S){return(d-b)*(e-S)>=(r-b)*(x-S)&&(r-b)*(l-S)>=(n-b)*(e-S)&&(n-b)*(x-S)>=(d-b)*(l-S)}function Lu(r,e,n,l,d,x,b,S){return!(r===b&&e===S)&&Bf(r,e,n,l,d,x,b,S)}function Of(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!function(n,l){let d=n;do{if(d.i!==n.i&&d.next.i!==n.i&&d.i!==l.i&&d.next.i!==l.i&&Zl(d,d.next,n,l))return!0;d=d.next}while(d!==n);return!1}(r,e)&&(ch(r,e)&&ch(e,r)&&function(n,l){let d=n,x=!1;const b=(n.x+l.x)/2,S=(n.y+l.y)/2;do d.y>S!=d.next.y>S&&d.next.y!==d.y&&b<(d.next.x-d.x)*(S-d.y)/(d.next.y-d.y)+d.x&&(x=!x),d=d.next;while(d!==n);return x}(r,e)&&(jn(r.prev,r,e.prev)||jn(r,e.prev,e))||Iu(r,e)&&jn(r.prev,r,r.next)>0&&jn(e.prev,e,e.next)>0)}function jn(r,e,n){return(e.y-r.y)*(n.x-e.x)-(e.x-r.x)*(n.y-e.y)}function Iu(r,e){return r.x===e.x&&r.y===e.y}function Zl(r,e,n,l){const d=lh(jn(r,e,n)),x=lh(jn(r,e,l)),b=lh(jn(n,l,r)),S=lh(jn(n,l,e));return d!==x&&b!==S||!(d!==0||!Jn(r,n,e))||!(x!==0||!Jn(r,l,e))||!(b!==0||!Jn(n,r,l))||!(S!==0||!Jn(n,e,l))}function Jn(r,e,n){return e.x<=Math.max(r.x,n.x)&&e.x>=Math.min(r.x,n.x)&&e.y<=Math.max(r.y,n.y)&&e.y>=Math.min(r.y,n.y)}function lh(r){return r>0?1:r<0?-1:0}function ch(r,e){return jn(r.prev,r,r.next)<0?jn(r,e,r.next)>=0&&jn(r,r.prev,e)>=0:jn(r,e,r.prev)<0||jn(r,r.next,e)<0}function $r(r,e){const n=Vd(r.i,r.x,r.y),l=Vd(e.i,e.x,e.y),d=r.next,x=e.prev;return r.next=e,e.prev=r,n.next=d,d.prev=n,l.next=n,n.prev=l,x.next=l,l.prev=x,l}function $p(r,e,n,l){const d=Vd(r,e,n);return l?(d.next=l.next,d.prev=l,l.next.prev=d,l.next=d):(d.prev=d,d.next=d),d}function uh(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Vd(r,e,n){return{i:r,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class yn{constructor(e,n){if(n>e)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=e,this._minGranularity=n}getGranularityForZoomLevel(e){return Math.max(Math.floor(this._baseZoomGranularity/(1<<e)),this._minGranularity,1)}}class Rs{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}}Rs.noSubdivision=new Rs({fill:new yn(0,0),line:new yn(0,0),tile:new yn(0,0),stencil:new yn(0,0),circle:1}),Ee("SubdivisionGranularityExpression",yn),Ee("SubdivisionGranularitySetting",Rs);const Oa=-32768,hh=32767;class Xp{constructor(e,n){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=e,this._granularityCellSize=Ze/e,this._canonical=n}_getKey(e,n){return(e+=32768)<<16|n+32768}_vertexToIndex(e,n){if(e<-32768||n<-32768||e>32767||n>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const l=0|Math.round(e),d=0|Math.round(n),x=this._getKey(l,d);if(this._vertexDictionary.has(x))return this._vertexDictionary.get(x);const b=this._vertexBuffer.length/2;return this._vertexDictionary.set(x,b),this._vertexBuffer.push(l,d),b}_subdivideTrianglesScanline(e){if(this._granularity<2)return function(d,x){const b=[];for(let S=0;S<x.length;S+=3){const E=x[S],k=x[S+1],N=x[S+2],V=d[2*E],q=d[2*E+1];(d[2*k]-V)*(d[2*N+1]-q)-(d[2*k+1]-q)*(d[2*N]-V)>0?(b.push(E),b.push(N),b.push(k)):(b.push(E),b.push(k),b.push(N))}return b}(this._vertexBuffer,e);const n=[],l=e.length;for(let d=0;d<l;d+=3){const x=[e[d+0],e[d+1],e[d+2]],b=[this._vertexBuffer[2*e[d+0]+0],this._vertexBuffer[2*e[d+0]+1],this._vertexBuffer[2*e[d+1]+0],this._vertexBuffer[2*e[d+1]+1],this._vertexBuffer[2*e[d+2]+0],this._vertexBuffer[2*e[d+2]+1]];let S=1/0,E=1/0,k=-1/0,N=-1/0;for(let et=0;et<3;et++){const at=b[2*et],ft=b[2*et+1];S=Math.min(S,at),k=Math.max(k,at),E=Math.min(E,ft),N=Math.max(N,ft)}if(S===k||E===N)continue;const V=Math.floor(S/this._granularityCellSize),q=Math.ceil(k/this._granularityCellSize),W=Math.floor(E/this._granularityCellSize),K=Math.ceil(N/this._granularityCellSize);if(V!==q||W!==K)for(let et=W;et<K;et++){const at=this._scanlineGenerateVertexRingForCellRow(et,b,x);uo(this._vertexBuffer,at,n)}else n.push(...x)}return n}_scanlineGenerateVertexRingForCellRow(e,n,l){const d=e*this._granularityCellSize,x=d+this._granularityCellSize,b=[];for(let S=0;S<3;S++){const E=n[2*S],k=n[2*S+1],N=n[2*(S+1)%6],V=n[(2*(S+1)+1)%6],q=n[2*(S+2)%6],W=n[(2*(S+2)+1)%6],K=N-E,et=V-k,at=K===0,ft=et===0,Dt=(d-k)/et,xt=(x-k)/et,Mt=Math.min(Dt,xt),jt=Math.max(Dt,xt);if(!ft&&(Mt>=1||jt<=0)||ft&&(k<d||k>x)){V>=d&&V<=x&&b.push(l[(S+1)%3]);continue}!ft&&Mt>0&&b.push(this._vertexToIndex(E+K*Mt,k+et*Mt));const $t=E+K*Math.max(Mt,0),se=E+K*Math.min(jt,1);at||this._generateIntraEdgeVertices(b,E,k,N,V,$t,se),!ft&&jt<1&&b.push(this._vertexToIndex(E+K*jt,k+et*jt)),(ft||V>=d&&V<=x)&&b.push(l[(S+1)%3]),!ft&&(V<=d||V>=x)&&this._generateInterEdgeVertices(b,E,k,N,V,q,W,se,d,x)}return b}_generateIntraEdgeVertices(e,n,l,d,x,b,S){const E=d-n,k=x-l,N=k===0,V=N?Math.min(n,d):Math.min(b,S),q=N?Math.max(n,d):Math.max(b,S),W=Math.floor(V/this._granularityCellSize)+1,K=Math.ceil(q/this._granularityCellSize)-1;if(N?n<d:b<S)for(let et=W;et<=K;et++){const at=et*this._granularityCellSize;e.push(this._vertexToIndex(at,l+k*(at-n)/E))}else for(let et=K;et>=W;et--){const at=et*this._granularityCellSize;e.push(this._vertexToIndex(at,l+k*(at-n)/E))}}_generateInterEdgeVertices(e,n,l,d,x,b,S,E,k,N){const V=x-l,q=b-d,W=S-x,K=(k-x)/W,et=(N-x)/W,at=Math.min(K,et),ft=Math.max(K,et),Dt=d+q*at;let xt=Math.floor(Math.min(Dt,E)/this._granularityCellSize)+1,Mt=Math.ceil(Math.max(Dt,E)/this._granularityCellSize)-1,jt=E<Dt;const $t=W===0;if($t&&(S===k||S===N))return;if($t||at>=1||ft<=0){const Pe=l-S,ye=b+(n-b)*Math.min((k-S)/Pe,(N-S)/Pe);xt=Math.floor(Math.min(ye,E)/this._granularityCellSize)+1,Mt=Math.ceil(Math.max(ye,E)/this._granularityCellSize)-1,jt=E<ye}const se=V>0?N:k;if(jt)for(let Pe=xt;Pe<=Mt;Pe++)e.push(this._vertexToIndex(Pe*this._granularityCellSize,se));else for(let Pe=Mt;Pe>=xt;Pe--)e.push(this._vertexToIndex(Pe*this._granularityCellSize,se))}_generateOutline(e){const n=[];for(const l of e){const d=Mc(l,this._granularity,!0),x=this._pointArrayToIndices(d),b=[];for(let S=1;S<x.length;S++)b.push(x[S-1]),b.push(x[S]);n.push(b)}return n}_handlePoles(e){let n=!1,l=!1;this._canonical&&(this._canonical.y===0&&(n=!0),this._canonical.y===(1<<this._canonical.z)-1&&(l=!0)),(n||l)&&this._fillPoles(e,n,l)}_ensureNoPoleVertices(){const e=this._vertexBuffer;for(let n=0;n<e.length;n+=2){const l=e[n+1];l===Oa&&(e[n+1]=-32767),l===hh&&(e[n+1]=32766)}}_generatePoleQuad(e,n,l,d,x,b){d>x!=(b===Oa)?(e.push(n),e.push(l),e.push(this._vertexToIndex(d,b)),e.push(l),e.push(this._vertexToIndex(x,b)),e.push(this._vertexToIndex(d,b))):(e.push(l),e.push(n),e.push(this._vertexToIndex(d,b)),e.push(this._vertexToIndex(x,b)),e.push(l),e.push(this._vertexToIndex(d,b)))}_fillPoles(e,n,l){const d=this._vertexBuffer,x=Ze,b=e.length;for(let S=2;S<b;S+=3){const E=e[S-2],k=e[S-1],N=e[S],V=d[2*E],q=d[2*E+1],W=d[2*k],K=d[2*k+1],et=d[2*N],at=d[2*N+1];n&&(q===0&&K===0&&this._generatePoleQuad(e,E,k,V,W,Oa),K===0&&at===0&&this._generatePoleQuad(e,k,N,W,et,Oa),at===0&&q===0&&this._generatePoleQuad(e,N,E,et,V,Oa)),l&&(q===x&&K===x&&this._generatePoleQuad(e,E,k,V,W,hh),K===x&&at===x&&this._generatePoleQuad(e,k,N,W,et,hh),at===x&&q===x&&this._generatePoleQuad(e,N,E,et,V,hh))}}_initializeVertices(e){for(let n=0;n<e.length;n+=2)this._vertexToIndex(e[n],e[n+1])}subdividePolygonInternal(e,n){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:l,holeIndices:d}=function(S){const E=[],k=[];for(const N of S)if(N.length!==0){N!==S[0]&&E.push(k.length/2);for(let V=0;V<N.length;V++)k.push(N[V].x),k.push(N[V].y)}return{flattened:k,holeIndices:E}}(e);let x;this._initializeVertices(l);try{const S=function(k,N,V=2){const q=N&&N.length,W=q?N[0]*V:k.length;let K=Qn(k,0,W,V,!0);const et=[];if(!K||K.next===K.prev)return et;let at,ft,Dt;if(q&&(K=function(xt,Mt,jt,$t){const se=[];for(let Pe=0,ye=Mt.length;Pe<ye;Pe++){const be=Qn(xt,Mt[Pe]*$t,Pe<ye-1?Mt[Pe+1]*$t:xt.length,$t,!1);be===be.next&&(be.steiner=!0),se.push(kf(be))}se.sort(qp);for(let Pe=0;Pe<se.length;Pe++)jt=Yh(se[Pe],jt);return jt}(k,N,K,V)),k.length>80*V){at=k[0],ft=k[1];let xt=at,Mt=ft;for(let jt=V;jt<W;jt+=V){const $t=k[jt],se=k[jt+1];$t<at&&(at=$t),se<ft&&(ft=se),$t>xt&&(xt=$t),se>Mt&&(Mt=se)}Dt=Math.max(xt-at,Mt-ft),Dt=Dt!==0?32767/Dt:0}return $h(K,et,V,at,ft,Dt,0),et}(l,d),E=this._convertIndices(l,S);x=this._subdivideTrianglesScanline(E)}catch(S){console.error(S)}let b=[];return n&&(b=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(x),{verticesFlattened:this._vertexBuffer,indicesTriangles:x,indicesLineList:b}}_convertIndices(e,n){const l=[];for(let d=0;d<n.length;d++)l.push(this._vertexToIndex(e[2*n[d]],e[2*n[d]+1]));return l}_pointArrayToIndices(e){const n=[];for(let l=0;l<e.length;l++){const d=e[l];n.push(this._vertexToIndex(d.x,d.y))}return n}}function Yp(r,e,n,l=!0){return new Xp(n,e).subdividePolygonInternal(r,l)}function Mc(r,e,n=!1){if(!r||r.length<1)return[];if(r.length<2)return[];const l=r[0],d=r[r.length-1],x=n&&(l.x!==d.x||l.y!==d.y);if(e<2)return x?[...r,r[0]]:[...r];const b=Math.floor(Ze/e),S=[];S.push(new H(r[0].x,r[0].y));const E=r.length,k=x?E:E-1;for(let N=0;N<k;N++){const V=r[N],q=N<E-1?r[N+1]:r[0],W=V.x,K=V.y,et=q.x,at=q.y,ft=W!==et,Dt=K!==at;if(!ft&&!Dt)continue;const xt=et-W,Mt=at-K,jt=Math.abs(xt),$t=Math.abs(Mt);let se=W,Pe=K;for(;;){const be=xt>0?(Math.floor(se/b)+1)*b:(Math.ceil(se/b)-1)*b,He=Mt>0?(Math.floor(Pe/b)+1)*b:(Math.ceil(Pe/b)-1)*b,Ae=Math.abs(se-be),Te=Math.abs(Pe-He),te=Math.abs(se-et),ei=Math.abs(Pe-at),ni=ft?Ae/jt:Number.POSITIVE_INFINITY,We=Dt?Te/$t:Number.POSITIVE_INFINITY;if((te<=Ae||!ft)&&(ei<=Te||!Dt))break;if(ni<We&&ft||!Dt){se=be,Pe+=Mt*ni;const Be=new H(se,Math.round(Pe));S[S.length-1].x===Be.x&&S[S.length-1].y===Be.y||S.push(Be)}else{se+=xt*We,Pe=He;const Be=new H(Math.round(se),Pe);S[S.length-1].x===Be.x&&S[S.length-1].y===Be.y||S.push(Be)}}const ye=new H(et,at);S[S.length-1].x===ye.x&&S[S.length-1].y===ye.y||S.push(ye)}return S}function uo(r,e,n){if(e.length===0)throw new Error("Subdivision vertex ring is empty.");let l=0,d=r[2*e[0]];for(let E=1;E<e.length;E++){const k=r[2*e[E]];k<d&&(d=k,l=E)}const x=e.length;let b=l,S=(b+1)%x;for(;;){const E=b-1>=0?b-1:x-1,k=(S+1)%x,N=r[2*e[E]],V=r[2*e[k]],q=r[2*e[b]],W=r[2*e[b]+1],K=r[2*e[S]+1];let et=!1;if(N<V)et=!0;else if(N>V)et=!1;else{const at=K-W,ft=-(r[2*e[S]]-q),Dt=W<K?1:-1;((N-q)*at+(r[2*e[E]+1]-W)*ft)*Dt>((V-q)*at+(r[2*e[k]+1]-W)*ft)*Dt&&(et=!0)}if(et){const at=e[E],ft=e[b],Dt=e[S];at!==ft&&at!==Dt&&ft!==Dt&&n.push(Dt,ft,at),b--,b<0&&(b=x-1)}else{const at=e[k],ft=e[b],Dt=e[S];at!==ft&&at!==Dt&&ft!==Dt&&n.push(Dt,ft,at),S++,S>=x&&(S=0)}if(E===k)break}}function Vo(r,e,n,l,d,x,b,S,E){const k=d.length/2,N=b&&S&&E;if(k<mi.MAX_VERTEX_ARRAY_LENGTH){const V=e.prepareSegment(k,n,l),q=V.vertexLength;for(let et=0;et<x.length;et+=3)l.emplaceBack(q+x[et],q+x[et+1],q+x[et+2]);let W,K;V.vertexLength+=k,V.primitiveLength+=x.length/3,N&&(K=b.prepareSegment(k,n,S),W=K.vertexLength,K.vertexLength+=k);for(let et=0;et<d.length;et+=2)r(d[et],d[et+1]);if(N)for(let et=0;et<E.length;et++){const at=E[et];for(let ft=1;ft<at.length;ft+=2)S.emplaceBack(W+at[ft-1],W+at[ft]);K.primitiveLength+=at.length/2}}else(function(V,q,W,K,et,at){const ft=[];for(let $t=0;$t<K.length/2;$t++)ft.push(-1);const Dt={count:0};let xt=0,Mt=V.getOrCreateLatestSegment(q,W),jt=Mt.vertexLength;for(let $t=2;$t<et.length;$t+=3){const se=et[$t-2],Pe=et[$t-1],ye=et[$t];let be=ft[se]<xt,He=ft[Pe]<xt,Ae=ft[ye]<xt;Mt.vertexLength+((be?1:0)+(He?1:0)+(Ae?1:0))>mi.MAX_VERTEX_ARRAY_LENGTH&&(Mt=V.createNewSegment(q,W),xt=Dt.count,be=!0,He=!0,Ae=!0,jt=0);const Te=dh(ft,K,at,Dt,se,be,Mt),te=dh(ft,K,at,Dt,Pe,He,Mt),ei=dh(ft,K,at,Dt,ye,Ae,Mt);W.emplaceBack(jt+Te-xt,jt+te-xt,jt+ei-xt),Mt.primitiveLength++}})(e,n,l,d,x,r),N&&function(V,q,W,K,et,at){const ft=[];for(let $t=0;$t<K.length/2;$t++)ft.push(-1);const Dt={count:0};let xt=0,Mt=V.getOrCreateLatestSegment(q,W),jt=Mt.vertexLength;for(let $t=0;$t<et.length;$t++){const se=et[$t];for(let Pe=1;Pe<et[$t].length;Pe+=2){const ye=se[Pe-1],be=se[Pe];let He=ft[ye]<xt,Ae=ft[be]<xt;Mt.vertexLength+((He?1:0)+(Ae?1:0))>mi.MAX_VERTEX_ARRAY_LENGTH&&(Mt=V.createNewSegment(q,W),xt=Dt.count,He=!0,Ae=!0,jt=0);const Te=dh(ft,K,at,Dt,ye,He,Mt),te=dh(ft,K,at,Dt,be,Ae,Mt);W.emplaceBack(jt+Te-xt,jt+te-xt),Mt.primitiveLength++}}}(b,n,S,d,E,r),e.forceNewSegmentOnNextPrepare(),b?.forceNewSegmentOnNextPrepare()}function dh(r,e,n,l,d,x,b){if(x){const S=l.count;return n(e[2*d],e[2*d+1]),r[d]=l.count,l.count++,b.vertexLength++,S}return r[d]}class ca{constructor(e){this.zoom=e.zoom,this.globalState=e.globalState,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Gt,this.indexArray=new Yi,this.indexArray2=new Gi,this.programConfigurations=new Kn(e.layers,e.zoom),this.segments=new mi,this.segments2=new mi,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,l){this.hasPattern=oh("fill",this.layers,n);const d=this.layers[0].layout.get("fill-sort-key"),x=!d.isConstant(),b=[];for(const{feature:S,id:E,index:k,sourceLayerIndex:N}of e){const V=this.layers[0]._featureFilter.needGeometry,q=Ba(S,V);if(!this.layers[0]._featureFilter.filter(new cn(this.zoom,{globalState:this.globalState}),q,l))continue;const W=x?d.evaluate(q,{},l,n.availableImages):void 0,K={id:E,properties:S.properties,type:S.type,sourceLayerIndex:N,index:k,geometry:V?q.geometry:Tn(S),patterns:{},sortKey:W};b.push(K)}x&&b.sort((S,E)=>S.sortKey-E.sortKey);for(const S of b){const{geometry:E,index:k,sourceLayerIndex:N}=S;if(this.hasPattern){const V=zu("fill",this.layers,S,this.zoom,n);this.patternFeatures.push(V)}else this.addFeature(S,E,k,l,{},n.subdivisionGranularity);n.featureIndex.insert(e[k].feature,E,k,N,this.index)}}update(e,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,l)}addFeatures(e,n,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,n,l,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Zp),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,l,d,x,b){for(const S of Sl(n,500)){const E=Yp(S,d,b.fill.getGranularityForZoomLevel(d.z)),k=this.layoutVertexArray;Vo((N,V)=>{k.emplaceBack(N,V)},this.segments,this.layoutVertexArray,this.indexArray,E.verticesFlattened,E.indicesTriangles,this.segments2,this.indexArray2,E.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,x,d)}}let Nf,Pc;Ee("FillBucket",ca,{omit:["layers","patternFeatures"]});var Ru={get paint(){return Pc=Pc||new zs({"fill-antialias":new Re(It.paint_fill["fill-antialias"]),"fill-opacity":new Xe(It.paint_fill["fill-opacity"]),"fill-color":new Xe(It.paint_fill["fill-color"]),"fill-outline-color":new Xe(It.paint_fill["fill-outline-color"]),"fill-translate":new Re(It.paint_fill["fill-translate"]),"fill-translate-anchor":new Re(It.paint_fill["fill-translate-anchor"]),"fill-pattern":new bc(It.paint_fill["fill-pattern"])})},get layout(){return Nf=Nf||new zs({"fill-sort-key":new Xe(It.layout_fill["fill-sort-key"])})}};class tu extends Xs{constructor(e){super(e,Ru)}recalculate(e,n){super.recalculate(e,n);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new ca(e)}queryRadius(){return Gh(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:n,transform:l,pixelsToTileUnits:d}){return Uh(zr(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-l.bearingInRadians,d),n)}isTileClipped(){return!0}}const jf=Yn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Ff=Yn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Gl}=jf;class ku{constructor(e,n,l,d,x){this.properties={},this.extent=l,this.type=0,this.id=void 0,this._pbf=e,this._geometry=-1,this._keys=d,this._values=x,e.readFields(fh,this,n)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos,l=[];let d,x=1,b=0,S=0,E=0;for(;e.pos<n;){if(b<=0){const k=e.readVarint();x=7&k,b=k>>3}if(b--,x===1||x===2)S+=e.readSVarint(),E+=e.readSVarint(),x===1&&(d&&l.push(d),d=[]),d&&d.push(new H(S,E));else{if(x!==7)throw new Error(`unknown command ${x}`);d&&d.push(d[0].clone())}}return d&&l.push(d),l}bbox(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos;let l=1,d=0,x=0,b=0,S=1/0,E=-1/0,k=1/0,N=-1/0;for(;e.pos<n;){if(d<=0){const V=e.readVarint();l=7&V,d=V>>3}if(d--,l===1||l===2)x+=e.readSVarint(),b+=e.readSVarint(),x<S&&(S=x),x>E&&(E=x),b<k&&(k=b),b>N&&(N=b);else if(l!==7)throw new Error(`unknown command ${l}`)}return[S,k,E,N]}toGeoJSON(e,n,l){const d=this.extent*Math.pow(2,l),x=this.extent*e,b=this.extent*n,S=this.loadGeometry();function E(q){return[360*(q.x+x)/d-180,360/Math.PI*Math.atan(Math.exp((1-2*(q.y+b)/d)*Math.PI))-90]}function k(q){return q.map(E)}let N;if(this.type===1){const q=[];for(const K of S)q.push(K[0]);const W=k(q);N=q.length===1?{type:"Point",coordinates:W[0]}:{type:"MultiPoint",coordinates:W}}else if(this.type===2){const q=S.map(k);N=q.length===1?{type:"LineString",coordinates:q[0]}:{type:"MultiLineString",coordinates:q}}else{if(this.type!==3)throw new Error("unknown feature type");{const q=function(K){const et=K.length;if(et<=1)return[K];const at=[];let ft,Dt;for(let xt=0;xt<et;xt++){const Mt=Wh(K[xt]);Mt!==0&&(Dt===void 0&&(Dt=Mt<0),Dt===Mt<0?(ft&&at.push(ft),ft=[K[xt]]):ft&&ft.push(K[xt]))}return ft&&at.push(ft),at}(S),W=[];for(const K of q)W.push(K.map(k));N=W.length===1?{type:"Polygon",coordinates:W[0]}:{type:"MultiPolygon",coordinates:W}}}const V={type:"Feature",geometry:N,properties:this.properties};return this.id!=null&&(V.id=this.id),V}}function fh(r,e,n){r===1?e.id=n.readVarint():r===2?function(l,d){const x=l.readVarint()+l.pos;for(;l.pos<x;){const b=d._keys[l.readVarint()],S=d._values[l.readVarint()];d.properties[b]=S}}(n,e):r===3?e.type=n.readVarint():r===4&&(e._geometry=n.pos)}function Wh(r){let e=0;for(let n,l,d=0,x=r.length,b=x-1;d<x;b=d++)n=r[d],l=r[b],e+=(l.x-n.x)*(n.y+l.y);return e}ku.types=["Unknown","Point","LineString","Polygon"];class ph{constructor(e,n){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(mh,this,n),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const n=this._pbf.readVarint()+this._pbf.pos;return new ku(this._pbf,n,this.extent,this._keys,this._values)}}function mh(r,e,n){r===15?e.version=n.readVarint():r===1?e.name=n.readString():r===5?e.extent=n.readVarint():r===2?e._features.push(n.pos):r===3?e._keys.push(n.readString()):r===4&&e._values.push(function(l){let d=null;const x=l.readVarint()+l.pos;for(;l.pos<x;){const b=l.readVarint()>>3;d=b===1?l.readString():b===2?l.readFloat():b===3?l.readDouble():b===4?l.readVarint64():b===5?l.readVarint():b===6?l.readSVarint():b===7?l.readBoolean():null}if(d==null)throw new Error("unknown feature value");return d}(n))}class Vf{constructor(e,n){this.layers=e.readFields(Wp,{},n)}}function Wp(r,e,n){if(r===3){const l=new ph(n,n.readVarint()+n.pos);l.length&&(e[l.name]=l)}}const Bu=Math.pow(2,13);function _h(r,e,n,l,d,x,b,S){r.emplaceBack(e,n,2*Math.floor(l*Bu)+b,d*Bu*2,x*Bu*2,Math.round(S))}class gh{constructor(e){this.zoom=e.zoom,this.globalState=e.globalState,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ot,this.centroidVertexArray=new gt,this.indexArray=new Yi,this.programConfigurations=new Kn(e.layers,e.zoom),this.segments=new mi,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,l){this.features=[],this.hasPattern=oh("fill-extrusion",this.layers,n);for(const{feature:d,id:x,index:b,sourceLayerIndex:S}of e){const E=this.layers[0]._featureFilter.needGeometry,k=Ba(d,E);if(!this.layers[0]._featureFilter.filter(new cn(this.zoom,{globalState:this.globalState}),k,l))continue;const N={id:x,sourceLayerIndex:S,index:b,geometry:E?k.geometry:Tn(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(zu("fill-extrusion",this.layers,N,this.zoom,n)):this.addFeature(N,N.geometry,b,l,{},n.subdivisionGranularity),n.featureIndex.insert(d,N.geometry,b,S,this.index,!0)}}addFeatures(e,n,l){for(const d of this.features){const{geometry:x}=d;this.addFeature(d,x,d.index,n,l,e.subdivisionGranularity)}}update(e,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Gl),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Ff.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,n,l,d,x,b){for(const S of Sl(n,500)){const E={x:0,y:0,sampleCount:0},k=this.layoutVertexArray.length;this.processPolygon(E,d,e,S,b);const N=this.layoutVertexArray.length-k,V=Math.floor(E.x/E.sampleCount),q=Math.floor(E.y/E.sampleCount);for(let W=0;W<N;W++)this.centroidVertexArray.emplaceBack(V,q)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,x,d)}processPolygon(e,n,l,d,x){if(d.length<1||Qp(d[0]))return;for(const V of d)V.length!==0&&Kp(e,V);const b={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},S=x.fill.getGranularityForZoomLevel(n.z),E=ku.types[l.type]==="Polygon";for(const V of d){if(V.length===0||Qp(V))continue;const q=Mc(V,S,E);this._generateSideFaces(q,b)}if(!E)return;const k=Yp(d,n,S,!1),N=this.layoutVertexArray;Vo((V,q)=>{_h(N,V,q,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,k.verticesFlattened,k.indicesTriangles)}_generateSideFaces(e,n){let l=0;for(let d=1;d<e.length;d++){const x=e[d],b=e[d-1];if(Xm(x,b))continue;n.segment.vertexLength+4>mi.MAX_VERTEX_ARRAY_LENGTH&&(n.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const S=x.sub(b)._perp()._unit(),E=b.dist(x);l+E>32768&&(l=0),_h(this.layoutVertexArray,x.x,x.y,S.x,S.y,0,0,l),_h(this.layoutVertexArray,x.x,x.y,S.x,S.y,0,1,l),l+=E,_h(this.layoutVertexArray,b.x,b.y,S.x,S.y,0,0,l),_h(this.layoutVertexArray,b.x,b.y,S.x,S.y,0,1,l);const k=n.segment.vertexLength;this.indexArray.emplaceBack(k,k+2,k+1),this.indexArray.emplaceBack(k+1,k+2,k+3),n.segment.vertexLength+=4,n.segment.primitiveLength+=2}}}function Kp(r,e){for(let n=0;n<e.length;n++){const l=e[n];n===e.length-1&&e[0].x===l.x&&e[0].y===l.y||(r.x+=l.x,r.y+=l.y,r.sampleCount++)}}function Xm(r,e){return r.x===e.x&&(r.x<0||r.x>Ze)||r.y===e.y&&(r.y<0||r.y>Ze)}function Qp(r){return r.every(e=>e.x<0)||r.every(e=>e.x>Ze)||r.every(e=>e.y<0)||r.every(e=>e.y>Ze)}let un;Ee("FillExtrusionBucket",gh,{omit:["layers","features"]});var Fn={get paint(){return un=un||new zs({"fill-extrusion-opacity":new Re(It["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Xe(It["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Re(It["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Re(It["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new bc(It["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Xe(It["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Xe(It["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Re(It["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class ji extends Xs{constructor(e){super(e,Fn)}createBucket(e){return new gh(e)}queryRadius(){return Gh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:n,featureState:l,geometry:d,transform:x,pixelsToTileUnits:b,pixelPosMatrix:S}){const E=zr(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-x.bearingInRadians,b),k=this.paint.get("fill-extrusion-height").evaluate(n,l),N=this.paint.get("fill-extrusion-base").evaluate(n,l),V=function(W,K){const et=[];for(const at of W){const ft=[at.x,at.y,0,1];Rn(ft,ft,K),et.push(new H(ft[0]/ft[3],ft[1]/ft[3]))}return et}(E,S),q=function(W,K,et,at){const ft=[],Dt=[],xt=at[8]*K,Mt=at[9]*K,jt=at[10]*K,$t=at[11]*K,se=at[8]*et,Pe=at[9]*et,ye=at[10]*et,be=at[11]*et;for(const He of W){const Ae=[],Te=[];for(const te of He){const ei=te.x,ni=te.y,We=at[0]*ei+at[4]*ni+at[12],Be=at[1]*ei+at[5]*ni+at[13],vi=at[2]*ei+at[6]*ni+at[14],Ki=at[3]*ei+at[7]*ni+at[15],Mn=vi+jt,vr=Ki+$t,Bs=We+se,xr=Be+Pe,Yr=vi+ye,In=Ki+be,tr=new H((We+xt)/vr,(Be+Mt)/vr);tr.z=Mn/vr,Ae.push(tr);const Wr=new H(Bs/In,xr/In);Wr.z=Yr/In,Te.push(Wr)}ft.push(Ae),Dt.push(Te)}return[ft,Dt]}(d,N,k,S);return function(W,K,et){let at=1/0;Uh(et,K)&&(at=hn(et,K[0]));for(let ft=0;ft<K.length;ft++){const Dt=K[ft],xt=W[ft];for(let Mt=0;Mt<Dt.length-1;Mt++){const jt=Dt[Mt],$t=[jt,Dt[Mt+1],xt[Mt+1],xt[Mt],jt];Pf(et,$t)&&(at=Math.min(at,hn(et,$t)))}}return at!==1/0&&at}(q[0],q[1],V)}}function ki(r,e){return r.x*e.x+r.y*e.y}function hn(r,e){if(r.length===1){let n=0;const l=e[n++];let d;for(;!d||l.equals(d);)if(d=e[n++],!d)return 1/0;for(;n<e.length;n++){const x=e[n],b=r[0],S=d.sub(l),E=x.sub(l),k=b.sub(l),N=ki(S,S),V=ki(S,E),q=ki(E,E),W=ki(k,S),K=ki(k,E),et=N*q-V*V,at=(q*W-V*K)/et,ft=(N*K-V*W)/et,Dt=l.z*(1-at-ft)+d.z*at+x.z*ft;if(isFinite(Dt))return Dt}return 1/0}{let n=1/0;for(const l of e)n=Math.min(n,l.z);return n}}const ho=Yn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:eu}=ho,yh=Yn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Uf}=yh,Ac=Math.cos(Math.PI/180*37.5),ur=Math.pow(2,14)/.5;class Hl{constructor(e){this.zoom=e.zoom,this.globalState=e.globalState,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new Nt,this.layoutVertexArray2=new Ut,this.indexArray=new Yi,this.programConfigurations=new Kn(e.layers,e.zoom),this.segments=new mi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,l){this.hasPattern=oh("line",this.layers,n);const d=this.layers[0].layout.get("line-sort-key"),x=!d.isConstant(),b=[];for(const{feature:S,id:E,index:k,sourceLayerIndex:N}of e){const V=this.layers[0]._featureFilter.needGeometry,q=Ba(S,V);if(!this.layers[0]._featureFilter.filter(new cn(this.zoom,{globalState:this.globalState}),q,l))continue;const W=x?d.evaluate(q,{},l):void 0,K={id:E,properties:S.properties,type:S.type,sourceLayerIndex:N,index:k,geometry:V?q.geometry:Tn(S),patterns:{},sortKey:W};b.push(K)}x&&b.sort((S,E)=>S.sortKey-E.sortKey);for(const S of b){const{geometry:E,index:k,sourceLayerIndex:N}=S;if(this.hasPattern){const V=zu("line",this.layers,S,this.zoom,n);this.patternFeatures.push(V)}else this.addFeature(S,E,k,l,{},n.subdivisionGranularity);n.featureIndex.insert(e[k].feature,E,k,N,this.index)}}update(e,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,l)}addFeatures(e,n,l){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,n,l,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Uf)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,eu),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,l,d,x,b){const S=this.layers[0].layout,E=S.get("line-join").evaluate(e,{}),k=S.get("line-cap"),N=S.get("line-miter-limit"),V=S.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const q of n)this.addLine(q,e,E,k,N,V,d,b);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,x,d)}addLine(e,n,l,d,x,b,S,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e=Mc(e,S?E.line.getGranularityForZoomLevel(S.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let xt=0;xt<e.length-1;xt++)this.totalDistance+=e[xt].dist(e[xt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const k=ku.types[n.type]==="Polygon";let N=e.length;for(;N>=2&&e[N-1].equals(e[N-2]);)N--;let V=0;for(;V<N-1&&e[V].equals(e[V+1]);)V++;if(N<(k?3:2))return;l==="bevel"&&(x=1.05);const q=this.overscaling<=16?122880/(512*this.overscaling):0,W=this.segments.prepareSegment(10*N,this.layoutVertexArray,this.indexArray);let K,et,at,ft,Dt;this.e1=this.e2=-1,k&&(K=e[N-2],Dt=e[V].sub(K)._unit()._perp());for(let xt=V;xt<N;xt++){if(at=xt===N-1?k?e[V+1]:void 0:e[xt+1],at&&e[xt].equals(at))continue;Dt&&(ft=Dt),K&&(et=K),K=e[xt],Dt=at?at.sub(K)._unit()._perp():ft,ft=ft||Dt;let Mt=ft.add(Dt);Mt.x===0&&Mt.y===0||Mt._unit();const jt=ft.x*Dt.x+ft.y*Dt.y,$t=Mt.x*Dt.x+Mt.y*Dt.y,se=$t!==0?1/$t:1/0,Pe=2*Math.sqrt(2-2*$t),ye=$t<Ac&&et&&at,be=ft.x*Dt.y-ft.y*Dt.x>0;if(ye&&xt>V){const Te=K.dist(et);if(Te>2*q){const te=K.sub(K.sub(et)._mult(q/Te)._round());this.updateDistance(et,te),this.addCurrentVertex(te,ft,0,0,W),et=te}}const He=et&&at;let Ae=He?l:k?"butt":d;if(He&&Ae==="round"&&(se<b?Ae="miter":se<=2&&(Ae="fakeround")),Ae==="miter"&&se>x&&(Ae="bevel"),Ae==="bevel"&&(se>2&&(Ae="flipbevel"),se<x&&(Ae="miter")),et&&this.updateDistance(et,K),Ae==="miter")Mt._mult(se),this.addCurrentVertex(K,Mt,0,0,W);else if(Ae==="flipbevel"){if(se>100)Mt=Dt.mult(-1);else{const Te=se*ft.add(Dt).mag()/ft.sub(Dt).mag();Mt._perp()._mult(Te*(be?-1:1))}this.addCurrentVertex(K,Mt,0,0,W),this.addCurrentVertex(K,Mt.mult(-1),0,0,W)}else if(Ae==="bevel"||Ae==="fakeround"){const Te=-Math.sqrt(se*se-1),te=be?Te:0,ei=be?0:Te;if(et&&this.addCurrentVertex(K,ft,te,ei,W),Ae==="fakeround"){const ni=Math.round(180*Pe/Math.PI/20);for(let We=1;We<ni;We++){let Be=We/ni;if(Be!==.5){const Ki=Be-.5;Be+=Be*Ki*(Be-1)*((1.0904+jt*(jt*(3.55645-1.43519*jt)-3.2452))*Ki*Ki+(.848013+jt*(.215638*jt-1.06021)))}const vi=Dt.sub(ft)._mult(Be)._add(ft)._unit()._mult(be?-1:1);this.addHalfVertex(K,vi.x,vi.y,!1,be,0,W)}}at&&this.addCurrentVertex(K,Dt,-te,-ei,W)}else if(Ae==="butt")this.addCurrentVertex(K,Mt,0,0,W);else if(Ae==="square"){const Te=et?1:-1;this.addCurrentVertex(K,Mt,Te,Te,W)}else Ae==="round"&&(et&&(this.addCurrentVertex(K,ft,0,0,W),this.addCurrentVertex(K,ft,1,1,W,!0)),at&&(this.addCurrentVertex(K,Dt,-1,-1,W,!0),this.addCurrentVertex(K,Dt,0,0,W)));if(ye&&xt<N-1){const Te=K.dist(at);if(Te>2*q){const te=K.add(at.sub(K)._mult(q/Te)._round());this.updateDistance(K,te),this.addCurrentVertex(te,Dt,0,0,W),K=te}}}}addCurrentVertex(e,n,l,d,x,b=!1){const S=n.y*d-n.x,E=-n.y-n.x*d;this.addHalfVertex(e,n.x+n.y*l,n.y-n.x*l,b,!1,l,x),this.addHalfVertex(e,S,E,b,!0,-d,x),this.distance>ur/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,n,l,d,x,b))}addHalfVertex({x:e,y:n},l,d,x,b,S,E){const k=.5*(this.lineClips?this.scaledDistance*(ur-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(x?1:0),(n<<1)+(b?1:0),Math.round(63*l)+128,Math.round(63*d)+128,1+(S===0?0:S<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const N=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,N,this.e2),E.primitiveLength++),b?this.e2=N:this.e1=N}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}let iu,Ud;Ee("LineBucket",Hl,{omit:["layers","patternFeatures"]});var fo={get paint(){return Ud=Ud||new zs({"line-opacity":new Xe(It.paint_line["line-opacity"]),"line-color":new Xe(It.paint_line["line-color"]),"line-translate":new Re(It.paint_line["line-translate"]),"line-translate-anchor":new Re(It.paint_line["line-translate-anchor"]),"line-width":new Xe(It.paint_line["line-width"]),"line-gap-width":new Xe(It.paint_line["line-gap-width"]),"line-offset":new Xe(It.paint_line["line-offset"]),"line-blur":new Xe(It.paint_line["line-blur"]),"line-dasharray":new La(It.paint_line["line-dasharray"]),"line-pattern":new bc(It.paint_line["line-pattern"]),"line-gradient":new il(It.paint_line["line-gradient"])})},get layout(){return iu=iu||new zs({"line-cap":new Re(It.layout_line["line-cap"]),"line-join":new Xe(It.layout_line["line-join"]),"line-miter-limit":new Re(It.layout_line["line-miter-limit"]),"line-round-limit":new Re(It.layout_line["line-round-limit"]),"line-sort-key":new Xe(It.layout_line["line-sort-key"])})}};class vh extends Xe{possiblyEvaluate(e,n){return n=new cn(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(e,n)}evaluate(e,n,l,d){return n=xi({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(e,n,l,d)}}let nu;class Na extends Xs{constructor(e){super(e,fo),this.gradientVersion=0,nu||(nu=new vh(fo.paint.properties["line-width"].specification),nu.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(n)&&n._styleExpression.expression instanceof Bn,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,n){super.recalculate(e,n),this.paint._values["line-floorwidth"]=nu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Hl(e)}queryRadius(e){const n=e,l=Zd(Zh("line-width",this,n),Zh("line-gap-width",this,n)),d=Zh("line-offset",this,n);return l/2+Math.abs(d)+Gh(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:n,featureState:l,geometry:d,transform:x,pixelsToTileUnits:b}){const S=zr(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-x.bearingInRadians,b),E=b/2*Zd(this.paint.get("line-width").evaluate(n,l),this.paint.get("line-gap-width").evaluate(n,l)),k=this.paint.get("line-offset").evaluate(n,l);return k&&(d=function(N,V){const q=[];for(let W=0;W<N.length;W++){const K=N[W],et=[];for(let at=0;at<K.length;at++){const ft=K[at-1],Dt=K[at],xt=K[at+1],Mt=at===0?new H(0,0):Dt.sub(ft)._unit()._perp(),jt=at===K.length-1?new H(0,0):xt.sub(Dt)._unit()._perp(),$t=Mt._add(jt)._unit(),se=$t.x*jt.x+$t.y*jt.y;se!==0&&$t._mult(1/se),et.push($t._mult(V)._add(Dt))}q.push(et)}return q}(d,k*b)),function(N,V,q){for(let W=0;W<V.length;W++){const K=V[W];if(N.length>=3){for(let et=0;et<K.length;et++)if(Cu(N,K[et]))return!0}if(Rp(N,K,q))return!0}return!1}(S,d,E)}isTileClipped(){return!0}}function Zd(r,e){return e>0?e+2*r:r}const Zf=Yn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Gd=Yn([{name:"a_projected_pos",components:3,type:"Float32"}],4);Yn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Hd=Yn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Yn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Cc=Yn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ks=Yn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ru(r,e,n){return r.sections.forEach(l=>{l.text=function(d,x,b){const S=x.layout.get("text-transform").evaluate(b,{});return S==="uppercase"?d=d.toLocaleUpperCase():S==="lowercase"&&(d=d.toLocaleLowerCase()),hs.applyArabicShaping&&(d=hs.applyArabicShaping(d)),d}(l.text,e,n)}),r}Yn([{name:"triangle",components:3,type:"Uint16"}]),Yn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Yn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Yn([{type:"Float32",name:"offsetX"}]),Yn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Yn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const ql={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Hn=24;const Kh=4294967296,qd=1/Kh,Gf=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class Ou{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,n,l=this.length){for(;this.pos<l;){const d=this.readVarint(),x=d>>3,b=this.pos;this.type=7&d,e(x,n,this),this.pos===b&&this.skip(d)}return n}readMessage(e,n){return this.readFields(e,n,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Kh;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Kh;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const n=this.buf;let l,d;return d=n[this.pos++],l=127&d,d<128?l:(d=n[this.pos++],l|=(127&d)<<7,d<128?l:(d=n[this.pos++],l|=(127&d)<<14,d<128?l:(d=n[this.pos++],l|=(127&d)<<21,d<128?l:(d=n[this.pos],l|=(15&d)<<28,function(x,b,S){const E=S.buf;let k,N;if(N=E[S.pos++],k=(112&N)>>4,N<128||(N=E[S.pos++],k|=(127&N)<<3,N<128)||(N=E[S.pos++],k|=(127&N)<<10,N<128)||(N=E[S.pos++],k|=(127&N)<<17,N<128)||(N=E[S.pos++],k|=(127&N)<<24,N<128)||(N=E[S.pos++],k|=(1&N)<<31,N<128))return su(x,k,b);throw new Error("Expected varint not more than 10 bytes")}(l,e,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2==1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,n=this.pos;return this.pos=e,e-n>=12&&Gf?Gf.decode(this.buf.subarray(n,e)):function(l,d,x){let b="",S=d;for(;S<x;){const E=l[S];let k,N,V,q=null,W=E>239?4:E>223?3:E>191?2:1;if(S+W>x)break;W===1?E<128&&(q=E):W===2?(k=l[S+1],(192&k)==128&&(q=(31&E)<<6|63&k,q<=127&&(q=null))):W===3?(k=l[S+1],N=l[S+2],(192&k)==128&&(192&N)==128&&(q=(15&E)<<12|(63&k)<<6|63&N,(q<=2047||q>=55296&&q<=57343)&&(q=null))):W===4&&(k=l[S+1],N=l[S+2],V=l[S+3],(192&k)==128&&(192&N)==128&&(192&V)==128&&(q=(15&E)<<18|(63&k)<<12|(63&N)<<6|63&V,(q<=65535||q>=1114112)&&(q=null))),q===null?(q=65533,W=1):q>65535&&(q-=65536,b+=String.fromCharCode(q>>>10&1023|55296),q=56320|1023&q),b+=String.fromCharCode(q),S+=W}return b}(this.buf,n,e)}readBytes(){const e=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,e);return this.pos=e,n}readPackedVarint(e=[],n){const l=this.readPackedEnd();for(;this.pos<l;)e.push(this.readVarint(n));return e}readPackedSVarint(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(e){const n=7&e;if(n===0)for(;this.buf[this.pos++]>127;);else if(n===2)this.pos=this.readVarint()+this.pos;else if(n===5)this.pos+=4;else{if(n!==1)throw new Error(`Unimplemented type: ${n}`);this.pos+=8}}writeTag(e,n){this.writeVarint(e<<3|n)}realloc(e){let n=this.length||16;for(;n<this.pos+e;)n*=2;if(n!==this.length){const l=new Uint8Array(n);l.set(this.buf),this.buf=l,this.dataView=new DataView(l.buffer),this.length=n}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*qd),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*qd),!0),this.pos+=8}writeVarint(e){(e=+e||0)>268435455||e<0?function(n,l){let d,x;if(n>=0?(d=n%4294967296|0,x=n/4294967296|0):(d=~(-n%4294967296),x=~(-n/4294967296),4294967295^d?d=d+1|0:(d=0,x=x+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(b,S,E){E.buf[E.pos++]=127&b|128,b>>>=7,E.buf[E.pos++]=127&b|128,b>>>=7,E.buf[E.pos++]=127&b|128,b>>>=7,E.buf[E.pos++]=127&b|128,E.buf[E.pos]=127&(b>>>=7)}(d,0,l),function(b,S){const E=(7&b)<<4;S.buf[S.pos++]|=E|((b>>>=3)?128:0),b&&(S.buf[S.pos++]=127&b|((b>>>=7)?128:0),b&&(S.buf[S.pos++]=127&b|((b>>>=7)?128:0),b&&(S.buf[S.pos++]=127&b|((b>>>=7)?128:0),b&&(S.buf[S.pos++]=127&b|((b>>>=7)?128:0),b&&(S.buf[S.pos++]=127&b)))))}(x,l)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))}writeSVarint(e){this.writeVarint(e<0?2*-e-1:2*e)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(4*e.length),this.pos++;const n=this.pos;this.pos=function(d,x,b){for(let S,E,k=0;k<x.length;k++){if(S=x.charCodeAt(k),S>55295&&S<57344){if(!E){S>56319||k+1===x.length?(d[b++]=239,d[b++]=191,d[b++]=189):E=S;continue}if(S<56320){d[b++]=239,d[b++]=191,d[b++]=189,E=S;continue}S=E-55296<<10|S-56320|65536,E=null}else E&&(d[b++]=239,d[b++]=191,d[b++]=189,E=null);S<128?d[b++]=S:(S<2048?d[b++]=S>>6|192:(S<65536?d[b++]=S>>12|224:(d[b++]=S>>18|240,d[b++]=S>>12&63|128),d[b++]=S>>6&63|128),d[b++]=63&S|128)}return b}(this.buf,e,this.pos);const l=this.pos-n;l>=128&&ja(n,l,this),this.pos=n-1,this.writeVarint(l),this.pos+=l}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const n=e.length;this.writeVarint(n),this.realloc(n);for(let l=0;l<n;l++)this.buf[this.pos++]=e[l]}writeRawMessage(e,n){this.pos++;const l=this.pos;e(n,this);const d=this.pos-l;d>=128&&ja(l,d,this),this.pos=l-1,this.writeVarint(d),this.pos+=d}writeMessage(e,n,l){this.writeTag(e,2),this.writeRawMessage(n,l)}writePackedVarint(e,n){n.length&&this.writeMessage(e,Jp,n)}writePackedSVarint(e,n){n.length&&this.writeMessage(e,po,n)}writePackedBoolean(e,n){n.length&&this.writeMessage(e,Ym,n)}writePackedFloat(e,n){n.length&&this.writeMessage(e,tm,n)}writePackedDouble(e,n){n.length&&this.writeMessage(e,em,n)}writePackedFixed32(e,n){n.length&&this.writeMessage(e,au,n)}writePackedSFixed32(e,n){n.length&&this.writeMessage(e,$d,n)}writePackedFixed64(e,n){n.length&&this.writeMessage(e,Hf,n)}writePackedSFixed64(e,n){n.length&&this.writeMessage(e,xh,n)}writeBytesField(e,n){this.writeTag(e,2),this.writeBytes(n)}writeFixed32Field(e,n){this.writeTag(e,5),this.writeFixed32(n)}writeSFixed32Field(e,n){this.writeTag(e,5),this.writeSFixed32(n)}writeFixed64Field(e,n){this.writeTag(e,1),this.writeFixed64(n)}writeSFixed64Field(e,n){this.writeTag(e,1),this.writeSFixed64(n)}writeVarintField(e,n){this.writeTag(e,0),this.writeVarint(n)}writeSVarintField(e,n){this.writeTag(e,0),this.writeSVarint(n)}writeStringField(e,n){this.writeTag(e,2),this.writeString(n)}writeFloatField(e,n){this.writeTag(e,5),this.writeFloat(n)}writeDoubleField(e,n){this.writeTag(e,1),this.writeDouble(n)}writeBooleanField(e,n){this.writeVarintField(e,+n)}}function su(r,e,n){return n?4294967296*e+(r>>>0):4294967296*(e>>>0)+(r>>>0)}function ja(r,e,n){const l=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(l);for(let d=n.pos-1;d>=r;d--)n.buf[d+l]=n.buf[d]}function Jp(r,e){for(let n=0;n<r.length;n++)e.writeVarint(r[n])}function po(r,e){for(let n=0;n<r.length;n++)e.writeSVarint(r[n])}function tm(r,e){for(let n=0;n<r.length;n++)e.writeFloat(r[n])}function em(r,e){for(let n=0;n<r.length;n++)e.writeDouble(r[n])}function Ym(r,e){for(let n=0;n<r.length;n++)e.writeBoolean(r[n])}function au(r,e){for(let n=0;n<r.length;n++)e.writeFixed32(r[n])}function $d(r,e){for(let n=0;n<r.length;n++)e.writeSFixed32(r[n])}function Hf(r,e){for(let n=0;n<r.length;n++)e.writeFixed64(r[n])}function xh(r,e){for(let n=0;n<r.length;n++)e.writeSFixed64(r[n])}function im(r,e,n){r===1&&n.readMessage(nm,e)}function nm(r,e,n){if(r===3){const{id:l,bitmap:d,width:x,height:b,left:S,top:E,advance:k}=n.readMessage(rm,{});e.push({id:l,bitmap:new Eu({width:x+6,height:b+6},d),metrics:{width:x,height:b,left:S,top:E,advance:k}})}}function rm(r,e,n){r===1?e.id=n.readVarint():r===2?e.bitmap=n.readBytes():r===3?e.width=n.readVarint():r===4?e.height=n.readVarint():r===5?e.left=n.readSVarint():r===6?e.top=n.readSVarint():r===7&&(e.advance=n.readVarint())}function Xd(r){let e=0,n=0;for(const b of r)e+=b.w*b.h,n=Math.max(n,b.w);r.sort((b,S)=>S.h-b.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let d=0,x=0;for(const b of r)for(let S=l.length-1;S>=0;S--){const E=l[S];if(!(b.w>E.w||b.h>E.h)){if(b.x=E.x,b.y=E.y,x=Math.max(x,b.y+b.h),d=Math.max(d,b.x+b.w),b.w===E.w&&b.h===E.h){const k=l.pop();k&&S<l.length&&(l[S]=k)}else b.h===E.h?(E.x+=b.w,E.w-=b.w):b.w===E.w?(E.y+=b.h,E.h-=b.h):(l.push({x:E.x+b.w,y:E.y,w:E.w-b.w,h:b.h}),E.y+=b.h,E.h-=b.h);break}}return{w:d,h:x,fill:e/(d*x)||0}}class Qh{constructor(e,{pixelRatio:n,version:l,stretchX:d,stretchY:x,content:b,textFitWidth:S,textFitHeight:E}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=d,this.stretchY=x,this.content=b,this.version=l,this.textFitWidth=S,this.textFitHeight=E}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class sm{constructor(e,n){const l={},d={};this.haveRenderCallbacks=[];const x=[];this.addImages(e,l,x),this.addImages(n,d,x);const{w:b,h:S}=Xd(x),E=new Is({width:b||1,height:S||1});for(const k in e){const N=e[k],V=l[k].paddedRect;Is.copy(N.data,E,{x:0,y:0},{x:V.x+1,y:V.y+1},N.data)}for(const k in n){const N=n[k],V=d[k].paddedRect,q=V.x+1,W=V.y+1,K=N.data.width,et=N.data.height;Is.copy(N.data,E,{x:0,y:0},{x:q,y:W},N.data),Is.copy(N.data,E,{x:0,y:et-1},{x:q,y:W-1},{width:K,height:1}),Is.copy(N.data,E,{x:0,y:0},{x:q,y:W+et},{width:K,height:1}),Is.copy(N.data,E,{x:K-1,y:0},{x:q-1,y:W},{width:1,height:et}),Is.copy(N.data,E,{x:0,y:0},{x:q+K,y:W},{width:1,height:et})}this.image=E,this.iconPositions=l,this.patternPositions=d}addImages(e,n,l){for(const d in e){const x=e[d],b={x:0,y:0,w:x.data.width+2,h:x.data.height+2};l.push(b),n[d]=new Qh(b,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(e,n){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in e.updatedImages)this.patchUpdatedImage(this.iconPositions[l],e.getImage(l),n),this.patchUpdatedImage(this.patternPositions[l],e.getImage(l),n)}patchUpdatedImage(e,n,l){if(!e||!n||e.version===n.version)return;e.version=n.version;const[d,x]=e.tl;l.update(n.data,void 0,{x:d,y:x})}}var ou;Ee("ImagePosition",Qh),Ee("ImageAtlas",sm),P.ao=void 0,(ou=P.ao||(P.ao={}))[ou.none=0]="none",ou[ou.horizontal=1]="horizontal",ou[ou.vertical=2]="vertical",ou[ou.horizontalOnly=3]="horizontalOnly";class Jh{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(e,n,l){const d=new Jh;return d.scale=e||1,d.fontStack=n,d.verticalAlign=l||"bottom",d}static forImage(e,n){const l=new Jh;return l.imageName=e,l.verticalAlign=n||"bottom",l}}class Nu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const l=new Nu;for(let d=0;d<e.sections.length;d++){const x=e.sections[d];x.image?l.addImageSection(x):l.addTextSection(x,n)}return l}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let n="";for(let l=0;l<e.length;l++){const d=e.charCodeAt(l+1)||null,x=e.charCodeAt(l-1)||null;n+=d&&nh(d)&&!ql[e[l+1]]||x&&nh(x)&&!ql[e[l-1]]||!ql[e[l]]?e[l]:ql[e[l]]}return n}(this.text)}trim(){let e=0;for(let l=0;l<this.text.length&&Ec[this.text.charCodeAt(l)];l++)e++;let n=this.text.length;for(let l=this.text.length-1;l>=0&&l>=e&&Ec[this.text.charCodeAt(l)];l--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const l=new Nu;return l.text=this.text.substring(e,n),l.sectionIndex=this.sectionIndex.slice(e,n),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}getMaxImageSize(e){let n=0,l=0;for(let d=0;d<this.length();d++){const x=this.getSection(d);if(x.imageName){const b=e[x.imageName];if(!b)continue;const S=b.displaySize;n=Math.max(n,S[0]),l=Math.max(l,S[1])}}return{maxImageWidth:n,maxImageHeight:l}}addTextSection(e,n){this.text+=e.text,this.sections.push(Jh.forText(e.scale,e.fontStack||n,e.verticalAlign));const l=this.sections.length-1;for(let d=0;d<e.text.length;++d)this.sectionIndex.push(l)}addImageSection(e){const n=e.image?e.image.name:"";if(n.length===0)return void An("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Jh.forImage(n,e.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):An("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function td(r,e,n,l,d,x,b,S,E,k,N,V,q,W,K){const et=Nu.fromFeature(r,d);let at;V===P.ao.vertical&&et.verticalizePunctuation();const{processBidirectionalText:ft,processStyledBidirectionalText:Dt}=hs;if(ft&&et.sections.length===1){at=[];const jt=ft(et.toString(),bh(et,k,x,e,l,W));for(const $t of jt){const se=new Nu;se.text=$t,se.sections=et.sections;for(let Pe=0;Pe<$t.length;Pe++)se.sectionIndex.push(0);at.push(se)}}else if(Dt){at=[];const jt=Dt(et.text,et.sectionIndex,bh(et,k,x,e,l,W));for(const $t of jt){const se=new Nu;se.text=$t[0],se.sectionIndex=$t[1],se.sections=et.sections,at.push(se)}}else at=function(jt,$t){const se=[],Pe=jt.text;let ye=0;for(const be of $t)se.push(jt.substring(ye,be)),ye=be;return ye<Pe.length&&se.push(jt.substring(ye,Pe.length)),se}(et,bh(et,k,x,e,l,W));const xt=[],Mt={positionedLines:xt,text:et.toString(),top:N[1],bottom:N[1],left:N[0],right:N[0],writingMode:V,iconsInText:!1,verticalizable:!1};return function(jt,$t,se,Pe,ye,be,He,Ae,Te,te,ei,ni){let We=0,Be=0,vi=0,Ki=0;const Mn=Ae==="right"?1:Ae==="left"?0:.5,vr=Hn/ni;let Bs=0;for(const In of ye){In.trim();const tr=In.getMaxScale(),Wr={positionedGlyphs:[],lineOffset:0};jt.positionedLines[Bs]=Wr;const jr=Wr.positionedGlyphs;let Kr=0;if(!In.length()){Be+=be,++Bs;continue}const Va=lm(Pe,In,vr);for(let _s=0;_s<In.length();_s++){const er=In.getSection(_s),Dr=In.getSectionIndex(_s),ir=In.getCharCode(_s),nr=Wf(Te,ei,ir);let nn;if(er.imageName){if(jt.iconsInText=!0,er.scale=er.scale*vr,nn=cm(er,nr,tr,Va,Pe),!nn)continue;Kr=Math.max(Kr,nn.imageOffset)}else if(nn=Wm(er,ir,nr,Va,$t,se),!nn)continue;const{rect:Uo,metrics:Ah,baselineOffset:Ua}=nn;jr.push({glyph:ir,imageName:er.imageName,x:We,y:Be+Ua+-17,vertical:nr,scale:er.scale,fontStack:er.fontStack,sectionIndex:Dr,metrics:Ah,rect:Uo}),nr?(jt.verticalizable=!0,We+=(er.imageName?Ah.advance:Hn)*er.scale+te):We+=Ah.advance*er.scale+te}jr.length!==0&&(vi=Math.max(We-te,vi),Km(jr,0,jr.length-1,Mn)),We=0,Wr.lineOffset=Math.max(Kr,(tr-1)*Hn);const Fr=be*tr+Kr;Be+=Fr,Ki=Math.max(Fr,Ki),++Bs}const{horizontalAlign:xr,verticalAlign:Yr}=Wd(He);(function(In,tr,Wr,jr,Kr,Va,Fr,_s,er){const Dr=(tr-Wr)*Kr;let ir=0;ir=Va!==Fr?-_s*jr- -17:-jr*er*Fr+.5*Fr;for(const nr of In)for(const nn of nr.positionedGlyphs)nn.x+=Dr,nn.y+=ir})(jt.positionedLines,Mn,xr,Yr,vi,Ki,be,Be,ye.length),jt.top+=-Yr*Be,jt.bottom=jt.top+Be,jt.left+=-xr*vi,jt.right=jt.left+vi}(Mt,e,n,l,at,b,S,E,V,k,q,K),!function(jt){for(const $t of jt)if($t.positionedGlyphs.length!==0)return!1;return!0}(xt)&&Mt}const Ec={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Yd={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},am={40:!0};function qf(r,e,n,l,d,x){if(e.imageName){const b=l[e.imageName];return b?b.displaySize[0]*e.scale*Hn/x+d:0}{const b=n[e.fontStack],S=b&&b[r];return S?S.metrics.advance*e.scale+d:0}}function $f(r,e,n,l){const d=Math.pow(r-e,2);return l?r<e?d/2:2*d:d+Math.abs(n)*n}function om(r,e,n){let l=0;return r===10&&(l-=1e4),n&&(l+=150),r!==40&&r!==65288||(l+=50),e!==41&&e!==65289||(l+=50),l}function Xf(r,e,n,l,d,x){let b=null,S=$f(e,n,d,x);for(const E of l){const k=$f(e-E.x,n,d,x)+E.badness;k<=S&&(b=E,S=k)}return{index:r,x:e,priorBreak:b,badness:S}}function Yf(r){return r?Yf(r.priorBreak).concat(r.index):[]}function bh(r,e,n,l,d,x){if(!r)return[];const b=[],S=function(V,q,W,K,et,at){let ft=0;for(let Dt=0;Dt<V.length();Dt++){const xt=V.getSection(Dt);ft+=qf(V.getCharCode(Dt),xt,K,et,q,at)}return ft/Math.max(1,Math.ceil(ft/W))}(r,e,n,l,d,x),E=r.text.indexOf("")>=0;let k=0;for(let V=0;V<r.length();V++){const q=r.getSection(V),W=r.getCharCode(V);if(Ec[W]||(k+=qf(W,q,l,d,e,x)),V<r.length()-1){const K=!((N=W)<11904)&&(!!Di["CJK Compatibility Forms"](N)||!!Di["CJK Compatibility"](N)||!!Di["CJK Strokes"](N)||!!Di["CJK Symbols and Punctuation"](N)||!!Di["Enclosed CJK Letters and Months"](N)||!!Di["Halfwidth and Fullwidth Forms"](N)||!!Di["Ideographic Description Characters"](N)||!!Di["Vertical Forms"](N)||gc.test(String.fromCodePoint(N)));(Yd[W]||K||q.imageName||V!==r.length()-2&&am[r.getCharCode(V+1)])&&b.push(Xf(V+1,k,S,b,om(W,r.getCharCode(V+1),K&&E),!1))}}var N;return Yf(Xf(r.length(),k,S,b,0,!0))}function Wd(r){let e=.5,n=.5;switch(r){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function lm(r,e,n){const l=e.getMaxScale()*Hn,{maxImageWidth:d,maxImageHeight:x}=e.getMaxImageSize(r),b=Math.max(l,x*n);return{verticalLineContentWidth:Math.max(l,d*n),horizontalLineContentHeight:b}}function Sn(r){switch(r){case"top":return 0;case"center":return .5;default:return 1}}function Wf(r,e,n){return!(r===P.ao.horizontal||!e&&!Su(n)||e&&(Ec[n]||(l=n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(l)))));var l}function Wm(r,e,n,l,d,x){const b=x[r.fontStack],S=function(k,N,V,q){if(k&&k.rect)return k;const W=N[V.fontStack],K=W&&W[q];return K?{rect:null,metrics:K.metrics}:null}(b&&b[e],d,r,e);if(S===null)return null;let E;if(n)E=l.verticalLineContentWidth-r.scale*Hn;else{const k=Sn(r.verticalAlign);E=(l.horizontalLineContentHeight-r.scale*Hn)*k}return{rect:S.rect,metrics:S.metrics,baselineOffset:E}}function cm(r,e,n,l,d){const x=d[r.imageName];if(!x)return null;const b=x.paddedRect,S=x.displaySize,E={width:S[0],height:S[1],left:1,top:-3,advance:e?S[1]:S[0]};let k;if(e)k=l.verticalLineContentWidth-S[1]*r.scale;else{const N=Sn(r.verticalAlign);k=(l.horizontalLineContentHeight-S[1]*r.scale)*N}return{rect:b,metrics:E,baselineOffset:k,imageOffset:(e?S[0]:S[1])*r.scale-Hn*n}}function Km(r,e,n,l){if(l===0)return;const d=r[n],x=(r[n].x+d.metrics.advance*d.scale)*l;for(let b=e;b<=n;b++)r[b].x-=x}function Qm(r,e,n){const{horizontalAlign:l,verticalAlign:d}=Wd(n),x=e[0]-r.displaySize[0]*l,b=e[1]-r.displaySize[1]*d;return{image:r,top:b,bottom:b+r.displaySize[1],left:x,right:x+r.displaySize[0]}}function um(r){var e,n;let l=r.left,d=r.top,x=r.right-l,b=r.bottom-d;const S=(e=r.image.textFitWidth)!==null&&e!==void 0?e:"stretchOrShrink",E=(n=r.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",k=(r.image.content[2]-r.image.content[0])/(r.image.content[3]-r.image.content[1]);if(E==="proportional"){if(S==="stretchOnly"&&x/b<k||S==="proportional"){const N=Math.ceil(b*k);l*=N/x,x=N}}else if(S==="proportional"&&E==="stretchOnly"&&k!==0&&x/b>k){const N=Math.ceil(x/k);d*=N/b,b=N}return{x1:l,y1:d,x2:l+x,y2:d+b}}function ed(r,e,n,l,d,x){const b=r.image;let S;if(b.content){const at=b.content,ft=b.pixelRatio||1;S=[at[0]/ft,at[1]/ft,b.displaySize[0]-at[2]/ft,b.displaySize[1]-at[3]/ft]}const E=e.left*x,k=e.right*x;let N,V,q,W;n==="width"||n==="both"?(W=d[0]+E-l[3],V=d[0]+k+l[1]):(W=d[0]+(E+k-b.displaySize[0])/2,V=W+b.displaySize[0]);const K=e.top*x,et=e.bottom*x;return n==="height"||n==="both"?(N=d[1]+K-l[0],q=d[1]+et+l[2]):(N=d[1]+(K+et-b.displaySize[1])/2,q=N+b.displaySize[1]),{image:b,top:N,right:V,bottom:q,left:W,collisionPadding:S}}const Fa=128,$l=32640;function id(r,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new cn(r+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:d}=n;let x=0;for(;x<l.length&&l[x]<=r;)x++;x=Math.max(0,x-1);let b=x;for(;b<l.length&&l[b]<r+1;)b++;b=Math.min(l.length-1,b);const S=l[x],E=l[b];return n.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:E,interpolationType:d}:{kind:"camera",minZoom:S,maxZoom:E,minSize:n.evaluate(new cn(S)),maxSize:n.evaluate(new cn(E)),interpolationType:d}}}function nd(r,e,n){let l="never";const d=r.get(e);return d?l=d:r.get(n)&&(l="always"),l}const ju=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function mo(r,e,n,l,d,x,b,S,E,k,N,V,q){const W=S?Math.min($l,Math.round(S[0])):0,K=S?Math.min($l,Math.round(S[1])):0;r.emplaceBack(e,n,Math.round(32*l),Math.round(32*d),x,b,(W<<1)+(E?1:0),K,16*k,16*N,256*V,256*q)}function Fu(r,e,n){r.emplaceBack(e.x,e.y,n),r.emplaceBack(e.x,e.y,n),r.emplaceBack(e.x,e.y,n),r.emplaceBack(e.x,e.y,n)}function Jm(r){for(const e of r.sections)if(Fh(e.text))return!0;return!1}class Kd{constructor(e){this.layoutVertexArray=new ve,this.indexArray=new Yi,this.programConfigurations=e,this.segments=new mi,this.dynamicLayoutVertexArray=new re,this.opacityVertexArray=new Oe,this.hasVisibleVertices=!1,this.placedSymbolArray=new J}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,n,l,d){this.isEmpty()||(l&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Zf.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Gd.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,ju,!0),this.opacityVertexBuffer.itemSize=1),(l||d)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ee("SymbolBuffers",Kd);class Qd{constructor(e,n,l){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new l,this.segments=new mi,this.collisionVertexArray=new Ni}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Hd.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ee("CollisionBuffers",Qd);class Vu{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.globalState=e.globalState,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(b=>b.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=id(this.zoom,n["text-size"]),this.iconSizeData=id(this.zoom,n["icon-size"]);const l=this.layers[0].layout,d=l.get("symbol-sort-key"),x=l.get("symbol-z-order");this.canOverlap=nd(l,"text-overlap","text-allow-overlap")!=="never"||nd(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(b=>P.ao[b])),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=e.sourceID}createArrays(){this.text=new Kd(new Kn(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Kd(new Kn(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new ut,this.lineVertexArray=new pt,this.symbolInstances=new ot,this.textAnchorOffsets=new mt}calculateGlyphDependencies(e,n,l,d,x){for(let b=0;b<e.length;b++)if(n[e.charCodeAt(b)]=!0,(l||d)&&x){const S=ql[e.charAt(b)];S&&(n[S.charCodeAt(0)]=!0)}}populate(e,n,l){const d=this.layers[0],x=d.layout,b=x.get("text-font"),S=x.get("text-field"),E=x.get("icon-image"),k=(S.value.kind!=="constant"||S.value.value instanceof kn&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),N=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,V=x.get("symbol-sort-key");if(this.features=[],!k&&!N)return;const q=n.iconDependencies,W=n.glyphDependencies,K=n.availableImages,et=new cn(this.zoom,{globalState:this.globalState});for(const{feature:at,id:ft,index:Dt,sourceLayerIndex:xt}of e){const Mt=d._featureFilter.needGeometry,jt=Ba(at,Mt);if(!d._featureFilter.filter(et,jt,l))continue;let $t,se;if(Mt||(jt.geometry=Tn(at)),k){const ye=d.getValueAndResolveTokens("text-field",jt,l,K),be=kn.factory(ye),He=this.hasRTLText=this.hasRTLText||Jm(be);(!He||hs.getRTLTextPluginStatus()==="unavailable"||He&&hs.isParsed())&&($t=ru(be,d,jt))}if(N){const ye=d.getValueAndResolveTokens("icon-image",jt,l,K);se=ye instanceof lr?ye:lr.fromString(ye)}if(!$t&&!se)continue;const Pe=this.sortFeaturesByKey?V.evaluate(jt,{},l):void 0;if(this.features.push({id:ft,text:$t,icon:se,index:Dt,sourceLayerIndex:xt,geometry:jt.geometry,properties:at.properties,type:ku.types[at.type],sortKey:Pe}),se&&(q[se.name]=!0),$t){const ye=b.evaluate(jt,{},l).join(","),be=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(P.ao.vertical)>=0;for(const He of $t.sections)if(He.image)q[He.image.name]=!0;else{const Ae=ao($t.toString()),Te=He.fontStack||ye,te=W[Te]=W[Te]||{};this.calculateGlyphDependencies(He.text,te,be,this.allowVerticalPlacement,Ae)}}}x.get("symbol-placement")==="line"&&(this.features=function(at){const ft={},Dt={},xt=[];let Mt=0;function jt(ye){xt.push(at[ye]),Mt++}function $t(ye,be,He){const Ae=Dt[ye];return delete Dt[ye],Dt[be]=Ae,xt[Ae].geometry[0].pop(),xt[Ae].geometry[0]=xt[Ae].geometry[0].concat(He[0]),Ae}function se(ye,be,He){const Ae=ft[be];return delete ft[be],ft[ye]=Ae,xt[Ae].geometry[0].shift(),xt[Ae].geometry[0]=He[0].concat(xt[Ae].geometry[0]),Ae}function Pe(ye,be,He){const Ae=He?be[0][be[0].length-1]:be[0][0];return`${ye}:${Ae.x}:${Ae.y}`}for(let ye=0;ye<at.length;ye++){const be=at[ye],He=be.geometry,Ae=be.text?be.text.toString():null;if(!Ae){jt(ye);continue}const Te=Pe(Ae,He),te=Pe(Ae,He,!0);if(Te in Dt&&te in ft&&Dt[Te]!==ft[te]){const ei=se(Te,te,He),ni=$t(Te,te,xt[ei].geometry);delete ft[Te],delete Dt[te],Dt[Pe(Ae,xt[ni].geometry,!0)]=ni,xt[ei].geometry=null}else Te in Dt?$t(Te,te,He):te in ft?se(Te,te,He):(jt(ye),ft[Te]=Mt-1,Dt[te]=Mt-1)}return xt.filter(ye=>ye.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((at,ft)=>at.sortKey-ft.sortKey)}update(e,n,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,l),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const l=this.lineVertexArray.length;if(e.segment!==void 0){let d=e.dist(n[e.segment+1]),x=e.dist(n[e.segment]);const b={};for(let S=e.segment+1;S<n.length;S++)b[S]={x:n[S].x,y:n[S].y,tileUnitDistanceFromAnchor:d},S<n.length-1&&(d+=n[S+1].dist(n[S]));for(let S=e.segment||0;S>=0;S--)b[S]={x:n[S].x,y:n[S].y,tileUnitDistanceFromAnchor:x},S>0&&(x+=n[S-1].dist(n[S]));for(let S=0;S<n.length;S++){const E=b[S];this.lineVertexArray.emplaceBack(E.x,E.y,E.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(e,n,l,d,x,b,S,E,k,N,V,q){const W=e.indexArray,K=e.layoutVertexArray,et=e.segments.prepareSegment(4*n.length,K,W,this.canOverlap?b.sortKey:void 0),at=this.glyphOffsetArray.length,ft=et.vertexLength,Dt=this.allowVerticalPlacement&&S===P.ao.vertical?Math.PI/2:0,xt=b.text&&b.text.sections;for(let Mt=0;Mt<n.length;Mt++){const{tl:jt,tr:$t,bl:se,br:Pe,tex:ye,pixelOffsetTL:be,pixelOffsetBR:He,minFontScaleX:Ae,minFontScaleY:Te,glyphOffset:te,isSDF:ei,sectionIndex:ni}=n[Mt],We=et.vertexLength,Be=te[1];mo(K,E.x,E.y,jt.x,Be+jt.y,ye.x,ye.y,l,ei,be.x,be.y,Ae,Te),mo(K,E.x,E.y,$t.x,Be+$t.y,ye.x+ye.w,ye.y,l,ei,He.x,be.y,Ae,Te),mo(K,E.x,E.y,se.x,Be+se.y,ye.x,ye.y+ye.h,l,ei,be.x,He.y,Ae,Te),mo(K,E.x,E.y,Pe.x,Be+Pe.y,ye.x+ye.w,ye.y+ye.h,l,ei,He.x,He.y,Ae,Te),Fu(e.dynamicLayoutVertexArray,E,Dt),W.emplaceBack(We,We+2,We+1),W.emplaceBack(We+1,We+2,We+3),et.vertexLength+=4,et.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(te[0]),Mt!==n.length-1&&ni===n[Mt+1].sectionIndex||e.programConfigurations.populatePaintArrays(K.length,b,b.index,{},q,xt&&xt[ni])}e.placedSymbolArray.emplaceBack(E.x,E.y,at,this.glyphOffsetArray.length-at,ft,k,N,E.segment,l?l[0]:0,l?l[1]:0,d[0],d[1],S,0,!1,0,V)}_addCollisionDebugVertex(e,n,l,d,x,b){return n.emplaceBack(0,0),e.emplaceBack(l.x,l.y,d,x,Math.round(b.x),Math.round(b.y))}addCollisionDebugVertices(e,n,l,d,x,b,S){const E=x.segments.prepareSegment(4,x.layoutVertexArray,x.indexArray),k=E.vertexLength,N=x.layoutVertexArray,V=x.collisionVertexArray,q=S.anchorX,W=S.anchorY;this._addCollisionDebugVertex(N,V,b,q,W,new H(e,n)),this._addCollisionDebugVertex(N,V,b,q,W,new H(l,n)),this._addCollisionDebugVertex(N,V,b,q,W,new H(l,d)),this._addCollisionDebugVertex(N,V,b,q,W,new H(e,d)),E.vertexLength+=4;const K=x.indexArray;K.emplaceBack(k,k+1),K.emplaceBack(k+1,k+2),K.emplaceBack(k+2,k+3),K.emplaceBack(k+3,k),E.primitiveLength+=4}addDebugCollisionBoxes(e,n,l,d){for(let x=e;x<n;x++){const b=this.collisionBoxArray.get(x);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,d?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Qd(yi,Cc.members,Gi),this.iconCollisionBox=new Qd(yi,Cc.members,Gi);for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(e,n,l,d,x,b,S,E,k){const N={};for(let V=n;V<l;V++){const q=e.get(V);N.textBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},N.textFeatureIndex=q.featureIndex;break}for(let V=d;V<x;V++){const q=e.get(V);N.verticalTextBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},N.verticalTextFeatureIndex=q.featureIndex;break}for(let V=b;V<S;V++){const q=e.get(V);N.iconBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},N.iconFeatureIndex=q.featureIndex;break}for(let V=E;V<k;V++){const q=e.get(V);N.verticalIconBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},N.verticalIconFeatureIndex=q.featureIndex;break}return N}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const l=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const l=e.placedSymbolArray.get(n),d=l.vertexStartIndex+4*l.numGlyphs;for(let x=l.vertexStartIndex;x<d;x+=4)e.indexArray.emplaceBack(x,x+2,x+1),e.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),l=Math.cos(e),d=[],x=[],b=[];for(let S=0;S<this.symbolInstances.length;++S){b.push(S);const E=this.symbolInstances.get(S);d.push(0|Math.round(n*E.anchorX+l*E.anchorY)),x.push(E.featureIndex)}return b.sort((S,E)=>d[S]-d[E]||x[E]-x[S]),b}addToSortKeyRanges(e,n){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===n?l.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const l=this.symbolInstances.get(n);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((d,x,b)=>{d>=0&&b.indexOf(d)===x&&this.addIndicesForPlacedSymbol(this.text,d)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Kf,hm;Ee("SymbolBucket",Vu,{omit:["layers","collisionBoxArray","features","compareText"]}),Vu.MAX_GLYPHS=65535,Vu.addDynamicAttributes=Fu;var rd={get paint(){return hm=hm||new zs({"icon-opacity":new Xe(It.paint_symbol["icon-opacity"]),"icon-color":new Xe(It.paint_symbol["icon-color"]),"icon-halo-color":new Xe(It.paint_symbol["icon-halo-color"]),"icon-halo-width":new Xe(It.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Xe(It.paint_symbol["icon-halo-blur"]),"icon-translate":new Re(It.paint_symbol["icon-translate"]),"icon-translate-anchor":new Re(It.paint_symbol["icon-translate-anchor"]),"text-opacity":new Xe(It.paint_symbol["text-opacity"]),"text-color":new Xe(It.paint_symbol["text-color"],{runtimeType:an,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new Xe(It.paint_symbol["text-halo-color"]),"text-halo-width":new Xe(It.paint_symbol["text-halo-width"]),"text-halo-blur":new Xe(It.paint_symbol["text-halo-blur"]),"text-translate":new Re(It.paint_symbol["text-translate"]),"text-translate-anchor":new Re(It.paint_symbol["text-translate-anchor"])})},get layout(){return Kf=Kf||new zs({"symbol-placement":new Re(It.layout_symbol["symbol-placement"]),"symbol-spacing":new Re(It.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Re(It.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Xe(It.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Re(It.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Re(It.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Re(It.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Re(It.layout_symbol["icon-ignore-placement"]),"icon-optional":new Re(It.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Re(It.layout_symbol["icon-rotation-alignment"]),"icon-size":new Xe(It.layout_symbol["icon-size"]),"icon-text-fit":new Re(It.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Re(It.layout_symbol["icon-text-fit-padding"]),"icon-image":new Xe(It.layout_symbol["icon-image"]),"icon-rotate":new Xe(It.layout_symbol["icon-rotate"]),"icon-padding":new Xe(It.layout_symbol["icon-padding"]),"icon-keep-upright":new Re(It.layout_symbol["icon-keep-upright"]),"icon-offset":new Xe(It.layout_symbol["icon-offset"]),"icon-anchor":new Xe(It.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Re(It.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Re(It.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Re(It.layout_symbol["text-rotation-alignment"]),"text-field":new Xe(It.layout_symbol["text-field"]),"text-font":new Xe(It.layout_symbol["text-font"]),"text-size":new Xe(It.layout_symbol["text-size"]),"text-max-width":new Xe(It.layout_symbol["text-max-width"]),"text-line-height":new Re(It.layout_symbol["text-line-height"]),"text-letter-spacing":new Xe(It.layout_symbol["text-letter-spacing"]),"text-justify":new Xe(It.layout_symbol["text-justify"]),"text-radial-offset":new Xe(It.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Re(It.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Xe(It.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Xe(It.layout_symbol["text-anchor"]),"text-max-angle":new Re(It.layout_symbol["text-max-angle"]),"text-writing-mode":new Re(It.layout_symbol["text-writing-mode"]),"text-rotate":new Xe(It.layout_symbol["text-rotate"]),"text-padding":new Re(It.layout_symbol["text-padding"]),"text-keep-upright":new Re(It.layout_symbol["text-keep-upright"]),"text-transform":new Xe(It.layout_symbol["text-transform"]),"text-offset":new Xe(It.layout_symbol["text-offset"]),"text-allow-overlap":new Re(It.layout_symbol["text-allow-overlap"]),"text-overlap":new Re(It.layout_symbol["text-overlap"]),"text-ignore-placement":new Re(It.layout_symbol["text-ignore-placement"]),"text-optional":new Re(It.layout_symbol["text-optional"])})}};class Qf{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Js,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ee("FormatSectionOverride",Qf,{omit:["defaultValue"]});class sd extends Xs{constructor(e){super(e,rd)}recalculate(e,n){if(super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const d=[];for(const x of l)d.indexOf(x)<0&&d.push(x);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,n,l,d){const x=this.layout.get(e).evaluate(n,{},l,d),b=this._unevaluatedLayout._values[e];return b.isDataDriven()||Aa(b.value)||!x?x:function(S,E){return E.replace(/{([^{}]+)}/g,(k,N)=>S&&N in S?String(S[N]):"")}(n.properties,x)}createBucket(e){return new Vu(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of rd.paint.overridableProperties){if(!sd.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),l=new Qf(n),d=new El(l,n.property.specification);let x=null;x=n.value.kind==="constant"||n.value.kind==="source"?new o("source",d):new _("composite",d,n.value.zoomStops),this.paint._values[e]=new en(n.property,x,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,l){return!(!this.layout||n.isDataDriven()||l.isDataDriven())&&sd.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const l=e.get("text-field"),d=rd.paint.properties[n];let x=!1;const b=S=>{for(const E of S)if(d.overrides&&d.overrides.hasOverride(E))return void(x=!0)};if(l.value.kind==="constant"&&l.value.value instanceof kn)b(l.value.value.sections);else if(l.value.kind==="source"){const S=k=>{x||(k instanceof fr&&Ye(k.value)===is?b(k.value.sections):k instanceof ws?b(k.sections):k.eachChild(S))},E=l.value;E._styleExpression&&S(E._styleExpression.expression)}return x}}let dm;var Jf={get paint(){return dm=dm||new zs({"background-color":new Re(It.paint_background["background-color"]),"background-pattern":new La(It.paint_background["background-pattern"]),"background-opacity":new Re(It.paint_background["background-opacity"])})}};class tp extends Xs{constructor(e){super(e,Jf)}}let fm;var t_={get paint(){return fm=fm||new zs({"raster-opacity":new Re(It.paint_raster["raster-opacity"]),"raster-hue-rotate":new Re(It.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Re(It.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Re(It.paint_raster["raster-brightness-max"]),"raster-saturation":new Re(It.paint_raster["raster-saturation"]),"raster-contrast":new Re(It.paint_raster["raster-contrast"]),"raster-resampling":new Re(It.paint_raster["raster-resampling"]),"raster-fade-duration":new Re(It.paint_raster["raster-fade-duration"])})}};class ad extends Xs{constructor(e){super(e,t_)}}class e_ extends Xs{constructor(e){super(e,{}),this.onAdd=n=>{this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)},this.onRemove=n=>{this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class pm{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Fi={once:!0},od=63710088e-1;class hl{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new hl(rn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,l=this.lat*n,d=e.lat*n,x=Math.sin(l)*Math.sin(d)+Math.cos(l)*Math.cos(d)*Math.cos((e.lng-this.lng)*n);return od*Math.acos(Math.min(x,1))}static convert(e){if(e instanceof hl)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new hl(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new hl(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Jd=2*Math.PI*od;function ep(r){return Jd*Math.cos(r*Math.PI/180)}function tf(r){return(180+r)/360}function wh(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function ld(r,e){return r/ep(e)}function lu(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function ip(r,e){return r*ep(lu(e))}class cd{constructor(e,n,l=0){this.x=+e,this.y=+n,this.z=+l}static fromLngLat(e,n=0){const l=hl.convert(e);return new cd(tf(l.lng),wh(l.lat),ld(n,l.lat))}toLngLat(){return new hl(360*this.x-180,lu(this.y))}toAltitude(){return ip(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Jd*(e=lu(this.y),1/Math.cos(e*Math.PI/180));var e}}function mm(r,e,n){var l=2*Math.PI*6378137/256/Math.pow(2,n);return[r*l-2*Math.PI*6378137/2,e*l-2*Math.PI*6378137/2]}class ef{constructor(e,n,l){if(!function(d,x,b){return!(d<0||d>25||b<0||b>=Math.pow(2,d)||x<0||x>=Math.pow(2,d))}(e,n,l))throw new Error(`x=${n}, y=${l}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=n,this.y=l,this.key=Hi(0,e,e,n,l)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n,l){const d=(b=this.y,S=this.z,E=mm(256*(x=this.x),256*(b=Math.pow(2,S)-b-1),S),k=mm(256*(x+1),256*(b+1),S),E[0]+","+E[1]+","+k[0]+","+k[1]);var x,b,S,E,k;const N=function(V,q,W){let K,et="";for(let at=V;at>0;at--)K=1<<at-1,et+=(q&K?1:0)+(W&K?2:0);return et}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,N).replace(/{bbox-epsg-3857}/g,d)}isChildOf(e){const n=this.z-e.z;return n>0&&e.x===this.x>>n&&e.y===this.y>>n}getTilePoint(e){const n=Math.pow(2,this.z);return new H((e.x*n-this.x)*Ze,(e.y*n-this.y)*Ze)}toString(){return`${this.z}/${this.x}/${this.y}`}}class np{constructor(e,n){this.wrap=e,this.canonical=n,this.key=Hi(e,n.z,n.z,n.x,n.y)}}class Ys{constructor(e,n,l,d,x){if(this.terrainRttPosMatrix32f=null,e<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${l}`);this.overscaledZ=e,this.wrap=n,this.canonical=new ef(l,+d,+x),this.key=Hi(n,e,l,d,x)}clone(){return new Ys(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-e;return e>this.canonical.z?new Ys(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ys(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-e;return e>this.canonical.z?Hi(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y):Hi(this.wrap*+n,e,e,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new Ys(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,l=2*this.canonical.x,d=2*this.canonical.y;return[new Ys(n,this.wrap,n,l,d),new Ys(n,this.wrap,n,l+1,d),new Ys(n,this.wrap,n,l,d+1),new Ys(n,this.wrap,n,l+1,d+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ys(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ys(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new np(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new cd(e.x-this.wrap,e.y))}}function Hi(r,e,n,l,d){(r*=2)<0&&(r=-1*r-1);const x=1<<n;return(x*x*r+x*d+l).toString(36)+n.toString(36)+e.toString(36)}function Uu(r,e){return e?r.properties[e]:r.id}Ee("CanonicalTileID",ef),Ee("OverscaledTileID",Ys,{omit:["terrainRttPosMatrix32f"]});class hr{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(e){return this.minX=Math.min(this.minX,e.x),this.minY=Math.min(this.minY,e.y),this.maxX=Math.max(this.maxX,e.x),this.maxY=Math.max(this.maxY,e.y),this}expandBy(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(e){return this.expandBy(-e)}map(e){const n=new hr;return n.extend(e(new H(this.minX,this.minY))),n.extend(e(new H(this.maxX,this.minY))),n.extend(e(new H(this.minX,this.maxY))),n.extend(e(new H(this.maxX,this.maxY))),n}static fromPoints(e){const n=new hr;for(const l of e)n.extend(l);return n}contains(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(e){return!this.empty()&&!e.empty()&&e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY}intersects(e){return!this.empty()&&!e.empty()&&e.minX<=this.maxX&&e.maxX>=this.minX&&e.minY<=this.maxY&&e.maxY>=this.minY}}class _m{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const l=e[n];this._stringToNumber[l]=n,this._numberToString[n]=l}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class nf{constructor(e,n,l,d,x){this.type="Feature",this._vectorTileFeature=e,e._z=n,e._x=l,e._y=d,this.properties=e.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(e[n]=this[n]);return e}}class rf{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new tl(Ze,16,0),this.grid3D=new tl(Ze,16,0),this.featureIndexArray=new At,this.promoteId=n}insert(e,n,l,d,x,b){const S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,d,x);const E=b?this.grid3D:this.grid;for(let k=0;k<n.length;k++){const N=n[k],V=[1/0,1/0,-1/0,-1/0];for(let q=0;q<N.length;q++){const W=N[q];V[0]=Math.min(V[0],W.x),V[1]=Math.min(V[1],W.y),V[2]=Math.max(V[2],W.x),V[3]=Math.max(V[3],W.y)}V[0]<Ze&&V[1]<Ze&&V[2]>=0&&V[3]>=0&&E.insert(S,V[0],V[1],V[2],V[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Vf(new Ou(this.rawTileData)).layers,this.sourceLayerCoder=new _m(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,n,l,d){this.loadVTLayers();const x=e.params,b=Ze/e.tileSize/e.scale,S=qt(x.filter),E=e.queryGeometry,k=e.queryPadding*b,N=hr.fromPoints(E),V=this.grid.query(N.minX-k,N.minY-k,N.maxX+k,N.maxY+k),q=hr.fromPoints(e.cameraQueryGeometry).expandBy(k),W=this.grid3D.query(q.minX,q.minY,q.maxX,q.maxY,(at,ft,Dt,xt)=>function(Mt,jt,$t,se,Pe){for(const be of Mt)if(jt<=be.x&&$t<=be.y&&se>=be.x&&Pe>=be.y)return!0;const ye=[new H(jt,$t),new H(jt,Pe),new H(se,Pe),new H(se,$t)];if(Mt.length>2){for(const be of ye)if(Cu(Mt,be))return!0}for(let be=0;be<Mt.length-1;be++)if(Bp(Mt[be],Mt[be+1],ye))return!0;return!1}(e.cameraQueryGeometry,at-k,ft-k,Dt+k,xt+k));for(const at of W)V.push(at);V.sort(gm);const K={};let et;for(let at=0;at<V.length;at++){const ft=V[at];if(ft===et)continue;et=ft;const Dt=this.featureIndexArray.get(ft);let xt=null;this.loadMatchingFeature(K,Dt.bucketIndex,Dt.sourceLayerIndex,Dt.featureIndex,S,x.layers,x.availableImages,n,l,d,(Mt,jt,$t)=>(xt||(xt=Tn(Mt)),jt.queryIntersectsFeature({queryGeometry:E,feature:Mt,featureState:$t,geometry:xt,zoom:this.z,transform:e.transform,pixelsToTileUnits:b,pixelPosMatrix:e.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:e.getElevation})))}return K}loadMatchingFeature(e,n,l,d,x,b,S,E,k,N,V){const q=this.bucketLayerIDs[n];if(b&&!q.some(at=>b.has(at)))return;const W=this.sourceLayerCoder.decode(l),K=this.vtLayers[W].feature(d);if(x.needGeometry){const at=Ba(K,!0);if(!x.filter(new cn(this.tileID.overscaledZ),at,this.tileID.canonical))return}else if(!x.filter(new cn(this.tileID.overscaledZ),K))return;const et=this.getId(K,W);for(let at=0;at<q.length;at++){const ft=q[at];if(b&&!b.has(ft))continue;const Dt=E[ft];if(!Dt)continue;let xt={};et&&N&&(xt=N.getState(Dt.sourceLayer||"_geojsonTileLayer",et));const Mt=xi({},k[ft]);Mt.paint=ud(Mt.paint,Dt.paint,K,xt,S),Mt.layout=ud(Mt.layout,Dt.layout,K,xt,S);const jt=!V||V(K,Dt,xt);if(!jt)continue;const $t=new nf(K,this.z,this.x,this.y,et);$t.layer=Mt;let se=e[ft];se===void 0&&(se=e[ft]=[]),se.push({featureIndex:d,feature:$t,intersectionZ:jt})}}lookupSymbolFeatures(e,n,l,d,x,b,S,E){const k={};this.loadVTLayers();const N=qt(x);for(const V of e)this.loadMatchingFeature(k,l,d,V,N,b,S,E,n);return k}hasLayer(e){for(const n of this.bucketLayerIDs)for(const l of n)if(e===l)return!0;return!1}getId(e,n){var l;let d=e.id;return this.promoteId&&(d=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof d=="boolean"&&(d=Number(d)),d===void 0&&(!((l=e.properties)===null||l===void 0)&&l.cluster)&&this.promoteId&&(d=Number(e.properties.cluster_id))),d}}function ud(r,e,n,l,d){return da(r,(x,b)=>{const S=e instanceof xc?e.get(b):null;return S&&S.evaluate?S.evaluate(n,l,d):S})}function gm(r,e){return e-r}function rp(r,e,n,l,d){const x=[];for(let b=0;b<r.length;b++){const S=r[b];let E;for(let k=0;k<S.length-1;k++){let N=S[k],V=S[k+1];N.x<e&&V.x<e||(N.x<e?N=new H(e,N.y+(e-N.x)/(V.x-N.x)*(V.y-N.y))._round():V.x<e&&(V=new H(e,N.y+(e-N.x)/(V.x-N.x)*(V.y-N.y))._round()),N.y<n&&V.y<n||(N.y<n?N=new H(N.x+(n-N.y)/(V.y-N.y)*(V.x-N.x),n)._round():V.y<n&&(V=new H(N.x+(n-N.y)/(V.y-N.y)*(V.x-N.x),n)._round()),N.x>=l&&V.x>=l||(N.x>=l?N=new H(l,N.y+(l-N.x)/(V.x-N.x)*(V.y-N.y))._round():V.x>=l&&(V=new H(l,N.y+(l-N.x)/(V.x-N.x)*(V.y-N.y))._round()),N.y>=d&&V.y>=d||(N.y>=d?N=new H(N.x+(d-N.y)/(V.y-N.y)*(V.x-N.x),d)._round():V.y>=d&&(V=new H(N.x+(d-N.y)/(V.y-N.y)*(V.x-N.x),d)._round()),E&&N.equals(E[E.length-1])||(E=[N],x.push(E)),E.push(V)))))}}return x}Ee("FeatureIndex",rf,{omit:["rawTileData","sourceLayerCoder"]});class Xl extends H{constructor(e,n,l,d){super(e,n),this.angle=l,d!==void 0&&(this.segment=d)}clone(){return new Xl(this.x,this.y,this.angle,this.segment)}}function sf(r,e,n,l,d){if(e.segment===void 0||n===0)return!0;let x=e,b=e.segment+1,S=0;for(;S>-n/2;){if(b--,b<0)return!1;S-=r[b].dist(x),x=r[b]}S+=r[b].dist(r[b+1]),b++;const E=[];let k=0;for(;S<n/2;){const N=r[b],V=r[b+1];if(!V)return!1;let q=r[b-1].angleTo(N)-N.angleTo(V);for(q=Math.abs((q+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:S,angleDelta:q}),k+=q;S-E[0].distance>l;)k-=E.shift().angleDelta;if(k>d)return!1;b++,S+=N.dist(V)}return!0}function ym(r){let e=0;for(let n=0;n<r.length-1;n++)e+=r[n].dist(r[n+1]);return e}function sp(r,e,n){return r?.6*e*n:0}function vm(r,e){return Math.max(r?r.right-r.left:0,e?e.right-e.left:0)}function xm(r,e,n,l,d,x){const b=sp(n,d,x),S=vm(n,l)*x;let E=0;const k=ym(r)/2;for(let N=0;N<r.length-1;N++){const V=r[N],q=r[N+1],W=V.dist(q);if(E+W>k){const K=(k-E)/W,et=sa.number(V.x,q.x,K),at=sa.number(V.y,q.y,K),ft=new Xl(et,at,q.angleTo(V),N);return ft._round(),!b||sf(r,ft,S,b,e)?ft:void 0}E+=W}}function i_(r,e,n,l,d,x,b,S,E){const k=sp(l,x,b),N=vm(l,d),V=N*b,q=r[0].x===0||r[0].x===E||r[0].y===0||r[0].y===E;return e-V<e/4&&(e=V+e/4),bm(r,q?e/2*S%e:(N/2+2*x)*b*S%e,e,k,n,V,q,!1,E)}function bm(r,e,n,l,d,x,b,S,E){const k=x/2,N=ym(r);let V=0,q=e-n,W=[];for(let K=0;K<r.length-1;K++){const et=r[K],at=r[K+1],ft=et.dist(at),Dt=at.angleTo(et);for(;q+n<V+ft;){q+=n;const xt=(q-V)/ft,Mt=sa.number(et.x,at.x,xt),jt=sa.number(et.y,at.y,xt);if(Mt>=0&&Mt<E&&jt>=0&&jt<E&&q-k>=0&&q+k<=N){const $t=new Xl(Mt,jt,Dt,K);$t._round(),l&&!sf(r,$t,x,l,d)||W.push($t)}}V+=ft}return S||W.length||b||(W=bm(r,V/2,n,l,d,x,b,!0,E)),W}function zc(r,e,n,l){const d=[],x=r.image,b=x.pixelRatio,S=x.paddedRect.w-2,E=x.paddedRect.h-2;let k={x1:r.left,y1:r.top,x2:r.right,y2:r.bottom};const N=x.stretchX||[[0,S]],V=x.stretchY||[[0,E]],q=(te,ei)=>te+ei[1]-ei[0],W=N.reduce(q,0),K=V.reduce(q,0),et=S-W,at=E-K;let ft=0,Dt=W,xt=0,Mt=K,jt=0,$t=et,se=0,Pe=at;if(x.content&&l){const te=x.content,ei=te[2]-te[0],ni=te[3]-te[1];(x.textFitWidth||x.textFitHeight)&&(k=um(r)),ft=hd(N,0,te[0]),xt=hd(V,0,te[1]),Dt=hd(N,te[0],te[2]),Mt=hd(V,te[1],te[3]),jt=te[0]-ft,se=te[1]-xt,$t=ei-Dt,Pe=ni-Mt}const ye=k.x1,be=k.y1,He=k.x2-ye,Ae=k.y2-be,Te=(te,ei,ni,We)=>{const Be=of(te.stretch-ft,Dt,He,ye),vi=lf(te.fixed-jt,$t,te.stretch,W),Ki=of(ei.stretch-xt,Mt,Ae,be),Mn=lf(ei.fixed-se,Pe,ei.stretch,K),vr=of(ni.stretch-ft,Dt,He,ye),Bs=lf(ni.fixed-jt,$t,ni.stretch,W),xr=of(We.stretch-xt,Mt,Ae,be),Yr=lf(We.fixed-se,Pe,We.stretch,K),In=new H(Be,Ki),tr=new H(vr,Ki),Wr=new H(vr,xr),jr=new H(Be,xr),Kr=new H(vi/b,Mn/b),Va=new H(Bs/b,Yr/b),Fr=e*Math.PI/180;if(Fr){const Dr=Math.sin(Fr),ir=Math.cos(Fr),nr=[ir,-Dr,Dr,ir];In._matMult(nr),tr._matMult(nr),jr._matMult(nr),Wr._matMult(nr)}const _s=te.stretch+te.fixed,er=ei.stretch+ei.fixed;return{tl:In,tr,bl:jr,br:Wr,tex:{x:x.paddedRect.x+1+_s,y:x.paddedRect.y+1+er,w:ni.stretch+ni.fixed-_s,h:We.stretch+We.fixed-er},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Kr,pixelOffsetBR:Va,minFontScaleX:$t/b/He,minFontScaleY:Pe/b/Ae,isSDF:n}};if(l&&(x.stretchX||x.stretchY)){const te=af(N,et,W),ei=af(V,at,K);for(let ni=0;ni<te.length-1;ni++){const We=te[ni],Be=te[ni+1];for(let vi=0;vi<ei.length-1;vi++)d.push(Te(We,ei[vi],Be,ei[vi+1]))}}else d.push(Te({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:E+1}));return d}function hd(r,e,n){let l=0;for(const d of r)l+=Math.max(e,Math.min(n,d[1]))-Math.max(e,Math.min(n,d[0]));return l}function af(r,e,n){const l=[{fixed:-1,stretch:0}];for(const[d,x]of r){const b=l[l.length-1];l.push({fixed:d-b.stretch,stretch:b.stretch}),l.push({fixed:d-b.stretch,stretch:b.stretch+(x-d)})}return l.push({fixed:e+1,stretch:n}),l}function of(r,e,n,l){return r/e*n+l}function lf(r,e,n,l){return r-e*n/l}Ee("Anchor",Xl);class Th{constructor(e,n,l,d,x,b,S,E,k,N){var V;if(this.boxStartIndex=e.length,k){let q=b.top,W=b.bottom;const K=b.collisionPadding;K&&(q-=K[1],W+=K[3]);let et=W-q;et>0&&(et=Math.max(10,et),this.circleDiameter=et)}else{const q=!((V=b.image)===null||V===void 0)&&V.content&&(b.image.textFitWidth||b.image.textFitHeight)?um(b):{x1:b.left,y1:b.top,x2:b.right,y2:b.bottom};q.y1=q.y1*S-E[0],q.y2=q.y2*S+E[2],q.x1=q.x1*S-E[3],q.x2=q.x2*S+E[1];const W=b.collisionPadding;if(W&&(q.x1-=W[0]*S,q.y1-=W[1]*S,q.x2+=W[2]*S,q.y2+=W[3]*S),N){const K=new H(q.x1,q.y1),et=new H(q.x2,q.y1),at=new H(q.x1,q.y2),ft=new H(q.x2,q.y2),Dt=N*Math.PI/180;K._rotate(Dt),et._rotate(Dt),at._rotate(Dt),ft._rotate(Dt),q.x1=Math.min(K.x,et.x,at.x,ft.x),q.x2=Math.max(K.x,et.x,at.x,ft.x),q.y1=Math.min(K.y,et.y,at.y,ft.y),q.y2=Math.max(K.y,et.y,at.y,ft.y)}e.emplaceBack(n.x,n.y,q.x1,q.y1,q.x2,q.y2,l,d,x)}this.boxEndIndex=e.length}}class n_{constructor(e=[],n=(l,d)=>l<d?-1:l>d?1:0){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:l}=this,d=n[e];for(;e>0;){const x=e-1>>1,b=n[x];if(l(d,b)>=0)break;n[e]=b,e=x}n[e]=d}_down(e){const{data:n,compare:l}=this,d=this.length>>1,x=n[e];for(;e<d;){let b=1+(e<<1);const S=b+1;if(S<this.length&&l(n[S],n[b])<0&&(b=S),l(n[b],x)>=0)break;n[e]=n[b],e=b}n[e]=x}}function dl(r,e=1,n=!1){const l=hr.fromPoints(r[0]),d=Math.min(l.width(),l.height());let x=d/2;const b=new n_([],ap),{minX:S,minY:E,maxX:k,maxY:N}=l;if(d===0)return new H(S,E);for(let W=S;W<k;W+=d)for(let K=E;K<N;K+=d)b.push(new Zu(W+x,K+x,x,r));let V=function(W){let K=0,et=0,at=0;const ft=W[0];for(let Dt=0,xt=ft.length,Mt=xt-1;Dt<xt;Mt=Dt++){const jt=ft[Dt],$t=ft[Mt],se=jt.x*$t.y-$t.x*jt.y;et+=(jt.x+$t.x)*se,at+=(jt.y+$t.y)*se,K+=3*se}return new Zu(et/K,at/K,0,W)}(r),q=b.length;for(;b.length;){const W=b.pop();(W.d>V.d||!V.d)&&(V=W,n&&console.log("found best %d after %d probes",Math.round(1e4*W.d)/1e4,q)),W.max-V.d<=e||(x=W.h/2,b.push(new Zu(W.p.x-x,W.p.y-x,x,r)),b.push(new Zu(W.p.x+x,W.p.y-x,x,r)),b.push(new Zu(W.p.x-x,W.p.y+x,x,r)),b.push(new Zu(W.p.x+x,W.p.y+x,x,r)),q+=4)}return n&&(console.log(`num probes: ${q}`),console.log(`best distance: ${V.d}`)),V.p}function ap(r,e){return e.max-r.max}function Zu(r,e,n,l){this.p=new H(r,e),this.h=n,this.d=function(d,x){let b=!1,S=1/0;for(let E=0;E<x.length;E++){const k=x[E];for(let N=0,V=k.length,q=V-1;N<V;q=N++){const W=k[N],K=k[q];W.y>d.y!=K.y>d.y&&d.x<(K.x-W.x)*(d.y-W.y)/(K.y-W.y)+W.x&&(b=!b),S=Math.min(S,Af(d,W,K))}}return(b?1:-1)*Math.sqrt(S)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var Xr;P.aE=void 0,(Xr=P.aE||(P.aE={}))[Xr.center=1]="center",Xr[Xr.left=2]="left",Xr[Xr.right=3]="right",Xr[Xr.top=4]="top",Xr[Xr.bottom=5]="bottom",Xr[Xr["top-left"]=6]="top-left",Xr[Xr["top-right"]=7]="top-right",Xr[Xr["bottom-left"]=8]="bottom-left",Xr[Xr["bottom-right"]=9]="bottom-right";const Gu=Number.POSITIVE_INFINITY;function _o(r,e){return e[1]!==Gu?function(n,l,d){let x=0,b=0;switch(l=Math.abs(l),d=Math.abs(d),n){case"top-right":case"top-left":case"top":b=d-7;break;case"bottom-right":case"bottom-left":case"bottom":b=7-d}switch(n){case"top-right":case"bottom-right":case"right":x=-l;break;case"top-left":case"bottom-left":case"left":x=l}return[x,b]}(r,e[0],e[1]):function(n,l){let d=0,x=0;l<0&&(l=0);const b=l/Math.SQRT2;switch(n){case"top-right":case"top-left":x=b-7;break;case"bottom-right":case"bottom-left":x=7-b;break;case"bottom":x=7-l;break;case"top":x=l-7}switch(n){case"top-right":case"bottom-right":d=-b;break;case"top-left":case"bottom-left":d=b;break;case"left":d=l;break;case"right":d=-l}return[d,x]}(r,e[0])}function op(r,e,n){var l;const d=r.layout,x=(l=d.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(e,{},n);if(x){const S=x.values,E=[];for(let k=0;k<S.length;k+=2){const N=E[k]=S[k],V=S[k+1].map(q=>q*Hn);N.startsWith("top")?V[1]-=7:N.startsWith("bottom")&&(V[1]+=7),E[k+1]=V}return new or(E)}const b=d.get("text-variable-anchor");if(b){let S;S=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[d.get("text-radial-offset").evaluate(e,{},n)*Hn,Gu]:d.get("text-offset").evaluate(e,{},n).map(k=>k*Hn);const E=[];for(const k of b)E.push(k,_o(k,S));return new or(E)}return null}function Sh(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Dc(r,e,n,l,d,x,b,S,E,k,N,V){let q=x.textMaxSize.evaluate(e,{});q===void 0&&(q=b);const W=r.layers[0].layout,K=W.get("icon-offset").evaluate(e,{},N),et=Tm(n.horizontal),at=b/24,ft=r.tilePixelRatio*at,Dt=r.tilePixelRatio*q/24,xt=r.tilePixelRatio*S,Mt=r.tilePixelRatio*W.get("symbol-spacing"),jt=W.get("text-padding")*r.tilePixelRatio,$t=function(ni,We,Be,vi=1){const Ki=ni.get("icon-padding").evaluate(We,{},Be),Mn=Ki&&Ki.values;return[Mn[0]*vi,Mn[1]*vi,Mn[2]*vi,Mn[3]*vi]}(W,e,N,r.tilePixelRatio),se=W.get("text-max-angle")/180*Math.PI,Pe=W.get("text-rotation-alignment")!=="viewport"&&W.get("symbol-placement")!=="point",ye=W.get("icon-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",be=W.get("symbol-placement"),He=Mt/2,Ae=W.get("icon-text-fit");let Te;l&&Ae!=="none"&&(r.allowVerticalPlacement&&n.vertical&&(Te=ed(l,n.vertical,Ae,W.get("icon-text-fit-padding"),K,at)),et&&(l=ed(l,et,Ae,W.get("icon-text-fit-padding"),K,at)));const te=N?V.line.getGranularityForZoomLevel(N.z):1,ei=(ni,We)=>{We.x<0||We.x>=Ze||We.y<0||We.y>=Ze||function(Be,vi,Ki,Mn,vr,Bs,xr,Yr,In,tr,Wr,jr,Kr,Va,Fr,_s,er,Dr,ir,nr,nn,Uo,Ah,Ua,i){const a=Be.addToLineVertexArray(vi,Ki);let h,v,C,R,Y=0,rt=0,St=0,Zt=0,ie=-1,le=-1;const Ht={};let Xt=ol("");if(Be.allowVerticalPlacement&&Mn.vertical){const ua=Yr.layout.get("text-rotate").evaluate(nn,{},Ua)+90;C=new Th(In,vi,tr,Wr,jr,Mn.vertical,Kr,Va,Fr,ua),xr&&(R=new Th(In,vi,tr,Wr,jr,xr,er,Dr,Fr,ua))}if(vr){const ua=Yr.layout.get("icon-rotate").evaluate(nn,{}),fl=Yr.layout.get("icon-text-fit")!=="none",pd=zc(vr,ua,Ah,fl),Lc=xr?zc(xr,ua,Ah,fl):void 0;v=new Th(In,vi,tr,Wr,jr,vr,er,Dr,!1,ua),Y=4*pd.length;const md=Be.iconSizeData;let uu=null;md.kind==="source"?(uu=[Fa*Yr.layout.get("icon-size").evaluate(nn,{})],uu[0]>$l&&An(`${Be.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):md.kind==="composite"&&(uu=[Fa*Uo.compositeIconSizes[0].evaluate(nn,{},Ua),Fa*Uo.compositeIconSizes[1].evaluate(nn,{},Ua)],(uu[0]>$l||uu[1]>$l)&&An(`${Be.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Be.addSymbols(Be.icon,pd,uu,nr,ir,nn,P.ao.none,vi,a.lineStartIndex,a.lineLength,-1,Ua),ie=Be.icon.placedSymbolArray.length-1,Lc&&(rt=4*Lc.length,Be.addSymbols(Be.icon,Lc,uu,nr,ir,nn,P.ao.vertical,vi,a.lineStartIndex,a.lineLength,-1,Ua),le=Be.icon.placedSymbolArray.length-1)}const _i=Object.keys(Mn.horizontal);for(const ua of _i){const fl=Mn.horizontal[ua];if(!h){Xt=ol(fl.text);const Lc=Yr.layout.get("text-rotate").evaluate(nn,{},Ua);h=new Th(In,vi,tr,Wr,jr,fl,Kr,Va,Fr,Lc)}const pd=fl.positionedLines.length===1;if(St+=wm(Be,vi,fl,Bs,Yr,Fr,nn,_s,a,Mn.vertical?P.ao.horizontal:P.ao.horizontalOnly,pd?_i:[ua],Ht,ie,Uo,Ua),pd)break}Mn.vertical&&(Zt+=wm(Be,vi,Mn.vertical,Bs,Yr,Fr,nn,_s,a,P.ao.vertical,["vertical"],Ht,le,Uo,Ua));const ui=h?h.boxStartIndex:Be.collisionBoxArray.length,Pn=h?h.boxEndIndex:Be.collisionBoxArray.length,kt=C?C.boxStartIndex:Be.collisionBoxArray.length,Rt=C?C.boxEndIndex:Be.collisionBoxArray.length,Vt=v?v.boxStartIndex:Be.collisionBoxArray.length,ae=v?v.boxEndIndex:Be.collisionBoxArray.length,Ke=R?R.boxStartIndex:Be.collisionBoxArray.length,Bi=R?R.boxEndIndex:Be.collisionBoxArray.length;let qe=-1;const oi=(ua,fl)=>ua&&ua.circleDiameter?Math.max(ua.circleDiameter,fl):fl;qe=oi(h,qe),qe=oi(C,qe),qe=oi(v,qe),qe=oi(R,qe);const Qr=qe>-1?1:0;Qr&&(qe*=i/Hn),Be.glyphOffsetArray.length>=Vu.MAX_GLYPHS&&An("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),nn.sortKey!==void 0&&Be.addToSortKeyRanges(Be.symbolInstances.length,nn.sortKey);const Qi=op(Yr,nn,Ua),[cu,r_]=function(ua,fl){const pd=ua.length,Lc=fl?.values;if(Lc?.length>0)for(let md=0;md<Lc.length;md+=2){const uu=Lc[md+1];ua.emplaceBack(P.aE[Lc[md]],uu[0],uu[1])}return[pd,ua.length]}(Be.textAnchorOffsets,Qi);Be.symbolInstances.emplaceBack(vi.x,vi.y,Ht.right>=0?Ht.right:-1,Ht.center>=0?Ht.center:-1,Ht.left>=0?Ht.left:-1,Ht.vertical||-1,ie,le,Xt,ui,Pn,kt,Rt,Vt,ae,Ke,Bi,tr,St,Zt,Y,rt,Qr,0,Kr,qe,cu,r_)}(r,We,ni,n,l,d,Te,r.layers[0],r.collisionBoxArray,e.index,e.sourceLayerIndex,r.index,ft,[jt,jt,jt,jt],Pe,E,xt,$t,ye,K,e,x,k,N,b)};if(be==="line")for(const ni of rp(e.geometry,0,0,Ze,Ze)){const We=Mc(ni,te),Be=i_(We,Mt,se,n.vertical||et,l,24,Dt,r.overscaling,Ze);for(const vi of Be)et&&Mh(r,et.text,He,vi)||ei(We,vi)}else if(be==="line-center"){for(const ni of e.geometry)if(ni.length>1){const We=Mc(ni,te),Be=xm(We,se,n.vertical||et,l,24,Dt);Be&&ei(We,Be)}}else if(e.type==="Polygon")for(const ni of Sl(e.geometry,0)){const We=dl(ni,16);ei(Mc(ni[0],te,!0),new Xl(We.x,We.y,0))}else if(e.type==="LineString")for(const ni of e.geometry){const We=Mc(ni,te);ei(We,new Xl(We[0].x,We[0].y,0))}else if(e.type==="Point")for(const ni of e.geometry)for(const We of ni)ei([We],new Xl(We.x,We.y,0))}function wm(r,e,n,l,d,x,b,S,E,k,N,V,q,W,K){const et=function(Dt,xt,Mt,jt,$t,se,Pe,ye){const be=jt.layout.get("text-rotate").evaluate(se,{})*Math.PI/180,He=[];for(const Ae of xt.positionedLines)for(const Te of Ae.positionedGlyphs){if(!Te.rect)continue;const te=Te.rect||{};let ei=4,ni=!0,We=1,Be=0;const vi=($t||ye)&&Te.vertical,Ki=Te.metrics.advance*Te.scale/2;if(ye&&xt.verticalizable&&(Be=Ae.lineOffset/2-(Te.imageName?-(Hn-Te.metrics.width*Te.scale)/2:(Te.scale-1)*Hn)),Te.imageName){const Dr=Pe[Te.imageName];ni=Dr.sdf,We=Dr.pixelRatio,ei=1/We}const Mn=$t?[Te.x+Ki,Te.y]:[0,0];let vr=$t?[0,0]:[Te.x+Ki+Mt[0],Te.y+Mt[1]-Be],Bs=[0,0];vi&&(Bs=vr,vr=[0,0]);const xr=Te.metrics.isDoubleResolution?2:1,Yr=(Te.metrics.left-ei)*Te.scale-Ki+vr[0],In=(-Te.metrics.top-ei)*Te.scale+vr[1],tr=Yr+te.w/xr*Te.scale/We,Wr=In+te.h/xr*Te.scale/We,jr=new H(Yr,In),Kr=new H(tr,In),Va=new H(Yr,Wr),Fr=new H(tr,Wr);if(vi){const Dr=new H(-Ki,Ki- -17),ir=-Math.PI/2,nr=12-Ki,nn=new H(22-nr,-(Te.imageName?nr:0)),Uo=new H(...Bs);jr._rotateAround(ir,Dr)._add(nn)._add(Uo),Kr._rotateAround(ir,Dr)._add(nn)._add(Uo),Va._rotateAround(ir,Dr)._add(nn)._add(Uo),Fr._rotateAround(ir,Dr)._add(nn)._add(Uo)}if(be){const Dr=Math.sin(be),ir=Math.cos(be),nr=[ir,-Dr,Dr,ir];jr._matMult(nr),Kr._matMult(nr),Va._matMult(nr),Fr._matMult(nr)}const _s=new H(0,0),er=new H(0,0);He.push({tl:jr,tr:Kr,bl:Va,br:Fr,tex:te,writingMode:xt.writingMode,glyphOffset:Mn,sectionIndex:Te.sectionIndex,isSDF:ni,pixelOffsetTL:_s,pixelOffsetBR:er,minFontScaleX:0,minFontScaleY:0})}return He}(0,n,S,d,x,b,l,r.allowVerticalPlacement),at=r.textSizeData;let ft=null;at.kind==="source"?(ft=[Fa*d.layout.get("text-size").evaluate(b,{})],ft[0]>$l&&An(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):at.kind==="composite"&&(ft=[Fa*W.compositeTextSizes[0].evaluate(b,{},K),Fa*W.compositeTextSizes[1].evaluate(b,{},K)],(ft[0]>$l||ft[1]>$l)&&An(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),r.addSymbols(r.text,et,ft,S,x,b,k,e,E.lineStartIndex,E.lineLength,q,K);for(const Dt of N)V[Dt]=r.text.placedSymbolArray.length-1;return 4*et.length}function Tm(r){for(const e in r)return r[e];return null}function Mh(r,e,n,l){const d=r.compareText;if(e in d){const x=d[e];for(let b=x.length-1;b>=0;b--)if(l.dist(x[b])<n)return!0}else d[e]=[];return d[e].push(l),!1}const lp=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class cp{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,l]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const d=l>>4;if(d!==1)throw new Error(`Got v${d} data when expected v1.`);const x=lp[15&l];if(!x)throw new Error("Unrecognized array type.");const[b]=new Uint16Array(e,2,1),[S]=new Uint32Array(e,4,1);return new cp(S,b,x,e)}constructor(e,n=64,l=Float64Array,d){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=l,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const x=lp.indexOf(this.ArrayType),b=2*e*this.ArrayType.BYTES_PER_ELEMENT,S=e*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-S%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${l}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+S+E,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+b+S+E),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+S+E,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=e,this.coords[this._pos++]=n,l}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return up(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:b,nodeSize:S}=this,E=[0,x.length-1,0],k=[];for(;E.length;){const N=E.pop()||0,V=E.pop()||0,q=E.pop()||0;if(V-q<=S){for(let at=q;at<=V;at++){const ft=b[2*at],Dt=b[2*at+1];ft>=e&&ft<=l&&Dt>=n&&Dt<=d&&k.push(x[at])}continue}const W=q+V>>1,K=b[2*W],et=b[2*W+1];K>=e&&K<=l&&et>=n&&et<=d&&k.push(x[W]),(N===0?e<=K:n<=et)&&(E.push(q),E.push(W-1),E.push(1-N)),(N===0?l>=K:d>=et)&&(E.push(W+1),E.push(V),E.push(1-N))}return k}within(e,n,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:x,nodeSize:b}=this,S=[0,d.length-1,0],E=[],k=l*l;for(;S.length;){const N=S.pop()||0,V=S.pop()||0,q=S.pop()||0;if(V-q<=b){for(let at=q;at<=V;at++)Mm(x[2*at],x[2*at+1],e,n)<=k&&E.push(d[at]);continue}const W=q+V>>1,K=x[2*W],et=x[2*W+1];Mm(K,et,e,n)<=k&&E.push(d[W]),(N===0?e-l<=K:n-l<=et)&&(S.push(q),S.push(W-1),S.push(1-N)),(N===0?e+l>=K:n+l>=et)&&(S.push(W+1),S.push(V),S.push(1-N))}return E}}function up(r,e,n,l,d,x){if(d-l<=n)return;const b=l+d>>1;Sm(r,e,b,l,d,x),up(r,e,n,l,b-1,1-x),up(r,e,n,b+1,d,1-x)}function Sm(r,e,n,l,d,x){for(;d>l;){if(d-l>600){const k=d-l+1,N=n-l+1,V=Math.log(k),q=.5*Math.exp(2*V/3),W=.5*Math.sqrt(V*q*(k-q)/k)*(N-k/2<0?-1:1);Sm(r,e,n,Math.max(l,Math.floor(n-N*q/k+W)),Math.min(d,Math.floor(n+(k-N)*q/k+W)),x)}const b=e[2*n+x];let S=l,E=d;for(dd(r,e,l,n),e[2*d+x]>b&&dd(r,e,l,d);S<E;){for(dd(r,e,S,E),S++,E--;e[2*S+x]<b;)S++;for(;e[2*E+x]>b;)E--}e[2*l+x]===b?dd(r,e,l,E):(E++,dd(r,e,E,d)),E<=n&&(l=E+1),n<=E&&(d=E-1)}}function dd(r,e,n,l){hp(r,n,l),hp(e,2*n,2*l),hp(e,2*n+1,2*l+1)}function hp(r,e,n){const l=r[e];r[e]=r[n],r[n]=l}function Mm(r,e,n,l){const d=r-n,x=e-l;return d*d+x*x}var dp;P.cx=void 0,(dp=P.cx||(P.cx={})).create="create",dp.load="load",dp.fullLoad="fullLoad";let fd=null,Yl=[];const Hu=1e3/60,cf="loadTime",fp="fullLoadTime",Ph={mark(r){performance.mark(r)},frame(r){const e=r;fd!=null&&Yl.push(e-fd),fd=e},clearMetrics(){fd=null,Yl=[],performance.clearMeasures(cf),performance.clearMeasures(fp);for(const r in P.cx)performance.clearMarks(P.cx[r])},getPerformanceMetrics(){performance.measure(cf,P.cx.create,P.cx.load),performance.measure(fp,P.cx.create,P.cx.fullLoad);const r=performance.getEntriesByName(cf)[0].duration,e=performance.getEntriesByName(fp)[0].duration,n=Yl.length,l=1/(Yl.reduce((x,b)=>x+b,0)/n/1e3),d=Yl.filter(x=>x>Hu).reduce((x,b)=>x+(b-Hu)/Hu,0);return{loadTime:r,fullLoadTime:e,fps:l,percentDroppedFrames:d/(n+d)*100,totalFrames:n}}};P.$=Ze,P.A=ne,P.B=function([r,e,n]){return e+=90,e*=Math.PI/180,n*=Math.PI/180,{x:r*Math.cos(e)*Math.sin(n),y:r*Math.sin(e)*Math.sin(n),z:r*Math.cos(n)}},P.C=sa,P.D=Re,P.E=Le,P.F=cn,P.G=ro,P.H=function(r){if(dr==null){const e=r.navigator?r.navigator.userAgent:null;dr=!!r.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return dr},P.I=Qh,P.J=class{constructor(r,e){this.target=r,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new pm(()=>this.process()),this.subscription=fa(this.target,"message",n=>this.receive(n),!1),this.globalScope=Ks(self)?r:window}registerMessageHandler(r,e){this.messageHandlers[r]=e}sendAsync(r,e){return new Promise((n,l)=>{const d=Math.round(1e18*Math.random()).toString(36).substring(0,10),x=e?fa(e.signal,"abort",()=>{x?.unsubscribe(),delete this.resolveRejects[d];const E={id:d,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(E)},Fi):null;this.resolveRejects[d]={resolve:E=>{x?.unsubscribe(),n(E)},reject:E=>{x?.unsubscribe(),l(E)}};const b=[],S=Object.assign(Object.assign({},r),{id:d,sourceMapId:this.mapId,origin:location.origin,data:_c(r.data,b)});this.target.postMessage(S,{transfer:b})})}receive(r){const e=r.data,n=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!=="resource://android"&&location.origin!=="resource://android"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[n];const l=this.abortControllers[n];return delete this.abortControllers[n],void(l&&l.abort())}if(Ks(self)||e.mustQueue)return this.tasks[n]=e,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,e)}}process(){if(this.taskQueue.length===0)return;const r=this.taskQueue.shift(),e=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(r,e)}processTask(r,e){return u(this,void 0,void 0,function*(){if(e.type==="<response>"){const d=this.resolveRejects[r];return delete this.resolveRejects[r],d?void(e.error?d.reject(so(e.error)):d.resolve(so(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=so(e.data),l=new AbortController;this.abortControllers[r]=l;try{const d=yield this.messageHandlers[e.type](e.sourceMapId,n,l);this.completeTask(r,null,d)}catch(d){this.completeTask(r,d)}})}completeTask(r,e,n){const l=[];delete this.abortControllers[r];const d={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?_c(e):null,data:_c(n,l)};this.target.postMessage(d,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},P.K=st,P.L=function(){var r=new ne(16);return ne!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},P.M=function(r,e,n){var l,d,x,b,S,E,k,N,V,q,W,K,et=n[0],at=n[1],ft=n[2];return e===r?(r[12]=e[0]*et+e[4]*at+e[8]*ft+e[12],r[13]=e[1]*et+e[5]*at+e[9]*ft+e[13],r[14]=e[2]*et+e[6]*at+e[10]*ft+e[14],r[15]=e[3]*et+e[7]*at+e[11]*ft+e[15]):(d=e[1],x=e[2],b=e[3],S=e[4],E=e[5],k=e[6],N=e[7],V=e[8],q=e[9],W=e[10],K=e[11],r[0]=l=e[0],r[1]=d,r[2]=x,r[3]=b,r[4]=S,r[5]=E,r[6]=k,r[7]=N,r[8]=V,r[9]=q,r[10]=W,r[11]=K,r[12]=l*et+S*at+V*ft+e[12],r[13]=d*et+E*at+q*ft+e[13],r[14]=x*et+k*at+W*ft+e[14],r[15]=b*et+N*at+K*ft+e[15]),r},P.N=function(r,e,n){var l=n[0],d=n[1],x=n[2];return r[0]=e[0]*l,r[1]=e[1]*l,r[2]=e[2]*l,r[3]=e[3]*l,r[4]=e[4]*d,r[5]=e[5]*d,r[6]=e[6]*d,r[7]=e[7]*d,r[8]=e[8]*x,r[9]=e[9]*x,r[10]=e[10]*x,r[11]=e[11]*x,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},P.O=function(r,e,n){var l=e[0],d=e[1],x=e[2],b=e[3],S=e[4],E=e[5],k=e[6],N=e[7],V=e[8],q=e[9],W=e[10],K=e[11],et=e[12],at=e[13],ft=e[14],Dt=e[15],xt=n[0],Mt=n[1],jt=n[2],$t=n[3];return r[0]=xt*l+Mt*S+jt*V+$t*et,r[1]=xt*d+Mt*E+jt*q+$t*at,r[2]=xt*x+Mt*k+jt*W+$t*ft,r[3]=xt*b+Mt*N+jt*K+$t*Dt,r[4]=(xt=n[4])*l+(Mt=n[5])*S+(jt=n[6])*V+($t=n[7])*et,r[5]=xt*d+Mt*E+jt*q+$t*at,r[6]=xt*x+Mt*k+jt*W+$t*ft,r[7]=xt*b+Mt*N+jt*K+$t*Dt,r[8]=(xt=n[8])*l+(Mt=n[9])*S+(jt=n[10])*V+($t=n[11])*et,r[9]=xt*d+Mt*E+jt*q+$t*at,r[10]=xt*x+Mt*k+jt*W+$t*ft,r[11]=xt*b+Mt*N+jt*K+$t*Dt,r[12]=(xt=n[12])*l+(Mt=n[13])*S+(jt=n[14])*V+($t=n[15])*et,r[13]=xt*d+Mt*E+jt*q+$t*at,r[14]=xt*x+Mt*k+jt*W+$t*ft,r[15]=xt*b+Mt*N+jt*K+$t*Dt,r},P.P=H,P.Q=function(r,e){const n={};for(let l=0;l<e.length;l++){const d=e[l];d in r&&(n[d]=r[d])}return n},P.R=Is,P.S=hl,P.T=ul,P.U=wh,P.V=tf,P.W=pe,P.X=ge,P.Y=vo,P.Z=Ys,P._=u,P.a=tt,P.a$=Ir,P.a0=function(r,e){var n,l,d,x;if(!r)return e??{};if(!e)return r;const b=Object.assign({},r);if(e.removeAll&&(b.removeAll=!0),e.remove){const S=new Set(b.remove?b.remove.concat(e.remove):e.remove);b.remove=Array.from(S.values())}if(e.add){const S=b.add?b.add.concat(e.add):e.add,E=new Map(S.map(k=>[k.id,k]));b.add=Array.from(E.values())}if(e.update){const S=new Map((n=b.update)===null||n===void 0?void 0:n.map(E=>[E.id,E]));for(const E of e.update){const k=(l=S.get(E.id))!==null&&l!==void 0?l:{id:E.id};E.newGeometry&&(k.newGeometry=E.newGeometry),E.addOrUpdateProperties&&(k.addOrUpdateProperties=((d=k.addOrUpdateProperties)!==null&&d!==void 0?d:[]).concat(E.addOrUpdateProperties)),E.removeProperties&&(k.removeProperties=((x=k.removeProperties)!==null&&x!==void 0?x:[]).concat(E.removeProperties)),E.removeAllProperties&&(k.removeAllProperties=!0),S.set(E.id,k)}b.update=Array.from(S.values())}return b},P.a1=cd,P.a2=hr,P.a3=25,P.a4=ef,P.a5=r=>{const e=window.document.createElement("video");return e.muted=!0,new Promise(n=>{e.onloadstart=()=>{n(e)};for(const l of r){const d=window.document.createElement("source");Ft(l)||(e.crossOrigin="Anonymous"),d.src=l,e.appendChild(d)}})},P.a6=ue,P.a7=function(){return rr++},P.a8=U,P.a9=Vu,P.aA=function(r){let e=1/0,n=1/0,l=-1/0,d=-1/0;for(const x of r)e=Math.min(e,x.x),n=Math.min(n,x.y),l=Math.max(l,x.x),d=Math.max(d,x.y);return[e,n,l,d]},P.aB=Hn,P.aC=yt,P.aD=function(r,e,n,l,d=!1){if(!n[0]&&!n[1])return[0,0];const x=d?l==="map"?-r.bearingInRadians:0:l==="viewport"?r.bearingInRadians:0;if(x){const b=Math.sin(x),S=Math.cos(x);n=[n[0]*S-n[1]*b,n[0]*b+n[1]*S]}return[d?n[0]:yt(e,n[0],r.zoom),d?n[1]:yt(e,n[1],r.zoom)]},P.aF=nd,P.aG=Sh,P.aH=Wd,P.aI=cp,P.aJ=Yn,P.aK=Rs,P.aL=gt,P.aM=mi,P.aN=Yi,P.aO=rn,P.aP=xo,P.aQ=ip,P.aR=Ti,P.aS=Ei,P.aT=function(r){var e=new ne(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e},P.aU=function(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r},P.aV=function(r,e){var n=e[0],l=e[1],d=e[2],x=n*n+l*l+d*d;return x>0&&(x=1/Math.sqrt(x)),r[0]=e[0]*x,r[1]=e[1]*x,r[2]=e[2]*x,r},P.aW=zi,P.aX=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]},P.aY=function(r,e,n){return r[0]=e[0]*n[0],r[1]=e[1]*n[1],r[2]=e[2]*n[2],r[3]=e[3]*n[3],r},P.aZ=Je,P.a_=function(r,e,n){const l=e[0]*n[0]+e[1]*n[1]+e[2]*n[2];return l===0?null:(-(r[0]*n[0]+r[1]*n[1]+r[2]*n[2])-n[3])/l},P.aa=qt,P.ab=Ba,P.ac=nf,P.ad=function(r){const e={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,l,d,x)=>{const b=d||x;return e[l]=!b||b.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e},P.ae=Go,P.af=function(r){return Math.pow(2,r)},P.ag=we,P.ah=Se,P.ai=85.051129,P.aj=ld,P.ak=function(r){return Math.log(r)/Math.LN2},P.al=function(r){var e=r[0],n=r[1];return e*e+n*n},P.am=function(r,e){const n=[];for(const l in r)l in e||n.push(l);return n},P.an=function(r,e){let n=0,l=0;if(r.kind==="constant")l=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:d,minZoom:x,maxZoom:b}=r,S=d?Se(mr.interpolationFactor(d,e,x,b),0,1):0;r.kind==="camera"?l=sa.number(r.minSize,r.maxSize,S):n=S}return{uSizeT:n,uSize:l}},P.ap=function(r,{uSize:e,uSizeT:n},{lowerSize:l,upperSize:d}){return r.kind==="source"?l/Fa:r.kind==="composite"?sa.number(l/Fa,d/Fa,n):e},P.aq=function(r,e){var n=e[0],l=e[1],d=e[2],x=e[3],b=e[4],S=e[5],E=e[6],k=e[7],N=e[8],V=e[9],q=e[10],W=e[11],K=e[12],et=e[13],at=e[14],ft=e[15],Dt=n*S-l*b,xt=n*E-d*b,Mt=n*k-x*b,jt=l*E-d*S,$t=l*k-x*S,se=d*k-x*E,Pe=N*et-V*K,ye=N*at-q*K,be=N*ft-W*K,He=V*at-q*et,Ae=V*ft-W*et,Te=q*ft-W*at,te=Dt*Te-xt*Ae+Mt*He+jt*be-$t*ye+se*Pe;return te?(r[0]=(S*Te-E*Ae+k*He)*(te=1/te),r[1]=(d*Ae-l*Te-x*He)*te,r[2]=(et*se-at*$t+ft*jt)*te,r[3]=(q*$t-V*se-W*jt)*te,r[4]=(E*be-b*Te-k*ye)*te,r[5]=(n*Te-d*be+x*ye)*te,r[6]=(at*Mt-K*se-ft*xt)*te,r[7]=(N*se-q*Mt+W*xt)*te,r[8]=(b*Ae-S*be+k*Pe)*te,r[9]=(l*be-n*Ae-x*Pe)*te,r[10]=(K*$t-et*Mt+ft*Dt)*te,r[11]=(V*Mt-N*$t-W*Dt)*te,r[12]=(S*ye-b*He-E*Pe)*te,r[13]=(n*He-l*ye+d*Pe)*te,r[14]=(et*xt-K*jt-at*Dt)*te,r[15]=(N*jt-V*xt+q*Dt)*te,r):null},P.ar=me,P.as=function(r){return Math.hypot(r[0],r[1])},P.at=function(r){return r[0]=0,r[1]=0,r},P.au=function(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r},P.av=Fu,P.aw=Rn,P.ax=function(r,e,n,l){const d=e.y-r.y,x=e.x-r.x,b=l.y-n.y,S=l.x-n.x,E=b*x-S*d;if(E===0)return null;const k=(S*(r.y-n.y)-b*(r.x-n.x))/E;return new H(r.x+k*x,r.y+k*d)},P.ay=rp,P.az=Pf,P.b=ys,P.b$=class extends g{},P.b0=function(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r},P.b1=function(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]},P.b2=np,P.b3=Hi,P.b4=function(r,e,n,l,d){var x,b=1/Math.tan(e/2);return r[0]=b/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=b,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,d!=null&&d!==1/0?(r[10]=(d+l)*(x=1/(l-d)),r[14]=2*d*l*x):(r[10]=-1,r[14]=-2*l),r},P.b5=function(r){var e=new ne(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},P.b6=function(r,e,n){var l=Math.sin(n),d=Math.cos(n),x=e[0],b=e[1],S=e[2],E=e[3],k=e[4],N=e[5],V=e[6],q=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=x*d+k*l,r[1]=b*d+N*l,r[2]=S*d+V*l,r[3]=E*d+q*l,r[4]=k*d-x*l,r[5]=N*d-b*l,r[6]=V*d-S*l,r[7]=q*d-E*l,r},P.b7=function(r,e,n){var l=Math.sin(n),d=Math.cos(n),x=e[4],b=e[5],S=e[6],E=e[7],k=e[8],N=e[9],V=e[10],q=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=x*d+k*l,r[5]=b*d+N*l,r[6]=S*d+V*l,r[7]=E*d+q*l,r[8]=k*d-x*l,r[9]=N*d-b*l,r[10]=V*d-S*l,r[11]=q*d-E*l,r},P.b8=function(){const r=new Float32Array(16);return we(r),r},P.b9=function(){const r=new Float64Array(16);return we(r),r},P.bA=function(r,e){const n=Wt(r,360),l=Wt(e,360),d=l-n,x=l>n?d-360:d+360;return Math.abs(d)<Math.abs(x)?d:x},P.bB=function(r){return r[0]=0,r[1]=0,r[2]=0,r},P.bC=function(r,e,n,l){const d=Math.sqrt(r*r+e*e),x=Math.sqrt(n*n+l*l);r/=d,e/=d,n/=x,l/=x;const b=Math.acos(r*n+e*l);return-e*n+r*l>0?b:-b},P.bD=function(r,e){const n=Wt(r,2*Math.PI),l=Wt(e,2*Math.PI);return Math.min(Math.abs(n-l),Math.abs(n-l+2*Math.PI),Math.abs(n-l-2*Math.PI))},P.bE=function(){const r={},e=It.$version;for(const n in It.$root){const l=It.$root[n];if(l.required){let d=null;d=n==="version"?e:l.type==="array"?[]:{},d!=null&&(r[n]=d)}}return r},P.bF=Tu,P.bG=Pt,P.bH=function r(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(let l=0;l<e.length;l++)if(!r(e[l],n[l]))return!1;return!0}if(typeof e=="object"&&e!==null&&n!==null){if(typeof n!="object"||Object.keys(e).length!==Object.keys(n).length)return!1;for(const l in e)if(!r(e[l],n[l]))return!1;return!0}return e===n},P.bI=function(r){r=r.slice();const e=Object.create(null);for(let n=0;n<r.length;n++)e[r[n].id]=r[n];for(let n=0;n<r.length;n++)"ref"in r[n]&&(r[n]=bi(r[n],e[r[n].ref]));return r},P.bJ=function(r){if(r.type==="custom")return new e_(r);switch(r.type){case"background":return new tp(r);case"circle":return new Np(r);case"color-relief":return new Up(r);case"fill":return new tu(r);case"fill-extrusion":return new ji(r);case"heatmap":return new If(r);case"hillshade":return new jp(r);case"line":return new Na(r);case"raster":return new ad(r);case"symbol":return new sd(r)}},P.bK=sr,P.bL=function(r,e){if(!r)return[{command:"setStyle",args:[e]}];let n=[];try{if(!Ge(r.version,e.version))return[{command:"setStyle",args:[e]}];Ge(r.center,e.center)||n.push({command:"setCenter",args:[e.center]}),Ge(r.state,e.state)||n.push({command:"setGlobalState",args:[e.state]}),Ge(r.centerAltitude,e.centerAltitude)||n.push({command:"setCenterAltitude",args:[e.centerAltitude]}),Ge(r.zoom,e.zoom)||n.push({command:"setZoom",args:[e.zoom]}),Ge(r.bearing,e.bearing)||n.push({command:"setBearing",args:[e.bearing]}),Ge(r.pitch,e.pitch)||n.push({command:"setPitch",args:[e.pitch]}),Ge(r.roll,e.roll)||n.push({command:"setRoll",args:[e.roll]}),Ge(r.sprite,e.sprite)||n.push({command:"setSprite",args:[e.sprite]}),Ge(r.glyphs,e.glyphs)||n.push({command:"setGlyphs",args:[e.glyphs]}),Ge(r.transition,e.transition)||n.push({command:"setTransition",args:[e.transition]}),Ge(r.light,e.light)||n.push({command:"setLight",args:[e.light]}),Ge(r.terrain,e.terrain)||n.push({command:"setTerrain",args:[e.terrain]}),Ge(r.sky,e.sky)||n.push({command:"setSky",args:[e.sky]}),Ge(r.projection,e.projection)||n.push({command:"setProjection",args:[e.projection]});const l={},d=[];(function(b,S,E,k){let N;for(N in S=S||{},b=b||{})Object.prototype.hasOwnProperty.call(b,N)&&(Object.prototype.hasOwnProperty.call(S,N)||qn(N,E,k));for(N in S)Object.prototype.hasOwnProperty.call(S,N)&&(Object.prototype.hasOwnProperty.call(b,N)?Ge(b[N],S[N])||(b[N].type==="geojson"&&S[N].type==="geojson"&&$i(b,S,N)?li(E,{command:"setGeoJSONSourceData",args:[N,S[N].data]}):Un(N,S,E,k)):Zi(N,S,E))})(r.sources,e.sources,d,l);const x=[];r.layers&&r.layers.forEach(b=>{"source"in b&&l[b.source]?n.push({command:"removeLayer",args:[b.id]}):x.push(b)}),n=n.concat(d),function(b,S,E){S=S||[];const k=(b=b||[]).map(si),N=S.map(si),V=b.reduce(fn,{}),q=S.reduce(fn,{}),W=k.slice(),K=Object.create(null);let et,at,ft,Dt,xt;for(let Mt=0,jt=0;Mt<k.length;Mt++)et=k[Mt],Object.prototype.hasOwnProperty.call(q,et)?jt++:(li(E,{command:"removeLayer",args:[et]}),W.splice(W.indexOf(et,jt),1));for(let Mt=0,jt=0;Mt<N.length;Mt++)et=N[N.length-1-Mt],W[W.length-1-Mt]!==et&&(Object.prototype.hasOwnProperty.call(V,et)?(li(E,{command:"removeLayer",args:[et]}),W.splice(W.lastIndexOf(et,W.length-jt),1)):jt++,Dt=W[W.length-Mt],li(E,{command:"addLayer",args:[q[et],Dt]}),W.splice(W.length-Mt,0,et),K[et]=!0);for(let Mt=0;Mt<N.length;Mt++)if(et=N[Mt],at=V[et],ft=q[et],!K[et]&&!Ge(at,ft))if(Ge(at.source,ft.source)&&Ge(at["source-layer"],ft["source-layer"])&&Ge(at.type,ft.type)){for(xt in ii(at.layout,ft.layout,E,et,null,"setLayoutProperty"),ii(at.paint,ft.paint,E,et,null,"setPaintProperty"),Ge(at.filter,ft.filter)||li(E,{command:"setFilter",args:[et,ft.filter]}),Ge(at.minzoom,ft.minzoom)&&Ge(at.maxzoom,ft.maxzoom)||li(E,{command:"setLayerZoomRange",args:[et,ft.minzoom,ft.maxzoom]}),at)Object.prototype.hasOwnProperty.call(at,xt)&&xt!=="layout"&&xt!=="paint"&&xt!=="filter"&&xt!=="metadata"&&xt!=="minzoom"&&xt!=="maxzoom"&&(xt.indexOf("paint.")===0?ii(at[xt],ft[xt],E,et,xt.slice(6),"setPaintProperty"):Ge(at[xt],ft[xt])||li(E,{command:"setLayerProperty",args:[et,xt,ft[xt]]}));for(xt in ft)Object.prototype.hasOwnProperty.call(ft,xt)&&!Object.prototype.hasOwnProperty.call(at,xt)&&xt!=="layout"&&xt!=="paint"&&xt!=="filter"&&xt!=="metadata"&&xt!=="minzoom"&&xt!=="maxzoom"&&(xt.indexOf("paint.")===0?ii(at[xt],ft[xt],E,et,xt.slice(6),"setPaintProperty"):Ge(at[xt],ft[xt])||li(E,{command:"setLayerProperty",args:[et,xt,ft[xt]]}))}else li(E,{command:"removeLayer",args:[et]}),Dt=W[W.lastIndexOf(et)+1],li(E,{command:"addLayer",args:[ft,Dt]})}(x,e.layers,n)}catch(l){console.warn("Unable to compute style diff:",l),n=[{command:"setStyle",args:[e]}]}return n},P.bM=function(r){const e=[],n=r.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),r.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},P.bN=da,P.bO=Ws,P.bP=class extends fs{constructor(r,e){super(r,e),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},P.bQ=Gn,P.bR=class extends fs{constructor(r,e){super(r,e),this.current=Ls}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let e=1;e<16;e++)if(r[e]!==this.current[e]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},P.bS=Ln,P.bT=class extends fs{constructor(r,e){super(r,e),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},P.bU=class extends fs{constructor(r,e){super(r,e),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},P.bV=Ne,P.bW=function(r,e){var n=Math.sin(e),l=Math.cos(e);return r[0]=l,r[1]=n,r[2]=0,r[3]=-n,r[4]=l,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},P.bX=function(r,e,n){var l=e[0],d=e[1],x=e[2];return r[0]=l*n[0]+d*n[3]+x*n[6],r[1]=l*n[1]+d*n[4]+x*n[7],r[2]=l*n[2]+d*n[5]+x*n[8],r},P.bY=function(r,e,n,l,d,x,b){var S=1/(e-n),E=1/(l-d),k=1/(x-b);return r[0]=-2*S,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*E,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*k,r[11]=0,r[12]=(e+n)*S,r[13]=(d+l)*E,r[14]=(b+x)*k,r[15]=1,r},P.bZ=class extends fs{constructor(r,e){super(r,e),this.current=new Array}set(r){if(r!=this.current){this.current=r;const e=new Float32Array(4*r.length);for(let n=0;n<r.length;n++)e[4*n]=r[n].r,e[4*n+1]=r[n].g,e[4*n+2]=r[n].b,e[4*n+3]=r[n].a;this.gl.uniform4fv(this.location,e)}}},P.b_=class extends fs{constructor(r,e){super(r,e),this.current=new Array}set(r){if(r!=this.current){this.current=r;const e=new Float32Array(r);this.gl.uniform1fv(this.location,e)}}},P.ba=function(){return new Float64Array(16)},P.bb=function(r,e,n){const l=new Float64Array(4);return Qt(l,r,e-90,n),l},P.bc=function(r,e,n,l){var d,x,b,S,E,k=e[0],N=e[1],V=e[2],q=e[3],W=n[0],K=n[1],et=n[2],at=n[3];return(x=k*W+N*K+V*et+q*at)<0&&(x=-x,W=-W,K=-K,et=-et,at=-at),1-x>de?(d=Math.acos(x),b=Math.sin(d),S=Math.sin((1-l)*d)/b,E=Math.sin(l*d)/b):(S=1-l,E=l),r[0]=S*k+E*W,r[1]=S*N+E*K,r[2]=S*V+E*et,r[3]=S*q+E*at,r},P.bd=function(r){const e=new Float64Array(9);var n,l,d,x,b,S,E,k,N,V,q,W,K,et,at,ft,Dt,xt;V=(d=(l=r)[0])*(E=d+d),q=(x=l[1])*E,K=(b=l[2])*E,et=b*(k=x+x),ft=(S=l[3])*E,Dt=S*k,xt=S*(N=b+b),(n=e)[0]=1-(W=x*k)-(at=b*N),n[3]=q-xt,n[6]=K+Dt,n[1]=q+xt,n[4]=1-V-at,n[7]=et-ft,n[2]=K-Dt,n[5]=et+ft,n[8]=1-V-W;const Mt=xo(-Math.asin(Se(e[2],-1,1)));let jt,$t;return Math.hypot(e[5],e[8])<.001?(jt=0,$t=-xo(Math.atan2(e[3],e[4]))):(jt=xo(e[5]===0&&e[8]===0?0:Math.atan2(e[5],e[8])),$t=xo(e[1]===0&&e[0]===0?0:Math.atan2(e[1],e[0]))),{roll:jt,pitch:Mt+90,bearing:$t}},P.be=function(r,e){return r.roll==e.roll&&r.pitch==e.pitch&&r.bearing==e.bearing},P.bf=di,P.bg=Fl,P.bh=Oa,P.bi=hh,P.bj=yn,P.bk=Ce,P.bl=xe,P.bm=_n,P.bn=function(r,e,n,l,d){return Ce(l,d,Se((r-e)/(n-e),0,1))},P.bo=Wt,P.bp=function(){return new Float64Array(3)},P.bq=function(r,e,n,l){return r[0]=e[0]+n[0]*l,r[1]=e[1]+n[1]*l,r[2]=e[2]+n[2]*l,r},P.br=Qt,P.bs=function(r,e,n){var l=n[0],d=n[1],x=n[2],b=e[0],S=e[1],E=e[2],k=d*E-x*S,N=x*b-l*E,V=l*S-d*b,q=d*V-x*N,W=x*k-l*V,K=l*N-d*k,et=2*n[3];return N*=et,V*=et,W*=2,K*=2,r[0]=b+(k*=et)+(q*=2),r[1]=S+N+W,r[2]=E+V+K,r},P.bt=function(r,e,n){const l=(d=[r[0],r[1],r[2],e[0],e[1],e[2],n[0],n[1],n[2]])[0]*((N=d[8])*(b=d[4])-(S=d[5])*(k=d[7]))+d[1]*(-N*(x=d[3])+S*(E=d[6]))+d[2]*(k*x-b*E);var d,x,b,S,E,k,N;if(l===0)return null;const V=zi([],[e[0],e[1],e[2]],[n[0],n[1],n[2]]),q=zi([],[n[0],n[1],n[2]],[r[0],r[1],r[2]]),W=zi([],[r[0],r[1],r[2]],[e[0],e[1],e[2]]),K=Ti([],V,-r[3]);return Ei(K,K,Ti([],q,-e[3])),Ei(K,K,Ti([],W,-n[3])),Ti(K,K,1/l),K},P.bu=od,P.bv=function(){return new Float64Array(4)},P.bw=function(r,e,n,l){var d=[],x=[];return d[0]=e[0]-n[0],d[1]=e[1]-n[1],d[2]=e[2]-n[2],x[0]=d[0]*Math.cos(l)-d[1]*Math.sin(l),x[1]=d[0]*Math.sin(l)+d[1]*Math.cos(l),x[2]=d[2],r[0]=x[0]+n[0],r[1]=x[1]+n[1],r[2]=x[2]+n[2],r},P.bx=function(r,e,n,l){var d=[],x=[];return d[0]=e[0]-n[0],d[1]=e[1]-n[1],d[2]=e[2]-n[2],x[0]=d[0],x[1]=d[1]*Math.cos(l)-d[2]*Math.sin(l),x[2]=d[1]*Math.sin(l)+d[2]*Math.cos(l),r[0]=x[0]+n[0],r[1]=x[1]+n[1],r[2]=x[2]+n[2],r},P.by=function(r,e,n,l){var d=[],x=[];return d[0]=e[0]-n[0],d[1]=e[1]-n[1],d[2]=e[2]-n[2],x[0]=d[2]*Math.sin(l)+d[0]*Math.cos(l),x[1]=d[1],x[2]=d[2]*Math.cos(l)-d[0]*Math.sin(l),r[0]=x[0]+n[0],r[1]=x[1]+n[1],r[2]=x[2]+n[2],r},P.bz=function(r,e,n){var l=Math.sin(n),d=Math.cos(n),x=e[0],b=e[1],S=e[2],E=e[3],k=e[8],N=e[9],V=e[10],q=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=x*d-k*l,r[1]=b*d-N*l,r[2]=S*d-V*l,r[3]=E*d-q*l,r[8]=x*l+k*d,r[9]=b*l+N*d,r[10]=S*l+V*d,r[11]=E*l+q*d,r},P.c=Ct,P.c0=ks,P.c1=class extends s{},P.c2=Od,P.c3=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},P.c4=Bd,P.c5=function(r,e,n){var l=e[0],d=e[1],x=e[2],b=n[3]*l+n[7]*d+n[11]*x+n[15];return r[0]=(n[0]*l+n[4]*d+n[8]*x+n[12])/(b=b||1),r[1]=(n[1]*l+n[5]*d+n[9]*x+n[13])/b,r[2]=(n[2]*l+n[6]*d+n[10]*x+n[14])/b,r},P.c6=class extends ds{},P.c7=class extends O{},P.c8=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]&&r[9]===e[9]&&r[10]===e[10]&&r[11]===e[11]&&r[12]===e[12]&&r[13]===e[13]&&r[14]===e[14]&&r[15]===e[15]},P.c9=function(r,e){var n=r[0],l=r[1],d=r[2],x=r[3],b=r[4],S=r[5],E=r[6],k=r[7],N=r[8],V=r[9],q=r[10],W=r[11],K=r[12],et=r[13],at=r[14],ft=r[15],Dt=e[0],xt=e[1],Mt=e[2],jt=e[3],$t=e[4],se=e[5],Pe=e[6],ye=e[7],be=e[8],He=e[9],Ae=e[10],Te=e[11],te=e[12],ei=e[13],ni=e[14],We=e[15];return Math.abs(n-Dt)<=de*Math.max(1,Math.abs(n),Math.abs(Dt))&&Math.abs(l-xt)<=de*Math.max(1,Math.abs(l),Math.abs(xt))&&Math.abs(d-Mt)<=de*Math.max(1,Math.abs(d),Math.abs(Mt))&&Math.abs(x-jt)<=de*Math.max(1,Math.abs(x),Math.abs(jt))&&Math.abs(b-$t)<=de*Math.max(1,Math.abs(b),Math.abs($t))&&Math.abs(S-se)<=de*Math.max(1,Math.abs(S),Math.abs(se))&&Math.abs(E-Pe)<=de*Math.max(1,Math.abs(E),Math.abs(Pe))&&Math.abs(k-ye)<=de*Math.max(1,Math.abs(k),Math.abs(ye))&&Math.abs(N-be)<=de*Math.max(1,Math.abs(N),Math.abs(be))&&Math.abs(V-He)<=de*Math.max(1,Math.abs(V),Math.abs(He))&&Math.abs(q-Ae)<=de*Math.max(1,Math.abs(q),Math.abs(Ae))&&Math.abs(W-Te)<=de*Math.max(1,Math.abs(W),Math.abs(Te))&&Math.abs(K-te)<=de*Math.max(1,Math.abs(K),Math.abs(te))&&Math.abs(et-ei)<=de*Math.max(1,Math.abs(et),Math.abs(ei))&&Math.abs(at-ni)<=de*Math.max(1,Math.abs(at),Math.abs(ni))&&Math.abs(ft-We)<=de*Math.max(1,Math.abs(ft),Math.abs(We))},P.cA=function(r,e){tt.REGISTERED_PROTOCOLS[r]=e},P.cB=function(r){delete tt.REGISTERED_PROTOCOLS[r]},P.cC=function(r,e){const n={};for(let d=0;d<r.length;d++){const x=e&&e[r[d].id]||qs(r[d]);e&&(e[r[d].id]=x);let b=n[x];b||(b=n[x]=[]),b.push(r[d])}const l=[];for(const d in n)l.push(n[d]);return l},P.cD=Ee,P.cE=_m,P.cF=rf,P.cG=sm,P.cH=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=Ze/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const e=r.bucket.layers[0],n=e.layout,l=e._unevaluatedLayout._values,d={layoutIconSize:l["icon-size"].possiblyEvaluate(new cn(r.bucket.zoom+1),r.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new cn(r.bucket.zoom+1),r.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new cn(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:N}=r.bucket.textSizeData;d.compositeTextSizes=[l["text-size"].possiblyEvaluate(new cn(k),r.canonical),l["text-size"].possiblyEvaluate(new cn(N),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:N}=r.bucket.iconSizeData;d.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new cn(k),r.canonical),l["icon-size"].possiblyEvaluate(new cn(N),r.canonical)]}const x=n.get("text-line-height")*Hn,b=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",S=n.get("text-keep-upright"),E=n.get("text-size");for(const k of r.bucket.features){const N=n.get("text-font").evaluate(k,{},r.canonical).join(","),V=E.evaluate(k,{},r.canonical),q=d.layoutTextSize.evaluate(k,{},r.canonical),W=d.layoutIconSize.evaluate(k,{},r.canonical),K={horizontal:{},vertical:void 0},et=k.text;let at,ft=[0,0];if(et){const Mt=et.toString(),jt=n.get("text-letter-spacing").evaluate(k,{},r.canonical)*Hn,$t=Nh(Mt)?jt:0,se=n.get("text-anchor").evaluate(k,{},r.canonical),Pe=op(e,k,r.canonical);if(!Pe){const Ae=n.get("text-radial-offset").evaluate(k,{},r.canonical);ft=Ae?_o(se,[Ae*Hn,Gu]):n.get("text-offset").evaluate(k,{},r.canonical).map(Te=>Te*Hn)}let ye=b?"center":n.get("text-justify").evaluate(k,{},r.canonical);const be=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(k,{},r.canonical)*Hn:1/0,He=()=>{r.bucket.allowVerticalPlacement&&ao(Mt)&&(K.vertical=td(et,r.glyphMap,r.glyphPositions,r.imagePositions,N,be,x,se,"left",$t,ft,P.ao.vertical,!0,q,V))};if(!b&&Pe){const Ae=new Set;if(ye==="auto")for(let te=0;te<Pe.values.length;te+=2)Ae.add(Sh(Pe.values[te]));else Ae.add(ye);let Te=!1;for(const te of Ae)if(!K.horizontal[te])if(Te)K.horizontal[te]=K.horizontal[0];else{const ei=td(et,r.glyphMap,r.glyphPositions,r.imagePositions,N,be,x,"center",te,$t,ft,P.ao.horizontal,!1,q,V);ei&&(K.horizontal[te]=ei,Te=ei.positionedLines.length===1)}He()}else{ye==="auto"&&(ye=Sh(se));const Ae=td(et,r.glyphMap,r.glyphPositions,r.imagePositions,N,be,x,se,ye,$t,ft,P.ao.horizontal,!1,q,V);Ae&&(K.horizontal[ye]=Ae),He(),ao(Mt)&&b&&S&&(K.vertical=td(et,r.glyphMap,r.glyphPositions,r.imagePositions,N,be,x,se,ye,$t,ft,P.ao.vertical,!1,q,V))}}let Dt=!1;if(k.icon&&k.icon.name){const Mt=r.imageMap[k.icon.name];Mt&&(at=Qm(r.imagePositions[k.icon.name],n.get("icon-offset").evaluate(k,{},r.canonical),n.get("icon-anchor").evaluate(k,{},r.canonical)),Dt=!!Mt.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=Dt:r.bucket.sdfIcons!==Dt&&An("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Mt.pixelRatio!==r.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const xt=Tm(K.horizontal)||K.vertical;r.bucket.iconsInText=!!xt&&xt.iconsInText,(xt||at)&&Dc(r.bucket,k,K,at,r.imageMap,d,q,W,ft,Dt,r.canonical,r.subdivisionGranularity)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},P.cI=Hl,P.cJ=ca,P.cK=gh,P.cL=Vf,P.cM=Ou,P.cN=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},P.cO=function(r,e,n,l,d){return u(this,void 0,void 0,function*(){if(ge())try{return yield vo(r,e,n,l,d)}catch{}return function(x,b,S,E,k){const N=x.width,V=x.height;vs&&Ha||(vs=new OffscreenCanvas(N,V),Ha=vs.getContext("2d",{willReadFrequently:!0})),vs.width=N,vs.height=V,Ha.drawImage(x,0,0,N,V);const q=Ha.getImageData(b,S,E,k);return Ha.clearRect(0,0,N,V),q.data}(r,e,n,l,d)})},P.cP=jd,P.cQ=X,P.cR=ph,P.cS=ku,P.cT=Ca,P.cU=function(r,e){const n=new Map;if(r!=null)if(r.type==="Feature")n.set(Uu(r,e),r);else for(const l of r.features)n.set(Uu(l,e),l);return n},P.cV=function(r,e){if(r==null)return!0;if(r.type==="Feature")return Uu(r,e)!=null;if(r.type==="FeatureCollection"){const n=new Set;for(const l of r.features){const d=Uu(l,e);if(d==null||n.has(d))return!1;n.add(d)}return!0}return!1},P.cW=function(r,e,n){var l,d,x,b;if(e.removeAll&&r.clear(),e.remove)for(const S of e.remove)r.delete(S);if(e.add)for(const S of e.add){const E=Uu(S,n);E!=null&&r.set(E,S)}if(e.update)for(const S of e.update){let E=r.get(S.id);if(E==null)continue;const k=!S.removeAllProperties&&(((l=S.removeProperties)===null||l===void 0?void 0:l.length)>0||((d=S.addOrUpdateProperties)===null||d===void 0?void 0:d.length)>0);if((S.newGeometry||S.removeAllProperties||k)&&(E=Object.assign({},E),r.set(S.id,E),k&&(E.properties=Object.assign({},E.properties))),S.newGeometry&&(E.geometry=S.newGeometry),S.removeAllProperties)E.properties={};else if(((x=S.removeProperties)===null||x===void 0?void 0:x.length)>0)for(const N of S.removeProperties)Object.prototype.hasOwnProperty.call(E.properties,N)&&delete E.properties[N];if(((b=S.addOrUpdateProperties)===null||b===void 0?void 0:b.length)>0)for(const{key:N,value:V}of S.addOrUpdateProperties)E.properties[N]=V}},P.cX=hs,P.ca=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},P.cb=r=>r.type==="symbol",P.cc=r=>r.type==="circle",P.cd=r=>r.type==="heatmap",P.ce=r=>r.type==="line",P.cf=r=>r.type==="fill",P.cg=r=>r.type==="fill-extrusion",P.ch=r=>r.type==="hillshade",P.ci=r=>r.type==="color-relief",P.cj=r=>r.type==="raster",P.ck=r=>r.type==="background",P.cl=r=>r.type==="custom",P.cm=ze,P.cn=function(r,e,n){const l=fe(e.x-n.x,e.y-n.y),d=fe(r.x-n.x,r.y-n.y);var x,b;return xo(Math.atan2(l[0]*d[1]-l[1]*d[0],(x=l)[0]*(b=d)[0]+x[1]*b[1]))},P.co=Fe,P.cp=function(r,e){return Vn[e]&&(r instanceof MouseEvent||r instanceof WheelEvent)},P.cq=function(r,e){return ts[e]&&"touches"in r},P.cr=function(r){return ts[r]||Vn[r]},P.cs=function(r,e,n){var l=e[0],d=e[1];return r[0]=n[0]*l+n[4]*d+n[12],r[1]=n[1]*l+n[5]*d+n[13],r},P.ct=function(r,e){const{x:n,y:l}=cd.fromLngLat(e);return!(r<0||r>25||l<0||l>=1||n<0||n>=1)},P.cu=function(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},P.cv=class extends Bl{},P.cw=Ph,P.cy=function(r){return r.message===es},P.cz=_t,P.d=Ft,P.e=xi,P.f=r=>u(void 0,void 0,void 0,function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(e)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),P.g=it,P.h=r=>new Promise((e,n)=>{const l=new Image;l.onload=()=>{e(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=Qs})},l.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const d=new Blob([new Uint8Array(r)],{type:"image/png"});l.src=r.byteLength?URL.createObjectURL(d):Qs}),P.i=Ks,P.j=(r,e)=>Et(xi(r,{type:"json"}),e),P.k=ee,P.l=oe,P.m=Et,P.n=(r,e)=>Et(xi(r,{type:"arrayBuffer"}),e),P.o=function(r){return new Ou(r).readFields(im,[])},P.p=Xd,P.q=Eu,P.r=zs,P.s=fa,P.t=rh,P.u=Di,P.v=It,P.w=An,P.x=Ed,P.y=Hc,P.z=Gc}),I("worker",["./shared"],function(P){class u{constructor(tt){this.keyCache={},tt&&this.replace(tt)}replace(tt){this._layerConfigs={},this._layers={},this.update(tt,[])}update(tt,it){for(const _t of tt){this._layerConfigs[_t.id]=_t;const Pt=this._layers[_t.id]=P.bJ(_t);Pt._featureFilter=P.aa(Pt.filter),this.keyCache[_t.id]&&delete this.keyCache[_t.id]}for(const _t of it)delete this.keyCache[_t],delete this._layerConfigs[_t],delete this._layers[_t];this.familiesBySource={};const st=P.cC(Object.values(this._layerConfigs),this.keyCache);for(const _t of st){const Pt=_t.map(ee=>this._layers[ee.id]),Et=Pt[0];if(Et.visibility==="none")continue;const Ft=Et.source||"";let zt=this.familiesBySource[Ft];zt||(zt=this.familiesBySource[Ft]={});const Kt=Et.sourceLayer||"_geojsonTileLayer";let oe=zt[Kt];oe||(oe=zt[Kt]=[]),oe.push(Pt)}}}class H{constructor(tt){const it={},st=[];for(const Ft in tt){const zt=tt[Ft],Kt=it[Ft]={};for(const oe in zt){const ee=zt[+oe];if(!ee||ee.bitmap.width===0||ee.bitmap.height===0)continue;const Le={x:0,y:0,w:ee.bitmap.width+2,h:ee.bitmap.height+2};st.push(Le),Kt[oe]={rect:Le,metrics:ee.metrics}}}const{w:_t,h:Pt}=P.p(st),Et=new P.q({width:_t||1,height:Pt||1});for(const Ft in tt){const zt=tt[Ft];for(const Kt in zt){const oe=zt[+Kt];if(!oe||oe.bitmap.width===0||oe.bitmap.height===0)continue;const ee=it[Ft][Kt].rect;P.q.copy(oe.bitmap,Et,{x:0,y:0},{x:ee.x+1,y:ee.y+1},oe.bitmap)}}this.image=Et,this.positions=it}}P.cD("GlyphAtlas",H);class X{constructor(tt){this.tileID=new P.Z(tt.tileID.overscaledZ,tt.tileID.wrap,tt.tileID.canonical.z,tt.tileID.canonical.x,tt.tileID.canonical.y),this.uid=tt.uid,this.zoom=tt.zoom,this.pixelRatio=tt.pixelRatio,this.tileSize=tt.tileSize,this.source=tt.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=tt.showCollisionBoxes,this.collectResourceTiming=!!tt.collectResourceTiming,this.returnDependencies=!!tt.returnDependencies,this.promoteId=tt.promoteId,this.inFlightDependencies=[],this.globalState=tt.globalState}parse(tt,it,st,_t,Pt){return P._(this,void 0,void 0,function*(){this.status="parsing",this.data=tt,this.collisionBoxArray=new P.a8;const Et=new P.cE(Object.keys(tt.layers).sort()),Ft=new P.cF(this.tileID,this.promoteId);Ft.bucketLayerIDs=[];const zt={},Kt={featureIndex:Ft,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:st,subdivisionGranularity:Pt},oe=it.familiesBySource[this.source];for(const ii in oe){const si=tt.layers[ii];if(!si)continue;si.version===1&&P.w(`Vector tile source "${this.source}" layer "${ii}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const fn=Et.encode(ii),ue=[];for(let Ie=0;Ie<si.length;Ie++){const vn=si.feature(Ie),pa=Ft.getId(vn,ii);ue.push({feature:vn,id:pa,index:Ie,sourceLayerIndex:fn})}for(const Ie of oe[ii]){const vn=Ie[0];vn.source!==this.source&&P.w(`layer.source = ${vn.source} does not equal this.source = ${this.source}`),vn.minzoom&&this.zoom<Math.floor(vn.minzoom)||vn.maxzoom&&this.zoom>=vn.maxzoom||vn.visibility!=="none"&&(Q(Ie,this.zoom,st),(zt[vn.id]=vn.createBucket({index:Ft.bucketLayerIDs.length,layers:Ie,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:fn,sourceID:this.source,globalState:this.globalState})).populate(ue,Kt,this.tileID.canonical),Ft.bucketLayerIDs.push(Ie.map(pa=>pa.id)))}}const ee=P.bN(Kt.glyphDependencies,ii=>Object.keys(ii).map(Number));this.inFlightDependencies.forEach(ii=>ii?.abort()),this.inFlightDependencies=[];let Le=Promise.resolve({});if(Object.keys(ee).length){const ii=new AbortController;this.inFlightDependencies.push(ii),Le=_t.sendAsync({type:"GG",data:{stacks:ee,source:this.source,tileID:this.tileID,type:"glyphs"}},ii)}const It=Object.keys(Kt.iconDependencies);let ri=Promise.resolve({});if(It.length){const ii=new AbortController;this.inFlightDependencies.push(ii),ri=_t.sendAsync({type:"GI",data:{icons:It,source:this.source,tileID:this.tileID,type:"icons"}},ii)}const bi=Object.keys(Kt.patternDependencies);let Ge=Promise.resolve({});if(bi.length){const ii=new AbortController;this.inFlightDependencies.push(ii),Ge=_t.sendAsync({type:"GI",data:{icons:bi,source:this.source,tileID:this.tileID,type:"patterns"}},ii)}const[li,Zi,qn]=yield Promise.all([Le,ri,Ge]),Un=new H(li),$i=new P.cG(Zi,qn);for(const ii in zt){const si=zt[ii];si instanceof P.a9?(Q(si.layers,this.zoom,st),P.cH({bucket:si,glyphMap:li,glyphPositions:Un.positions,imageMap:Zi,imagePositions:$i.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Kt.subdivisionGranularity})):si.hasPattern&&(si instanceof P.cI||si instanceof P.cJ||si instanceof P.cK)&&(Q(si.layers,this.zoom,st),si.addFeatures(Kt,this.tileID.canonical,$i.patternPositions))}return this.status="done",{buckets:Object.values(zt).filter(ii=>!ii.isEmpty()),featureIndex:Ft,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Un.image,imageAtlas:$i,glyphMap:this.returnDependencies?li:null,iconMap:this.returnDependencies?Zi:null,glyphPositions:this.returnDependencies?Un.positions:null}})}}function Q(Ct,tt,it){const st=new P.F(tt);for(const _t of Ct)_t.recalculate(st,it)}class dt{constructor(tt,it,st){this.actor=tt,this.layerIndex=it,this.availableImages=st,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(tt,it){return P._(this,void 0,void 0,function*(){const st=yield P.n(tt.request,it);try{return{vectorTile:new P.cL(new P.cM(st.data)),rawData:st.data,cacheControl:st.cacheControl,expires:st.expires}}catch(_t){const Pt=new Uint8Array(st.data);let Et=`Unable to parse the tile at ${tt.request.url}, `;throw Et+=Pt[0]===31&&Pt[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${_t.message}`,new Error(Et)}})}loadTile(tt){return P._(this,void 0,void 0,function*(){const it=tt.uid,st=!!(tt&&tt.request&&tt.request.collectResourceTiming)&&new P.cN(tt.request),_t=new X(tt);this.loading[it]=_t;const Pt=new AbortController;_t.abort=Pt;try{const Et=yield this.loadVectorTile(tt,Pt);if(delete this.loading[it],!Et)return null;const Ft=Et.rawData,zt={};Et.expires&&(zt.expires=Et.expires),Et.cacheControl&&(zt.cacheControl=Et.cacheControl);const Kt={};if(st){const ee=st.finish();ee&&(Kt.resourceTiming=JSON.parse(JSON.stringify(ee)))}_t.vectorTile=Et.vectorTile;const oe=_t.parse(Et.vectorTile,this.layerIndex,this.availableImages,this.actor,tt.subdivisionGranularity);this.loaded[it]=_t,this.fetching[it]={rawTileData:Ft,cacheControl:zt,resourceTiming:Kt};try{const ee=yield oe;return P.e({rawTileData:Ft.slice(0)},ee,zt,Kt)}finally{delete this.fetching[it]}}catch(Et){throw delete this.loading[it],_t.status="done",this.loaded[it]=_t,Et}})}reloadTile(tt){return P._(this,void 0,void 0,function*(){const it=tt.uid;if(!this.loaded||!this.loaded[it])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const st=this.loaded[it];if(st.showCollisionBoxes=tt.showCollisionBoxes,st.globalState=tt.globalState,st.status==="parsing"){const _t=yield st.parse(st.vectorTile,this.layerIndex,this.availableImages,this.actor,tt.subdivisionGranularity);let Pt;if(this.fetching[it]){const{rawTileData:Et,cacheControl:Ft,resourceTiming:zt}=this.fetching[it];delete this.fetching[it],Pt=P.e({rawTileData:Et.slice(0)},_t,Ft,zt)}else Pt=_t;return Pt}if(st.status==="done"&&st.vectorTile)return st.parse(st.vectorTile,this.layerIndex,this.availableImages,this.actor,tt.subdivisionGranularity)})}abortTile(tt){return P._(this,void 0,void 0,function*(){const it=this.loading,st=tt.uid;it&&it[st]&&it[st].abort&&(it[st].abort.abort(),delete it[st])})}removeTile(tt){return P._(this,void 0,void 0,function*(){this.loaded&&this.loaded[tt.uid]&&delete this.loaded[tt.uid]})}}class ht{constructor(){this.loaded={}}loadTile(tt){return P._(this,void 0,void 0,function*(){const{uid:it,encoding:st,rawImageData:_t,redFactor:Pt,greenFactor:Et,blueFactor:Ft,baseShift:zt}=tt,Kt=_t.width+2,oe=_t.height+2,ee=P.b(_t)?new P.R({width:Kt,height:oe},yield P.cO(_t,-1,-1,Kt,oe)):_t,Le=new P.cP(it,ee,st,Pt,Et,Ft,zt);return this.loaded=this.loaded||{},this.loaded[it]=Le,Le})}removeTile(tt){const it=this.loaded,st=tt.uid;it&&it[st]&&delete it[st]}}var lt,Yt,Jt=function(){if(Yt)return lt;function Ct(it,st){if(it.length!==0){tt(it[0],st);for(var _t=1;_t<it.length;_t++)tt(it[_t],!st)}}function tt(it,st){for(var _t=0,Pt=0,Et=0,Ft=it.length,zt=Ft-1;Et<Ft;zt=Et++){var Kt=(it[Et][0]-it[zt][0])*(it[zt][1]+it[Et][1]),oe=_t+Kt;Pt+=Math.abs(_t)>=Math.abs(Kt)?_t-oe+Kt:Kt-oe+_t,_t=oe}_t+Pt>=0!=!!st&&it.reverse()}return Yt=1,lt=function it(st,_t){var Pt,Et=st&&st.type;if(Et==="FeatureCollection")for(Pt=0;Pt<st.features.length;Pt++)it(st.features[Pt],_t);else if(Et==="GeometryCollection")for(Pt=0;Pt<st.geometries.length;Pt++)it(st.geometries[Pt],_t);else if(Et==="Feature")it(st.geometry,_t);else if(Et==="Polygon")Ct(st.coordinates,_t);else if(Et==="MultiPolygon")for(Pt=0;Pt<st.coordinates.length;Pt++)Ct(st.coordinates[Pt],_t);return st}}(),pe=P.cQ(Jt);class ge extends P.cS{constructor(tt,it){super(new P.cM,0,it,[],[]),this.feature=tt,this.type=tt.type,this.properties=tt.tags?tt.tags:{},"id"in tt&&(typeof tt.id=="string"?this.id=parseInt(tt.id,10):typeof tt.id!="number"||isNaN(tt.id)||(this.id=tt.id))}loadGeometry(){const tt=[],it=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const st of it){const _t=[];for(const Pt of st)_t.push(new P.P(Pt[0],Pt[1]));tt.push(_t)}return tt}}class de extends P.cR{constructor(tt,it){super(new P.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=it?it.version:1,this.extent=it?it.extent:4096,this.length=tt.length,this.features=tt}feature(tt){return new ge(this.features[tt],this.extent)}}function ne(Ct,tt){tt.writeVarintField(15,Ct.version||1),tt.writeStringField(1,Ct.name||""),tt.writeVarintField(5,Ct.extent||4096);const it={keys:[],values:[],keycache:{},valuecache:{}};for(let Pt=0;Pt<Ct.length;Pt++)it.feature=Ct.feature(Pt),tt.writeMessage(2,Ne,it);const st=it.keys;for(const Pt of st)tt.writeStringField(3,Pt);const _t=it.values;for(const Pt of _t)tt.writeMessage(4,Ei,Pt)}function Ne(Ct,tt){if(!Ct.feature)return;const it=Ct.feature;it.id!==void 0&&tt.writeVarintField(1,it.id),tt.writeMessage(2,we,Ct),tt.writeVarintField(3,it.type),tt.writeMessage(4,Ue,it)}function we(Ct,tt){for(const it in Ct.feature?.properties){let st=Ct.feature.properties[it],_t=Ct.keycache[it];if(st===null)continue;_t===void 0&&(Ct.keys.push(it),_t=Ct.keys.length-1,Ct.keycache[it]=_t),tt.writeVarint(_t),typeof st!="string"&&typeof st!="boolean"&&typeof st!="number"&&(st=JSON.stringify(st));const Pt=typeof st+":"+st;let Et=Ct.valuecache[Pt];Et===void 0&&(Ct.values.push(st),Et=Ct.values.length-1,Ct.valuecache[Pt]=Et),tt.writeVarint(Et)}}function Ve(Ct,tt){return(tt<<3)+(7&Ct)}function Je(Ct){return Ct<<1^Ct>>31}function Ue(Ct,tt){const it=Ct.loadGeometry(),st=Ct.type;let _t=0,Pt=0;for(const Et of it){let Ft=1;st===1&&(Ft=Et.length),tt.writeVarint(Ve(1,Ft));const zt=st===3?Et.length-1:Et.length;for(let Kt=0;Kt<zt;Kt++){Kt===1&&st!==1&&tt.writeVarint(Ve(2,zt-1));const oe=Et[Kt].x-_t,ee=Et[Kt].y-Pt;tt.writeVarint(Je(oe)),tt.writeVarint(Je(ee)),_t+=oe,Pt+=ee}Ct.type===3&&tt.writeVarint(Ve(7,1))}}function Ei(Ct,tt){const it=typeof Ct;it==="string"?tt.writeStringField(1,Ct):it==="boolean"?tt.writeBooleanField(7,Ct):it==="number"&&(Ct%1!=0?tt.writeDoubleField(3,Ct):Ct<0?tt.writeSVarintField(6,Ct):tt.writeVarintField(5,Ct))}const Ti={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ct=>Ct},zi=Math.fround||(Pi=new Float32Array(1),Ct=>(Pi[0]=+Ct,Pi[0]));var Pi;class Ir{constructor(tt){this.options=Object.assign(Object.create(Ti),tt),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(tt){const{log:it,minZoom:st,maxZoom:_t}=this.options;it&&console.time("total time");const Pt=`prepare ${tt.length} points`;it&&console.time(Pt),this.points=tt;const Et=[];for(let zt=0;zt<tt.length;zt++){const Kt=tt[zt];if(!Kt.geometry)continue;const[oe,ee]=Kt.geometry.coordinates,Le=zi(Qt(oe)),It=zi(me(ee));Et.push(Le,It,1/0,zt,-1,1),this.options.reduce&&Et.push(0)}let Ft=this.trees[_t+1]=this._createTree(Et);it&&console.timeEnd(Pt);for(let zt=_t;zt>=st;zt--){const Kt=+Date.now();Ft=this.trees[zt]=this._createTree(this._cluster(Ft,zt)),it&&console.log("z%d: %d clusters in %dms",zt,Ft.numItems,+Date.now()-Kt)}return it&&console.timeEnd("total time"),this}getClusters(tt,it){let st=((tt[0]+180)%360+360)%360-180;const _t=Math.max(-90,Math.min(90,tt[1]));let Pt=tt[2]===180?180:((tt[2]+180)%360+360)%360-180;const Et=Math.max(-90,Math.min(90,tt[3]));if(tt[2]-tt[0]>=360)st=-180,Pt=180;else if(st>Pt){const ee=this.getClusters([st,_t,180,Et],it),Le=this.getClusters([-180,_t,Pt,Et],it);return ee.concat(Le)}const Ft=this.trees[this._limitZoom(it)],zt=Ft.range(Qt(st),me(Et),Qt(Pt),me(_t)),Kt=Ft.data,oe=[];for(const ee of zt){const Le=this.stride*ee;oe.push(Kt[Le+5]>1?Rn(Kt,Le,this.clusterProps):this.points[Kt[Le+3]])}return oe}getChildren(tt){const it=this._getOriginId(tt),st=this._getOriginZoom(tt),_t="No cluster with the specified id.",Pt=this.trees[st];if(!Pt)throw new Error(_t);const Et=Pt.data;if(it*this.stride>=Et.length)throw new Error(_t);const Ft=this.options.radius/(this.options.extent*Math.pow(2,st-1)),zt=Pt.within(Et[it*this.stride],Et[it*this.stride+1],Ft),Kt=[];for(const oe of zt){const ee=oe*this.stride;Et[ee+4]===tt&&Kt.push(Et[ee+5]>1?Rn(Et,ee,this.clusterProps):this.points[Et[ee+3]])}if(Kt.length===0)throw new Error(_t);return Kt}getLeaves(tt,it,st){const _t=[];return this._appendLeaves(_t,tt,it=it||10,st=st||0,0),_t}getTile(tt,it,st){const _t=this.trees[this._limitZoom(tt)],Pt=Math.pow(2,tt),{extent:Et,radius:Ft}=this.options,zt=Ft/Et,Kt=(st-zt)/Pt,oe=(st+1+zt)/Pt,ee={features:[]};return this._addTileFeatures(_t.range((it-zt)/Pt,Kt,(it+1+zt)/Pt,oe),_t.data,it,st,Pt,ee),it===0&&this._addTileFeatures(_t.range(1-zt/Pt,Kt,1,oe),_t.data,Pt,st,Pt,ee),it===Pt-1&&this._addTileFeatures(_t.range(0,Kt,zt/Pt,oe),_t.data,-1,st,Pt,ee),ee.features.length?ee:null}getClusterExpansionZoom(tt){let it=this._getOriginZoom(tt)-1;for(;it<=this.options.maxZoom;){const st=this.getChildren(tt);if(it++,st.length!==1)break;tt=st[0].properties.cluster_id}return it}_appendLeaves(tt,it,st,_t,Pt){const Et=this.getChildren(it);for(const Ft of Et){const zt=Ft.properties;if(zt&&zt.cluster?Pt+zt.point_count<=_t?Pt+=zt.point_count:Pt=this._appendLeaves(tt,zt.cluster_id,st,_t,Pt):Pt<_t?Pt++:tt.push(Ft),tt.length===st)break}return Pt}_createTree(tt){const it=new P.aI(tt.length/this.stride|0,this.options.nodeSize,Float32Array);for(let st=0;st<tt.length;st+=this.stride)it.add(tt[st],tt[st+1]);return it.finish(),it.data=tt,it}_addTileFeatures(tt,it,st,_t,Pt,Et){for(const Ft of tt){const zt=Ft*this.stride,Kt=it[zt+5]>1;let oe,ee,Le;if(Kt)oe=dn(it,zt,this.clusterProps),ee=it[zt],Le=it[zt+1];else{const bi=this.points[it[zt+3]];oe=bi.properties;const[Ge,li]=bi.geometry.coordinates;ee=Qt(Ge),Le=me(li)}const It={type:1,geometry:[[Math.round(this.options.extent*(ee*Pt-st)),Math.round(this.options.extent*(Le*Pt-_t))]],tags:oe};let ri;ri=Kt||this.options.generateId?it[zt+3]:this.points[it[zt+3]].id,ri!==void 0&&(It.id=ri),Et.features.push(It)}}_limitZoom(tt){return Math.max(this.options.minZoom,Math.min(Math.floor(+tt),this.options.maxZoom+1))}_cluster(tt,it){const{radius:st,extent:_t,reduce:Pt,minPoints:Et}=this.options,Ft=st/(_t*Math.pow(2,it)),zt=tt.data,Kt=[],oe=this.stride;for(let ee=0;ee<zt.length;ee+=oe){if(zt[ee+2]<=it)continue;zt[ee+2]=it;const Le=zt[ee],It=zt[ee+1],ri=tt.within(zt[ee],zt[ee+1],Ft),bi=zt[ee+5];let Ge=bi;for(const li of ri){const Zi=li*oe;zt[Zi+2]>it&&(Ge+=zt[Zi+5])}if(Ge>bi&&Ge>=Et){let li,Zi=Le*bi,qn=It*bi,Un=-1;const $i=(ee/oe<<5)+(it+1)+this.points.length;for(const ii of ri){const si=ii*oe;if(zt[si+2]<=it)continue;zt[si+2]=it;const fn=zt[si+5];Zi+=zt[si]*fn,qn+=zt[si+1]*fn,zt[si+4]=$i,Pt&&(li||(li=this._map(zt,ee,!0),Un=this.clusterProps.length,this.clusterProps.push(li)),Pt(li,this._map(zt,si)))}zt[ee+4]=$i,Kt.push(Zi/Ge,qn/Ge,1/0,$i,-1,Ge),Pt&&Kt.push(Un)}else{for(let li=0;li<oe;li++)Kt.push(zt[ee+li]);if(Ge>1)for(const li of ri){const Zi=li*oe;if(!(zt[Zi+2]<=it)){zt[Zi+2]=it;for(let qn=0;qn<oe;qn++)Kt.push(zt[Zi+qn])}}}}return Kt}_getOriginId(tt){return tt-this.points.length>>5}_getOriginZoom(tt){return(tt-this.points.length)%32}_map(tt,it,st){if(tt[it+5]>1){const Et=this.clusterProps[tt[it+6]];return st?Object.assign({},Et):Et}const _t=this.points[tt[it+3]].properties,Pt=this.options.map(_t);return st&&Pt===_t?Object.assign({},Pt):Pt}}function Rn(Ct,tt,it){return{type:"Feature",id:Ct[tt+3],properties:dn(Ct,tt,it),geometry:{type:"Point",coordinates:[(st=Ct[tt],360*(st-.5)),fe(Ct[tt+1])]}};var st}function dn(Ct,tt,it){const st=Ct[tt+5],_t=st>=1e4?`${Math.round(st/1e3)}k`:st>=1e3?Math.round(st/100)/10+"k":st,Pt=Ct[tt+6],Et=Pt===-1?{}:Object.assign({},it[Pt]);return Object.assign(Et,{cluster:!0,cluster_id:Ct[tt+3],point_count:st,point_count_abbreviated:_t})}function Qt(Ct){return Ct/360+.5}function me(Ct){const tt=Math.sin(Ct*Math.PI/180),it=.5-.25*Math.log((1+tt)/(1-tt))/Math.PI;return it<0?0:it>1?1:it}function fe(Ct){const tt=(180-360*Ct)*Math.PI/180;return 360*Math.atan(Math.exp(tt))/Math.PI-90}function Ze(Ct,tt,it,st){let _t=st;const Pt=tt+(it-tt>>1);let Et,Ft=it-tt;const zt=Ct[tt],Kt=Ct[tt+1],oe=Ct[it],ee=Ct[it+1];for(let Le=tt+3;Le<it;Le+=3){const It=yt(Ct[Le],Ct[Le+1],zt,Kt,oe,ee);if(It>_t)Et=Le,_t=It;else if(It===_t){const ri=Math.abs(Le-Pt);ri<Ft&&(Et=Le,Ft=ri)}}_t>st&&(Et-tt>3&&Ze(Ct,tt,Et,st),Ct[Et+2]=_t,it-Et>3&&Ze(Ct,Et,it,st))}function yt(Ct,tt,it,st,_t,Pt){let Et=_t-it,Ft=Pt-st;if(Et!==0||Ft!==0){const zt=((Ct-it)*Et+(tt-st)*Ft)/(Et*Et+Ft*Ft);zt>1?(it=_t,st=Pt):zt>0&&(it+=Et*zt,st+=Ft*zt)}return Et=Ct-it,Ft=tt-st,Et*Et+Ft*Ft}function Wt(Ct,tt,it,st){const _t={id:Ct??null,type:tt,geometry:it,tags:st,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(tt==="Point"||tt==="MultiPoint"||tt==="LineString")Ce(_t,it);else if(tt==="Polygon")Ce(_t,it[0]);else if(tt==="MultiLineString")for(const Pt of it)Ce(_t,Pt);else if(tt==="MultiPolygon")for(const Pt of it)Ce(_t,Pt[0]);return _t}function Ce(Ct,tt){for(let it=0;it<tt.length;it+=3)Ct.minX=Math.min(Ct.minX,tt[it]),Ct.minY=Math.min(Ct.minY,tt[it+1]),Ct.maxX=Math.max(Ct.maxX,tt[it]),Ct.maxY=Math.max(Ct.maxY,tt[it+1])}function xe(Ct,tt,it,st){if(!tt.geometry)return;const _t=tt.geometry.coordinates;if(_t&&_t.length===0)return;const Pt=tt.geometry.type,Et=Math.pow(it.tolerance/((1<<it.maxZoom)*it.extent),2);let Ft=[],zt=tt.id;if(it.promoteId?zt=tt.properties[it.promoteId]:it.generateId&&(zt=st||0),Pt==="Point")ze(_t,Ft);else if(Pt==="MultiPoint")for(const Kt of _t)ze(Kt,Ft);else if(Pt==="LineString")Fe(_t,Ft,Et,!1);else if(Pt==="MultiLineString"){if(it.lineMetrics){for(const Kt of _t)Ft=[],Fe(Kt,Ft,Et,!1),Ct.push(Wt(zt,"LineString",Ft,tt.properties));return}Se(_t,Ft,Et,!1)}else if(Pt==="Polygon")Se(_t,Ft,Et,!0);else{if(Pt!=="MultiPolygon"){if(Pt==="GeometryCollection"){for(const Kt of tt.geometry.geometries)xe(Ct,{id:zt,geometry:Kt,properties:tt.properties},it,st);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Kt of _t){const oe=[];Se(Kt,oe,Et,!0),Ft.push(oe)}}Ct.push(Wt(zt,Pt,Ft,tt.properties))}function ze(Ct,tt){tt.push(rn(Ct[0]),xi(Ct[1]),0)}function Fe(Ct,tt,it,st){let _t,Pt,Et=0;for(let zt=0;zt<Ct.length;zt++){const Kt=rn(Ct[zt][0]),oe=xi(Ct[zt][1]);tt.push(Kt,oe,0),zt>0&&(Et+=st?(_t*oe-Kt*Pt)/2:Math.sqrt(Math.pow(Kt-_t,2)+Math.pow(oe-Pt,2))),_t=Kt,Pt=oe}const Ft=tt.length-3;tt[2]=1,Ze(tt,0,Ft,it),tt[Ft+2]=1,tt.size=Math.abs(Et),tt.start=0,tt.end=tt.size}function Se(Ct,tt,it,st){for(let _t=0;_t<Ct.length;_t++){const Pt=[];Fe(Ct[_t],Pt,it,st),tt.push(Pt)}}function rn(Ct){return Ct/360+.5}function xi(Ct){const tt=Math.sin(Ct*Math.PI/180),it=.5-.25*Math.log((1+tt)/(1-tt))/Math.PI;return it<0?0:it>1?1:it}function rr(Ct,tt,it,st,_t,Pt,Et,Ft){if(st/=tt,Pt>=(it/=tt)&&Et<st)return Ct;if(Et<it||Pt>=st)return null;const zt=[];for(const Kt of Ct){const oe=Kt.geometry;let ee=Kt.type;const Le=_t===0?Kt.minX:Kt.minY,It=_t===0?Kt.maxX:Kt.maxY;if(Le>=it&&It<st){zt.push(Kt);continue}if(It<it||Le>=st)continue;let ri=[];if(ee==="Point"||ee==="MultiPoint")da(oe,ri,it,st,_t);else if(ee==="LineString")Ws(oe,ri,it,st,_t,!1,Ft.lineMetrics);else if(ee==="MultiLineString")sn(oe,ri,it,st,_t,!1);else if(ee==="Polygon")sn(oe,ri,it,st,_t,!0);else if(ee==="MultiPolygon")for(const bi of oe){const Ge=[];sn(bi,Ge,it,st,_t,!0),Ge.length&&ri.push(Ge)}if(ri.length){if(Ft.lineMetrics&&ee==="LineString"){for(const bi of ri)zt.push(Wt(Kt.id,ee,bi,Kt.tags));continue}ee!=="LineString"&&ee!=="MultiLineString"||(ri.length===1?(ee="LineString",ri=ri[0]):ee="MultiLineString"),ee!=="Point"&&ee!=="MultiPoint"||(ee=ri.length===3?"Point":"MultiPoint"),zt.push(Wt(Kt.id,ee,ri,Kt.tags))}}return zt.length?zt:null}function da(Ct,tt,it,st,_t){for(let Pt=0;Pt<Ct.length;Pt+=3){const Et=Ct[Pt+_t];Et>=it&&Et<=st&&An(tt,Ct[Pt],Ct[Pt+1],Ct[Pt+2])}}function Ws(Ct,tt,it,st,_t,Pt,Et){let Ft=sr(Ct);const zt=_t===0?Os:Ks;let Kt,oe,ee=Ct.start;for(let Ge=0;Ge<Ct.length-3;Ge+=3){const li=Ct[Ge],Zi=Ct[Ge+1],qn=Ct[Ge+2],Un=Ct[Ge+3],$i=Ct[Ge+4],ii=_t===0?li:Zi,si=_t===0?Un:$i;let fn=!1;Et&&(Kt=Math.sqrt(Math.pow(li-Un,2)+Math.pow(Zi-$i,2))),ii<it?si>it&&(oe=zt(Ft,li,Zi,Un,$i,it),Et&&(Ft.start=ee+Kt*oe)):ii>st?si<st&&(oe=zt(Ft,li,Zi,Un,$i,st),Et&&(Ft.start=ee+Kt*oe)):An(Ft,li,Zi,qn),si<it&&ii>=it&&(oe=zt(Ft,li,Zi,Un,$i,it),fn=!0),si>st&&ii<=st&&(oe=zt(Ft,li,Zi,Un,$i,st),fn=!0),!Pt&&fn&&(Et&&(Ft.end=ee+Kt*oe),tt.push(Ft),Ft=sr(Ct)),Et&&(ee+=Kt)}let Le=Ct.length-3;const It=Ct[Le],ri=Ct[Le+1],bi=_t===0?It:ri;bi>=it&&bi<=st&&An(Ft,It,ri,Ct[Le+2]),Le=Ft.length-3,Pt&&Le>=3&&(Ft[Le]!==Ft[0]||Ft[Le+1]!==Ft[1])&&An(Ft,Ft[0],Ft[1],Ft[2]),Ft.length&&tt.push(Ft)}function sr(Ct){const tt=[];return tt.size=Ct.size,tt.start=Ct.start,tt.end=Ct.end,tt}function sn(Ct,tt,it,st,_t,Pt){for(const Et of Ct)Ws(Et,tt,it,st,_t,Pt,!1)}function An(Ct,tt,it,st){Ct.push(tt,it,st)}function Os(Ct,tt,it,st,_t,Pt){const Et=(Pt-tt)/(st-tt);return An(Ct,Pt,it+(_t-it)*Et,1),Et}function Ks(Ct,tt,it,st,_t,Pt){const Et=(Pt-it)/(_t-it);return An(Ct,tt+(st-tt)*Et,Pt,1),Et}function dr(Ct,tt){const it=[];for(let st=0;st<Ct.length;st++){const _t=Ct[st],Pt=_t.type;let Et;if(Pt==="Point"||Pt==="MultiPoint"||Pt==="LineString")Et=ys(_t.geometry,tt);else if(Pt==="MultiLineString"||Pt==="Polygon"){Et=[];for(const Ft of _t.geometry)Et.push(ys(Ft,tt))}else if(Pt==="MultiPolygon"){Et=[];for(const Ft of _t.geometry){const zt=[];for(const Kt of Ft)zt.push(ys(Kt,tt));Et.push(zt)}}it.push(Wt(_t.id,Pt,Et,_t.tags))}return it}function ys(Ct,tt){const it=[];it.size=Ct.size,Ct.start!==void 0&&(it.start=Ct.start,it.end=Ct.end);for(let st=0;st<Ct.length;st+=3)it.push(Ct[st]+tt,Ct[st+1],Ct[st+2]);return it}function Qs(Ct,tt){if(Ct.transformed)return Ct;const it=1<<Ct.z,st=Ct.x,_t=Ct.y;for(const Pt of Ct.features){const Et=Pt.geometry,Ft=Pt.type;if(Pt.geometry=[],Ft===1)for(let zt=0;zt<Et.length;zt+=2)Pt.geometry.push(vo(Et[zt],Et[zt+1],tt,it,st,_t));else for(let zt=0;zt<Et.length;zt++){const Kt=[];for(let oe=0;oe<Et[zt].length;oe+=2)Kt.push(vo(Et[zt][oe],Et[zt][oe+1],tt,it,st,_t));Pt.geometry.push(Kt)}}return Ct.transformed=!0,Ct}function vo(Ct,tt,it,st,_t,Pt){return[Math.round(it*(Ct*st-_t)),Math.round(it*(tt*st-Pt))]}function vs(Ct,tt,it,st,_t){const Pt=tt===_t.maxZoom?0:_t.tolerance/((1<<tt)*_t.extent),Et={features:[],numPoints:0,numSimplified:0,numFeatures:Ct.length,source:null,x:it,y:st,z:tt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ft of Ct)Ha(Et,Ft,Pt,_t);return Et}function Ha(Ct,tt,it,st){const _t=tt.geometry,Pt=tt.type,Et=[];if(Ct.minX=Math.min(Ct.minX,tt.minX),Ct.minY=Math.min(Ct.minY,tt.minY),Ct.maxX=Math.max(Ct.maxX,tt.maxX),Ct.maxY=Math.max(Ct.maxY,tt.maxY),Pt==="Point"||Pt==="MultiPoint")for(let Ft=0;Ft<_t.length;Ft+=3)Et.push(_t[Ft],_t[Ft+1]),Ct.numPoints++,Ct.numSimplified++;else if(Pt==="LineString")fa(Et,_t,Ct,it,!1,!1);else if(Pt==="MultiLineString"||Pt==="Polygon")for(let Ft=0;Ft<_t.length;Ft++)fa(Et,_t[Ft],Ct,it,Pt==="Polygon",Ft===0);else if(Pt==="MultiPolygon")for(let Ft=0;Ft<_t.length;Ft++){const zt=_t[Ft];for(let Kt=0;Kt<zt.length;Kt++)fa(Et,zt[Kt],Ct,it,!0,Kt===0)}if(Et.length){let Ft=tt.tags||null;if(Pt==="LineString"&&st.lineMetrics){Ft={};for(const Kt in tt.tags)Ft[Kt]=tt.tags[Kt];Ft.mapbox_clip_start=_t.start/_t.size,Ft.mapbox_clip_end=_t.end/_t.size}const zt={geometry:Et,type:Pt==="Polygon"||Pt==="MultiPolygon"?3:Pt==="LineString"||Pt==="MultiLineString"?2:1,tags:Ft};tt.id!==null&&(zt.id=tt.id),Ct.features.push(zt)}}function fa(Ct,tt,it,st,_t,Pt){const Et=st*st;if(st>0&&tt.size<(_t?Et:st))return void(it.numPoints+=tt.length/3);const Ft=[];for(let zt=0;zt<tt.length;zt+=3)(st===0||tt[zt+2]>Et)&&(it.numSimplified++,Ft.push(tt[zt],tt[zt+1])),it.numPoints++;_t&&function(zt,Kt){let oe=0;for(let ee=0,Le=zt.length,It=Le-2;ee<Le;It=ee,ee+=2)oe+=(zt[ee]-zt[It])*(zt[ee+1]+zt[It+1]);if(oe>0===Kt)for(let ee=0,Le=zt.length;ee<Le/2;ee+=2){const It=zt[ee],ri=zt[ee+1];zt[ee]=zt[Le-2-ee],zt[ee+1]=zt[Le-1-ee],zt[Le-2-ee]=It,zt[Le-1-ee]=ri}}(Ft,Pt),Ct.push(Ft)}const Go={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class xo{constructor(tt,it){const st=(it=this.options=function(Pt,Et){for(const Ft in Et)Pt[Ft]=Et[Ft];return Pt}(Object.create(Go),it)).debug;if(st&&console.time("preprocess data"),it.maxZoom<0||it.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(it.promoteId&&it.generateId)throw new Error("promoteId and generateId cannot be used together.");let _t=function(Pt,Et){const Ft=[];if(Pt.type==="FeatureCollection")for(let zt=0;zt<Pt.features.length;zt++)xe(Ft,Pt.features[zt],Et,zt);else xe(Ft,Pt.type==="Feature"?Pt:{geometry:Pt},Et);return Ft}(tt,it);this.tiles={},this.tileCoords=[],st&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",it.indexMaxZoom,it.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),_t=function(Pt,Et){const Ft=Et.buffer/Et.extent;let zt=Pt;const Kt=rr(Pt,1,-1-Ft,Ft,0,-1,2,Et),oe=rr(Pt,1,1-Ft,2+Ft,0,-1,2,Et);return(Kt||oe)&&(zt=rr(Pt,1,-Ft,1+Ft,0,-1,2,Et)||[],Kt&&(zt=dr(Kt,1).concat(zt)),oe&&(zt=zt.concat(dr(oe,-1)))),zt}(_t,it),_t.length&&this.splitTile(_t,0,0,0),st&&(_t.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(tt,it,st,_t,Pt,Et,Ft){const zt=[tt,it,st,_t],Kt=this.options,oe=Kt.debug;for(;zt.length;){_t=zt.pop(),st=zt.pop(),it=zt.pop(),tt=zt.pop();const ee=1<<it,Le=ts(it,st,_t);let It=this.tiles[Le];if(!It&&(oe>1&&console.time("creation"),It=this.tiles[Le]=vs(tt,it,st,_t,Kt),this.tileCoords.push({z:it,x:st,y:_t}),oe)){oe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",it,st,_t,It.numFeatures,It.numPoints,It.numSimplified),console.timeEnd("creation"));const fn=`z${it}`;this.stats[fn]=(this.stats[fn]||0)+1,this.total++}if(It.source=tt,Pt==null){if(it===Kt.indexMaxZoom||It.numPoints<=Kt.indexMaxPoints)continue}else{if(it===Kt.maxZoom||it===Pt)continue;if(Pt!=null){const fn=Pt-it;if(st!==Et>>fn||_t!==Ft>>fn)continue}}if(It.source=null,tt.length===0)continue;oe>1&&console.time("clipping");const ri=.5*Kt.buffer/Kt.extent,bi=.5-ri,Ge=.5+ri,li=1+ri;let Zi=null,qn=null,Un=null,$i=null,ii=rr(tt,ee,st-ri,st+Ge,0,It.minX,It.maxX,Kt),si=rr(tt,ee,st+bi,st+li,0,It.minX,It.maxX,Kt);tt=null,ii&&(Zi=rr(ii,ee,_t-ri,_t+Ge,1,It.minY,It.maxY,Kt),qn=rr(ii,ee,_t+bi,_t+li,1,It.minY,It.maxY,Kt),ii=null),si&&(Un=rr(si,ee,_t-ri,_t+Ge,1,It.minY,It.maxY,Kt),$i=rr(si,ee,_t+bi,_t+li,1,It.minY,It.maxY,Kt),si=null),oe>1&&console.timeEnd("clipping"),zt.push(Zi||[],it+1,2*st,2*_t),zt.push(qn||[],it+1,2*st,2*_t+1),zt.push(Un||[],it+1,2*st+1,2*_t),zt.push($i||[],it+1,2*st+1,2*_t+1)}}getTile(tt,it,st){tt=+tt,it=+it,st=+st;const _t=this.options,{extent:Pt,debug:Et}=_t;if(tt<0||tt>24)return null;const Ft=1<<tt,zt=ts(tt,it=it+Ft&Ft-1,st);if(this.tiles[zt])return Qs(this.tiles[zt],Pt);Et>1&&console.log("drilling down to z%d-%d-%d",tt,it,st);let Kt,oe=tt,ee=it,Le=st;for(;!Kt&&oe>0;)oe--,ee>>=1,Le>>=1,Kt=this.tiles[ts(oe,ee,Le)];return Kt&&Kt.source?(Et>1&&(console.log("found parent tile z%d-%d-%d",oe,ee,Le),console.time("drilling down")),this.splitTile(Kt.source,oe,ee,Le,tt,it,st),Et>1&&console.timeEnd("drilling down"),this.tiles[zt]?Qs(this.tiles[zt],Pt):null):null}}function ts(Ct,tt,it){return 32*((1<<Ct)*it+tt)+Ct}class Vn extends dt{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(tt,it){return P._(this,void 0,void 0,function*(){const st=tt.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const _t=this._geoJSONIndex.getTile(st.z,st.x,st.y);if(!_t)return null;const Pt=new de(_t.features,{version:2,extent:P.$});let Et=function(Ft){const zt=new P.cM;return function(Kt,oe){for(const ee in Kt.layers)oe.writeMessage(3,ne,Kt.layers[ee])}(Ft,zt),zt.finish()}(Pt);return Et.byteOffset===0&&Et.byteLength===Et.buffer.byteLength||(Et=new Uint8Array(Et)),{vectorTile:Pt,rawData:Et.buffer}})}loadData(tt){return P._(this,void 0,void 0,function*(){var it;(it=this._pendingRequest)===null||it===void 0||it.abort();const st=!!(tt&&tt.request&&tt.request.collectResourceTiming)&&new P.cN(tt.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(tt,this._pendingRequest);const _t=yield this._pendingData;this._geoJSONIndex=tt.cluster?new Ir(function({superclusterOptions:Et,clusterProperties:Ft}){if(!Ft||!Et)return Et;const zt={},Kt={},oe={accumulated:null,zoom:0},ee={properties:null},Le=Object.keys(Ft);for(const It of Le){const[ri,bi]=Ft[It],Ge=P.cT(bi),li=P.cT(typeof ri=="string"?[ri,["accumulated"],["get",It]]:ri);zt[It]=Ge.value,Kt[It]=li.value}return Et.map=It=>{ee.properties=It;const ri={};for(const bi of Le)ri[bi]=zt[bi].evaluate(oe,ee);return ri},Et.reduce=(It,ri)=>{ee.properties=ri;for(const bi of Le)oe.accumulated=It[bi],It[bi]=Kt[bi].evaluate(oe,ee)},Et}(tt)).load(_t.features):function(Et,Ft){return new xo(Et,Ft)}(_t,tt.geojsonVtOptions),this.loaded={};const Pt={data:_t};if(st){const Et=st.finish();Et&&(Pt.resourceTiming={},Pt.resourceTiming[tt.source]=JSON.parse(JSON.stringify(Et)))}return Pt}catch(_t){if(delete this._pendingRequest,P.cy(_t))return{abandoned:!0};throw _t}})}getData(){return P._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(tt){const it=this.loaded;return it&&it[tt.uid]?super.reloadTile(tt):this.loadTile(tt)}loadAndProcessGeoJSON(tt,it){return P._(this,void 0,void 0,function*(){let st=yield this.loadGeoJSON(tt,it);if(delete this._pendingRequest,typeof st!="object")throw new Error(`Input data given to '${tt.source}' is not a valid GeoJSON object.`);if(pe(st,!0),tt.filter){const _t=P.cT(tt.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(_t.result==="error")throw new Error(_t.value.map(Et=>`${Et.key}: ${Et.message}`).join(", "));st={type:"FeatureCollection",features:st.features.filter(Et=>_t.value.evaluate({zoom:0},Et))}}return st})}loadGeoJSON(tt,it){return P._(this,void 0,void 0,function*(){const{promoteId:st}=tt;if(tt.request){const _t=yield P.j(tt.request,it);return this._dataUpdateable=P.cV(_t.data,st)?P.cU(_t.data,st):void 0,_t.data}if(typeof tt.data=="string")try{const _t=JSON.parse(tt.data);return this._dataUpdateable=P.cV(_t,st)?P.cU(_t,st):void 0,_t}catch{throw new Error(`Input data given to '${tt.source}' is not a valid GeoJSON object.`)}if(!tt.dataDiff)throw new Error(`Input data given to '${tt.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${tt.source}`);return P.cW(this._dataUpdateable,tt.dataDiff,st),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(tt){return P._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(tt){return this._geoJSONIndex.getClusterExpansionZoom(tt.clusterId)}getClusterChildren(tt){return this._geoJSONIndex.getChildren(tt.clusterId)}getClusterLeaves(tt){return this._geoJSONIndex.getLeaves(tt.clusterId,tt.limit,tt.offset)}}class es{constructor(tt){this.self=tt,this.actor=new P.J(tt),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(it,st)=>{if(this.externalWorkerSourceTypes[it])throw new Error(`Worker source with name "${it}" already registered.`);this.externalWorkerSourceTypes[it]=st},this.self.addProtocol=P.cA,this.self.removeProtocol=P.cB,this.self.registerRTLTextPlugin=it=>{P.cX.setMethods(it)},this.actor.registerMessageHandler("LDT",(it,st)=>this._getDEMWorkerSource(it,st.source).loadTile(st)),this.actor.registerMessageHandler("RDT",(it,st)=>P._(this,void 0,void 0,function*(){this._getDEMWorkerSource(it,st.source).removeTile(st)})),this.actor.registerMessageHandler("GCEZ",(it,st)=>P._(this,void 0,void 0,function*(){return this._getWorkerSource(it,st.type,st.source).getClusterExpansionZoom(st)})),this.actor.registerMessageHandler("GCC",(it,st)=>P._(this,void 0,void 0,function*(){return this._getWorkerSource(it,st.type,st.source).getClusterChildren(st)})),this.actor.registerMessageHandler("GCL",(it,st)=>P._(this,void 0,void 0,function*(){return this._getWorkerSource(it,st.type,st.source).getClusterLeaves(st)})),this.actor.registerMessageHandler("LD",(it,st)=>this._getWorkerSource(it,st.type,st.source).loadData(st)),this.actor.registerMessageHandler("GD",(it,st)=>this._getWorkerSource(it,st.type,st.source).getData()),this.actor.registerMessageHandler("LT",(it,st)=>this._getWorkerSource(it,st.type,st.source).loadTile(st)),this.actor.registerMessageHandler("RT",(it,st)=>this._getWorkerSource(it,st.type,st.source).reloadTile(st)),this.actor.registerMessageHandler("AT",(it,st)=>this._getWorkerSource(it,st.type,st.source).abortTile(st)),this.actor.registerMessageHandler("RMT",(it,st)=>this._getWorkerSource(it,st.type,st.source).removeTile(st)),this.actor.registerMessageHandler("RS",(it,st)=>P._(this,void 0,void 0,function*(){if(!this.workerSources[it]||!this.workerSources[it][st.type]||!this.workerSources[it][st.type][st.source])return;const _t=this.workerSources[it][st.type][st.source];delete this.workerSources[it][st.type][st.source],_t.removeSource!==void 0&&_t.removeSource(st)})),this.actor.registerMessageHandler("RM",it=>P._(this,void 0,void 0,function*(){delete this.layerIndexes[it],delete this.availableImages[it],delete this.workerSources[it],delete this.demWorkerSources[it]})),this.actor.registerMessageHandler("SR",(it,st)=>P._(this,void 0,void 0,function*(){this.referrer=st})),this.actor.registerMessageHandler("SRPS",(it,st)=>this._syncRTLPluginState(it,st)),this.actor.registerMessageHandler("IS",(it,st)=>P._(this,void 0,void 0,function*(){this.self.importScripts(st)})),this.actor.registerMessageHandler("SI",(it,st)=>this._setImages(it,st)),this.actor.registerMessageHandler("UL",(it,st)=>P._(this,void 0,void 0,function*(){this._getLayerIndex(it).update(st.layers,st.removedIds)})),this.actor.registerMessageHandler("SL",(it,st)=>P._(this,void 0,void 0,function*(){this._getLayerIndex(it).replace(st)}))}_setImages(tt,it){return P._(this,void 0,void 0,function*(){this.availableImages[tt]=it;for(const st in this.workerSources[tt]){const _t=this.workerSources[tt][st];for(const Pt in _t)_t[Pt].availableImages=it}})}_syncRTLPluginState(tt,it){return P._(this,void 0,void 0,function*(){return yield P.cX.syncState(it,this.self.importScripts)})}_getAvailableImages(tt){let it=this.availableImages[tt];return it||(it=[]),it}_getLayerIndex(tt){let it=this.layerIndexes[tt];return it||(it=this.layerIndexes[tt]=new u),it}_getWorkerSource(tt,it,st){if(this.workerSources[tt]||(this.workerSources[tt]={}),this.workerSources[tt][it]||(this.workerSources[tt][it]={}),!this.workerSources[tt][it][st]){const _t={sendAsync:(Pt,Et)=>(Pt.targetMapId=tt,this.actor.sendAsync(Pt,Et))};switch(it){case"vector":this.workerSources[tt][it][st]=new dt(_t,this._getLayerIndex(tt),this._getAvailableImages(tt));break;case"geojson":this.workerSources[tt][it][st]=new Vn(_t,this._getLayerIndex(tt),this._getAvailableImages(tt));break;default:this.workerSources[tt][it][st]=new this.externalWorkerSourceTypes[it](_t,this._getLayerIndex(tt),this._getAvailableImages(tt))}}return this.workerSources[tt][it][st]}_getDEMWorkerSource(tt,it){return this.demWorkerSources[tt]||(this.demWorkerSources[tt]={}),this.demWorkerSources[tt][it]||(this.demWorkerSources[tt][it]=new ht),this.demWorkerSources[tt][it]}}return P.i(self)&&(self.worker=new es(self)),es}),I("index",["exports","./shared"],function(P,u){var H="5.6.2";function X(){var g=new u.A(4);return u.A!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g}let Q,dt;const ht={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(g,t,s){const c=requestAnimationFrame(y=>{f(),t(y)}),{unsubscribe:f}=u.s(g.signal,"abort",()=>{f(),cancelAnimationFrame(c),s(u.c())},!1)},frameAsync(g){return new Promise((t,s)=>{this.frame(g,t,s)})},getImageData(g,t=0){return this.getImageCanvasContext(g).getImageData(-t,-t,g.width+2*t,g.height+2*t)},getImageCanvasContext(g){const t=window.document.createElement("canvas"),s=t.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("failed to create canvas 2d context");return t.width=g.width,t.height=g.height,s.drawImage(g,0,0,g.width,g.height),s},resolveURL:g=>(Q||(Q=document.createElement("a")),Q.href=g,Q.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(dt==null&&(dt=matchMedia("(prefers-reduced-motion: reduce)")),dt.matches)}};class lt{static testProp(t){if(!lt.docStyle)return t[0];for(let s=0;s<t.length;s++)if(t[s]in lt.docStyle)return t[s];return t[0]}static create(t,s,c){const f=window.document.createElement(t);return s!==void 0&&(f.className=s),c&&c.appendChild(f),f}static createNS(t,s){return window.document.createElementNS(t,s)}static disableDrag(){lt.docStyle&&lt.selectProp&&(lt.userSelect=lt.docStyle[lt.selectProp],lt.docStyle[lt.selectProp]="none")}static enableDrag(){lt.docStyle&&lt.selectProp&&(lt.docStyle[lt.selectProp]=lt.userSelect)}static setTransform(t,s){t.style[lt.transformProp]=s}static addEventListener(t,s,c,f={}){t.addEventListener(s,c,"passive"in f?f:f.capture)}static removeEventListener(t,s,c,f={}){t.removeEventListener(s,c,"passive"in f?f:f.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",lt.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",lt.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",lt.suppressClickInternal,!0)},0)}static getScale(t){const s=t.getBoundingClientRect();return{x:s.width/t.offsetWidth||1,y:s.height/t.offsetHeight||1,boundingClientRect:s}}static getPoint(t,s,c){const f=s.boundingClientRect;return new u.P((c.clientX-f.left)/s.x-t.clientLeft,(c.clientY-f.top)/s.y-t.clientTop)}static mousePos(t,s){const c=lt.getScale(t);return lt.getPoint(t,c,s)}static touchPos(t,s){const c=[],f=lt.getScale(t);for(let y=0;y<s.length;y++)c.push(lt.getPoint(t,f,s[y]));return c}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const s=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),c=s.querySelectorAll("script");for(const f of c)f.remove();return lt.clean(s),s.innerHTML}static isPossiblyDangerous(t,s){const c=s.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!c.includes("javascript:")&&!c.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const s=t.children;for(const c of s)lt.removeAttributes(c),lt.clean(c)}static removeAttributes(t){for(const{name:s,value:c}of t.attributes)lt.isPossiblyDangerous(s,c)&&t.removeAttribute(s)}}lt.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,lt.selectProp=lt.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),lt.transformProp=lt.testProp(["transform","WebkitTransform"]);const Yt={supported:!1,testSupport:function(g){!ge&&pe&&(de?ne(g):Jt=g)}};let Jt,pe,ge=!1,de=!1;function ne(g){const t=g.createTexture();g.bindTexture(g.TEXTURE_2D,t);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,pe),g.isContextLost())return;Yt.supported=!0}catch{}g.deleteTexture(t),ge=!0}var Ne;typeof document<"u"&&(pe=document.createElement("img"),pe.onload=()=>{Jt&&ne(Jt),Jt=null,de=!0},pe.onerror=()=>{ge=!0,Jt=null},pe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(g){let t,s,c,f;g.resetRequestQueue=()=>{t=[],s=0,c=0,f={}},g.addThrottleControl=D=>{const O=c++;return f[O]=D,O},g.removeThrottleControl=D=>{delete f[D],T()},g.getImage=(D,O,j=!0)=>new Promise((Z,U)=>{Yt.supported&&(D.headers||(D.headers={}),D.headers.accept="image/webp,*/*"),u.e(D,{type:"image"}),t.push({abortController:O,requestParameters:D,supportImageRefresh:j,state:"queued",onError:$=>{U($)},onSuccess:$=>{Z($)}}),T()});const y=D=>u._(this,void 0,void 0,function*(){D.state="running";const{requestParameters:O,supportImageRefresh:j,onError:Z,onSuccess:U,abortController:$}=D,J=j===!1&&!u.i(self)&&!u.g(O.url)&&(!O.headers||Object.keys(O.headers).reduce((ut,pt)=>ut&&pt==="accept",!0));s++;const ct=J?z(O,$):u.m(O,$);try{const ut=yield ct;delete D.abortController,D.state="completed",ut.data instanceof HTMLImageElement||u.b(ut.data)?U(ut):ut.data&&U({data:yield(ot=ut.data,typeof createImageBitmap=="function"?u.f(ot):u.h(ot)),cacheControl:ut.cacheControl,expires:ut.expires})}catch(ut){delete D.abortController,Z(ut)}finally{s--,T()}var ot}),T=()=>{const D=(()=>{for(const O of Object.keys(f))if(f[O]())return!0;return!1})()?u.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:u.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let O=s;O<D&&t.length>0;O++){const j=t.shift();j.abortController.signal.aborted?O--:y(j)}},z=(D,O)=>new Promise((j,Z)=>{const U=new Image,$=D.url,J=D.credentials;J&&J==="include"?U.crossOrigin="use-credentials":(J&&J==="same-origin"||!u.d($))&&(U.crossOrigin="anonymous"),O.signal.addEventListener("abort",()=>{U.src="",Z(u.c())}),U.fetchPriority="high",U.onload=()=>{U.onerror=U.onload=null,j({data:U})},U.onerror=()=>{U.onerror=U.onload=null,O.signal.aborted||Z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},U.src=$})}(Ne||(Ne={})),Ne.resetRequestQueue();class we{constructor(t){this._transformRequestFn=t??null}transformRequest(t,s){return this._transformRequestFn&&this._transformRequestFn(t,s)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function Ve(g){const t=[];if(typeof g=="string")t.push({id:"default",url:g});else if(g&&g.length>0){const s=[];for(const{id:c,url:f}of g){const y=`${c}${f}`;s.indexOf(y)===-1&&(s.push(y),t.push({id:c,url:f}))}}return t}function Je(g,t,s){try{const c=new URL(g);return c.pathname+=`${t}${s}`,c.toString()}catch{throw new Error(`Invalid sprite URL "${g}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Ue(g){const{userImage:t}=g;return!!(t&&t.render&&t.render())&&(g.data.replace(new Uint8Array(t.data.buffer)),!0)}class Ei extends u.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:s,promiseResolve:c}of this.requestors)c(this._getImagesForIds(s));this.requestors=[]}}getImage(t){const s=this.images[t];if(s&&!s.data&&s.spriteData){const c=s.spriteData;s.data=new u.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),s.spriteData=null}return s}addImage(t,s){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,s)&&(this.images[t]=s)}_validate(t,s){let c=!0;const f=s.data||s.spriteData;return this._validateStretch(s.stretchX,f&&f.width)||(this.fire(new u.k(new Error(`Image "${t}" has invalid "stretchX" value`))),c=!1),this._validateStretch(s.stretchY,f&&f.height)||(this.fire(new u.k(new Error(`Image "${t}" has invalid "stretchY" value`))),c=!1),this._validateContent(s.content,s)||(this.fire(new u.k(new Error(`Image "${t}" has invalid "content" value`))),c=!1),c}_validateStretch(t,s){if(!t)return!0;let c=0;for(const f of t){if(f[0]<c||f[1]<f[0]||s<f[1])return!1;c=f[1]}return!0}_validateContent(t,s){if(!t)return!0;if(t.length!==4)return!1;const c=s.spriteData,f=c&&c.width||s.data.width,y=c&&c.height||s.data.height;return!(t[0]<0||f<t[0]||t[1]<0||y<t[1]||t[2]<0||f<t[2]||t[3]<0||y<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,s,c=!0){const f=this.getImage(t);if(c&&(f.data.width!==s.data.width||f.data.height!==s.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=f.version+1,this.images[t]=s,this.updatedImages[t]=!0}removeImage(t){const s=this.images[t];delete this.images[t],delete this.patterns[t],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((s,c)=>{let f=!0;if(!this.isLoaded())for(const y of t)this.images[y]||(f=!1);this.isLoaded()||f?s(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:s})})}_getImagesForIds(t){const s={};for(const c of t){let f=this.getImage(c);f||(this.fire(new u.l("styleimagemissing",{id:c})),f=this.getImage(c)),f?s[c]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:u.w(`Image "${c}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return s}getPixelSize(){const{width:t,height:s}=this.atlasImage;return{width:t,height:s}}getPattern(t){const s=this.patterns[t],c=this.getImage(t);if(!c)return null;if(s&&s.position.version===c.version)return s.position;if(s)s.position.version=c.version;else{const f={w:c.data.width+2,h:c.data.height+2,x:0,y:0},y=new u.I(f,c);this.patterns[t]={bin:f,position:y}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const s=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new u.T(t,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const y in this.patterns)t.push(this.patterns[y].bin);const{w:s,h:c}=u.p(t),f=this.atlasImage;f.resize({width:s||1,height:c||1});for(const y in this.patterns){const{bin:T}=this.patterns[y],z=T.x+1,D=T.y+1,O=this.getImage(y).data,j=O.width,Z=O.height;u.R.copy(O,f,{x:0,y:0},{x:z,y:D},{width:j,height:Z}),u.R.copy(O,f,{x:0,y:Z-1},{x:z,y:D-1},{width:j,height:1}),u.R.copy(O,f,{x:0,y:0},{x:z,y:D+Z},{width:j,height:1}),u.R.copy(O,f,{x:j-1,y:0},{x:z-1,y:D},{width:1,height:Z}),u.R.copy(O,f,{x:0,y:0},{x:z+j,y:D},{width:1,height:Z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const s of t){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const c=this.getImage(s);c||u.w(`Image with ID: "${s}" was not found`),Ue(c)&&this.updateImage(s,c)}}}const Ti=1e20;function zi(g,t,s,c,f,y,T,z,D){for(let O=t;O<t+c;O++)Pi(g,s*y+O,y,f,T,z,D);for(let O=s;O<s+f;O++)Pi(g,O*y+t,1,c,T,z,D)}function Pi(g,t,s,c,f,y,T){y[0]=0,T[0]=-Ti,T[1]=Ti,f[0]=g[t];for(let z=1,D=0,O=0;z<c;z++){f[z]=g[t+z*s];const j=z*z;do{const Z=y[D];O=(f[z]-f[Z]+j-Z*Z)/(z-Z)/2}while(O<=T[D]&&--D>-1);D++,y[D]=z,T[D]=O,T[D+1]=Ti}for(let z=0,D=0;z<c;z++){for(;T[D+1]<z;)D++;const O=y[D],j=z-O;g[t+z*s]=f[O]+j*j}}class Ir{constructor(t,s){this.requestManager=t,this.localIdeographFontFamily=s,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return u._(this,void 0,void 0,function*(){const s=[];for(const y in t)for(const T of t[y])s.push(this._getAndCacheGlyphsPromise(y,T));const c=yield Promise.all(s),f={};for(const{stack:y,id:T,glyph:z}of c)f[y]||(f[y]={}),f[y][T]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics};return f})}_getAndCacheGlyphsPromise(t,s){return u._(this,void 0,void 0,function*(){let c=this.entries[t];c||(c=this.entries[t]={glyphs:{},requests:{},ranges:{}});let f=c.glyphs[s];if(f!==void 0)return{stack:t,id:s,glyph:f};if(f=this._tinySDF(c,t,s),f)return c.glyphs[s]=f,{stack:t,id:s,glyph:f};const y=Math.floor(s/256);if(256*y>65535)throw new Error("glyphs > 65535 not supported");if(c.ranges[y])return{stack:t,id:s,glyph:f};if(!this.url)throw new Error("glyphsUrl is not set");if(!c.requests[y]){const z=Ir.loadGlyphRange(t,y,this.url,this.requestManager);c.requests[y]=z}const T=yield c.requests[y];for(const z in T)this._doesCharSupportLocalGlyph(+z)||(c.glyphs[+z]=T[+z]);return c.ranges[y]=!0,{stack:t,id:s,glyph:T[s]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(t))||u.u["CJK Unified Ideographs"](t)||u.u["Hangul Syllables"](t)||u.u.Hiragana(t)||u.u.Katakana(t)||u.u["CJK Symbols and Punctuation"](t)||u.u["Halfwidth and Fullwidth Forms"](t))}_tinySDF(t,s,c){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let y=t.tinySDF;if(!y){let z="400";/bold/i.test(s)?z="900":/medium/i.test(s)?z="500":/light/i.test(s)&&(z="200"),y=t.tinySDF=new Ir.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:z})}const T=y.draw(String.fromCharCode(c));return{id:c,bitmap:new u.q({width:T.width||60,height:T.height||60},T.data),metrics:{width:T.glyphWidth/2||24,height:T.glyphHeight/2||24,left:T.glyphLeft/2+.5||0,top:T.glyphTop/2-27.5||-8,advance:T.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ir.loadGlyphRange=function(g,t,s,c){return u._(this,void 0,void 0,function*(){const f=256*t,y=f+255,T=c.transformRequest(s.replace("{fontstack}",g).replace("{range}",`${f}-${y}`),"Glyphs"),z=yield u.n(T,new AbortController);if(!z||!z.data)throw new Error(`Could not load glyph range. range: ${t}, ${f}-${y}`);const D={};for(const O of u.o(z.data))D[O.id]=O;return D})},Ir.TinySDF=class{constructor({fontSize:g=24,buffer:t=3,radius:s=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:y="normal",fontStyle:T="normal",lang:z=null}={}){this.buffer=t,this.cutoff=c,this.radius=s,this.lang=z;const D=this.size=g+4*t,O=this._createCanvas(D),j=this.ctx=O.getContext("2d",{willReadFrequently:!0});j.font=`${T} ${y} ${g}px ${f}`,j.textBaseline="alphabetic",j.textAlign="left",j.fillStyle="black",this.gridOuter=new Float64Array(D*D),this.gridInner=new Float64Array(D*D),this.f=new Float64Array(D),this.z=new Float64Array(D+1),this.v=new Uint16Array(D)}_createCanvas(g){const t=document.createElement("canvas");return t.width=t.height=g,t}draw(g){const{width:t,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:y}=this.ctx.measureText(g),T=Math.ceil(s),z=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-f))),D=Math.min(this.size-this.buffer,T+Math.ceil(c)),O=z+2*this.buffer,j=D+2*this.buffer,Z=Math.max(O*j,0),U=new Uint8ClampedArray(Z),$={data:U,width:O,height:j,glyphWidth:z,glyphHeight:D,glyphTop:T,glyphLeft:0,glyphAdvance:t};if(z===0||D===0)return $;const{ctx:J,buffer:ct,gridInner:ot,gridOuter:ut}=this;this.lang&&(J.lang=this.lang),J.clearRect(ct,ct,z,D),J.fillText(g,ct,ct+T);const pt=J.getImageData(ct,ct,z,D);ut.fill(Ti,0,Z),ot.fill(0,0,Z);for(let vt=0;vt<D;vt++)for(let mt=0;mt<z;mt++){const bt=pt.data[4*(vt*z+mt)+3]/255;if(bt===0)continue;const At=(vt+ct)*O+mt+ct;if(bt===1)ut[At]=0,ot[At]=Ti;else{const gt=.5-bt;ut[At]=gt>0?gt*gt:0,ot[At]=gt<0?gt*gt:0}}zi(ut,0,0,O,j,O,this.f,this.v,this.z),zi(ot,ct,ct,z,D,O,this.f,this.v,this.z);for(let vt=0;vt<Z;vt++){const mt=Math.sqrt(ut[vt])-Math.sqrt(ot[vt]);U[vt]=Math.round(255-255*(mt/this.radius+this.cutoff))}return $}};class Rn{constructor(){this.specification=u.v.light.position}possiblyEvaluate(t,s){return u.B(t.expression.evaluate(s))}interpolate(t,s,c){return{x:u.C.number(t.x,s.x,c),y:u.C.number(t.y,s.y,c),z:u.C.number(t.z,s.z,c)}}}let dn;class Qt extends u.E{constructor(t){super(),dn=dn||new u.r({anchor:new u.D(u.v.light.anchor),position:new Rn,color:new u.D(u.v.light.color),intensity:new u.D(u.v.light.intensity)}),this._transitionable=new u.t(dn),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,s={}){if(!this._validate(u.x,t,s))for(const c in t){const f=t[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,s,c){return(!c||c.validate!==!1)&&u.y(this,t.call(u.z,{value:s,style:{glyphs:!0,sprite:!0},styleSpec:u.v}))}}const me=new u.r({"sky-color":new u.D(u.v.sky["sky-color"]),"horizon-color":new u.D(u.v.sky["horizon-color"]),"fog-color":new u.D(u.v.sky["fog-color"]),"fog-ground-blend":new u.D(u.v.sky["fog-ground-blend"]),"horizon-fog-blend":new u.D(u.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new u.D(u.v.sky["sky-horizon-blend"]),"atmosphere-blend":new u.D(u.v.sky["atmosphere-blend"])});class fe extends u.E{constructor(t){super(),this._transitionable=new u.t(me),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new u.F(0))}setSky(t,s={}){if(!this._validate(u.G,t,s)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const c in t){const f=t[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,s,c={}){return c?.validate!==!1&&u.y(this,t.call(u.z,u.e({value:s,style:{glyphs:!0,sprite:!0},styleSpec:u.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class Ze{constructor(t,s){this.width=t,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,s){const c=t.join(",")+String(s);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(t,s)),this.dashEntry[c]}getDashRanges(t,s,c){const f=[];let y=t.length%2==1?-t[t.length-1]*c:0,T=t[0]*c,z=!0;f.push({left:y,right:T,isDash:z,zeroLength:t[0]===0});let D=t[0];for(let O=1;O<t.length;O++){z=!z;const j=t[O];y=D*c,D+=j,T=D*c,f.push({left:y,right:T,isDash:z,zeroLength:j===0})}return f}addRoundDash(t,s,c){const f=s/2;for(let y=-c;y<=c;y++){const T=this.width*(this.nextRow+c+y);let z=0,D=t[z];for(let O=0;O<this.width;O++){O/D.right>1&&(D=t[++z]);const j=Math.abs(O-D.left),Z=Math.abs(O-D.right),U=Math.min(j,Z);let $;const J=y/c*(f+1);if(D.isDash){const ct=f-Math.abs(J);$=Math.sqrt(U*U+ct*ct)}else $=f-Math.sqrt(U*U+J*J);this.data[T+O]=Math.max(0,Math.min(255,$+128))}}}addRegularDash(t){for(let z=t.length-1;z>=0;--z){const D=t[z],O=t[z+1];D.zeroLength?t.splice(z,1):O&&O.isDash===D.isDash&&(O.left=D.left,t.splice(z,1))}const s=t[0],c=t[t.length-1];s.isDash===c.isDash&&(s.left=c.left-this.width,c.right=s.right+this.width);const f=this.width*this.nextRow;let y=0,T=t[y];for(let z=0;z<this.width;z++){z/T.right>1&&(T=t[++y]);const D=Math.abs(z-T.left),O=Math.abs(z-T.right),j=Math.min(D,O);this.data[f+z]=Math.max(0,Math.min(255,(T.isDash?j:-j)+128))}}addDash(t,s){const c=s?7:0,f=2*c+1;if(this.nextRow+f>this.height)return u.w("LineAtlas out of space"),null;let y=0;for(let z=0;z<t.length;z++)y+=t[z];if(y!==0){const z=this.width/y,D=this.getDashRanges(t,this.width,z);s?this.addRoundDash(D,z,c):this.addRegularDash(D)}const T={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:y};return this.nextRow+=f,this.dirty=!0,T}bind(t){const s=t.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}const yt="maplibre_preloaded_worker_pool";class Wt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Wt.workerCount;)this.workers.push(new Worker(u.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[yt]}numActive(){return Object.keys(this.active).length}}const Ce=Math.floor(ht.hardwareConcurrency/2);let xe,ze;function Fe(){return xe||(xe=new Wt),xe}Wt.workerCount=u.H(globalThis)?Math.max(Math.min(Ce,3),1):1;class Se{constructor(t,s){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=s;const c=this.workerPool.acquire(s);for(let f=0;f<c.length;f++){const y=new u.J(c[f],s);y.name=`Worker ${f}`,this.actors.push(y)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,s){const c=[];for(const f of this.actors)c.push(f.sendAsync({type:t,data:s}));return Promise.all(c)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(s=>{s.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,s){for(const c of this.actors)c.registerMessageHandler(t,s)}}function rn(){return ze||(ze=new Se(Fe(),u.K),ze.registerMessageHandler("GR",(g,t,s)=>u.m(t,s))),ze}function xi(g,t){const s=u.L();return u.M(s,s,[1,1,0]),u.N(s,s,[.5*g.width,.5*g.height,1]),g.calculatePosMatrix?u.O(s,s,g.calculatePosMatrix(t.toUnwrapped())):s}function rr(g,t,s,c,f,y,T){var z;const D=function(U,$,J){if(U)for(const ct of U){const ot=$[ct];if(ot&&ot.source===J&&ot.type==="fill-extrusion")return!0}else for(const ct in $){const ot=$[ct];if(ot.source===J&&ot.type==="fill-extrusion")return!0}return!1}((z=f?.layers)!==null&&z!==void 0?z:null,t,g.id),O=y.maxPitchScaleFactor(),j=g.tilesIn(c,O,D);j.sort(da);const Z=[];for(const U of j)Z.push({wrappedTileID:U.tileID.wrapped().key,queryResults:U.tile.queryRenderedFeatures(t,s,g._state,U.queryGeometry,U.cameraQueryGeometry,U.scale,f,y,O,xi(g.transform,U.tileID),T?($,J)=>T(U.tileID,$,J):void 0)});return function(U,$){for(const J in U)for(const ct of U[J])Ws(ct,$);return U}(function(U){const $={},J={};for(const ct of U){const ot=ct.queryResults,ut=ct.wrappedTileID,pt=J[ut]=J[ut]||{};for(const vt in ot){const mt=ot[vt],bt=pt[vt]=pt[vt]||{},At=$[vt]=$[vt]||[];for(const gt of mt)bt[gt.featureIndex]||(bt[gt.featureIndex]=!0,At.push(gt))}}return $}(Z),g)}function da(g,t){const s=g.tileID,c=t.tileID;return s.overscaledZ-c.overscaledZ||s.canonical.y-c.canonical.y||s.wrap-c.wrap||s.canonical.x-c.canonical.x}function Ws(g,t){const s=g.feature,c=t.getFeatureState(s.layer["source-layer"],s.id);s.source=s.layer.source,s.layer["source-layer"]&&(s.sourceLayer=s.layer["source-layer"]),s.state=c}function sr(g,t,s){return u._(this,void 0,void 0,function*(){let c=g;if(g.url?c=(yield u.j(t.transformRequest(g.url,"Source"),s)).data:yield ht.frameAsync(s),!c)return null;const f=u.Q(u.e(c,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in c&&c.vector_layers&&(f.vectorLayerIds=c.vector_layers.map(y=>y.id)),f})}class sn{constructor(t,s){t&&(s?this.setSouthWest(t).setNorthEast(s):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof u.S?new u.S(t.lng,t.lat):u.S.convert(t),this}setSouthWest(t){return this._sw=t instanceof u.S?new u.S(t.lng,t.lat):u.S.convert(t),this}extend(t){const s=this._sw,c=this._ne;let f,y;if(t instanceof u.S)f=t,y=t;else{if(!(t instanceof sn))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(sn.convert(t)):this.extend(u.S.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(u.S.convert(t)):this;if(f=t._sw,y=t._ne,!f||!y)return this}return s||c?(s.lng=Math.min(f.lng,s.lng),s.lat=Math.min(f.lat,s.lat),c.lng=Math.max(y.lng,c.lng),c.lat=Math.max(y.lat,c.lat)):(this._sw=new u.S(f.lng,f.lat),this._ne=new u.S(y.lng,y.lat)),this}getCenter(){return new u.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new u.S(this.getWest(),this.getNorth())}getSouthEast(){return new u.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:s,lat:c}=u.S.convert(t);let f=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(t){return t instanceof sn?t:t&&new sn(t)}static fromLngLat(t,s=0){const c=360*s/40075017,f=c/Math.cos(Math.PI/180*t.lat);return new sn(new u.S(t.lng-f,t.lat-c),new u.S(t.lng+f,t.lat+c))}adjustAntiMeridian(){const t=new u.S(this._sw.lng,this._sw.lat),s=new u.S(this._ne.lng,this._ne.lat);return new sn(t,t.lng>s.lng?new u.S(s.lng+360,s.lat):s)}}class An{constructor(t,s,c){this.bounds=sn.convert(this.validateBounds(t)),this.minzoom=s||0,this.maxzoom=c||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const s=Math.pow(2,t.z),c=Math.floor(u.V(this.bounds.getWest())*s),f=Math.floor(u.U(this.bounds.getNorth())*s),y=Math.ceil(u.V(this.bounds.getEast())*s),T=Math.ceil(u.U(this.bounds.getSouth())*s);return t.x>=c&&t.x<y&&t.y>=f&&t.y<T}}class Os extends u.E{constructor(t,s,c,f){if(super(),this.id=t,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.e(this,u.Q(s,["url","scheme","tileSize","promoteId"])),this._options=u.e({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield sr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(u.e(this,t),t.bounds&&(this.tileBounds=new An(t.bounds,this.minzoom,this.maxzoom)),this.fire(new u.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new u.k(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return u.e({},this._options)}loadTile(t){return u._(this,void 0,void 0,function*(){const s=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c={request:this.map._requestManager.transformRequest(s,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};c.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise((y,T)=>{t.reloadPromise={resolve:y,reject:T}})}else t.actor=this.dispatcher.getActor(),f="LT";t.abortController=new AbortController;try{const y=yield t.actor.sendAsync({type:f,data:c},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,y)}catch(y){if(delete t.abortController,t.aborted)return;if(y&&y.status!==404)throw y;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,s){if(s&&s.resourceTiming&&(t.resourceTiming=s.resourceTiming),s&&this.map._refreshExpiredTiles&&t.setExpiryData(s),t.loadVectorData(s,this.map.painter),t.reloadPromise){const c=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(c.resolve).catch(c.reject)}}abortTile(t){return u._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return u._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ks extends u.E{constructor(t,s,c,f){super(),this.id=t,this.dispatcher=c,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.e({type:"raster"},s),u.e(this,u.Q(s,["url","scheme","tileSize"]))}load(){return u._(this,arguments,void 0,function*(t=!1){this._loaded=!1,this.fire(new u.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const s=yield sr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,s&&(u.e(this,s),s.bounds&&(this.tileBounds=new An(s.bounds,this.minzoom,this.maxzoom)),this.fire(new u.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(s){this._tileJSONRequest=null,this.fire(new u.k(s))}})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return u.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return u._(this,void 0,void 0,function*(){const s=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const c=yield Ne.getImage(this.map._requestManager.transformRequest(s,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(c&&c.data){this.map._refreshExpiredTiles&&(c.cacheControl||c.expires)&&t.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const f=this.map.painter.context,y=f.gl,T=c.data;t.texture=this.map.painter.getTileTexture(T.width),t.texture?t.texture.update(T,{useMipmap:!0}):(t.texture=new u.T(f,T,y.RGBA,{useMipmap:!0}),t.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(c){if(delete t.abortController,t.aborted)t.state="unloaded";else if(c)throw t.state="errored",c}})}abortTile(t){return u._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return u._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class dr extends Ks{constructor(t,s,c,f){super(t,s,c,f),this.type="raster-dem",this.maxzoom=22,this._options=u.e({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox",this.redFactor=s.redFactor,this.greenFactor=s.greenFactor,this.blueFactor=s.blueFactor,this.baseShift=s.baseShift}loadTile(t){return u._(this,void 0,void 0,function*(){const s=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c=this.map._requestManager.transformRequest(s,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const f=yield Ne.getImage(c,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(f&&f.data){const y=f.data;this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&t.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const T=u.b(y)&&u.W()?y:yield this.readImageNow(y),z={type:this.type,uid:t.uid,source:this.id,rawImageData:T,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const D=yield t.actor.sendAsync({type:"LDT",data:z});t.dem=D,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(f){if(delete t.abortController,t.aborted)t.state="unloaded";else if(f)throw t.state="errored",f}})}readImageNow(t){return u._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&u.X()){const s=t.width+2,c=t.height+2;try{return new u.R({width:s,height:c},yield u.Y(t,-1,-1,s,c))}catch{}}return ht.getImageData(t,1)})}_getNeighboringTiles(t){const s=t.canonical,c=Math.pow(2,s.z),f=(s.x-1+c)%c,y=s.x===0?t.wrap-1:t.wrap,T=(s.x+1+c)%c,z=s.x+1===c?t.wrap+1:t.wrap,D={};return D[new u.Z(t.overscaledZ,y,s.z,f,s.y).key]={backfilled:!1},D[new u.Z(t.overscaledZ,z,s.z,T,s.y).key]={backfilled:!1},s.y>0&&(D[new u.Z(t.overscaledZ,y,s.z,f,s.y-1).key]={backfilled:!1},D[new u.Z(t.overscaledZ,t.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},D[new u.Z(t.overscaledZ,z,s.z,T,s.y-1).key]={backfilled:!1}),s.y+1<c&&(D[new u.Z(t.overscaledZ,y,s.z,f,s.y+1).key]={backfilled:!1},D[new u.Z(t.overscaledZ,t.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},D[new u.Z(t.overscaledZ,z,s.z,T,s.y+1).key]={backfilled:!1}),D}unloadTile(t){return u._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class ys extends u.E{constructor(t,s,c,f){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:s.data},this.actor=c.getActor(),this.setEventedParent(f),this._data=s.data,this._options=u.e({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId,s.clusterMaxZoom!==void 0&&this.maxzoom<=s.clusterMaxZoom&&u.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${s.clusterMaxZoom}".`),this.workerOptions=u.e({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(s.buffer!==void 0?s.buffer:128),tolerance:this._pixelsToTileUnits(s.tolerance!==void 0?s.tolerance:.375),extent:u.$,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(s.clusterMaxZoom),minPoints:Math.max(2,s.clusterMinPoints||2),extent:u.$,radius:this._pixelsToTileUnits(s.clusterRadius||50),log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(t){return t*(u.$/this.tileSize)}_getClusterMaxZoom(t){const s=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||u.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${s}"`),s}load(){return u._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._pendingWorkerUpdate={data:t},this._updateWorkerData(),this}updateData(t){return this._pendingWorkerUpdate.diff=u.a0(this._pendingWorkerUpdate.diff,t),this._updateWorkerData(),this}getData(){return u._(this,void 0,void 0,function*(){const t=u.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})})}getCoordinatesFromGeometry(t){return t.type==="GeometryCollection"?t.geometries.map(s=>s.coordinates).flat(1/0):t.coordinates.flat(1/0)}getBounds(){return u._(this,void 0,void 0,function*(){const t=new sn,s=yield this.getData();let c;switch(s.type){case"FeatureCollection":c=s.features.map(f=>this.getCoordinatesFromGeometry(f.geometry)).flat(1/0);break;case"Feature":c=this.getCoordinatesFromGeometry(s.geometry);break;default:c=this.getCoordinatesFromGeometry(s)}if(c.length==0)return t;for(let f=0;f<c.length-1;f+=2)t.extend([c[f],c[f+1]]);return t})}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,s,c){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:s,offset:c}})}_updateWorkerData(){return u._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;const{data:t,diff:s}=this._pendingWorkerUpdate;if(!t&&!s)return void u.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const c=u.e({type:this.type},this.workerOptions);t?(typeof t=="string"?(c.request=this.map._requestManager.transformRequest(ht.resolveURL(t),"Source"),c.request.collectResourceTiming=this._collectResourceTiming):c.data=JSON.stringify(t),this._pendingWorkerUpdate.data=void 0):s&&(c.dataDiff=s,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new u.l("dataloading",{dataType:"source"}));try{const f=yield this.actor.sendAsync({type:"LD",data:c});if(this._isUpdatingWorker=!1,this._removed||f.abandoned)return void this.fire(new u.l("dataabort",{dataType:"source"}));this._data=f.data;let y=null;f.resourceTiming&&f.resourceTiming[this.id]&&(y=f.resourceTiming[this.id].slice(0));const T={dataType:"source"};this._collectResourceTiming&&y&&y.length>0&&u.e(T,{resourceTiming:y}),this.fire(new u.l("data",Object.assign(Object.assign({},T),{sourceDataType:"metadata"}))),this.fire(new u.l("data",Object.assign(Object.assign({},T),{sourceDataType:"content"})))}catch(f){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new u.l("dataabort",{dataType:"source"}));this.fire(new u.k(f))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}})}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(t){return u._(this,void 0,void 0,function*(){const s=t.actor?"RT":"LT";t.actor=this.actor;const c={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};t.abortController=new AbortController;const f=yield this.actor.sendAsync({type:s,data:c},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(f,this.map.painter,s==="RT")})}abortTile(t){return u._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return u._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return u.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Qs extends u.E{constructor(t,s,c,f){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=c,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=s}load(t){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const s=yield Ne.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,s&&s.data&&(this.image=s.data,t&&(this.coordinates=t),this._finishLoading())}catch(s){this._request=null,this._loaded=!0,this.fire(new u.k(s))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const s=t.map(u.a1.fromLngLat);var c;return this.tileID=function(f){const y=u.a2.fromPoints(f),T=y.width(),z=y.height(),D=Math.max(T,z),O=Math.max(0,Math.floor(-Math.log(D)/Math.LN2)),j=Math.pow(2,O);return new u.a4(O,Math.floor((y.minX+y.maxX)/2*j),Math.floor((y.minY+y.maxY)/2*j))}(s),this.terrainTileRanges=this._getOverlappingTileRanges(s),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=s.map(f=>this.tileID.getTilePoint(f)._round()),this.flippedWindingOrder=((c=this.tileCoords)[1].x-c[0].x)*(c[2].y-c[0].y)-(c[1].y-c[0].y)*(c[2].x-c[0].x)<0,this.fire(new u.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,s=t.gl;this.texture||(this.texture=new u.T(t,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,c=!0)}c&&this.fire(new u.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return u._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:s,minY:c,maxX:f,maxY:y}=u.a2.fromPoints(t),T={};for(let z=0;z<=u.a3;z++){const D=Math.pow(2,z),O=Math.floor(s*D),j=Math.floor(c*D),Z=Math.floor(f*D),U=Math.floor(y*D);T[z]={minTileX:O,minTileY:j,maxTileX:Z,maxTileY:U}}return T}}class vo extends Qs{constructor(t,s,c,f){super(t,s,c,f),this.roundZoom=!0,this.type="video",this.options=s}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const s of t.urls)this.urls.push(this.map._requestManager.transformRequest(s,"Source").url);try{const s=yield u.a5(this.urls);if(this._loaded=!0,!s)return;this.video=s,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(s){this.fire(new u.k(s))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const s=this.video.seekable;t<s.start(0)||t>s.end(0)?this.fire(new u.k(new u.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,s=t.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new u.T(t,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,c=!0)}c&&this.fire(new u.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class vs extends Qs{constructor(t,s,c,f){super(t,s,c,f),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(T=>typeof T!="number"))||this.fire(new u.k(new u.a6(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.k(new u.a6(`sources.${t}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new u.k(new u.a6(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new u.k(new u.a6(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.k(new u.a6(`sources.${t}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){return u._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,c=s.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new u.T(s,this.canvas,c.RGBA,{premultiply:!0});let f=!1;for(const y in this.tiles){const T=this.tiles[y];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,f=!0)}f&&this.fire(new u.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const Ha={},fa=g=>{switch(g){case"geojson":return ys;case"image":return Qs;case"raster":return Ks;case"raster-dem":return dr;case"vector":return Os;case"video":return vo;case"canvas":return vs}return Ha[g]},Go="RTLPluginLoaded";class xo extends u.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=rn()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch(s=>{throw this.status="error",s})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return u._(this,arguments,void 0,function*(s,c=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=ht.resolveURL(s),!this.url)throw new Error(`requested url ${s} is invalid`);if(this.status==="unavailable"){if(!c)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return u._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new u.l(Go))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let ts=null;function Vn(){return ts||(ts=new xo),ts}class es{constructor(t,s){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=u.a7(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const s=t+this.timeAdded;s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,s,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(f,y){const T={};if(!y)return T;for(const z of f){const D=z.layerIds.map(O=>y.getLayer(O)).filter(Boolean);if(D.length!==0){z.layers=D,z.stateDependentLayerIds&&(z.stateDependentLayers=z.stateDependentLayerIds.map(O=>D.filter(j=>j.id===O)[0]));for(const O of D)T[O.id]=z}}return T}(t.buckets,s?.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const y=this.buckets[f];if(y instanceof u.a9){if(this.hasSymbolBuckets=!0,!c)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const y=this.buckets[f];if(y instanceof u.a9&&y.hasRTLText){this.hasRTLText=!0,Vn().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const y=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(f).queryRadius(y))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new u.a8}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const c in this.buckets){const f=this.buckets[c];f.uploadPending()&&f.upload(t)}const s=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new u.T(t,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new u.T(t,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,s,c,f,y,T,z,D,O,j,Z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:y,scale:T,tileSize:this.tileSize,pixelPosMatrix:j,transform:D,params:z,queryPadding:this.queryPadding*O,getElevation:Z},t,s,c):{}}querySourceFeatures(t,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const f=c.loadVTLayers(),y=s&&s.sourceLayer?s.sourceLayer:"",T=f._geojsonTileLayer||f[y];if(!T)return;const z=u.aa(s&&s.filter),{z:D,x:O,y:j}=this.tileID.canonical,Z={z:D,x:O,y:j};for(let U=0;U<T.length;U++){const $=T.feature(U);if(z.needGeometry){const ot=u.ab($,!0);if(!z.filter(new u.F(this.tileID.overscaledZ),ot,this.tileID.canonical))continue}else if(!z.filter(new u.F(this.tileID.overscaledZ),$))continue;const J=c.getId($,y),ct=new u.ac($,D,O,j,J);ct.tile=Z,t.push(ct)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const s=this.expirationTime;if(t.cacheControl){const c=u.ad(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const c=Date.now();let f=!1;if(this.expirationTime>c)f=!1;else if(s)if(this.expirationTime<s)f=!0;else{const y=this.expirationTime-s;y?this.expirationTime=c+Math.max(y,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!s.style.hasLayer(f))continue;const y=this.buckets[f],T=y.layers[0].sourceLayer||"_geojsonTileLayer",z=c[T],D=t[T];if(!z||!D||Object.keys(D).length===0)continue;y.update(D,z,this.imageAtlas&&this.imageAtlas.patternPositions||{});const O=s&&s.style&&s.style.getLayer(f);O&&(this.queryPadding=Math.max(this.queryPadding,O.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ht.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=ht.now()+t}setDependencies(t,s){const c={};for(const f of s)c[f]=!0;this.dependencies[t]=c}hasDependency(t,s){for(const c of t){const f=this.dependencies[c];if(f){for(const y of s)if(f[y])return!0}}return!1}}class Ct{constructor(t,s){this.max=t,this.onRemove=s,this.reset()}reset(){for(const t in this.data)for(const s of this.data[t])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(t,s,c){const f=t.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const y={value:s,timeout:void 0};if(c!==void 0&&(y.timeout=setTimeout(()=>{this.remove(t,y)},c)),this.data[f].push(y),this.order.push(f),this.order.length>this.max){const T=this._getAndRemoveByKey(this.order[0]);T&&this.onRemove(T)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const s=this.data[t].shift();return s.timeout&&clearTimeout(s.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),s.value}getByKey(t){const s=this.data[t];return s?s[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,s){if(!this.has(t))return this;const c=t.wrapped().key,f=s===void 0?0:this.data[c].indexOf(s),y=this.data[c][f];return this.data[c].splice(f,1),y.timeout&&clearTimeout(y.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(y.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(t){const s=[];for(const c in this.data)for(const f of this.data[c])t(f.value)||s.push(f);for(const c of s)this.remove(c.value.tileID,c)}}class tt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,s,c){const f=String(s);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][f]=this.stateChanges[t][f]||{},u.e(this.stateChanges[t][f],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(const y in this.state[t])y!==f&&(this.deletedStates[t][y]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][f]===null){this.deletedStates[t][f]={};for(const y in this.state[t][f])c[y]||(this.deletedStates[t][f][y]=null)}else for(const y in c)this.deletedStates[t]&&this.deletedStates[t][f]&&this.deletedStates[t][f][y]===null&&delete this.deletedStates[t][f][y]}removeFeatureState(t,s,c){if(this.deletedStates[t]===null)return;const f=String(s);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&s!==void 0)this.deletedStates[t][f]!==null&&(this.deletedStates[t][f]=this.deletedStates[t][f]||{},this.deletedStates[t][f][c]=null);else if(s!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][f])for(c in this.deletedStates[t][f]={},this.stateChanges[t][f])this.deletedStates[t][f][c]=null;else this.deletedStates[t][f]=null;else this.deletedStates[t]=null}getState(t,s){const c=String(s),f=u.e({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const y=this.deletedStates[t][s];if(y===null)return{};for(const T in y)delete f[T]}return f}initializeTileState(t,s){t.setFeatureState(this.state,s)}coalesceChanges(t,s){const c={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const y={};for(const T in this.stateChanges[f])this.state[f][T]||(this.state[f][T]={}),u.e(this.state[f][T],this.stateChanges[f][T]),y[T]=this.state[f][T];c[f]=y}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const y={};if(this.deletedStates[f]===null)for(const T in this.state[f])y[T]={},this.state[f][T]={};else for(const T in this.deletedStates[f]){if(this.deletedStates[f][T]===null)this.state[f][T]={};else for(const z of Object.keys(this.deletedStates[f][T]))delete this.state[f][T][z];y[T]=this.state[f][T]}c[f]=c[f]||{},u.e(c[f],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const f in t)t[f].setFeatureState(c,s)}}const it=89.25;function st(g,t){const s=u.ah(t.lat,-u.ai,u.ai);return new u.P(u.V(t.lng)*g,u.U(s)*g)}function _t(g,t){return new u.a1(t.x/g,t.y/g).toLngLat()}function Pt(g){return g.cameraToCenterDistance*Math.min(.85*Math.tan(u.ae(90-g.pitch)),Math.tan(u.ae(it-g.pitch)))}function Et(g,t){const s=g.canonical,c=t/u.af(s.z),f=s.x+Math.pow(2,s.z)*g.wrap,y=u.ag(new Float64Array(16));return u.M(y,y,[f*c,s.y*c,0]),u.N(y,y,[c/u.$,c/u.$,1]),y}function Ft(g,t,s,c,f){const y=u.a1.fromLngLat(g,t),T=f*u.aj(1,g.lat),z=T*Math.cos(u.ae(s)),D=Math.sqrt(T*T-z*z),O=D*Math.sin(u.ae(-c)),j=D*Math.cos(u.ae(-c));return new u.a1(y.x+O,y.y+j,y.z+z)}function zt(g,t,s){const c=t.intersectsFrustum(g);if(!s||c===0)return c;const f=t.intersectsPlane(s);return f===0?0:c===2&&f===2?2:1}function Kt(g,t,s){let c=0;const f=(s-t)/10;for(let y=0;y<10;y++)c+=f*Math.pow(Math.cos(t+(y+.5)/10*(s-t)),g);return c}function oe(g,t){return function(s,c,f,y,T){const z=2*((g-1)/u.ak(Math.cos(u.ae(it-T))/Math.cos(u.ae(it)))-1),D=Math.acos(f/y),O=2*Kt(z-1,0,u.ae(T/2)),j=Math.min(u.ae(it),D+u.ae(T/2)),Z=Kt(z-1,Math.min(j,D-u.ae(T/2)),j),U=Math.atan(c/f),$=Math.hypot(c,f);let J=s;return J+=u.ak(y/$/Math.max(.5,Math.cos(u.ae(T/2)))),J+=z*u.ak(Math.cos(U))/2,J-=u.ak(Math.max(1,Z/O/t))/2,J}}const ee=oe(9.314,3);function Le(g,t){const s=(t.roundZoom?Math.round:Math.floor)(g.zoom+u.ak(g.tileSize/t.tileSize));return Math.max(0,s)}function It(g,t){const s=g.getCameraFrustum(),c=g.getClippingPlane(),f=g.screenPointToMercatorCoordinate(g.getCameraPoint()),y=u.a1.fromLngLat(g.center,g.elevation);f.z=y.z+Math.cos(g.pitchInRadians)*g.cameraToCenterDistance/g.worldSize;const T=g.getCoveringTilesDetailsProvider(),z=T.allowVariableZoom(g,t),D=Le(g,t),O=t.minzoom||0,j=t.maxzoom!==void 0?t.maxzoom:g.maxZoom,Z=Math.min(Math.max(0,D),j),U=Math.pow(2,Z),$=[U*f.x,U*f.y,0],J=[U*y.x,U*y.y,0],ct=Math.hypot(y.x-f.x,y.y-f.y),ot=Math.abs(y.z-f.z),ut=Math.hypot(ct,ot),pt=bt=>({zoom:0,x:0,y:0,wrap:bt,fullyVisible:!1}),vt=[],mt=[];if(g.renderWorldCopies&&T.allowWorldCopies())for(let bt=1;bt<=3;bt++)vt.push(pt(-bt)),vt.push(pt(bt));for(vt.push(pt(0));vt.length>0;){const bt=vt.pop(),At=bt.x,gt=bt.y;let Lt=bt.fullyVisible;const Gt={x:At,y:gt,z:bt.zoom},Ot=T.getTileBoundingVolume(Gt,bt.wrap,g.elevation,t);if(!Lt){const ve=zt(s,Ot,c);if(ve===0)continue;Lt=ve===2}const Nt=T.distanceToTile2d(f.x,f.y,Gt,Ot);let Ut=D;z&&(Ut=(t.calculateTileZoom||ee)(g.zoom+u.ak(g.tileSize/t.tileSize),Nt,ot,ut,g.fov)),Ut=(t.roundZoom?Math.round:Math.floor)(Ut),Ut=Math.max(0,Ut);const _e=Math.min(Ut,j);if(bt.wrap=T.getWrap(y,Gt,bt.wrap),bt.zoom>=_e){if(bt.zoom<O)continue;const ve=Z-bt.zoom,re=$[0]-.5-(At<<ve),Oe=$[1]-.5-(gt<<ve),yi=t.reparseOverscaled?Math.max(bt.zoom,Ut):bt.zoom;mt.push({tileID:new u.Z(bt.zoom===j?yi:bt.zoom,bt.wrap,bt.zoom,At,gt),distanceSq:u.al([J[0]-.5-At,J[1]-.5-gt]),tileDistanceToCamera:Math.sqrt(re*re+Oe*Oe)})}else for(let ve=0;ve<4;ve++)vt.push({zoom:bt.zoom+1,x:(At<<1)+ve%2,y:(gt<<1)+(ve>>1),wrap:bt.wrap,fullyVisible:Lt})}return mt.sort((bt,At)=>bt.distanceSq-At.distanceSq).map(bt=>bt.tileID)}const ri=u.a2.fromPoints([new u.P(0,0),new u.P(u.$,u.$)]);class bi extends u.E{constructor(t,s,c){super(),this.id=t,this.dispatcher=c,this.on("data",f=>this._dataHandler(f)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((f,y,T,z)=>{const D=new(fa(y.type))(f,y,T,z);if(D.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${D.id}`);return D})(t,s,c,this),this._tiles={},this._cache=new Ct(0,f=>this._unloadTile(f)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new tt,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const s=this._tiles[t];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,s,c){return u._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,s,c)}catch(f){t.state="errored",f.status!==404?this._source.fire(new u.k(f,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new u.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const c=this._tiles[s];c.upload(t),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(Ge).map(t=>t.key)}getRenderableIds(t){const s=[];for(const c in this._tiles)this._isIdRenderable(c,t)&&s.push(this._tiles[c]);return t?s.sort((c,f)=>{const y=c.tileID,T=f.tileID,z=new u.P(y.canonical.x,y.canonical.y)._rotate(-this.transform.bearingInRadians),D=new u.P(T.canonical.x,T.canonical.y)._rotate(-this.transform.bearingInRadians);return y.overscaledZ-T.overscaledZ||D.y-z.y||D.x-z.x}).map(c=>c.tileID.key):s.map(c=>c.tileID).sort(Ge).map(c=>c.key)}hasRenderableParent(t){const s=this.findLoadedParent(t,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(t,s){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(s||!this._tiles[t].holdingForFade())}reload(t){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)t?this._reloadTile(s,"expired"):this._tiles[s].state!=="errored"&&this._reloadTile(s,"reloading")}}_reloadTile(t,s){return u._(this,void 0,void 0,function*(){const c=this._tiles[t];c&&(c.state!=="loading"&&(c.state=s),yield this._loadTile(c,t,s))})}_tileLoaded(t,s,c){t.timeAdded=ht.now(),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(s,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new u.l("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const s=this.getRenderableIds();for(let f=0;f<s.length;f++){const y=s[f];if(t.neighboringTiles&&t.neighboringTiles[y]){const T=this.getTileByID(y);c(t,T),c(T,t)}}function c(f,y){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let T=y.tileID.canonical.x-f.tileID.canonical.x;const z=y.tileID.canonical.y-f.tileID.canonical.y,D=Math.pow(2,f.tileID.canonical.z),O=y.tileID.key;T===0&&z===0||Math.abs(z)>1||(Math.abs(T)>1&&(Math.abs(T+D)===1?T+=D:Math.abs(T-D)===1&&(T-=D)),y.dem&&f.dem&&(f.dem.backfillBorder(y.dem,T,z),f.neighboringTiles&&f.neighboringTiles[O]&&(f.neighboringTiles[O].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,s,c,f){for(const y in this._tiles){let T=this._tiles[y];if(f[y]||!T.hasData()||T.tileID.overscaledZ<=s||T.tileID.overscaledZ>c)continue;let z=T.tileID;for(;T&&T.tileID.overscaledZ>s+1;){const O=T.tileID.scaledTo(T.tileID.overscaledZ-1);T=this._tiles[O.key],T&&T.hasData()&&(z=O)}let D=z;for(;D.overscaledZ>s;)if(D=D.scaledTo(D.overscaledZ-1),t[D.key]||t[D.canonical.key]){f[z.key]=z;break}}}findLoadedParent(t,s){if(t.key in this._loadedParentTiles){const c=this._loadedParentTiles[t.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=t.overscaledZ-1;c>=s;c--){const f=t.scaledTo(c),y=this._getLoadedTile(f);if(y)return y}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const s=this._tiles[t.key];return s&&s.hasData()?s:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const s=Math.ceil(t.width/this._source.tileSize)+1,c=Math.ceil(t.height/this._source.tileSize)+1,f=Math.floor(s*c*(this._maxTileCacheZoomLevels===null?u.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(y)}handleWrapJump(t){const s=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,s){const c={};for(const f in this._tiles){const y=this._tiles[f];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+s),c[y.tileID.key]=y}this._tiles=c;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}_updateCoveredAndRetainedTiles(t,s,c,f,y,T){const z={},D={},O=Object.keys(t),j=ht.now();for(const Z of O){const U=t[Z],$=this._tiles[Z];if(!$||$.fadeEndTime!==0&&$.fadeEndTime<=j)continue;const J=this.findLoadedParent(U,s),ct=this.findLoadedSibling(U),ot=J||ct||null;ot&&(this._addTile(ot.tileID),z[ot.tileID.key]=ot.tileID),D[Z]=U}this._retainLoadedChildren(D,f,c,t);for(const Z in z)t[Z]||(this._coveredTiles[Z]=!0,t[Z]=z[Z]);if(T){const Z={},U={};for(const $ of y)this._tiles[$.key].hasData()?Z[$.key]=$:U[$.key]=$;for(const $ in U){const J=U[$].children(this._source.maxzoom);this._tiles[J[0].key]&&this._tiles[J[1].key]&&this._tiles[J[2].key]&&this._tiles[J[3].key]&&(Z[J[0].key]=t[J[0].key]=J[0],Z[J[1].key]=t[J[1].key]=J[1],Z[J[2].key]=t[J[2].key]=J[2],Z[J[3].key]=t[J[3].key]=J[3],delete U[$])}for(const $ in U){const J=U[$],ct=this.findLoadedParent(J,this._source.minzoom),ot=this.findLoadedSibling(J),ut=ct||ot||null;if(ut){Z[ut.tileID.key]=t[ut.tileID.key]=ut.tileID;for(const pt in Z)Z[pt].isChildOf(ut.tileID)&&delete Z[pt]}}for(const $ in this._tiles)Z[$]||(this._coveredTiles[$]=!0)}}update(t,s){if(!this._sourceLoaded||this._paused)return;let c;this.transform=t,this.terrain=s,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new u.Z(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y)):(c=It(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(c=c.filter(j=>this._source.hasTile(j)))):c=[];const f=Le(t,this._source),y=Math.max(f-bi.maxOverzooming,this._source.minzoom),T=Math.max(f+bi.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const j={};for(const Z of c)if(Z.canonical.z>this._source.minzoom){const U=Z.scaledTo(Z.canonical.z-1);j[U.key]=U;const $=Z.scaledTo(Math.max(this._source.minzoom,Math.min(Z.canonical.z,5)));j[$.key]=$}c=c.concat(Object.values(j))}const z=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,z&&this.fire(new u.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const D=this._updateRetainedTiles(c,f);li(this._source.type)&&this._updateCoveredAndRetainedTiles(D,y,T,f,c,s);for(const j in D)this._tiles[j].clearFadeHold();const O=u.am(this._tiles,D);for(const j of O){const Z=this._tiles[j];Z.hasSymbolBuckets&&!Z.holdingForFade()?Z.setHoldDuration(this.map._fadeDuration):Z.hasSymbolBuckets&&!Z.symbolFadeFinished()||this._removeTile(j)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,s){var c;const f={},y={},T=Math.max(s-bi.maxOverzooming,this._source.minzoom),z=Math.max(s+bi.maxUnderzooming,this._source.minzoom),D={};for(const O of t){const j=this._addTile(O);f[O.key]=O,j.hasData()||s<this._source.maxzoom&&(D[O.key]=O)}this._retainLoadedChildren(D,s,z,f);for(const O of t){let j=this._tiles[O.key];if(j.hasData())continue;if(s+1>this._source.maxzoom){const U=O.children(this._source.maxzoom)[0],$=this.getTile(U);if($&&$.hasData()){f[U.key]=U;continue}}else{const U=O.children(this._source.maxzoom);if(f[U[0].key]&&f[U[1].key]&&f[U[2].key]&&f[U[3].key])continue}let Z=j.wasRequested();for(let U=O.overscaledZ-1;U>=T;--U){const $=O.scaledTo(U);if(y[$.key])break;if(y[$.key]=!0,j=this.getTile($),!j&&Z&&(j=this._addTile($)),j){const J=j.hasData();if((J||!(!((c=this.map)===null||c===void 0)&&c.cancelPendingTileRequestsWhileZooming)||Z)&&(f[$.key]=$),Z=j.wasRequested(),J)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const s=[];let c,f=this._tiles[t].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){c=this._loadedParentTiles[f.key];break}s.push(f.key);const y=f.scaledTo(f.overscaledZ-1);if(c=this._getLoadedTile(y),c)break;f=y}for(const y of s)this._loadedParentTiles[y]=c}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const s=this._tiles[t].tileID,c=this._getLoadedTile(s);this._loadedSiblingTiles[s.key]=c}}_addTile(t){let s=this._tiles[t.key];if(s)return s;s=this._cache.getAndRemove(t),s&&(this._setTileReloadTimer(t.key,s),s.tileID=t,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,s)));const c=s;return s||(s=new es(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(s,t.key,s.state)),s.uses++,this._tiles[t.key]=s,c||this._source.fire(new u.l("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(t,s){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const c=s.getExpiryTimeout();c&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},c))}refreshTiles(t){for(const s in this._tiles)(this._isIdRenderable(s)||this._tiles[s].state=="errored")&&t.some(c=>c.equals(this._tiles[s].tileID.canonical))&&this._reloadTile(s,"expired")}_removeTile(t){const s=this._tiles[t];s&&(s.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}_dataHandler(t){const s=t.sourceDataType;t.dataType==="source"&&s==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&t.dataType==="source"&&s==="content"&&(this.reload(t.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,s,c){const f=[],y=this.transform;if(!y)return f;const T=y.getCoveringTilesDetailsProvider().allowWorldCopies(),z=c?y.getCameraQueryGeometry(t):t,D=$=>y.screenPointToMercatorCoordinate($,this.terrain),O=this.transformBbox(t,D,!T),j=this.transformBbox(z,D,!T),Z=this.getIds(),U=u.a2.fromPoints(j);for(let $=0;$<Z.length;$++){const J=this._tiles[Z[$]];if(J.holdingForFade())continue;const ct=T?[J.tileID]:[J.tileID.unwrapTo(-1),J.tileID.unwrapTo(0)],ot=Math.pow(2,y.zoom-J.tileID.overscaledZ),ut=s*J.queryPadding*u.$/J.tileSize/ot;for(const pt of ct){const vt=U.map(mt=>pt.getTilePoint(new u.a1(mt.x,mt.y)));if(vt.expandBy(ut),vt.intersects(ri)){const mt=O.map(At=>pt.getTilePoint(At)),bt=j.map(At=>pt.getTilePoint(At));f.push({tile:J,tileID:T?pt:pt.unwrapTo(0),queryGeometry:mt,cameraQueryGeometry:bt,scale:ot})}}}return f}transformBbox(t,s,c){let f=t.map(s);if(c){const y=u.a2.fromPoints(t);y.shrinkBy(.001*Math.min(y.width(),y.height()));const T=y.map(s);u.a2.fromPoints(f).covers(T)||(f=f.map(z=>z.x>.5?new u.a1(z.x-1,z.y,z.z):z))}return f}getVisibleCoordinates(t){const s=this.getRenderableIds(t).map(c=>this._tiles[c].tileID);return this.transform&&this.transform.populateCache(s),s}hasTransition(){if(this._source.hasTransition())return!0;if(li(this._source.type)){const t=ht.now();for(const s in this._tiles)if(this._tiles[s].fadeEndTime>=t)return!0}return!1}setFeatureState(t,s,c){this._state.updateState(t=t||"_geojsonTileLayer",s,c)}removeFeatureState(t,s,c){this._state.removeFeatureState(t=t||"_geojsonTileLayer",s,c)}getFeatureState(t,s){return this._state.getState(t=t||"_geojsonTileLayer",s)}setDependencies(t,s,c){const f=this._tiles[t];f&&f.setDependencies(s,c)}reloadTilesForDependencies(t,s){for(const c in this._tiles)this._tiles[c].hasDependency(t,s)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(t,s))}}function Ge(g,t){const s=Math.abs(2*g.wrap)-+(g.wrap<0),c=Math.abs(2*t.wrap)-+(t.wrap<0);return g.overscaledZ-t.overscaledZ||c-s||t.canonical.y-g.canonical.y||t.canonical.x-g.canonical.x}function li(g){return g==="raster"||g==="image"||g==="video"}bi.maxOverzooming=10,bi.maxUnderzooming=3;class Zi{constructor(t,s){this.reset(t,s)}reset(t,s){this.points=t||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=u.ah(t,0,1);let s=1,c=this._distances[s];const f=t*this.paddedLength+this.padding;for(;c<f&&s<this._distances.length;)c=this._distances[++s];const y=s-1,T=this._distances[y],z=c-T,D=z>0?(f-T)/z:0;return this.points[y].mult(1-D).add(this.points[s].mult(D))}}function qn(g,t){let s=!0;return g==="always"||g!=="never"&&t!=="never"||(s=!1),s}class Un{constructor(t,s,c){const f=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(t/c),this.yCellCount=Math.ceil(s/c);for(let T=0;T<this.xCellCount*this.yCellCount;T++)f.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=s,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,s,c,f,y){this._forEachCell(s,c,f,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(y)}insertCircle(t,s,c,f){this._forEachCell(s-f,c-f,s+f,c+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(s),this.circles.push(c),this.circles.push(f)}_insertBoxCell(t,s,c,f,y,T){this.boxCells[y].push(T)}_insertCircleCell(t,s,c,f,y,T){this.circleCells[y].push(T)}_query(t,s,c,f,y,T,z){if(c<0||t>this.width||f<0||s>this.height)return[];const D=[];if(t<=0&&s<=0&&this.width<=c&&this.height<=f){if(y)return[{key:null,x1:t,y1:s,x2:c,y2:f}];for(let O=0;O<this.boxKeys.length;O++)D.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const j=this.circles[3*O],Z=this.circles[3*O+1],U=this.circles[3*O+2];D.push({key:this.circleKeys[O],x1:j-U,y1:Z-U,x2:j+U,y2:Z+U})}}else this._forEachCell(t,s,c,f,this._queryCell,D,{hitTest:y,overlapMode:T,seenUids:{box:{},circle:{}}},z);return D}query(t,s,c,f){return this._query(t,s,c,f,!1,null)}hitTest(t,s,c,f,y,T){return this._query(t,s,c,f,!0,y,T).length>0}hitTestCircle(t,s,c,f,y){const T=t-c,z=t+c,D=s-c,O=s+c;if(z<0||T>this.width||O<0||D>this.height)return!1;const j=[];return this._forEachCell(T,D,z,O,this._queryCellCircle,j,{hitTest:!0,overlapMode:f,circle:{x:t,y:s,radius:c},seenUids:{box:{},circle:{}}},y),j.length>0}_queryCell(t,s,c,f,y,T,z,D){const{seenUids:O,hitTest:j,overlapMode:Z}=z,U=this.boxCells[y];if(U!==null){const J=this.bboxes;for(const ct of U)if(!O.box[ct]){O.box[ct]=!0;const ot=4*ct,ut=this.boxKeys[ct];if(t<=J[ot+2]&&s<=J[ot+3]&&c>=J[ot+0]&&f>=J[ot+1]&&(!D||D(ut))&&(!j||!qn(Z,ut.overlapMode))&&(T.push({key:ut,x1:J[ot],y1:J[ot+1],x2:J[ot+2],y2:J[ot+3]}),j))return!0}}const $=this.circleCells[y];if($!==null){const J=this.circles;for(const ct of $)if(!O.circle[ct]){O.circle[ct]=!0;const ot=3*ct,ut=this.circleKeys[ct];if(this._circleAndRectCollide(J[ot],J[ot+1],J[ot+2],t,s,c,f)&&(!D||D(ut))&&(!j||!qn(Z,ut.overlapMode))){const pt=J[ot],vt=J[ot+1],mt=J[ot+2];if(T.push({key:ut,x1:pt-mt,y1:vt-mt,x2:pt+mt,y2:vt+mt}),j)return!0}}}return!1}_queryCellCircle(t,s,c,f,y,T,z,D){const{circle:O,seenUids:j,overlapMode:Z}=z,U=this.boxCells[y];if(U!==null){const J=this.bboxes;for(const ct of U)if(!j.box[ct]){j.box[ct]=!0;const ot=4*ct,ut=this.boxKeys[ct];if(this._circleAndRectCollide(O.x,O.y,O.radius,J[ot+0],J[ot+1],J[ot+2],J[ot+3])&&(!D||D(ut))&&!qn(Z,ut.overlapMode))return T.push(!0),!0}}const $=this.circleCells[y];if($!==null){const J=this.circles;for(const ct of $)if(!j.circle[ct]){j.circle[ct]=!0;const ot=3*ct,ut=this.circleKeys[ct];if(this._circlesCollide(J[ot],J[ot+1],J[ot+2],O.x,O.y,O.radius)&&(!D||D(ut))&&!qn(Z,ut.overlapMode))return T.push(!0),!0}}}_forEachCell(t,s,c,f,y,T,z,D){const O=this._convertToXCellCoord(t),j=this._convertToYCellCoord(s),Z=this._convertToXCellCoord(c),U=this._convertToYCellCoord(f);for(let $=O;$<=Z;$++)for(let J=j;J<=U;J++)if(y.call(this,t,s,c,f,this.xCellCount*J+$,T,z,D))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,s,c,f,y,T){const z=f-t,D=y-s,O=c+T;return O*O>z*z+D*D}_circleAndRectCollide(t,s,c,f,y,T,z){const D=(T-f)/2,O=Math.abs(t-(f+D));if(O>D+c)return!1;const j=(z-y)/2,Z=Math.abs(s-(y+j));if(Z>j+c)return!1;if(O<=D||Z<=j)return!0;const U=O-D,$=Z-j;return U*U+$*$<=c*c}}function $i(g,t,s){const c=u.L();if(!g){const{vecSouth:Z,vecEast:U}=si(t),$=X();$[0]=U[0],$[1]=U[1],$[2]=Z[0],$[3]=Z[1],f=$,(j=(T=(y=$)[0])*(O=y[3])-(D=y[2])*(z=y[1]))&&(f[0]=O*(j=1/j),f[1]=-z*j,f[2]=-D*j,f[3]=T*j),c[0]=$[0],c[1]=$[1],c[4]=$[2],c[5]=$[3]}var f,y,T,z,D,O,j;return u.N(c,c,[1/s,1/s,1]),c}function ii(g,t,s,c){if(g){const f=u.L();if(!t){const{vecSouth:y,vecEast:T}=si(s);f[0]=T[0],f[1]=T[1],f[4]=y[0],f[5]=y[1]}return u.N(f,f,[c,c,1]),f}return s.pixelsToClipSpaceMatrix}function si(g){const t=Math.cos(g.rollInRadians),s=Math.sin(g.rollInRadians),c=Math.cos(g.pitchInRadians),f=Math.cos(g.bearingInRadians),y=Math.sin(g.bearingInRadians),T=u.ar();T[0]=-f*c*s-y*t,T[1]=-y*c*s+f*t;const z=u.as(T);z<1e-9?u.at(T):u.au(T,T,1/z);const D=u.ar();D[0]=f*c*t-y*s,D[1]=y*c*t+f*s;const O=u.as(D);return O<1e-9?u.at(D):u.au(D,D,1/O),{vecEast:D,vecSouth:T}}function fn(g,t,s,c){let f;c?(f=[g,t,c(g,t),1],u.aw(f,f,s)):(f=[g,t,0,1],ga(f,f,s));const y=f[3];return{point:new u.P(f[0]/y,f[1]/y),signedDistanceFromCamera:y,isOccluded:!1}}function ue(g,t){return .5+g/t*.5}function Ie(g,t){return g.x>=-t[0]&&g.x<=t[0]&&g.y>=-t[1]&&g.y<=t[1]}function vn(g,t,s,c,f,y,T,z,D,O,j,Z,U){const $=s?g.textSizeData:g.iconSizeData,J=u.an($,t.transform.zoom),ct=[256/t.width*2+1,256/t.height*2+1],ot=s?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;ot.clear();const ut=g.lineVertexArray,pt=s?g.text.placedSymbolArray:g.icon.placedSymbolArray,vt=t.transform.width/t.transform.height;let mt=!1;for(let bt=0;bt<pt.length;bt++){const At=pt.get(bt);if(At.hidden||At.writingMode===u.ao.vertical&&!mt){_a(At.numGlyphs,ot);continue}mt=!1;const gt=new u.P(At.anchorX,At.anchorY),Lt={getElevation:U,pitchedLabelPlaneMatrix:c,lineVertexArray:ut,pitchWithMap:y,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:gt,unwrappedTileID:D,width:O,height:j,translation:Z},Gt=pn(At.anchorX,At.anchorY,Lt);if(!Ie(Gt.point,ct)){_a(At.numGlyphs,ot);continue}const Ot=ue(t.transform.cameraToCenterDistance,Gt.signedDistanceFromCamera),Nt=u.ap($,J,At),Ut=y?Nt*t.transform.getPitchedTextCorrection(At.anchorX,At.anchorY,D)/Ot:Nt*Ot,_e=Me({projectionContext:Lt,pitchedLabelPlaneMatrixInverse:f,symbol:At,fontSize:Ut,flip:!1,keepUpright:T,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:ot,aspectRatio:vt,rotateToLine:z});mt=_e.useVertical,(_e.notEnoughRoom||mt||_e.needsFlipping&&Me({projectionContext:Lt,pitchedLabelPlaneMatrixInverse:f,symbol:At,fontSize:Ut,flip:!0,keepUpright:T,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:ot,aspectRatio:vt,rotateToLine:z}).notEnoughRoom)&&_a(At.numGlyphs,ot)}s?g.text.dynamicLayoutVertexBuffer.updateData(ot):g.icon.dynamicLayoutVertexBuffer.updateData(ot)}function pa(g,t,s,c,f,y,T,z){const D=y.glyphStartIndex+y.numGlyphs,O=y.lineStartIndex,j=y.lineStartIndex+y.lineLength,Z=t.getoffsetX(y.glyphStartIndex),U=t.getoffsetX(D-1),$=is(g*Z,s,c,f,y.segment,O,j,z,T);if(!$)return null;const J=is(g*U,s,c,f,y.segment,O,j,z,T);return J?z.projectionCache.anyProjectionOccluded?null:{first:$,last:J}:null}function Js(g,t,s,c){return g===u.ao.horizontal&&Math.abs(s.y-t.y)>Math.abs(s.x-t.x)*c?{useVertical:!0}:(g===u.ao.vertical?t.y<s.y:t.x>s.x)?{needsFlipping:!0}:null}function Me(g){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:s,symbol:c,fontSize:f,flip:y,keepUpright:T,glyphOffsetArray:z,dynamicLayoutVertexArray:D,aspectRatio:O,rotateToLine:j}=g,Z=f/24,U=c.lineOffsetX*Z,$=c.lineOffsetY*Z;let J;if(c.numGlyphs>1){const ct=c.glyphStartIndex+c.numGlyphs,ot=c.lineStartIndex,ut=c.lineStartIndex+c.lineLength,pt=pa(Z,z,U,$,y,c,j,t);if(!pt)return{notEnoughRoom:!0};const vt=xs(pt.first.point.x,pt.first.point.y,t,s),mt=xs(pt.last.point.x,pt.last.point.y,t,s);if(T&&!y){const bt=Js(c.writingMode,vt,mt,O);if(bt)return bt}J=[pt.first];for(let bt=c.glyphStartIndex+1;bt<ct-1;bt++){const At=is(Z*z.getoffsetX(bt),U,$,y,c.segment,ot,ut,t,j);if(!At)return{notEnoughRoom:!0};J.push(At)}J.push(pt.last)}else{if(T&&!y){const ot=an(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,ut=c.lineStartIndex+c.segment+1,pt=new u.P(t.lineVertexArray.getx(ut),t.lineVertexArray.gety(ut)),vt=an(pt.x,pt.y,t),mt=vt.signedDistanceFromCamera>0?vt.point:ci(t.tileAnchorPoint,pt,ot,1,t),bt=xs(ot.x,ot.y,t,s),At=xs(mt.x,mt.y,t,s),gt=Js(c.writingMode,bt,At,O);if(gt)return gt}const ct=is(Z*z.getoffsetX(c.glyphStartIndex),U,$,y,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,t,j);if(!ct||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};J=[ct]}for(const ct of J)u.av(D,ct.point,ct.angle);return{}}function ci(g,t,s,c,f){const y=g.add(g.sub(t)._unit()),T=an(y.x,y.y,f).point,z=s.sub(T);return s.add(z._mult(c/z.mag()))}function ai(g,t,s){const c=t.projectionCache;if(c.projections[g])return c.projections[g];const f=new u.P(t.lineVertexArray.getx(g),t.lineVertexArray.gety(g)),y=an(f.x,f.y,t);if(y.signedDistanceFromCamera>0)return c.projections[g]=y.point,c.anyProjectionOccluded=c.anyProjectionOccluded||y.isOccluded,y.point;const T=g-s.direction;return ci(s.distanceFromAnchor===0?t.tileAnchorPoint:new u.P(t.lineVertexArray.getx(T),t.lineVertexArray.gety(T)),f,s.previousVertex,s.absOffsetX-s.distanceFromAnchor+1,t)}function an(g,t,s){const c=g+s.translation[0],f=t+s.translation[1];let y;return s.pitchWithMap?(y=fn(c,f,s.pitchedLabelPlaneMatrix,s.getElevation),y.isOccluded=!1):(y=s.transform.projectTileCoordinates(c,f,s.unwrappedTileID,s.getElevation),y.point.x=(.5*y.point.x+.5)*s.width,y.point.y=(.5*-y.point.y+.5)*s.height),y}function xs(g,t,s,c){if(s.pitchWithMap){const f=[g,t,0,1];return u.aw(f,f,c),s.transform.projectTileCoordinates(f[0]/f[3],f[1]/f[3],s.unwrappedTileID,s.getElevation).point}return{x:g/s.width*2-1,y:1-t/s.height*2}}function pn(g,t,s){return s.transform.projectTileCoordinates(g,t,s.unwrappedTileID,s.getElevation)}function hi(g,t,s){return g._unit()._perp()._mult(t*s)}function Jl(g,t,s,c,f,y,T,z,D){if(z.projectionCache.offsets[g])return z.projectionCache.offsets[g];const O=s.add(t);if(g+D.direction<c||g+D.direction>=f)return z.projectionCache.offsets[g]=O,O;const j=ai(g+D.direction,z,D),Z=hi(j.sub(s),T,D.direction),U=s.add(Z),$=j.add(Z);return z.projectionCache.offsets[g]=u.ax(y,O,U,$)||O,z.projectionCache.offsets[g]}function is(g,t,s,c,f,y,T,z,D){const O=c?g-t:g+t;let j=O>0?1:-1,Z=0;c&&(j*=-1,Z=Math.PI),j<0&&(Z+=Math.PI);let U,$=j>0?y+f:y+f+1;z.projectionCache.cachedAnchorPoint?U=z.projectionCache.cachedAnchorPoint:(U=an(z.tileAnchorPoint.x,z.tileAnchorPoint.y,z).point,z.projectionCache.cachedAnchorPoint=U);let J,ct,ot=U,ut=U,pt=0,vt=0;const mt=Math.abs(O),bt=[];let At;for(;pt+vt<=mt;){if($+=j,$<y||$>=T)return null;pt+=vt,ut=ot,ct=J;const Gt={absOffsetX:mt,direction:j,distanceFromAnchor:pt,previousVertex:ut};if(ot=ai($,z,Gt),s===0)bt.push(ut),At=ot.sub(ut);else{let Ot;const Nt=ot.sub(ut);Ot=Nt.mag()===0?hi(ai($+j,z,Gt).sub(ot),s,j):hi(Nt,s,j),ct||(ct=ut.add(Ot)),J=Jl($,Ot,ot,y,T,ct,s,z,Gt),bt.push(ct),At=J.sub(ct)}vt=At.mag()}const gt=At._mult((mt-pt)/vt)._add(ct||ut),Lt=Z+Math.atan2(ot.y-ut.y,ot.x-ut.x);return bt.push(gt),{point:gt,angle:D?Lt:0,path:bt}}const ma=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function _a(g,t){for(let s=0;s<g;s++){const c=t.length;t.resize(c+4),t.float32.set(ma,3*c)}}function ga(g,t,s){const c=t[0],f=t[1];return g[0]=s[0]*c+s[4]*f+s[12],g[1]=s[1]*c+s[5]*f+s[13],g[3]=s[3]*c+s[7]*f+s[15],g}const Cn=100;class Rc{constructor(t,s=new Un(t.width+200,t.height+200,25),c=new Un(t.width+200,t.height+200,25)){this.transform=t,this.grid=s,this.ignoredGrid=c,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Cn,this.screenBottomBoundary=t.height+Cn,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,s,c,f,y,T,z,D,O,j,Z,U){const $=this.projectAndGetPerspectiveRatio(t.anchorPointX+D[0],t.anchorPointY+D[1],y,j,U),J=c*$.perspectiveRatio;let ct;if(T||z)ct=this._projectCollisionBox(t,J,f,y,T,z,D,$,j,Z,U);else{const At=$.x+(Z?Z.x*J:0),gt=$.y+(Z?Z.y*J:0);ct={allPointsOccluded:!1,box:[At+t.x1*J,gt+t.y1*J,At+t.x2*J,gt+t.y2*J]}}const[ot,ut,pt,vt]=ct.box,mt=T?ct.allPointsOccluded:$.isOccluded;let bt=mt;return bt||(bt=$.perspectiveRatio<this.perspectiveRatioCutoff),bt||(bt=!this.isInsideGrid(ot,ut,pt,vt)),bt||s!=="always"&&this.grid.hitTest(ot,ut,pt,vt,s,O)?{box:[ot,ut,pt,vt],placeable:!1,offscreen:!1,occluded:mt}:{box:[ot,ut,pt,vt],placeable:!0,offscreen:this.isOffscreen(ot,ut,pt,vt),occluded:mt}}placeCollisionCircles(t,s,c,f,y,T,z,D,O,j,Z,U,$,J){const ct=[],ot=new u.P(s.anchorX,s.anchorY),ut=this.getPerspectiveRatio(ot.x,ot.y,T,J),pt=(O?y*this.transform.getPitchedTextCorrection(s.anchorX,s.anchorY,T)/ut:y*ut)/u.aB,vt={getElevation:J,pitchedLabelPlaneMatrix:z,lineVertexArray:c,pitchWithMap:O,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ot,unwrappedTileID:T,width:this.transform.width,height:this.transform.height,translation:$},mt=pa(pt,f,s.lineOffsetX*pt,s.lineOffsetY*pt,!1,s,!1,vt);let bt=!1,At=!1,gt=!0;if(mt){const Lt=.5*Z*ut+U,Gt=new u.P(-100,-100),Ot=new u.P(this.screenRightBoundary,this.screenBottomBoundary),Nt=new Zi,Ut=mt.first,_e=mt.last;let ve=[];for(let yi=Ut.path.length-1;yi>=1;yi--)ve.push(Ut.path[yi]);for(let yi=1;yi<_e.path.length;yi++)ve.push(_e.path[yi]);const re=2.5*Lt;if(O){const yi=this.projectPathToScreenSpace(ve,vt);ve=yi.some(Ni=>Ni.signedDistanceFromCamera<=0)?[]:yi.map(Ni=>Ni.point)}let Oe=[];if(ve.length>0){const yi=ve[0].clone(),Ni=ve[0].clone();for(let Yi=1;Yi<ve.length;Yi++)yi.x=Math.min(yi.x,ve[Yi].x),yi.y=Math.min(yi.y,ve[Yi].y),Ni.x=Math.max(Ni.x,ve[Yi].x),Ni.y=Math.max(Ni.y,ve[Yi].y);Oe=yi.x>=Gt.x&&Ni.x<=Ot.x&&yi.y>=Gt.y&&Ni.y<=Ot.y?[ve]:Ni.x<Gt.x||yi.x>Ot.x||Ni.y<Gt.y||yi.y>Ot.y?[]:u.ay([ve],Gt.x,Gt.y,Ot.x,Ot.y)}for(const yi of Oe){Nt.reset(yi,.25*Lt);let Ni=0;Ni=Nt.length<=.5*Lt?1:Math.ceil(Nt.paddedLength/re)+1;for(let Yi=0;Yi<Ni;Yi++){const Gi=Yi/Math.max(Ni-1,1),On=Nt.lerp(Gi),Dn=On.x+Cn,mi=On.y+Cn;ct.push(Dn,mi,Lt,0);const Wi=Dn-Lt,Wn=mi-Lt,yr=Dn+Lt,Er=mi+Lt;if(gt=gt&&this.isOffscreen(Wi,Wn,yr,Er),At=At||this.isInsideGrid(Wi,Wn,yr,Er),t!=="always"&&this.grid.hitTestCircle(Dn,mi,Lt,t,j)&&(bt=!0,!D))return{circles:[],offscreen:!1,collisionDetected:bt}}}}return{circles:!D&&bt||!At||ut<this.perspectiveRatioCutoff?[]:ct,offscreen:gt,collisionDetected:bt}}projectPathToScreenSpace(t,s){const c=function(f,y){const T=u.L();return u.aq(T,y.pitchedLabelPlaneMatrix),f.map(z=>{const D=fn(z.x,z.y,T,y.getElevation),O=y.transform.projectTileCoordinates(D.point.x,D.point.y,y.unwrappedTileID,y.getElevation);return O.point.x=(.5*O.point.x+.5)*y.width,O.point.y=(.5*-O.point.y+.5)*y.height,O})}(t,s);return function(f){let y=0,T=0,z=0,D=0;for(let O=0;O<f.length;O++)f[O].isOccluded?(z=O+1,D=0):(D++,D>T&&(T=D,y=z));return f.slice(y,y+T)}(c)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[],c=new u.a2;for(const Z of t){const U=new u.P(Z.x+Cn,Z.y+Cn);c.extend(U),s.push(U)}const{minX:f,minY:y,maxX:T,maxY:z}=c,D=this.grid.query(f,y,T,z).concat(this.ignoredGrid.query(f,y,T,z)),O={},j={};for(const Z of D){const U=Z.key;if(O[U.bucketInstanceId]===void 0&&(O[U.bucketInstanceId]={}),O[U.bucketInstanceId][U.featureIndex])continue;const $=[new u.P(Z.x1,Z.y1),new u.P(Z.x2,Z.y1),new u.P(Z.x2,Z.y2),new u.P(Z.x1,Z.y2)];u.az(s,$)&&(O[U.bucketInstanceId][U.featureIndex]=!0,j[U.bucketInstanceId]===void 0&&(j[U.bucketInstanceId]=[]),j[U.bucketInstanceId].push(U.featureIndex))}return j}insertCollisionBox(t,s,c,f,y,T){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:y,collisionGroupID:T,overlapMode:s},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,s,c,f,y,T){const z=c?this.ignoredGrid:this.grid,D={bucketInstanceId:f,featureIndex:y,collisionGroupID:T,overlapMode:s};for(let O=0;O<t.length;O+=4)z.insertCircle(D,t[O],t[O+1],t[O+2])}projectAndGetPerspectiveRatio(t,s,c,f,y){if(y){let T;f?(T=[t,s,f(t,s),1],u.aw(T,T,y)):(T=[t,s,0,1],ga(T,T,y));const z=T[3];return{x:(T[0]/z+1)/2*this.transform.width+Cn,y:(-T[1]/z+1)/2*this.transform.height+Cn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/z*.5,isOccluded:!1,signedDistanceFromCamera:z}}{const T=this.transform.projectTileCoordinates(t,s,c,f);return{x:(T.point.x+1)/2*this.transform.width+Cn,y:(1-T.point.y)/2*this.transform.height+Cn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/T.signedDistanceFromCamera*.5,isOccluded:T.isOccluded,signedDistanceFromCamera:T.signedDistanceFromCamera}}}getPerspectiveRatio(t,s,c,f){const y=this.transform.projectTileCoordinates(t,s,c,f);return .5+this.transform.cameraToCenterDistance/y.signedDistanceFromCamera*.5}isOffscreen(t,s,c,f){return c<Cn||t>=this.screenRightBoundary||f<Cn||s>this.screenBottomBoundary}isInsideGrid(t,s,c,f){return c>=0&&t<this.gridRightBoundary&&f>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const t=u.ag([]);return u.M(t,t,[-100,-100,0]),t}_projectCollisionBox(t,s,c,f,y,T,z,D,O,j,Z){let U=1,$=0,J=0,ct=1;const ot=t.anchorPointX+z[0],ut=t.anchorPointY+z[1];if(T&&!y){const ve=this.projectAndGetPerspectiveRatio(ot+1,ut,f,O,Z),re=ve.x-D.x,Oe=Math.atan((ve.y-D.y)/re)+(re<0?Math.PI:0),yi=Math.sin(Oe),Ni=Math.cos(Oe);U=Ni,$=yi,J=-yi,ct=Ni}else if(!T&&y){const ve=si(this.transform);U=ve.vecEast[0],$=ve.vecEast[1],J=ve.vecSouth[0],ct=ve.vecSouth[1]}let pt=D.x,vt=D.y,mt=s;y&&(pt=ot,vt=ut,mt=Math.pow(2,-(this.transform.zoom-c.overscaledZ)),mt*=this.transform.getPitchedTextCorrection(ot,ut,f),j||(mt*=u.ah(.5+D.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),j&&(pt+=U*j.x*mt+J*j.y*mt,vt+=$*j.x*mt+ct*j.y*mt);const bt=t.x1*mt,At=t.x2*mt,gt=(bt+At)/2,Lt=t.y1*mt,Gt=t.y2*mt,Ot=(Lt+Gt)/2,Nt=[{offsetX:bt,offsetY:Lt},{offsetX:gt,offsetY:Lt},{offsetX:At,offsetY:Lt},{offsetX:At,offsetY:Ot},{offsetX:At,offsetY:Gt},{offsetX:gt,offsetY:Gt},{offsetX:bt,offsetY:Gt},{offsetX:bt,offsetY:Ot}];let Ut=[];for(const{offsetX:ve,offsetY:re}of Nt)Ut.push(new u.P(pt+U*ve+J*re,vt+$*ve+ct*re));let _e=!1;if(y){const ve=Ut.map(re=>this.projectAndGetPerspectiveRatio(re.x,re.y,f,O,Z));_e=ve.some(re=>!re.isOccluded),Ut=ve.map(re=>new u.P(re.x,re.y))}else _e=!0;return{box:u.aA(Ut),allPointsOccluded:!_e}}}class wr{constructor(t,s,c,f){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?s:-s))):f&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class Vi{constructor(t,s,c,f,y){this.text=new wr(t?t.text:null,s,c,y),this.icon=new wr(t?t.icon:null,s,f,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ya{constructor(t,s,c){this.text=t,this.icon=s,this.skipFade=c}}class qa{constructor(t,s,c,f,y){this.bucketInstanceId=t,this.featureIndex=s,this.sourceLayerIndex=c,this.bucketIndex=f,this.tileID=y}}class bo{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const s=++this.maxGroupID;this.collisionGroups[t]={ID:s,predicate:c=>c.collisionGroupID===s}}return this.collisionGroups[t]}}function ns(g,t,s,c,f){const{horizontalAlign:y,verticalAlign:T}=u.aH(g);return new u.P(-(y-.5)*t+c[0]*f,-(T-.5)*s+c[1]*f)}class ta{constructor(t,s,c,f,y){this.transform=t.clone(),this.terrain=s,this.collisionIndex=new Rc(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new bo(f),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const s=this.terrain;return s?(c,f)=>s.getElevation(t,c,f):null}getBucketParts(t,s,c,f){const y=c.getBucket(s),T=c.latestFeatureIndex;if(!y||!T||s.id!==y.layerIds[0])return;const z=c.collisionBoxArray,D=y.layers[0].layout,O=y.layers[0].paint,j=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),Z=c.tileSize/u.$,U=c.tileID.toUnwrapped(),$=D.get("text-rotation-alignment")==="map",J=u.aC(c,1,this.transform.zoom),ct=u.aD(this.collisionIndex.transform,c,O.get("text-translate"),O.get("text-translate-anchor")),ot=u.aD(this.collisionIndex.transform,c,O.get("icon-translate"),O.get("icon-translate-anchor")),ut=$i($,this.transform,J);this.retainedQueryData[y.bucketInstanceId]=new qa(y.bucketInstanceId,T,y.sourceLayerIndex,y.index,c.tileID);const pt={bucket:y,layout:D,translationText:ct,translationIcon:ot,unwrappedTileID:U,pitchedLabelPlaneMatrix:ut,scale:j,textPixelRatio:Z,holdingForFade:c.holdingForFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:u.an(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(f)for(const vt of y.sortKeyRanges){const{sortKey:mt,symbolInstanceStart:bt,symbolInstanceEnd:At}=vt;t.push({sortKey:mt,symbolInstanceStart:bt,symbolInstanceEnd:At,parameters:pt})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:pt})}attemptAnchorPlacement(t,s,c,f,y,T,z,D,O,j,Z,U,$,J,ct,ot,ut,pt,vt,mt){const bt=u.aE[t.textAnchor],At=[t.textOffset0,t.textOffset1],gt=ns(bt,c,f,At,y),Lt=this.collisionIndex.placeCollisionBox(s,U,D,O,j,z,T,ot,Z.predicate,vt,gt,mt);if((!pt||this.collisionIndex.placeCollisionBox(pt,U,D,O,j,z,T,ut,Z.predicate,vt,gt,mt).placeable)&&Lt.placeable){let Gt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID].text&&(Gt=this.prevPlacement.variableOffsets[$.crossTileID].anchor),$.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[$.crossTileID]={textOffset:At,width:c,height:f,anchor:bt,textBoxScale:y,prevAnchor:Gt},this.markUsedJustification(J,bt,$,ct),J.allowVerticalPlacement&&(this.markUsedOrientation(J,ct,$),this.placedOrientations[$.crossTileID]=ct),{shift:gt,placedGlyphBoxes:Lt}}}placeLayerBucketPart(t,s,c){const{bucket:f,layout:y,translationText:T,translationIcon:z,unwrappedTileID:D,pitchedLabelPlaneMatrix:O,textPixelRatio:j,holdingForFade:Z,collisionBoxArray:U,partiallyEvaluatedTextSize:$,collisionGroup:J}=t.parameters,ct=y.get("text-optional"),ot=y.get("icon-optional"),ut=u.aF(y,"text-overlap","text-allow-overlap"),pt=ut==="always",vt=u.aF(y,"icon-overlap","icon-allow-overlap"),mt=vt==="always",bt=y.get("text-rotation-alignment")==="map",At=y.get("text-pitch-alignment")==="map",gt=y.get("icon-text-fit")!=="none",Lt=y.get("symbol-z-order")==="viewport-y",Gt=pt&&(mt||!f.hasIconData()||ot),Ot=mt&&(pt||!f.hasTextData()||ct);!f.collisionArrays&&U&&f.deserializeCollisionBoxes(U);const Nt=this.retainedQueryData[f.bucketInstanceId].tileID,Ut=this._getTerrainElevationFunc(Nt),_e=this.transform.getFastPathSimpleProjectionMatrix(Nt),ve=(re,Oe,yi)=>{var Ni,Yi;if(s[re.crossTileID])return;if(Z)return void(this.placements[re.crossTileID]=new ya(!1,!1,!1));let Gi=!1,On=!1,Dn=!0,mi=null,Wi={box:null,placeable:!1,offscreen:null,occluded:!1},Wn={placeable:!1},yr=null,Er=null,Ds=null,lo=0,al=0,Ia=0;Oe.textFeatureIndex?lo=Oe.textFeatureIndex:re.useRuntimeCollisionCircles&&(lo=re.featureIndex),Oe.verticalTextFeatureIndex&&(al=Oe.verticalTextFeatureIndex);const Ol=Oe.textBox;if(Ol){const qr=Ln=>{let Gn=u.ao.horizontal;if(f.allowVerticalPlacement&&!Ln&&this.prevPlacement){const Ls=this.prevPlacement.placedOrientations[re.crossTileID];Ls&&(this.placedOrientations[re.crossTileID]=Ls,Gn=Ls,this.markUsedOrientation(f,Gn,re))}return Gn},Ra=(Ln,Gn)=>{if(f.allowVerticalPlacement&&re.numVerticalGlyphVertices>0&&Oe.verticalTextBox){for(const Ls of f.writingModes)if(Ls===u.ao.vertical?(Wi=Gn(),Wn=Wi):Wi=Ln(),Wi&&Wi.placeable)break}else Wi=Ln()},fs=re.textAnchorOffsetStartIndex,Fl=re.textAnchorOffsetEndIndex;if(Fl===fs){const Ln=(Gn,Ls)=>{const Nn=this.collisionIndex.placeCollisionBox(Gn,ut,j,Nt,D,At,bt,T,J.predicate,Ut,void 0,_e);return Nn&&Nn.placeable&&(this.markUsedOrientation(f,Ls,re),this.placedOrientations[re.crossTileID]=Ls),Nn};Ra(()=>Ln(Ol,u.ao.horizontal),()=>{const Gn=Oe.verticalTextBox;return f.allowVerticalPlacement&&re.numVerticalGlyphVertices>0&&Gn?Ln(Gn,u.ao.vertical):{box:null,offscreen:null}}),qr(Wi&&Wi.placeable)}else{let Ln=u.aE[(Yi=(Ni=this.prevPlacement)===null||Ni===void 0?void 0:Ni.variableOffsets[re.crossTileID])===null||Yi===void 0?void 0:Yi.anchor];const Gn=(Nn,Vl,Tc)=>{const Fo=Nn.x2-Nn.x1,ps=Nn.y2-Nn.y1,ll=re.textBoxScale,la=gt&&vt==="never"?Vl:null;let Kn=null,cl=ut==="never"?1:2,sh="never";Ln&&cl++;for(let co=0;co<cl;co++){for(let ka=fs;ka<Fl;ka++){const Tn=f.textAnchorOffsets.get(ka);if(Ln&&Tn.textAnchor!==Ln)continue;const Ba=this.attemptAnchorPlacement(Tn,Nn,Fo,ps,ll,bt,At,j,Nt,D,J,sh,re,f,Tc,T,z,la,Ut);if(Ba&&(Kn=Ba.placedGlyphBoxes,Kn&&Kn.placeable))return Gi=!0,mi=Ba.shift,Kn}Ln?Ln=null:sh=ut}return c&&!Kn&&(Kn={box:this.collisionIndex.placeCollisionBox(Ol,"always",j,Nt,D,At,bt,T,J.predicate,Ut,void 0,_e).box,offscreen:!1,placeable:!1,occluded:!1}),Kn};Ra(()=>Gn(Ol,Oe.iconBox,u.ao.horizontal),()=>{const Nn=Oe.verticalTextBox;return f.allowVerticalPlacement&&(!Wi||!Wi.placeable)&&re.numVerticalGlyphVertices>0&&Nn?Gn(Nn,Oe.verticalIconBox,u.ao.vertical):{box:null,occluded:!0,offscreen:null}}),Wi&&(Gi=Wi.placeable,Dn=Wi.offscreen);const Ls=qr(Wi&&Wi.placeable);if(!Gi&&this.prevPlacement){const Nn=this.prevPlacement.variableOffsets[re.crossTileID];Nn&&(this.variableOffsets[re.crossTileID]=Nn,this.markUsedJustification(f,Nn.anchor,re,Ls))}}}if(yr=Wi,Gi=yr&&yr.placeable,Dn=yr&&yr.offscreen,re.useRuntimeCollisionCircles){const qr=f.text.placedSymbolArray.get(re.centerJustifiedTextSymbolIndex),Ra=u.ap(f.textSizeData,$,qr),fs=y.get("text-padding");Er=this.collisionIndex.placeCollisionCircles(ut,qr,f.lineVertexArray,f.glyphOffsetArray,Ra,D,O,c,At,J.predicate,re.collisionCircleDiameter,fs,T,Ut),Er.circles.length&&Er.collisionDetected&&!c&&u.w("Collisions detected, but collision boxes are not shown"),Gi=pt||Er.circles.length>0&&!Er.collisionDetected,Dn=Dn&&Er.offscreen}if(Oe.iconFeatureIndex&&(Ia=Oe.iconFeatureIndex),Oe.iconBox){const qr=Ra=>this.collisionIndex.placeCollisionBox(Ra,vt,j,Nt,D,At,bt,z,J.predicate,Ut,gt&&mi?mi:void 0,_e);Wn&&Wn.placeable&&Oe.verticalIconBox?(Ds=qr(Oe.verticalIconBox),On=Ds.placeable):(Ds=qr(Oe.iconBox),On=Ds.placeable),Dn=Dn&&Ds.offscreen}const ol=ct||re.numHorizontalGlyphVertices===0&&re.numVerticalGlyphVertices===0,Nl=ot||re.numIconVertices===0;ol||Nl?Nl?ol||(On=On&&Gi):Gi=On&&Gi:On=Gi=On&&Gi;const jl=On&&Ds.placeable;if(Gi&&yr.placeable&&this.collisionIndex.insertCollisionBox(yr.box,ut,y.get("text-ignore-placement"),f.bucketInstanceId,Wn&&Wn.placeable&&al?al:lo,J.ID),jl&&this.collisionIndex.insertCollisionBox(Ds.box,vt,y.get("icon-ignore-placement"),f.bucketInstanceId,Ia,J.ID),Er&&Gi&&this.collisionIndex.insertCollisionCircles(Er.circles,ut,y.get("text-ignore-placement"),f.bucketInstanceId,lo,J.ID),c&&this.storeCollisionData(f.bucketInstanceId,yi,Oe,yr,Ds,Er),re.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[re.crossTileID]=new ya((Gi||Gt)&&!yr?.occluded,(On||Ot)&&!Ds?.occluded,Dn||f.justReloaded),s[re.crossTileID]=!0};if(Lt){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const re=f.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Oe=re.length-1;Oe>=0;--Oe){const yi=re[Oe];ve(f.symbolInstances.get(yi),f.collisionArrays[yi],yi)}}else for(let re=t.symbolInstanceStart;re<t.symbolInstanceEnd;re++)ve(f.symbolInstances.get(re),f.collisionArrays[re],re);f.justReloaded=!1}storeCollisionData(t,s,c,f,y,T){if(c.textBox||c.iconBox){let z,D;this.collisionBoxArrays.has(t)?z=this.collisionBoxArrays.get(t):(z=new Map,this.collisionBoxArrays.set(t,z)),z.has(s)?D=z.get(s):(D={text:null,icon:null},z.set(s,D)),c.textBox&&(D.text=f.box),c.iconBox&&(D.icon=y.box)}if(T){let z=this.collisionCircleArrays[t];z===void 0&&(z=this.collisionCircleArrays[t]=[]);for(let D=0;D<T.circles.length;D+=4)z.push(T.circles[D+0]-Cn),z.push(T.circles[D+1]-Cn),z.push(T.circles[D+2]),z.push(T.collisionDetected?1:0)}}markUsedJustification(t,s,c,f){let y;y=f===u.ao.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[u.aG(s)];const T=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const z of T)z>=0&&(t.text.placedSymbolArray.get(z).crossTileID=y>=0&&z!==y?0:c.crossTileID)}markUsedOrientation(t,s,c){const f=s===u.ao.horizontal||s===u.ao.horizontalOnly?s:0,y=s===u.ao.vertical?s:0,T=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const z of T)t.text.placedSymbolArray.get(z).placedOrientation=f;c.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let c=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const f=s?s.symbolFadeChange(t):1,y=s?s.opacities:{},T=s?s.variableOffsets:{},z=s?s.placedOrientations:{};for(const D in this.placements){const O=this.placements[D],j=y[D];j?(this.opacities[D]=new Vi(j,f,O.text,O.icon),c=c||O.text!==j.text.placed||O.icon!==j.icon.placed):(this.opacities[D]=new Vi(null,f,O.text,O.icon,O.skipFade),c=c||O.text||O.icon)}for(const D in y){const O=y[D];if(!this.opacities[D]){const j=new Vi(O,f,!1,!1);j.isHidden()||(this.opacities[D]=j,c=c||O.text.placed||O.icon.placed)}}for(const D in T)this.variableOffsets[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.variableOffsets[D]=T[D]);for(const D in z)this.placedOrientations[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.placedOrientations[D]=z[D]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:t)}updateLayerOpacities(t,s){const c={};for(const f of s){const y=f.getBucket(t);y&&f.latestFeatureIndex&&t.id===y.layerIds[0]&&this.updateBucketOpacities(y,f.tileID,c,f.collisionBoxArray)}}updateBucketOpacities(t,s,c,f){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const y=t.layers[0],T=y.layout,z=new Vi(null,0,!1,!1,!0),D=T.get("text-allow-overlap"),O=T.get("icon-allow-overlap"),j=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Z=T.get("text-rotation-alignment")==="map",U=T.get("text-pitch-alignment")==="map",$=T.get("icon-text-fit")!=="none",J=new Vi(null,0,D&&(O||!t.hasIconData()||T.get("icon-optional")),O&&(D||!t.hasTextData()||T.get("text-optional")),!0);!t.collisionArrays&&f&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(f);const ct=(ut,pt,vt)=>{for(let mt=0;mt<pt/4;mt++)ut.opacityVertexArray.emplaceBack(vt);ut.hasVisibleVertices=ut.hasVisibleVertices||vt!==To},ot=this.collisionBoxArrays.get(t.bucketInstanceId);for(let ut=0;ut<t.symbolInstances.length;ut++){const pt=t.symbolInstances.get(ut),{numHorizontalGlyphVertices:vt,numVerticalGlyphVertices:mt,crossTileID:bt}=pt;let At=this.opacities[bt];c[bt]?At=z:At||(At=J,this.opacities[bt]=At),c[bt]=!0;const gt=pt.numIconVertices>0,Lt=this.placedOrientations[pt.crossTileID],Gt=Lt===u.ao.vertical,Ot=Lt===u.ao.horizontal||Lt===u.ao.horizontalOnly;if(vt>0||mt>0){const Ut=on(At.text);ct(t.text,vt,Gt?To:Ut),ct(t.text,mt,Ot?To:Ut);const _e=At.text.isHidden();[pt.rightJustifiedTextSymbolIndex,pt.centerJustifiedTextSymbolIndex,pt.leftJustifiedTextSymbolIndex].forEach(Oe=>{Oe>=0&&(t.text.placedSymbolArray.get(Oe).hidden=_e||Gt?1:0)}),pt.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(pt.verticalPlacedTextSymbolIndex).hidden=_e||Ot?1:0);const ve=this.variableOffsets[pt.crossTileID];ve&&this.markUsedJustification(t,ve.anchor,pt,Lt);const re=this.placedOrientations[pt.crossTileID];re&&(this.markUsedJustification(t,"left",pt,re),this.markUsedOrientation(t,re,pt))}if(gt){const Ut=on(At.icon),_e=!($&&pt.verticalPlacedIconSymbolIndex&&Gt);pt.placedIconSymbolIndex>=0&&(ct(t.icon,pt.numIconVertices,_e?Ut:To),t.icon.placedSymbolArray.get(pt.placedIconSymbolIndex).hidden=At.icon.isHidden()),pt.verticalPlacedIconSymbolIndex>=0&&(ct(t.icon,pt.numVerticalIconVertices,_e?To:Ut),t.icon.placedSymbolArray.get(pt.verticalPlacedIconSymbolIndex).hidden=At.icon.isHidden())}const Nt=ot&&ot.has(ut)?ot.get(ut):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Ut=t.collisionArrays[ut];if(Ut){let _e=new u.P(0,0);if(Ut.textBox||Ut.verticalTextBox){let ve=!0;if(j){const re=this.variableOffsets[bt];re?(_e=ns(re.anchor,re.width,re.height,re.textOffset,re.textBoxScale),Z&&_e._rotate(U?-this.transform.bearingInRadians:this.transform.bearingInRadians)):ve=!1}if(Ut.textBox||Ut.verticalTextBox){let re;Ut.textBox&&(re=Gt),Ut.verticalTextBox&&(re=Ot),$a(t.textCollisionBox.collisionVertexArray,At.text.placed,!ve||re,Nt.text,_e.x,_e.y)}}if(Ut.iconBox||Ut.verticalIconBox){const ve=!!(!Ot&&Ut.verticalIconBox);let re;Ut.iconBox&&(re=ve),Ut.verticalIconBox&&(re=!ve),$a(t.iconCollisionBox.collisionVertexArray,At.icon.placed,re,Nt.icon,$?_e.x:0,$?_e.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,s){const c=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*c>t}setStale(){this.stale=!0}}function $a(g,t,s,c,f,y){c&&c.length!==0||(c=[0,0,0,0]);const T=c[0]-Cn,z=c[1]-Cn,D=c[2]-Cn,O=c[3]-Cn;g.emplaceBack(t?1:0,s?1:0,f||0,y||0,T,z),g.emplaceBack(t?1:0,s?1:0,f||0,y||0,D,z),g.emplaceBack(t?1:0,s?1:0,f||0,y||0,D,O),g.emplaceBack(t?1:0,s?1:0,f||0,y||0,T,O)}const Oi=Math.pow(2,25),mn=Math.pow(2,24),$n=Math.pow(2,17),wo=Math.pow(2,16),_l=Math.pow(2,9),gl=Math.pow(2,8),Si=Math.pow(2,1);function on(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const t=g.placed?1:0,s=Math.floor(127*g.opacity);return s*Oi+t*mn+s*$n+t*wo+s*_l+t*gl+s*Si+t}const To=0;class Tr{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,s,c,f,y){const T=this._bucketParts;for(;this._currentTileIndex<t.length;)if(s.getBucketParts(T,f,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort((z,D)=>z.sortKey-D.sortKey));this._currentPartIndex<T.length;)if(s.placeLayerBucketPart(T[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,y())return!0;return!1}}class Rr{constructor(t,s,c,f,y,T,z,D){this.placement=new ta(t,s,T,z,D),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(t,s,c){const f=ht.now(),y=()=>!this._forceFullPlacement&&ht.now()-f>2;for(;this._currentPlacementIndex>=0;){const T=s[t[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(T.type==="symbol"&&(!T.minzoom||T.minzoom<=z)&&(!T.maxzoom||T.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new Tr(T)),this._inProgressLayer.continuePlacement(c[T.source],this.placement,this._showCollisionBoxes,T,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Ho=512/u.$/2;class So{constructor(t,s,c){this.tileID=t,this.bucketInstanceId=c,this._symbolsByKey={};const f=new Map;for(let y=0;y<s.length;y++){const T=s.get(y),z=T.key,D=f.get(z);D?D.push(T):f.set(z,[T])}for(const[y,T]of f){const z={positions:T.map(D=>({x:Math.floor(D.anchorX*Ho),y:Math.floor(D.anchorY*Ho)})),crossTileIDs:T.map(D=>D.crossTileID)};if(z.positions.length>128){const D=new u.aI(z.positions.length,16,Uint16Array);for(const{x:O,y:j}of z.positions)D.add(O,j);D.finish(),delete z.positions,z.index=D}this._symbolsByKey[y]=z}}getScaledCoordinates(t,s){const{x:c,y:f,z:y}=this.tileID.canonical,{x:T,y:z,z:D}=s.canonical,O=Ho/Math.pow(2,D-y),j=(z*u.$+t.anchorY)*O,Z=f*u.$*Ho;return{x:Math.floor((T*u.$+t.anchorX)*O-c*u.$*Ho),y:Math.floor(j-Z)}}findMatches(t,s,c){const f=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let y=0;y<t.length;y++){const T=t.get(y);if(T.crossTileID)continue;const z=this._symbolsByKey[T.key];if(!z)continue;const D=this.getScaledCoordinates(T,s);if(z.index){const O=z.index.range(D.x-f,D.y-f,D.x+f,D.y+f).sort();for(const j of O){const Z=z.crossTileIDs[j];if(!c[Z]){c[Z]=!0,T.crossTileID=Z;break}}}else if(z.positions)for(let O=0;O<z.positions.length;O++){const j=z.positions[O],Z=z.crossTileIDs[O];if(Math.abs(j.x-D.x)<=f&&Math.abs(j.y-D.y)<=f&&!c[Z]){c[Z]=!0,T.crossTileID=Z;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class rs{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Zn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const s=Math.round((t-this.lng)/360);if(s!==0)for(const c in this.indexes){const f=this.indexes[c],y={};for(const T in f){const z=f[T];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+s),y[z.tileID.key]=z}this.indexes[c]=y}this.lng=t}addBucket(t,s,c){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let y=0;y<s.symbolInstances.length;y++)s.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const f=this.usedCrossTileIDs[t.overscaledZ];for(const y in this.indexes){const T=this.indexes[y];if(Number(y)>t.overscaledZ)for(const z in T){const D=T[z];D.tileID.isChildOf(t)&&D.findMatches(s.symbolInstances,t,f)}else{const z=T[t.scaledTo(Number(y)).key];z&&z.findMatches(s.symbolInstances,t,f)}}for(let y=0;y<s.symbolInstances.length;y++){const T=s.symbolInstances.get(y);T.crossTileID||(T.crossTileID=c.generate(),f[T.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new So(t,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(t,s){for(const c of s.getCrossTileIDsLists())for(const f of c)delete this.usedCrossTileIDs[t][f]}removeStaleBuckets(t){let s=!1;for(const c in this.indexes){const f=this.indexes[c];for(const y in f)t[f[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,f[y]),delete f[y],s=!0)}return s}}class bs{constructor(){this.layerIndexes={},this.crossTileIDs=new rs,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,s,c){let f=this.layerIndexes[t.id];f===void 0&&(f=this.layerIndexes[t.id]=new Zn);let y=!1;const T={};f.handleWrapJump(c);for(const z of s){const D=z.getBucket(t);D&&t.id===D.layerIds[0]&&(D.bucketInstanceId||(D.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(z.tileID,D,this.crossTileIDs)&&(y=!0),T[D.bucketInstanceId]=!0)}return f.removeStaleBuckets(T)&&(y=!0),y}pruneUnusedLayers(t){const s={};t.forEach(c=>{s[c]=!0});for(const c in this.layerIndexes)s[c]||delete this.layerIndexes[c]}}var ss="void main() {fragColor=vec4(1.0);}";const Ur={prelude:gi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:gi("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:gi("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:gi(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:gi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:gi(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:gi(ss,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:gi(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:gi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:gi("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:gi("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:gi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:gi("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:gi(ss,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:gi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:gi(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:gi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:gi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:gi(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:gi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:gi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:gi(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:gi(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:gi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:gi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:gi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:gi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:gi(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:gi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:gi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:gi("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:gi("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:gi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:gi("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:gi(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:gi("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function gi(g,t){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=t.match(/in ([\w]+) ([\w]+)/g),f=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=y?y.concat(f):f,z={};return{fragmentSource:g=g.replace(s,(D,O,j,Z,U)=>(z[U]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${U}
in ${j} ${Z} ${U};
#else
uniform ${j} ${Z} u_${U};
#endif
`:`
#ifdef HAS_UNIFORM_u_${U}
    ${j} ${Z} ${U} = u_${U};
#endif
`)),vertexSource:t=t.replace(s,(D,O,j,Z,U)=>{const $=Z==="float"?"vec2":"vec4",J=U.match(/color/)?"color":$;return z[U]?O==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
in ${j} ${$} a_${U};
out ${j} ${Z} ${U};
#else
uniform ${j} ${Z} u_${U};
#endif
`:J==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = a_${U};
#else
    ${j} ${Z} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = unpack_mix_${J}(a_${U}, u_${U}_t);
#else
    ${j} ${Z} ${U} = u_${U};
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
in ${j} ${$} a_${U};
#else
uniform ${j} ${Z} u_${U};
#endif
`:J==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${j} ${Z} ${U} = a_${U};
#else
    ${j} ${Z} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${j} ${Z} ${U} = unpack_mix_${J}(a_${U}, u_${U}_t);
#else
    ${j} ${Z} ${U} = u_${U};
#endif
`}),staticAttributes:c,staticUniforms:T}}class Ns{constructor(t,s,c){this.vertexBuffer=t,this.indexBuffer=s,this.segments=c}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var js=u.aJ([{name:"a_pos",type:"Int16",components:2}]);const ea="#define PROJECTION_MERCATOR",va="mercator";class di{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return va}get shaderDefine(){return ea}get shaderPreludeCode(){return Ur.projectionMercator}get vertexShaderPreludeCode(){return Ur.projectionMercator.vertexSource}get subdivisionGranularity(){return u.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,s,c,f,y){if(this._cachedMesh)return this._cachedMesh;const T=new u.aL;T.emplaceBack(0,0),T.emplaceBack(u.$,0),T.emplaceBack(0,u.$),T.emplaceBack(u.$,u.$);const z=t.createVertexBuffer(T,js.members),D=u.aM.simpleSegment(0,0,4,2),O=new u.aN;O.emplaceBack(1,0,2),O.emplaceBack(1,2,3);const j=t.createIndexBuffer(O);return this._cachedMesh=new Ns(z,j,D),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class ia{constructor(t=0,s=0,c=0,f=0){if(isNaN(t)||t<0||isNaN(s)||s<0||isNaN(c)||c<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=s,this.left=c,this.right=f}interpolate(t,s,c){return s.top!=null&&t.top!=null&&(this.top=u.C.number(t.top,s.top,c)),s.bottom!=null&&t.bottom!=null&&(this.bottom=u.C.number(t.bottom,s.bottom,c)),s.left!=null&&t.left!=null&&(this.left=u.C.number(t.left,s.left,c)),s.right!=null&&t.right!=null&&(this.right=u.C.number(t.right,s.right,c)),this}getCenter(t,s){const c=u.ah((this.left+t-this.right)/2,0,t),f=u.ah((this.top+s-this.bottom)/2,0,s);return new u.P(c,f)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new ia(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Xa(g,t){if(!g.renderWorldCopies||g.lngRange)return;const s=t.lng-g.center.lng;t.lng+=s>180?-360:s<-180?360:0}function xa(g){return Math.max(0,Math.floor(g))}class kn{constructor(t,s,c,f,y,T){this._callbacks=t,this._tileSize=512,this._renderWorldCopies=T===void 0||!!T,this._minZoom=s||0,this._maxZoom=c||22,this._minPitch=f??0,this._maxPitch=y??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new u.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=xa(this._zoom),this._scale=u.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new ia,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,s,c){this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=xa(this._zoom),this._scale=u.af(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new ia(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!c&&t.autoCalculateNearFarZ,s&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const s=u.aO(t,-180,180)*Math.PI/180;var c,f,y,T,z,D,O,j,Z;this._bearingInRadians!==s&&(this._unmodified=!1,this._bearingInRadians=s,this._calcMatrices(),this._rotationMatrix=X(),c=this._rotationMatrix,y=-this._bearingInRadians,T=(f=this._rotationMatrix)[0],z=f[1],D=f[2],O=f[3],j=Math.sin(y),Z=Math.cos(y),c[0]=T*Z+D*j,c[1]=z*Z+O*j,c[2]=T*-j+D*Z,c[3]=z*-j+O*Z)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const s=u.ah(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==s&&(this._unmodified=!1,this._pitchInRadians=s,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const s=t/180*Math.PI;this._rollInRadians!==s&&(this._unmodified=!1,this._rollInRadians=s,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return u.aP(this._fovInRadians)}setFov(t){t=u.ah(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=u.ae(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const s=this.getConstrained(this._center,t).zoom;this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this._tileZoom=Math.max(0,Math.floor(s)),this._scale=u.af(s),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,s){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=s,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,s,c){this._unmodified=!1,this._edgeInsets.interpolate(t,s,c),this._constrain(),this._calcMatrices()}resize(t,s,c=!0){this._width=t,this._height=s,c&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new sn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-u.ai,u.ai])}getConstrained(t,s){return this._callbacks.getConstrained(t,s)}getCameraQueryGeometry(t,s){if(s.length===1)return[s[0],t];{const{minX:c,minY:f,maxX:y,maxY:T}=u.a2.fromPoints(s).extend(t);return[new u.P(c,f),new u.P(y,f),new u.P(y,T),new u.P(c,T),new u.P(c,f)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:s,zoom:c}=this.getConstrained(this.center,this.zoom);this.setCenter(s),this.setZoom(c),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=u.ag(new Float64Array(16));u.N(t,t,[this._width/2,-this._height/2,1]),u.M(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=u.ag(new Float64Array(16)),u.N(t,t,[1,-1,1]),u.M(t,t,[-1,-1,0]),u.N(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,s,c,f){const y=c!==void 0?c:this.bearing,T=f=f!==void 0?f:this.pitch,z=u.a1.fromLngLat(t,s),D=-Math.cos(u.ae(T)),O=Math.sin(u.ae(T)),j=O*Math.sin(u.ae(y)),Z=-O*Math.cos(u.ae(y));let U=this.elevation;const $=s-U;let J;D*$>=0||Math.abs(D)<.1?(J=1e4,U=s+J*D):J=-$/D;let ct,ot,ut=u.aQ(1,z.y),pt=0;do{if(pt+=1,pt>10)break;ot=J/ut,ct=new u.a1(z.x+j*ot,z.y+Z*ot),ut=1/ct.meterInMercatorCoordinateUnits()}while(Math.abs(J-ot*ut)>1e-12);return{center:ct.toLngLat(),elevation:U,zoom:u.ak(this.height/2/Math.tan(this.fovInRadians/2)/ot/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const s=u.aj(1,this.center.lat)*this.worldSize,c=this.cameraToCenterDistance/s,f=u.a1.fromLngLat(this.center,this.elevation),y=Ft(this.center,this.elevation,this.pitch,this.bearing,c);this._elevation=t;const T=this.calculateCenterFromCameraLngLatAlt(y.toLngLat(),u.aQ(y.z,f.y),this.bearing,this.pitch);this._elevation=T.elevation,this._center=T.center,this.setZoom(T.zoom)}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=u.aj(1,this.center.lat)*this.worldSize;return Ft(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const s=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/s,t.canonical.y/s,1/s/u.$,1/s/u.$]}}class ar{constructor(t,s){this.min=t,this.max=s,this.center=u.aR([],u.aS([],this.min,this.max),.5)}quadrant(t){const s=[t%2==0,t<2],c=u.aT(this.min),f=u.aT(this.max);for(let y=0;y<s.length;y++)c[y]=s[y]?this.min[y]:this.center[y],f[y]=s[y]?this.center[y]:this.max[y];return f[2]=this.max[2],new ar(c,f)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let s=!0;for(let c=0;c<t.planes.length;c++){const f=this.intersectsPlane(t.planes[c]);if(f===0)return 0;f===1&&(s=!1)}return s?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let s=t[3],c=t[3];for(let f=0;f<3;f++)t[f]>0?(s+=t[f]*this.min[f],c+=t[f]*this.max[f]):(c+=t[f]*this.min[f],s+=t[f]*this.max[f]);return s>=0?2:c<0?0:1}}class Qe{distanceToTile2d(t,s,c,f){const y=f.distanceX([t,s]),T=f.distanceY([t,s]);return Math.hypot(y,T)}getWrap(t,s,c){return c}getTileBoundingVolume(t,s,c,f){var y,T;let z=0,D=0;if(f?.terrain){const j=new u.Z(t.z,s,t.z,t.x,t.y),Z=f.terrain.getMinMaxElevation(j);z=(y=Z.minElevation)!==null&&y!==void 0?y:Math.min(0,c),D=(T=Z.maxElevation)!==null&&T!==void 0?T:Math.max(0,c)}const O=1<<t.z;return new ar([s+t.x/O,t.y/O,z],[s+(t.x+1)/O,(t.y+1)/O,D])}allowVariableZoom(t,s){const c=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,f=u.ah(78.5-c/2,0,60);return!!s.terrain||t.pitch>f}allowWorldCopies(){return!0}prepareNextFrame(){}}class Ui{constructor(t,s,c){this.points=t,this.planes=s,this.aabb=c}static fromInvProjectionMatrix(t,s=1,c=0,f,y){const T=y?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],z=Math.pow(2,c),D=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(U=>function($,J,ct,ot){const ut=u.aw([],$,J),pt=1/ut[3]/ct*ot;return u.aY(ut,ut,[pt,pt,1/ut[3],pt])}(U,t,s,z));f&&function(U,$,J,ct){const ot=ct?4:0,ut=ct?0:4;let pt=0;const vt=[],mt=[];for(let gt=0;gt<4;gt++){const Lt=u.aU([],U[gt+ut],U[gt+ot]),Gt=u.aZ(Lt);u.aR(Lt,Lt,1/Gt),vt.push(Gt),mt.push(Lt)}for(let gt=0;gt<4;gt++){const Lt=u.a_(U[gt+ot],mt[gt],J);pt=Lt!==null&&Lt>=0?Math.max(pt,Lt):Math.max(pt,vt[gt])}const bt=function(gt,Lt){const Gt=u.aU([],gt[Lt[0]],gt[Lt[1]]),Ot=u.aU([],gt[Lt[2]],gt[Lt[1]]),Nt=[0,0,0,0];return u.aV(Nt,u.aW([],Gt,Ot)),Nt[3]=-u.aX(Nt,gt[Lt[0]]),Nt}(U,$),At=function(gt,Lt){const Gt=u.a$(gt),Ot=u.b0([],gt,1/Gt),Nt=u.aU([],Lt,u.aR([],Ot,u.aX(Lt,Ot))),Ut=u.a$(Nt);if(Ut>0){const _e=Math.sqrt(1-Ot[3]*Ot[3]),ve=u.aR([],Ot,-Ot[3]),re=u.aS([],ve,u.aR([],Nt,_e/Ut));return u.b1(Lt,re)}return null}(J,bt);if(At!==null){const gt=At/u.aX(mt[0],bt);pt=Math.min(pt,gt)}for(let gt=0;gt<4;gt++){const Lt=Math.min(pt,vt[gt]);U[gt+ut]=[U[gt+ot][0]+mt[gt][0]*Lt,U[gt+ot][1]+mt[gt][1]*Lt,U[gt+ot][2]+mt[gt][2]*Lt,1]}}(D,T[0],f,y);const O=T.map(U=>{const $=u.aU([],D[U[0]],D[U[1]]),J=u.aU([],D[U[2]],D[U[1]]),ct=u.aV([],u.aW([],$,J)),ot=-u.aX(ct,D[U[1]]);return ct.concat(ot)}),j=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],Z=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const U of D)for(let $=0;$<3;$++)j[$]=Math.min(j[$],U[$]),Z[$]=Math.max(Z[$],U[$]);return new Ui(D,O,new ar(j,Z))}}class ti{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,s,c){return this._helper.interpolatePadding(t,s,c)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,s,c=!0){this._helper.resize(t,s,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,s){this._helper.overrideNearFarZ(t,s)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,s){}constructor(t,s,c,f,y){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new kn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(T,z)=>this.getConstrained(T,z)},t,s,c,f,y),this._coveringTilesDetailsProvider=new Qe}clone(){const t=new ti;return t.apply(this),t}apply(t,s,c){this._helper.apply(t,s,c)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const s=[new u.b2(0,t)];if(this._helper._renderWorldCopies){const c=this.screenPointToMercatorCoordinate(new u.P(0,0)),f=this.screenPointToMercatorCoordinate(new u.P(this._helper._width,0)),y=this.screenPointToMercatorCoordinate(new u.P(this._helper._width,this._helper._height)),T=this.screenPointToMercatorCoordinate(new u.P(0,this._helper._height)),z=Math.floor(Math.min(c.x,f.x,y.x,T.x)),D=Math.floor(Math.max(c.x,f.x,y.x,T.x)),O=1;for(let j=z-O;j<=D+O;j++)j!==0&&s.push(new u.b2(j,t))}return s}getCameraFrustum(){return Ui.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const s=this.screenPointToLocation(this.centerPoint,t),c=t?t.getElevationForLngLatZoom(s,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(c)}setLocationAtPoint(t,s){const c=u.aj(this.elevation,this.center.lat),f=this.screenPointToMercatorCoordinateAtZ(s,c),y=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,c),T=u.a1.fromLngLat(t),z=new u.a1(T.x-(f.x-y.x),T.y-(f.y-y.y));this.setCenter(z?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,s){return s?this.coordinatePoint(u.a1.fromLngLat(t),s.getElevationForLngLatZoom(t,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(u.a1.fromLngLat(t))}screenPointToLocation(t,s){var c;return(c=this.screenPointToMercatorCoordinate(t,s))===null||c===void 0?void 0:c.toLngLat()}screenPointToMercatorCoordinate(t,s){if(s){const c=s.pointCoordinate(t);if(c!=null)return c}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,s){const c=s||0,f=[t.x,t.y,0,1],y=[t.x,t.y,1,1];u.aw(f,f,this._pixelMatrixInverse),u.aw(y,y,this._pixelMatrixInverse);const T=f[3],z=y[3],D=f[1]/T,O=y[1]/z,j=f[2]/T,Z=y[2]/z,U=j===Z?0:(c-j)/(Z-j);return new u.a1(u.C.number(f[0]/T,y[0]/z,U)/this.worldSize,u.C.number(D,O,U)/this.worldSize,c)}coordinatePoint(t,s=0,c=this._pixelMatrix){const f=[t.x*this.worldSize,t.y*this.worldSize,s,1];return u.aw(f,f,c),new u.P(f[0]/f[3],f[1]/f[3])}getBounds(){const t=Math.max(0,this._helper._height/2-Pt(this));return new sn().extend(this.screenPointToLocation(new u.P(0,t))).extend(this.screenPointToLocation(new u.P(this._helper._width,t))).extend(this.screenPointToLocation(new u.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new u.P(0,this._helper._height)))}isPointOnMapSurface(t,s){return s?s.pointCoordinate(t)!=null:t.y>this.height/2-Pt(this)}calculatePosMatrix(t,s=!1,c){var f;const y=(f=t.key)!==null&&f!==void 0?f:u.b3(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),T=s?this._alignedPosMatrixCache:this._posMatrixCache;if(T.has(y)){const O=T.get(y);return c?O.f32:O.f64}const z=Et(t,this.worldSize);u.O(z,s?this._alignedProjMatrix:this._viewProjMatrix,z);const D={f64:z,f32:new Float32Array(z)};return T.set(y,D),c?D.f32:D.f64}calculateFogMatrix(t){const s=t.key,c=this._fogMatrixCacheF32;if(c.has(s))return c.get(s);const f=Et(t,this.worldSize);return u.O(f,this._fogMatrix,f),c.set(s,new Float32Array(f)),c.get(s)}getConstrained(t,s){s=u.ah(+s,this.minZoom,this.maxZoom);const c={center:new u.S(t.lng,t.lat),zoom:s};let f=this._helper._lngRange;if(!this._helper._renderWorldCopies&&f===null){const vt=179.9999999999;f=[-vt,vt]}const y=this.tileSize*u.af(c.zoom);let T=0,z=y,D=0,O=y,j=0,Z=0;const{x:U,y:$}=this.size;if(this._helper._latRange){const vt=this._helper._latRange;T=u.U(vt[1])*y,z=u.U(vt[0])*y,z-T<$&&(j=$/(z-T))}f&&(D=u.aO(u.V(f[0])*y,0,y),O=u.aO(u.V(f[1])*y,0,y),O<D&&(O+=y),O-D<U&&(Z=U/(O-D)));const{x:J,y:ct}=st(y,t);let ot,ut;const pt=Math.max(Z||0,j||0);if(pt){const vt=new u.P(Z?(O+D)/2:J,j?(z+T)/2:ct);return c.center=_t(y,vt).wrap(),c.zoom+=u.ak(pt),c}if(this._helper._latRange){const vt=$/2;ct-vt<T&&(ut=T+vt),ct+vt>z&&(ut=z-vt)}if(f){const vt=(D+O)/2;let mt=J;this._helper._renderWorldCopies&&(mt=u.aO(J,vt-y/2,vt+y/2));const bt=U/2;mt-bt<D&&(ot=D+bt),mt+bt>O&&(ot=O-bt)}if(ot!==void 0||ut!==void 0){const vt=new u.P(ot??J,ut??ct);c.center=_t(y,vt).wrap()}return c}calculateCenterFromCameraLngLatAlt(t,s,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,s,c,f)}_calculateNearFarZIfNeeded(t,s,c){if(!this._helper.autoCalculateNearFarZ)return;const f=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),y=t-f*this._helper._pixelPerMeter/Math.cos(s),T=f<0?y:t,z=Math.PI/2+this.pitchInRadians,D=u.ae(this.fov)*(Math.abs(Math.cos(u.ae(this.roll)))*this.height+Math.abs(Math.sin(u.ae(this.roll)))*this.width)/this.height*(.5+c.y/this.height),O=Math.sin(D)*T/Math.sin(u.ah(Math.PI-z-D,.01,Math.PI-.01)),j=Pt(this),Z=Math.atan(j/this._helper.cameraToCenterDistance),U=u.ae(.75),$=Z>U?2*Z*(.5+c.y/(2*j)):U,J=Math.sin($)*T/Math.sin(u.ah(Math.PI-z-$,.01,Math.PI-.01)),ct=Math.min(O,J);this._helper._farZ=1.01*(Math.cos(Math.PI/2-s)*ct+T),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,s=st(this.worldSize,this.center),c=s.x,f=s.y;this._helper._pixelPerMeter=u.aj(1,this.center.lat)*this.worldSize;const y=u.ae(Math.min(this.pitch,it)),T=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(y));let z;this._calculateNearFarZIfNeeded(T,y,t),z=new Float64Array(16),u.b4(z,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),u.aq(this._invProjMatrix,z),z[8]=2*-t.x/this._helper._width,z[9]=2*t.y/this._helper._height,this._projectionMatrix=u.b5(z),u.N(z,z,[1,-1,1]),u.M(z,z,[0,0,-this._helper.cameraToCenterDistance]),u.b6(z,z,-this.rollInRadians),u.b7(z,z,this.pitchInRadians),u.b6(z,z,-this.bearingInRadians),u.M(z,z,[-c,-f,0]),this._mercatorMatrix=u.N([],z,[this.worldSize,this.worldSize,this.worldSize]),u.N(z,z,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=u.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,z),u.M(z,z,[0,0,-this.elevation]),this._viewProjMatrix=z,this._invViewProjMatrix=u.aq([],z);const D=[0,0,-1,1];u.aw(D,D,this._invViewProjMatrix),this._cameraPosition=[D[0]/D[3],D[1]/D[3],D[2]/D[3]],this._fogMatrix=new Float64Array(16),u.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,T,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,u.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),u.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),u.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),u.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),u.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),u.M(this._fogMatrix,this._fogMatrix,[-c,-f,0]),u.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),u.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=u.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,z);const O=this._helper._width%2/2,j=this._helper._height%2/2,Z=Math.cos(this.bearingInRadians),U=Math.sin(-this.bearingInRadians),$=c-Math.round(c)+Z*O+U*j,J=f-Math.round(f)+Z*j+U*O,ct=new Float64Array(z);if(u.M(ct,ct,[$>.5?$-1:$,J>.5?J-1:J,0]),this._alignedProjMatrix=ct,z=u.aq(new Float64Array(16),this._pixelMatrix),!z)throw new Error("failed to invert matrix");this._pixelMatrixInverse=z,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new u.P(0,0)),s=[t.x*this.worldSize,t.y*this.worldSize,0,1];return u.aw(s,s,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=u.aj(1,this.center.lat)*this.worldSize;return Ft(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,s){const c=u.a1.fromLngLat(t),f=[c.x*this.worldSize,c.y*this.worldSize,s,1];return u.aw(f,f,this._viewProjMatrix),f[2]/f[3]}getProjectionData(t){const{overscaledTileID:s,aligned:c,applyTerrainMatrix:f}=t,y=this._helper.getMercatorTileCoordinates(s),T=s?this.calculatePosMatrix(s,c,!0):null;let z;return z=s&&s.terrainRttPosMatrix32f&&f?s.terrainRttPosMatrix32f:T||u.b8(),{mainMatrix:z,tileMercatorCoords:y,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:z}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,s,c){return 1}transformLightDirection(t){return u.aT(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,s,c,f){const y=this.calculatePosMatrix(c);let T;f?(T=[t,s,f(t,s),1],u.aw(T,T,y)):(T=[t,s,0,1],ga(T,T,y));const z=T[3];return{point:new u.P(T[0]/z,T[1]/z),signedDistanceFromCamera:z,isOccluded:!1}}populateCache(t){for(const s of t)this.calculatePosMatrix(s)}getMatrixForModel(t,s){const c=u.a1.fromLngLat(t,s),f=c.meterInMercatorCoordinateUnits(),y=u.b9();return u.M(y,y,[c.x,c.y,c.z]),u.b6(y,y,Math.PI),u.b7(y,y,Math.PI/2),u.N(y,y,[-f,f,f]),y}getProjectionDataForCustomLayer(t=!0){const s=new u.Z(0,0,0,0,0),c=this.getProjectionData({overscaledTileID:s,applyGlobeMatrix:t}),f=Et(s,this.worldSize);u.O(f,this._viewProjMatrix,f),c.tileMercatorCoords=[0,0,1,1];const y=[u.$,u.$,this.worldSize/this._helper.pixelsPerMeter],T=u.ba();return u.N(T,f,y),c.fallbackMatrix=T,c.mainMatrix=T,c}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function na(){u.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function or(g){if(g.useSlerp)if(g.k<1){const t=u.bb(g.startEulerAngles.roll,g.startEulerAngles.pitch,g.startEulerAngles.bearing),s=u.bb(g.endEulerAngles.roll,g.endEulerAngles.pitch,g.endEulerAngles.bearing),c=new Float64Array(4);u.bc(c,t,s,g.k);const f=u.bd(c);g.tr.setRoll(f.roll),g.tr.setPitch(f.pitch),g.tr.setBearing(f.bearing)}else g.tr.setRoll(g.endEulerAngles.roll),g.tr.setPitch(g.endEulerAngles.pitch),g.tr.setBearing(g.endEulerAngles.bearing);else g.tr.setRoll(u.C.number(g.startEulerAngles.roll,g.endEulerAngles.roll,g.k)),g.tr.setPitch(u.C.number(g.startEulerAngles.pitch,g.endEulerAngles.pitch,g.k)),g.tr.setBearing(u.C.number(g.startEulerAngles.bearing,g.endEulerAngles.bearing,g.k))}function lr(g,t,s,c,f){const y=f.padding,T=st(f.worldSize,s.getNorthWest()),z=st(f.worldSize,s.getNorthEast()),D=st(f.worldSize,s.getSouthEast()),O=st(f.worldSize,s.getSouthWest()),j=u.ae(-c),Z=T.rotate(j),U=z.rotate(j),$=D.rotate(j),J=O.rotate(j),ct=new u.P(Math.max(Z.x,U.x,J.x,$.x),Math.max(Z.y,U.y,J.y,$.y)),ot=new u.P(Math.min(Z.x,U.x,J.x,$.x),Math.min(Z.y,U.y,J.y,$.y)),ut=ct.sub(ot),pt=(f.width-(y.left+y.right+t.left+t.right))/ut.x,vt=(f.height-(y.top+y.bottom+t.top+t.bottom))/ut.y;if(vt<0||pt<0)return void na();const mt=Math.min(u.ak(f.scale*Math.min(pt,vt)),g.maxZoom),bt=u.P.convert(g.offset),At=new u.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(u.ae(c)),gt=bt.add(At).mult(f.scale/u.af(mt));return{center:_t(f.worldSize,T.add(D).div(2).sub(gt)),zoom:mt,bearing:c}}class _n{get useGlobeControls(){return!1}handlePanInertia(t,s){return{easingOffset:t,easingCenter:s.center}}handleMapControlsRollPitchBearingZoom(t,s){t.bearingDelta&&s.setBearing(s.bearing+t.bearingDelta),t.pitchDelta&&s.setPitch(s.pitch+t.pitchDelta),t.rollDelta&&s.setRoll(s.roll+t.rollDelta),t.zoomDelta&&s.setZoom(s.zoom+t.zoomDelta)}handleMapControlsPan(t,s,c){t.around.distSqr(s.centerPoint)<.01||s.setLocationAtPoint(c,t.around)}cameraForBoxAndBearing(t,s,c,f,y){return lr(t,s,c,f,y)}handleJumpToCenterZoom(t,s){t.zoom!==(s.zoom!==void 0?+s.zoom:t.zoom)&&t.setZoom(+s.zoom),s.center!==void 0&&t.setCenter(u.S.convert(s.center))}handleEaseTo(t,s){const c=t.zoom,f=t.padding,y={roll:t.roll,pitch:t.pitch,bearing:t.bearing},T={roll:s.roll===void 0?t.roll:s.roll,pitch:s.pitch===void 0?t.pitch:s.pitch,bearing:s.bearing===void 0?t.bearing:s.bearing},z=s.zoom!==void 0,D=!t.isPaddingEqual(s.padding);let O=!1;const j=z?+s.zoom:t.zoom;let Z=t.centerPoint.add(s.offsetAsPoint);const U=t.screenPointToLocation(Z),{center:$,zoom:J}=t.getConstrained(u.S.convert(s.center||U),j??c);Xa(t,$);const ct=st(t.worldSize,U),ot=st(t.worldSize,$).sub(ct),ut=u.af(J-c);return O=J!==c,{easeFunc:pt=>{if(O&&t.setZoom(u.C.number(c,J,pt)),u.be(y,T)||or({startEulerAngles:y,endEulerAngles:T,tr:t,k:pt,useSlerp:y.roll!=T.roll}),D&&(t.interpolatePadding(f,s.padding,pt),Z=t.centerPoint.add(s.offsetAsPoint)),s.around)t.setLocationAtPoint(s.around,s.aroundPoint);else{const vt=u.af(t.zoom-c),mt=J>c?Math.min(2,ut):Math.max(.5,ut),bt=Math.pow(mt,1-pt),At=_t(t.worldSize,ct.add(ot.mult(pt*bt)).mult(vt));t.setLocationAtPoint(t.renderWorldCopies?At.wrap():At,Z)}},isZooming:O,elevationCenter:$}}handleFlyTo(t,s){const c=s.zoom!==void 0,f=t.zoom,y=t.getConstrained(u.S.convert(s.center||s.locationAtOffset),c?+s.zoom:f),T=y.center,z=y.zoom;Xa(t,T);const D=st(t.worldSize,s.locationAtOffset),O=st(t.worldSize,T).sub(D),j=O.mag(),Z=u.af(z-f);let U;if(s.minZoom!==void 0){const $=Math.min(+s.minZoom,f,z),J=t.getConstrained(T,$).zoom;U=u.af(J-f)}return{easeFunc:($,J,ct,ot)=>{t.setZoom($===1?z:f+u.ak(J));const ut=$===1?T:_t(t.worldSize,D.add(O.mult(ct)).mult(J));t.setLocationAtPoint(t.renderWorldCopies?ut.wrap():ut,ot)},scaleOfZoom:Z,targetCenter:T,scaleOfMinZoom:U,pixelPathLength:j}}}class Ri{constructor(t,s,c){this.blendFunction=t,this.blendColor=s,this.mask=c}}Ri.Replace=[1,0],Ri.disabled=new Ri(Ri.Replace,u.bf.transparent,[!1,!1,!1,!1]),Ri.unblended=new Ri(Ri.Replace,u.bf.transparent,[!0,!0,!0,!0]),Ri.alphaBlended=new Ri([1,771],u.bf.transparent,[!0,!0,!0,!0]);const Fs=2305;class Ye{constructor(t,s,c){this.enable=t,this.mode=s,this.frontFace=c}}Ye.disabled=new Ye(!1,1029,Fs),Ye.backCCW=new Ye(!0,1029,Fs),Ye.frontCCW=new Ye(!0,1028,Fs);class je{constructor(t,s,c){this.func=t,this.mask=s,this.range=c}}je.ReadOnly=!1,je.ReadWrite=!0,je.disabled=new je(519,je.ReadOnly,[0,1]);const fr=7680;class Ai{constructor(t,s,c,f,y,T){this.test=t,this.ref=s,this.mask=c,this.fail=f,this.depthFail=y,this.pass=T}}Ai.disabled=new Ai({func:519,mask:0},0,0,fr,fr,fr);const Ji=new WeakMap;function kr(g){var t;if(Ji.has(g))return Ji.get(g);{const s=(t=g.getParameter(g.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return Ji.set(g,s),s}}class as{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const s=t.context,c=s.gl;this._texFormat=c.RGBA,this._texType=c.UNSIGNED_BYTE;const f=new u.aL;f.emplaceBack(-1,-1),f.emplaceBack(2,-1),f.emplaceBack(-1,2);const y=new u.aN;y.emplaceBack(0,1,2),this._fullscreenTriangle=new Ns(s.createVertexBuffer(f,js.members),s.createIndexBuffer(y),u.aM.simpleSegment(0,0,f.length,y.length)),this._resultBuffer=new Uint8Array(4),s.activeTexture.set(c.TEXTURE1);const T=c.createTexture();c.bindTexture(c.TEXTURE_2D,T),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texImage2D(c.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=s.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(T),kr(c)&&(this._pbo=c.createBuffer(),c.bindBuffer(c.PIXEL_PACK_BUFFER,this._pbo),c.bufferData(c.PIXEL_PACK_BUFFER,4,c.STREAM_READ),c.bindBuffer(c.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,s){const c=this._updateCount;return this._readbackQueue?c>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():c>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,s),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,s=t.gl;t.activeTexture.set(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,s){const c=this._cachedRenderContext.context,f=c.gl;if(this._bindFramebuffer(),c.viewport.set([0,0,this._texWidth,this._texHeight]),c.clear({color:u.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(c,f.TRIANGLES,je.disabled,Ai.disabled,Ri.unblended,Ye.disabled,((y,T)=>({u_input:y,u_output_expected:T}))(t,s),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&kr(f)){f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.readBuffer(f.COLOR_ATTACHMENT0),f.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),f.bindBuffer(f.PIXEL_PACK_BUFFER,null);const y=f.fenceSync(f.SYNC_GPU_COMMANDS_COMPLETE,0);f.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:y}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&kr(t)){const s=t.clientWaitSync(this._readbackQueue.sync,0,0);if(s===t.WAIT_FAILED)return u.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(s===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=as._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let s=0;return s+=t[0]/256,s+=t[1]/65536,s+=t[2]/16777216,t[3]<127&&(s=-s),s/128}}const ba=u.$/128;function pu(g,t){const s=g.granularity!==void 0?Math.max(g.granularity,1):1,c=s+(g.generateBorders?2:0),f=s+(g.extendToNorthPole||g.generateBorders?1:0)+(g.extendToSouthPole||g.generateBorders?1:0),y=c+1,T=f+1,z=g.generateBorders?-1:0,D=g.generateBorders||g.extendToNorthPole?-1:0,O=s+(g.generateBorders?1:0),j=s+(g.generateBorders||g.extendToSouthPole?1:0),Z=y*T,U=c*f*6,$=y*T>65536;if($&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const J=$||t==="32bit",ct=new Int16Array(2*Z);let ot=0;for(let vt=D;vt<=j;vt++)for(let mt=z;mt<=O;mt++){let bt=mt/s*u.$;mt===-1&&(bt=-ba),mt===s+1&&(bt=u.$+ba);let At=vt/s*u.$;vt===-1&&(At=g.extendToNorthPole?u.bh:-ba),vt===s+1&&(At=g.extendToSouthPole?u.bi:u.$+ba),ct[ot++]=bt,ct[ot++]=At}const ut=J?new Uint32Array(U):new Uint16Array(U);let pt=0;for(let vt=0;vt<f;vt++)for(let mt=0;mt<c;mt++){const bt=mt+1+vt*y,At=mt+(vt+1)*y,gt=mt+1+(vt+1)*y;ut[pt++]=mt+vt*y,ut[pt++]=At,ut[pt++]=bt,ut[pt++]=bt,ut[pt++]=At,ut[pt++]=gt}return{vertices:ct.buffer.slice(0),indices:ut.buffer.slice(0),uses32bitIndices:J}}const Ya=new u.aK({fill:new u.bj(128,2),line:new u.bj(512,0),tile:new u.bj(128,32),stencil:new u.bj(128,1),circle:3});class Mi{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ur.projectionGlobe}get vertexShaderPreludeCode(){return Ur.projectionMercator.vertexSource}get subdivisionGranularity(){return Ya}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new as(t));const s=u.U(this._errorQueryLatitudeDegrees),c=2*Math.atan(Math.exp(Math.PI-s*Math.PI*2))-.5*Math.PI,f=this._errorMeasurement.updateErrorLoop(s,c),y=ht.now();f!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=f,this._errorMeasurementLastChangeTime=y);const T=Math.min(Math.max((y-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=u.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,u.bl(T))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,s,c,f,y){const T=(y==="stencil"?Ya.stencil:Ya.tile).getGranularityForZoomLevel(s.z);return this._getMesh(t,{granularity:T,generateBorders:c,extendToNorthPole:s.y===0&&f,extendToSouthPole:s.y===(1<<s.z)-1&&f})}_getMesh(t,s){const c=this._getMeshKey(s);if(c in this._tileMeshCache)return this._tileMeshCache[c];const f=function(y,T){const z=pu(T,"16bit"),D=u.aL.deserialize({arrayBuffer:z.vertices,length:z.vertices.byteLength/2/2}),O=u.aN.deserialize({arrayBuffer:z.indices,length:z.indices.byteLength/2/3});return new Ns(y.createVertexBuffer(D,js.members),y.createIndexBuffer(O),u.aM.simpleSegment(0,0,D.length,O.length))}(t,s);return this._tileMeshCache[c]=f,f}recalculate(t){}hasTransition(){const t=ht.now();let s=!1;return s=s||(t-this._errorMeasurementLastChangeTime)/1e3<.7,s=s||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,s}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const Mo=new u.r({type:new u.D(u.v.projection.type)});class Sr extends u.E{constructor(t){super(),this._transitionable=new u.t(Mo),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new u.F(0)),this._mercatorProjection=new di,this._verticalPerspectiveProjection=new Mi}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof u.bm){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,s,c,f,y){return this.currentProjection.getMeshFromTileID(t,s,c,f,y)}setProjection(t){this._transitionable.setValue("type",t?.type||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function Wa(g){const t=Po(g.worldSize,g.center.lat);return 2*Math.PI*t}function Vs(g,t,s,c,f){const y=1/(1<<f),T=t/u.$*y+c*y,z=u.bo((g/u.$*y+s*y)*Math.PI*2+Math.PI,2*Math.PI),D=2*Math.atan(Math.exp(Math.PI-T*Math.PI*2))-.5*Math.PI,O=Math.cos(D),j=new Float64Array(3);return j[0]=Math.sin(z)*O,j[1]=Math.sin(D),j[2]=Math.cos(z)*O,j}function pr(g){return function(t,s){const c=Math.cos(s),f=new Float64Array(3);return f[0]=Math.sin(t)*c,f[1]=Math.sin(s),f[2]=Math.cos(t)*c,f}(g.lng*Math.PI/180,g.lat*Math.PI/180)}function Po(g,t){return g/(2*Math.PI)/Math.cos(t*Math.PI/180)}function qo(g){const t=Math.asin(g[1])/Math.PI*180,s=Math.sqrt(g[0]*g[0]+g[2]*g[2]);if(s>1e-6){const c=g[0]/s,f=Math.acos(g[2]/s),y=(c>0?f:-f)/Math.PI*180;return new u.S(u.aO(y,-180,180),t)}return new u.S(0,t)}function Ao(g){return Math.cos(g*Math.PI/180)}function Bn(g,t){const s=Ao(g),c=Ao(t);return u.ak(c/s)}function Xu(g,t){const s=g.rotate(t.bearingInRadians),c=t.zoom+Bn(t.center.lat,0),f=u.bk(1/Ao(t.center.lat),1/Ao(Math.min(Math.abs(t.center.lat),60)),u.bn(c,7,3,0,1)),y=360/Wa({worldSize:t.worldSize,center:{lat:t.center.lat}});return new u.S(t.center.lng-s.x*y*f,u.ah(t.center.lat+s.y*y,-u.ai,u.ai))}function $o(g){const t=.5*g,s=Math.sin(t),c=Math.cos(t);return Math.log(s+c)-Math.log(c-s)}function mu(g,t,s,c){const f=g.lat+s*c;if(Math.abs(s)>1){const y=(Math.sign(g.lat+s)!==Math.sign(g.lat)?-Math.abs(g.lat):Math.abs(g.lat))*Math.PI/180,T=Math.abs(g.lat+s)*Math.PI/180,z=$o(y+c*(T-y)),D=$o(y),O=$o(T);return new u.S(g.lng+t*((z-D)/(O-D)),f)}return new u.S(g.lng+t*c,f)}class ra{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,s,c,f){const y=`${t.z}_${t.x}_${t.y}_${f?.terrain?"t":""}`,T=this._cache.get(y);if(T)return T;const z=this._cachePrevious.get(y);if(z)return this._cache.set(y,z),z;const D=this._boundingVolumeFactory(t,s,c,f);return this._cache.set(y,D),this._hadAnyChanges=!0,D}}class yl{constructor(t,s,c,f){this.min=c,this.max=f,this.points=t,this.planes=s}static fromAabb(t,s){const c=[];for(let f=0;f<8;f++)c.push([1&~f?t[0]:s[0],(f>>1&1)==1?s[1]:t[1],(f>>2&1)==1?s[2]:t[2]]);return new yl(c,[[-1,0,0,s[0]],[1,0,0,-t[0]],[0,-1,0,s[1]],[0,1,0,-t[1]],[0,0,-1,s[2]],[0,0,1,-t[2]]],t,s)}static fromCenterSizeAngles(t,s,c){const f=u.br([],c[0],c[1],c[2]),y=u.bs([],[s[0],0,0],f),T=u.bs([],[0,s[1],0],f),z=u.bs([],[0,0,s[2]],f),D=[...t],O=[...t];for(let Z=0;Z<8;Z++)for(let U=0;U<3;U++){const $=t[U]+y[U]*(1&~Z?-1:1)+T[U]*((Z>>1&1)==1?1:-1)+z[U]*((Z>>2&1)==1?1:-1);D[U]=Math.min(D[U],$),O[U]=Math.max(O[U],$)}const j=[];for(let Z=0;Z<8;Z++){const U=[...t];u.aS(U,U,u.aR([],y,1&~Z?-1:1)),u.aS(U,U,u.aR([],T,(Z>>1&1)==1?1:-1)),u.aS(U,U,u.aR([],z,(Z>>2&1)==1?1:-1)),j.push(U)}return new yl(j,[[...y,-u.aX(y,j[0])],[...T,-u.aX(T,j[0])],[...z,-u.aX(z,j[0])],[-y[0],-y[1],-y[2],-u.aX(y,j[7])],[-T[0],-T[1],-T[2],-u.aX(T,j[7])],[-z[0],-z[1],-z[2],-u.aX(z,j[7])]],D,O)}intersectsFrustum(t){let s=!0;const c=this.points.length,f=this.planes.length,y=t.planes.length,T=t.points.length;for(let z=0;z<y;z++){const D=t.planes[z];let O=0;for(let j=0;j<c;j++){const Z=this.points[j];D[0]*Z[0]+D[1]*Z[1]+D[2]*Z[2]+D[3]>=0&&O++}if(O===0)return 0;O<c&&(s=!1)}if(s)return 2;for(let z=0;z<f;z++){const D=this.planes[z];let O=0;for(let j=0;j<T;j++){const Z=t.points[j];D[0]*Z[0]+D[1]*Z[1]+D[2]*Z[2]+D[3]>=0&&O++}if(O===0)return 0}return 1}intersectsPlane(t){const s=this.points.length;let c=0;for(let f=0;f<s;f++){const y=this.points[f];t[0]*y[0]+t[1]*y[1]+t[2]*y[2]+t[3]>=0&&c++}return c===s?2:c===0?0:1}}function mr(g,t,s){const c=g-t;return c<0?-c:Math.max(0,c-s)}function Us(g,t,s,c,f){const y=g-s;let T;return T=y<0?Math.min(-y,1+y-f):y>1?Math.min(Math.max(y-f,0),1-y):0,Math.max(T,mr(t,c,f))}class sa{constructor(){this._boundingVolumeCache=new ra(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,s,c,f){const y=1<<c.z,T=1/y,z=c.x/y,D=c.y/y;let O=2;return O=Math.min(O,Us(t,s,z,D,T)),O=Math.min(O,Us(t,s,z+.5,-D-T,T)),O=Math.min(O,Us(t,s,z+.5,2-D-T,T)),O}getWrap(t,s,c){const f=1<<s.z,y=1/f,T=s.x/f,z=mr(t.x,T,y),D=mr(t.x,T-1,y),O=mr(t.x,T+1,y),j=Math.min(z,D,O);return j===O?1:j===D?-1:0}allowVariableZoom(t,s){return Le(t,s)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,s,c,f){return this._boundingVolumeCache.getTileBoundingVolume(t,s,c,f)}_computeTileBoundingVolume(t,s,c,f){var y,T;let z=0,D=0;if(f?.terrain){const O=new u.Z(t.z,s,t.z,t.x,t.y),j=f.terrain.getMinMaxElevation(O);z=(y=j.minElevation)!==null&&y!==void 0?y:Math.min(0,c),D=(T=j.maxElevation)!==null&&T!==void 0?T:Math.max(0,c)}if(z/=u.bu,D/=u.bu,z+=1,D+=1,t.z<=0)return yl.fromAabb([-D,-D,-D],[D,D,D]);if(t.z===1)return yl.fromAabb([t.x===0?-D:0,t.y===0?0:-D,-D],[t.x===0?0:D,t.y===0?D:0,D]);{const O=[Vs(0,0,t.x,t.y,t.z),Vs(u.$,0,t.x,t.y,t.z),Vs(u.$,u.$,t.x,t.y,t.z),Vs(0,u.$,t.x,t.y,t.z)],j=[];for(const Nt of O)j.push(u.aR([],Nt,D));if(D!==z)for(const Nt of O)j.push(u.aR([],Nt,z));t.y===0&&j.push([0,1,0]),t.y===(1<<t.z)-1&&j.push([0,-1,0]);const Z=[1,1,1],U=[-1,-1,-1];for(const Nt of j)for(let Ut=0;Ut<3;Ut++)Z[Ut]=Math.min(Z[Ut],Nt[Ut]),U[Ut]=Math.max(U[Ut],Nt[Ut]);const $=Vs(u.$/2,u.$/2,t.x,t.y,t.z),J=u.aW([],[0,1,0],$);u.aV(J,J);const ct=u.aW([],$,J);u.aV(ct,ct);const ot=u.aW([],O[2],O[1]);u.aV(ot,ot);const ut=u.aW([],O[0],O[3]);u.aV(ut,ut),j.push(u.aR([],$,D)),t.y>=(1<<t.z)/2&&j.push(u.aR([],Vs(u.$/2,0,t.x,t.y,t.z),D)),t.y<(1<<t.z)/2&&j.push(u.aR([],Vs(u.$/2,u.$,t.x,t.y,t.z),D));const pt=Co($,j),vt=Co(ct,j),mt=[-$[0],-$[1],-$[2],pt.max],bt=[$[0],$[1],$[2],-pt.min],At=[-ct[0],-ct[1],-ct[2],vt.max],gt=[ct[0],ct[1],ct[2],-vt.min],Lt=[...ot,0],Gt=[...ut,0],Ot=[];return t.y===0?Ot.push(u.bt(Gt,Lt,mt),u.bt(Gt,Lt,bt)):Ot.push(u.bt(At,Lt,mt),u.bt(At,Lt,bt),u.bt(At,Gt,mt),u.bt(At,Gt,bt)),t.y===(1<<t.z)-1?Ot.push(u.bt(Gt,Lt,mt),u.bt(Gt,Lt,bt)):Ot.push(u.bt(gt,Lt,mt),u.bt(gt,Lt,bt),u.bt(gt,Gt,mt),u.bt(gt,Gt,bt)),new yl(Ot,[mt,bt,At,gt,Lt,Gt],Z,U)}}}function Co(g,t){let s=1/0,c=-1/0;for(const f of t){const y=u.aX(g,f);s=Math.min(s,y),c=Math.max(c,y)}return{min:s,max:c}}class Xo{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,s,c){return this._helper.interpolatePadding(t,s,c)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,s){this._helper.resize(t,s)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,s){this._helper.overrideNearFarZ(t,s)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(){this._cachedClippingPlane=u.bv(),this._projectionMatrix=u.b9(),this._globeViewProjMatrix32f=u.b8(),this._globeViewProjMatrixNoCorrection=u.b9(),this._globeViewProjMatrixNoCorrectionInverted=u.b9(),this._globeProjMatrixInverted=u.b9(),this._cameraPosition=u.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new kn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,s)=>this.getConstrained(t,s)}),this._coveringTilesDetailsProvider=new sa}clone(){const t=new Xo;return t.apply(this),t}apply(t,s){this._globeLatitudeErrorCorrectionRadians=s||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=u.bp();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:s,applyGlobeMatrix:c}=t,f=this._helper.getMercatorTileCoordinates(s);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:f,clippingPlane:this._cachedClippingPlane,projectionTransition:c?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const s=this.pitchInRadians,c=this.cameraToCenterDistance/t,f=Math.sin(s)*c,y=Math.cos(s)*c+1,T=1/Math.sqrt(f*f+y*y)*1;let z=-f,D=y;const O=Math.sqrt(z*z+D*D);z/=O,D/=O;const j=[0,z,D];u.bw(j,j,[0,0,0],-this.bearingInRadians),u.bx(j,j,[0,0,0],-1*this.center.lat*Math.PI/180),u.by(j,j,[0,0,0],this.center.lng*Math.PI/180);const Z=1/u.aZ(j);return u.aR(j,j,Z),[...j,-T*Z]}isLocationOccluded(t){return!this.isSurfacePointVisible(pr(t))}transformLightDirection(t){const s=this._helper._center.lng*Math.PI/180,c=this._helper._center.lat*Math.PI/180,f=Math.cos(c),y=[Math.sin(s)*f,Math.sin(c),Math.cos(s)*f],T=[y[2],0,-y[0]],z=[0,0,0];u.aW(z,T,y),u.aV(T,T),u.aV(z,z);const D=[0,0,0];return u.aV(D,[T[0]*t[0]+z[0]*t[1]+y[0]*t[2],T[1]*t[0]+z[1]*t[1]+y[1]*t[2],T[2]*t[0]+z[2]*t[1]+y[2]*t[2]]),D}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,s,c){const f=function(z,D,O){const j=1/(1<<O.z);return new u.a1(z/u.$*j+O.x*j,D/u.$*j+O.y*j)}(t,s,c.canonical),y=(T=f.y,[u.bo(f.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-T*Math.PI*2))-.5*Math.PI]);var T;return this.getCircleRadiusCorrection()/Math.cos(y[1])}projectTileCoordinates(t,s,c,f){const y=c.canonical,T=Vs(t,s,y.x,y.y,y.z),z=1+(f?f(t,s):0)/u.bu,D=[T[0]*z,T[1]*z,T[2]*z,1];u.aw(D,D,this._globeViewProjMatrixNoCorrection);const O=this._cachedClippingPlane,j=O[0]*T[0]+O[1]*T[1]+O[2]*T[2]+O[3]<0;return{point:new u.P(D[0]/D[3],D[1]/D[3]),signedDistanceFromCamera:D[3],isOccluded:j}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=Po(this.worldSize,this.center.lat),s=u.ba(),c=u.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),u.b4(s,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const f=this.centerOffset;s[8]=2*-f.x/this._helper._width,s[9]=2*f.y/this._helper._height,this._projectionMatrix=u.b5(s),this._globeProjMatrixInverted=u.ba(),u.aq(this._globeProjMatrixInverted,s),u.M(s,s,[0,0,-this.cameraToCenterDistance]),u.b6(s,s,this.rollInRadians),u.b7(s,s,-this.pitchInRadians),u.b6(s,s,this.bearingInRadians),u.M(s,s,[0,0,-t]);const y=u.bp();y[0]=t,y[1]=t,y[2]=t,u.b7(c,s,this.center.lat*Math.PI/180),u.bz(c,c,-this.center.lng*Math.PI/180),u.N(c,c,y),this._globeViewProjMatrixNoCorrection=c,u.b7(s,s,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),u.bz(s,s,-this.center.lng*Math.PI/180),u.N(s,s,y),this._globeViewProjMatrix32f=new Float32Array(s),this._globeViewProjMatrixNoCorrectionInverted=u.ba(),u.aq(this._globeViewProjMatrixNoCorrectionInverted,c);const T=u.bp();this._cameraPosition=u.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/t,u.bw(this._cameraPosition,this._cameraPosition,T,-this.rollInRadians),u.bx(this._cameraPosition,this._cameraPosition,T,this.pitchInRadians),u.bw(this._cameraPosition,this._cameraPosition,T,-this.bearingInRadians),u.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),u.bx(this._cameraPosition,this._cameraPosition,T,-this.center.lat*Math.PI/180),u.by(this._cameraPosition,this._cameraPosition,T,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const z=u.b5(this._globeViewProjMatrixNoCorrectionInverted);u.N(z,z,[1,1,-1]),this._cachedFrustum=Ui.fromInvProjectionMatrix(z,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){u.w("calculateFogMatrix is not supported on globe projection.");const s=u.ba();return u.ag(s),s}getVisibleUnwrappedCoordinates(t){return[new u.b2(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&u.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,s){if(!this._globeViewProjMatrixNoCorrection)return 1;const c=pr(t);u.aR(c,c,1+s/u.bu);const f=u.bv();return u.aw(f,[c[0],c[1],c[2],1],this._globeViewProjMatrixNoCorrection),f[2]/f[3]}populateCache(t){}getBounds(){const t=.5*this.width,s=.5*this.height,c=[new u.P(0,0),new u.P(t,0),new u.P(this.width,0),new u.P(this.width,s),new u.P(this.width,this.height),new u.P(t,this.height),new u.P(0,this.height),new u.P(0,s)],f=[];for(const Z of c)f.push(this.unprojectScreenPoint(Z));let y=0,T=0,z=0,D=0;const O=this.center;for(const Z of f){const U=u.bA(O.lng,Z.lng),$=u.bA(O.lat,Z.lat);U<T&&(T=U),U>y&&(y=U),$<D&&(D=$),$>z&&(z=$)}const j=[O.lng+T,O.lat+D,O.lng+y,O.lat+z];return this.isSurfacePointOnScreen([0,1,0])&&(j[3]=90,j[0]=-180,j[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(j[1]=-90,j[0]=-180,j[2]=180),new sn(j)}getConstrained(t,s){const c=u.ah(t.lat,-u.ai,u.ai),f=u.ah(+s,this.minZoom+Bn(0,c),this.maxZoom);return{center:new u.S(t.lng,c),zoom:f}}calculateCenterFromCameraLngLatAlt(t,s,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,s,c,f)}setLocationAtPoint(t,s){const c=pr(this.unprojectScreenPoint(s)),f=pr(t),y=u.bp();u.bB(y);const T=u.bp();u.by(T,c,y,-this.center.lng*Math.PI/180),u.bx(T,T,y,this.center.lat*Math.PI/180);const z=f[0]*f[0]+f[2]*f[2],D=T[0]*T[0];if(z<D)return;const O=Math.sqrt(z-D),j=-O,Z=u.bC(f[0],f[2],T[0],O),U=u.bC(f[0],f[2],T[0],j),$=u.bp();u.by($,f,y,-Z);const J=u.bC($[1],$[2],T[1],T[2]),ct=u.bp();u.by(ct,f,y,-U);const ot=u.bC(ct[1],ct[2],T[1],T[2]),ut=.5*Math.PI,pt=J>=-ut&&J<=ut,vt=ot>=-ut&&ot<=ut;let mt,bt;if(pt&&vt){const Gt=this.center.lng*Math.PI/180,Ot=this.center.lat*Math.PI/180;u.bD(Z,Gt)+u.bD(J,Ot)<u.bD(U,Gt)+u.bD(ot,Ot)?(mt=Z,bt=J):(mt=U,bt=ot)}else if(pt)mt=Z,bt=J;else{if(!vt)return;mt=U,bt=ot}const At=mt/Math.PI*180,gt=bt/Math.PI*180,Lt=this.center.lat;this.setCenter(new u.S(At,u.ah(gt,-90,90))),this.setZoom(this.zoom+Bn(Lt,this.center.lat))}locationToScreenPoint(t,s){const c=pr(t);if(s){const f=s.getElevationForLngLatZoom(t,this._helper._tileZoom);u.aR(c,c,1+f/u.bu)}return this._projectSurfacePointToScreen(c)}_projectSurfacePointToScreen(t){const s=u.bv();return u.aw(s,[...t,1],this._globeViewProjMatrixNoCorrection),s[0]/=s[3],s[1]/=s[3],new u.P((.5*s[0]+.5)*this.width,(.5*-s[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,s){if(s){const c=s.pointCoordinate(t);if(c)return c}return u.a1.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,s){var c;return(c=this.screenPointToMercatorCoordinate(t,s))===null||c===void 0?void 0:c.toLngLat()}isPointOnMapSurface(t,s){const c=this._cameraPosition,f=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(c,f)}getRayDirectionFromPixel(t){const s=u.bv();s[0]=t.x/this.width*2-1,s[1]=-1*(t.y/this.height*2-1),s[2]=1,s[3]=1,u.aw(s,s,this._globeViewProjMatrixNoCorrectionInverted),s[0]/=s[3],s[1]/=s[3],s[2]/=s[3];const c=u.bp();c[0]=s[0]-this._cameraPosition[0],c[1]=s[1]-this._cameraPosition[1],c[2]=s[2]-this._cameraPosition[2];const f=u.bp();return u.aV(f,c),f}isSurfacePointVisible(t){const s=this._cachedClippingPlane;return s[0]*t[0]+s[1]*t[1]+s[2]*t[2]+s[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const s=u.bv();return u.aw(s,[...t,1],this._globeViewProjMatrixNoCorrection),s[0]/=s[3],s[1]/=s[3],s[2]/=s[3],s[0]>-1&&s[0]<1&&s[1]>-1&&s[1]<1&&s[2]>-1&&s[2]<1}rayPlanetIntersection(t,s){const c=u.aX(t,s),f=u.bp(),y=u.bp();u.aR(y,s,c),u.aU(f,t,y);const T=1-u.aX(f,f);if(T<0)return null;const z=u.aX(t,t)-1,D=-c+(c<0?1:-1)*Math.sqrt(T),O=z/D,j=D;return{tMin:Math.min(O,j),tMax:Math.max(O,j)}}unprojectScreenPoint(t){const s=this._cameraPosition,c=this.getRayDirectionFromPixel(t),f=this.rayPlanetIntersection(s,c);if(f){const j=u.bp();u.aS(j,s,[c[0]*f.tMin,c[1]*f.tMin,c[2]*f.tMin]);const Z=u.bp();return u.aV(Z,j),qo(Z)}const y=this._cachedClippingPlane,T=y[0]*c[0]+y[1]*c[1]+y[2]*c[2],z=-u.b1(y,s)/T,D=u.bp();if(z>0)u.aS(D,s,[c[0]*z,c[1]*z,c[2]*z]);else{const j=u.bp();u.aS(j,s,[2*c[0],2*c[1],2*c[2]]);const Z=u.b1(this._cachedClippingPlane,j);u.aU(D,j,[this._cachedClippingPlane[0]*Z,this._cachedClippingPlane[1]*Z,this._cachedClippingPlane[2]*Z])}const O=function(j){const Z=u.bp();return Z[0]=j[0]*-j[3],Z[1]=j[1]*-j[3],Z[2]=j[2]*-j[3],{center:Z,radius:Math.sqrt(1-j[3]*j[3])}}(y);return qo(function(j,Z,U){const $=u.bp();u.aU($,U,j);const J=u.bp();return u.bq(J,j,$,Z/u.a$($)),J}(O.center,O.radius,D))}getMatrixForModel(t,s){const c=u.S.convert(t),f=1/u.bu,y=u.b9();return u.bz(y,y,c.lng/180*Math.PI),u.b7(y,y,-c.lat/180*Math.PI),u.M(y,y,[0,0,1+s/u.bu]),u.b7(y,y,.5*Math.PI),u.N(y,y,[f,f,f]),y}getProjectionDataForCustomLayer(t=!0){const s=this.getProjectionData({overscaledTileID:new u.Z(0,0,0,0,0),applyGlobeMatrix:t});return s.tileMercatorCoords=[0,0,1,1],s}getFastPathSimpleProjectionMatrix(t){}}class tc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,s,c){return this._helper.interpolatePadding(t,s,c)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,s,c=!0){this._helper.resize(t,s,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,s){this._helper.overrideNearFarZ(t,s)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,s){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=s,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new kn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,s)=>this.getConstrained(t,s)}),this._globeness=1,this._mercatorTransform=new ti,this._verticalPerspectiveTransform=new Xo}clone(){const t=new tc;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const s=this._mercatorTransform.getProjectionData(t),c=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?c.mainMatrix:s.mainMatrix,clippingPlane:c.clippingPlane,tileMercatorCoords:c.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:s.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return u.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return u.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,s,c){const f=this._mercatorTransform.getPitchedTextCorrection(t,s,c),y=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,s,c);return u.bk(f,y,this._globeness)}projectTileCoordinates(t,s,c,f){return this.currentTransform.projectTileCoordinates(t,s,c,f)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,s){return this.currentTransform.lngLatToCameraDepth(t,s)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}getConstrained(t,s){return this.currentTransform.getConstrained(t,s)}calculateCenterFromCameraLngLatAlt(t,s,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,s,c,f)}setLocationAtPoint(t,s){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,s),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,s),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,s){return this.currentTransform.locationToScreenPoint(t,s)}screenPointToMercatorCoordinate(t,s){return this.currentTransform.screenPointToMercatorCoordinate(t,s)}screenPointToLocation(t,s){return this.currentTransform.screenPointToLocation(t,s)}isPointOnMapSurface(t,s){return this.currentTransform.isPointOnMapSurface(t,s)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,s){return this.currentTransform.getMatrixForModel(t,s)}getProjectionDataForCustomLayer(t=!0){const s=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return s;const c=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return c.fallbackMatrix=s.mainMatrix,c}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class Mr{get useGlobeControls(){return!0}handlePanInertia(t,s){const c=Xu(t,s);return Math.abs(c.lng-s.center.lng)>180&&(c.lng=s.center.lng+179.5*Math.sign(c.lng-s.center.lng)),{easingCenter:c,easingOffset:new u.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,s){const c=t.around,f=s.screenPointToLocation(c);t.bearingDelta&&s.setBearing(s.bearing+t.bearingDelta),t.pitchDelta&&s.setPitch(s.pitch+t.pitchDelta),t.rollDelta&&s.setRoll(s.roll+t.rollDelta);const y=s.zoom;t.zoomDelta&&s.setZoom(s.zoom+t.zoomDelta);const T=s.zoom-y;if(T===0)return;const z=u.bA(s.center.lng,f.lng),D=z/(Math.abs(z/180)+1),O=u.bA(s.center.lat,f.lat),j=s.getRayDirectionFromPixel(c),Z=s.cameraPosition,U=-1*u.aX(Z,j),$=u.bp();u.aS($,Z,[j[0]*U,j[1]*U,j[2]*U]);const J=u.aZ($)-1,ct=Math.exp(.5*-Math.max(J-.3,0)),ot=Po(s.worldSize,s.center.lat)/Math.min(s.width,s.height),ut=u.bn(ot,.9,.5,1,.25),pt=(1-u.af(-T))*Math.min(ct,ut),vt=s.center.lat,mt=s.zoom,bt=new u.S(s.center.lng+D*pt,u.ah(s.center.lat+O*pt,-u.ai,u.ai));s.setLocationAtPoint(f,c);const At=s.center,gt=u.bn(Math.abs(z),45,85,0,1),Lt=u.bn(ot,.75,.35,0,1),Gt=Math.pow(Math.max(gt,Lt),.25),Ot=u.bA(At.lng,bt.lng),Nt=u.bA(At.lat,bt.lat);s.setCenter(new u.S(At.lng+Ot*Gt,At.lat+Nt*Gt).wrap()),s.setZoom(mt+Bn(vt,s.center.lat))}handleMapControlsPan(t,s,c){if(!t.panDelta)return;const f=s.center.lat,y=s.zoom;s.setCenter(Xu(t.panDelta,s).wrap()),s.setZoom(y+Bn(f,s.center.lat))}cameraForBoxAndBearing(t,s,c,f,y){const T=lr(t,s,c,f,y),z=s.left/y.width*2-1,D=(y.width-s.right)/y.width*2-1,O=s.top/y.height*-2+1,j=(y.height-s.bottom)/y.height*-2+1,Z=u.bA(c.getWest(),c.getEast())<0,U=Z?c.getEast():c.getWest(),$=Z?c.getWest():c.getEast(),J=Math.max(c.getNorth(),c.getSouth()),ct=Math.min(c.getNorth(),c.getSouth()),ot=U+.5*u.bA(U,$),ut=J+.5*u.bA(J,ct),pt=y.clone();pt.setCenter(T.center),pt.setBearing(T.bearing),pt.setPitch(0),pt.setRoll(0),pt.setZoom(T.zoom);const vt=pt.modelViewProjectionMatrix,mt=[pr(c.getNorthWest()),pr(c.getNorthEast()),pr(c.getSouthWest()),pr(c.getSouthEast()),pr(new u.S($,ut)),pr(new u.S(U,ut)),pr(new u.S(ot,J)),pr(new u.S(ot,ct))],bt=pr(T.center);let At=Number.POSITIVE_INFINITY;for(const gt of mt)z<0&&(At=Mr.getLesserNonNegativeNonNull(At,Mr.solveVectorScale(gt,bt,vt,"x",z))),D>0&&(At=Mr.getLesserNonNegativeNonNull(At,Mr.solveVectorScale(gt,bt,vt,"x",D))),O>0&&(At=Mr.getLesserNonNegativeNonNull(At,Mr.solveVectorScale(gt,bt,vt,"y",O))),j<0&&(At=Mr.getLesserNonNegativeNonNull(At,Mr.solveVectorScale(gt,bt,vt,"y",j)));if(Number.isFinite(At)&&At!==0)return T.zoom=pt.zoom+u.ak(At),T;na()}handleJumpToCenterZoom(t,s){const c=t.center.lat,f=t.getConstrained(s.center?u.S.convert(s.center):t.center,t.zoom).center;t.setCenter(f.wrap());const y=s.zoom!==void 0?+s.zoom:t.zoom+Bn(c,f.lat);t.zoom!==y&&t.setZoom(y)}handleEaseTo(t,s){const c=t.zoom,f=t.center,y=t.padding,T={roll:t.roll,pitch:t.pitch,bearing:t.bearing},z={roll:s.roll===void 0?t.roll:s.roll,pitch:s.pitch===void 0?t.pitch:s.pitch,bearing:s.bearing===void 0?t.bearing:s.bearing},D=s.zoom!==void 0,O=!t.isPaddingEqual(s.padding);let j=!1;const Z=s.center?u.S.convert(s.center):f,U=t.getConstrained(Z,c).center;Xa(t,U);const $=t.clone();$.setCenter(U),$.setZoom(D?+s.zoom:c+Bn(f.lat,Z.lat)),$.setBearing(s.bearing);const J=new u.P(u.ah(t.centerPoint.x+s.offsetAsPoint.x,0,t.width),u.ah(t.centerPoint.y+s.offsetAsPoint.y,0,t.height));$.setLocationAtPoint(U,J);const ct=(s.offset&&s.offsetAsPoint.mag())>0?$.center:U,ot=D?+s.zoom:c+Bn(f.lat,ct.lat),ut=c+Bn(f.lat,0),pt=ot+Bn(ct.lat,0),vt=u.bA(f.lng,ct.lng),mt=u.bA(f.lat,ct.lat),bt=u.af(pt-ut);return j=ot!==c,{easeFunc:At=>{if(u.be(T,z)||or({startEulerAngles:T,endEulerAngles:z,tr:t,k:At,useSlerp:T.roll!=z.roll}),O&&t.interpolatePadding(y,s.padding,At),s.around)u.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(s.around,s.aroundPoint);else{const gt=pt>ut?Math.min(2,bt):Math.max(.5,bt),Lt=Math.pow(gt,1-At),Gt=mu(f,vt,mt,At*Lt);t.setCenter(Gt.wrap())}if(j){const gt=u.C.number(ut,pt,At)+Bn(0,t.center.lat);t.setZoom(gt)}},isZooming:j,elevationCenter:ct}}handleFlyTo(t,s){const c=s.zoom!==void 0,f=t.center,y=t.zoom,T=t.padding,z=!t.isPaddingEqual(s.padding),D=t.getConstrained(u.S.convert(s.center||s.locationAtOffset),y).center,O=c?+s.zoom:t.zoom+Bn(t.center.lat,D.lat),j=t.clone();j.setCenter(D),j.setZoom(O),j.setBearing(s.bearing);const Z=new u.P(u.ah(t.centerPoint.x+s.offsetAsPoint.x,0,t.width),u.ah(t.centerPoint.y+s.offsetAsPoint.y,0,t.height));j.setLocationAtPoint(D,Z);const U=j.center;Xa(t,U);const $=function(mt,bt,At){const gt=pr(bt),Lt=pr(At),Gt=u.aX(gt,Lt),Ot=Math.acos(Gt),Nt=Wa(mt);return Ot/(2*Math.PI)*Nt}(t,f,U),J=y+Bn(f.lat,0),ct=O+Bn(U.lat,0),ot=u.af(ct-J);let ut;if(typeof s.minZoom=="number"){const mt=+s.minZoom+Bn(U.lat,0),bt=Math.min(mt,J,ct)+Bn(0,U.lat),At=t.getConstrained(U,bt).zoom+Bn(U.lat,0);ut=u.af(At-J)}const pt=u.bA(f.lng,U.lng),vt=u.bA(f.lat,U.lat);return{easeFunc:(mt,bt,At,gt)=>{const Lt=mu(f,pt,vt,At);z&&t.interpolatePadding(T,s.padding,mt);const Gt=mt===1?U:Lt;t.setCenter(Gt.wrap());const Ot=J+u.ak(bt);t.setZoom(mt===1?O:Ot+Bn(0,Gt.lat))},scaleOfZoom:ot,targetCenter:U,scaleOfMinZoom:ut,pixelPathLength:$}}static solveVectorScale(t,s,c,f,y){const T=f==="x"?[c[0],c[4],c[8],c[12]]:[c[1],c[5],c[9],c[13]],z=[c[3],c[7],c[11],c[15]],D=t[0]*T[0]+t[1]*T[1]+t[2]*T[2],O=t[0]*z[0]+t[1]*z[1]+t[2]*z[2],j=s[0]*T[0]+s[1]*T[1]+s[2]*T[2],Z=s[0]*z[0]+s[1]*z[1]+s[2]*z[2];return j+y*O===D+y*Z||z[3]*(D-j)+T[3]*(Z-O)+D*Z==j*O?null:(j+T[3]-y*Z-y*z[3])/(j-D-y*Z+y*O)}static getLesserNonNegativeNonNull(t,s){return s!==null&&s>=0&&s<t?s:t}}class kc{constructor(t){this._globe=t,this._mercatorCameraHelper=new _n,this._verticalPerspectiveCameraHelper=new Mr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,s){return this.currentHelper.handlePanInertia(t,s)}handleMapControlsRollPitchBearingZoom(t,s){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,s)}handleMapControlsPan(t,s,c){this.currentHelper.handleMapControlsPan(t,s,c)}cameraForBoxAndBearing(t,s,c,f,y){return this.currentHelper.cameraForBoxAndBearing(t,s,c,f,y)}handleJumpToCenterZoom(t,s){this.currentHelper.handleJumpToCenterZoom(t,s)}handleEaseTo(t,s){return this.currentHelper.handleEaseTo(t,s)}handleFlyTo(t,s){return this.currentHelper.handleFlyTo(t,s)}}const Bc=(g,t)=>u.y(g,t&&t.filter(s=>s.identifier!=="source.canvas")),Ih=u.bE();class ec extends u.E{constructor(t,s={}){super(),this._rtlPluginLoaded=()=>{for(const c in this.sourceCaches){const f=this.sourceCaches[c].getSource().type;f!=="vector"&&f!=="geojson"||this.sourceCaches[c].reload()}},this.map=t,this.dispatcher=new Se(Fe(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",(c,f)=>this.getGlyphs(c,f)),this.dispatcher.registerMessageHandler("GI",(c,f)=>this.getImages(c,f)),this.imageManager=new Ei,this.imageManager.setEventedParent(this),this.glyphManager=new Ir(t._requestManager,s.localIdeographFontFamily),this.lineAtlas=new Ze(256,512),this.crossTileSymbolIndex=new bs,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",u.bG()),Vn().on(Go,this._rtlPluginLoaded),this.on("data",c=>{if(c.dataType!=="source"||c.sourceDataType!=="metadata")return;const f=this.sourceCaches[c.sourceId];if(!f)return;const y=f.getSource();if(y&&y.vectorLayerIds)for(const T in this._layers){const z=this._layers[T];z.source===y.id&&this._validateLayer(z)}})}setGlobalStateProperty(t,s){var c,f,y;this._checkLoaded();const T=s===null?(y=(f=(c=this.stylesheet.state)===null||c===void 0?void 0:c[t])===null||f===void 0?void 0:f.default)!==null&&y!==void 0?y:null:s;if(u.bH(T,this._globalState[t]))return this;this._globalState[t]=T;const z=this._findGlobalStateAffectedSources([t]);for(const D in this.sourceCaches)z.has(D)&&(this._reloadSource(D),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const s=[];for(const f in t)!u.bH(this._globalState[f],t[f].default)&&(s.push(f),this._globalState[f]=t[f].default);const c=this._findGlobalStateAffectedSources(s);for(const f in this.sourceCaches)c.has(f)&&(this._reloadSource(f),this._changed=!0)}_findGlobalStateAffectedSources(t){if(t.length===0)return new Set;const s=new Set;for(const c in this._layers){const f=this._layers[c],y=f.getLayoutAffectingGlobalStateRefs();for(const T of t)y.has(T)&&s.add(f.source)}return s}loadURL(t,s={},c){this.fire(new u.l("dataloading",{dataType:"style"})),s.validate=typeof s.validate!="boolean"||s.validate;const f=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const y=this._loadStyleRequest;u.j(f,this._loadStyleRequest).then(T=>{this._loadStyleRequest=null,this._load(T.data,s,c)}).catch(T=>{this._loadStyleRequest=null,T&&!y.signal.aborted&&this.fire(new u.k(T))})}loadJSON(t,s={},c){this.fire(new u.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ht.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,s.validate=s.validate!==!1,this._load(t,s,c)}).catch(()=>{})}loadEmpty(){this.fire(new u.l("dataloading",{dataType:"style"})),this._load(Ih,{validate:!1})}_load(t,s,c){var f,y,T;const z=s.transformStyle?s.transformStyle(c,t):t;if(!s.validate||!Bc(this,u.z(z))){this._loaded=!0,this.stylesheet=z;for(const D in z.sources)this.addSource(D,z.sources[D],{validate:!1});z.sprite?this._loadSprite(z.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(z.glyphs),this._createLayers(),this.light=new Qt(this.stylesheet.light),this._setProjectionInternal(((f=this.stylesheet.projection)===null||f===void 0?void 0:f.type)||"mercator"),this.sky=new fe(this.stylesheet.sky),this.map.setTerrain((y=this.stylesheet.terrain)!==null&&y!==void 0?y:null),this.setGlobalState((T=this.stylesheet.state)!==null&&T!==void 0?T:null),this.fire(new u.l("data",{dataType:"style"})),this.fire(new u.l("style.load"))}}_createLayers(){const t=u.bI(this.stylesheet.layers);this.dispatcher.broadcast("SL",t),this._order=t.map(s=>s.id),this._layers={},this._serializedLayers=null;for(const s of t){const c=u.bJ(s);c.setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=c}}_loadSprite(t,s=!1,c=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(y,T,z,D){return u._(this,void 0,void 0,function*(){const O=Ve(y),j=z>1?"@2x":"",Z={},U={};for(const{id:$,url:J}of O){const ct=T.transformRequest(Je(J,j,".json"),"SpriteJSON");Z[$]=u.j(ct,D);const ot=T.transformRequest(Je(J,j,".png"),"SpriteImage");U[$]=Ne.getImage(ot,D)}return yield Promise.all([...Object.values(Z),...Object.values(U)]),function($,J){return u._(this,void 0,void 0,function*(){const ct={};for(const ot in $){ct[ot]={};const ut=ht.getImageCanvasContext((yield J[ot]).data),pt=(yield $[ot]).data;for(const vt in pt){const{width:mt,height:bt,x:At,y:gt,sdf:Lt,pixelRatio:Gt,stretchX:Ot,stretchY:Nt,content:Ut,textFitWidth:_e,textFitHeight:ve}=pt[vt];ct[ot][vt]={data:null,pixelRatio:Gt,sdf:Lt,stretchX:Ot,stretchY:Nt,content:Ut,textFitWidth:_e,textFitHeight:ve,spriteData:{width:mt,height:bt,x:At,y:gt,context:ut}}}}return ct})}(Z,U)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(y=>{if(this._spriteRequest=null,y)for(const T in y){this._spritesImagesIds[T]=[];const z=this._spritesImagesIds[T]?this._spritesImagesIds[T].filter(D=>!(D in y)):[];for(const D of z)this.imageManager.removeImage(D),this._changedImages[D]=!0;for(const D in y[T]){const O=T==="default"?D:`${T}:${D}`;this._spritesImagesIds[T].push(O),O in this.imageManager.images?this.imageManager.updateImage(O,y[T][D],!1):this.imageManager.addImage(O,y[T][D]),s&&(this._changedImages[O]=!0)}}}).catch(y=>{this._spriteRequest=null,f=y,this.fire(new u.k(f))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),s&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"})),c&&c(f)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"}))}_validateLayer(t){const s=this.sourceCaches[t.source];if(!s)return;const c=t.sourceLayer;if(!c)return;const f=s.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(c)===-1)&&this.fire(new u.k(new Error(`Source layer "${c}" does not exist on source "${f.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,s=!1){const c=this._serializedAllLayers();if(!t||t.length===0)return Object.values(s?u.bK(c):c);const f=[];for(const y of t)if(c[y]){const T=s?u.bK(c[y]):c[y];f.push(T)}return f}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const s=Object.keys(this._layers);for(const c of s){const f=this._layers[c];f.type!=="custom"&&(t[c]=f.serialize())}return t}hasTransitions(){var t,s,c;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((s=this.sky)===null||s===void 0)&&s.hasTransition()||!((c=this.projection)===null||c===void 0)&&c.hasTransition())return!0;for(const f in this.sourceCaches)if(this.sourceCaches[f].hasTransition())return!0;for(const f in this._layers)if(this._layers[f].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const s=this._changed;if(s){const f=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(f.length||y.length)&&this._updateWorkerLayers(f,y);for(const T in this._updatedSources){const z=this._updatedSources[T];if(z==="reload")this._reloadSource(T);else{if(z!=="clear")throw new Error(`Invalid action ${z}`);this._clearSource(T)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const T in this._updatedPaintProps)this._layers[T].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const c={};for(const f in this.sourceCaches){const y=this.sourceCaches[f];c[f]=y.used,y.used=!1}for(const f of this._order){const y=this._layers[f];y.recalculate(t,this._availableImages),!y.isHidden(t.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const f in c){const y=this.sourceCaches[f];!!c[f]!=!!y.used&&y.fire(new u.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,s&&this.fire(new u.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,s){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,s={}){var c;this._checkLoaded();const f=this.serialize();if(t=s.transformStyle?s.transformStyle(f,t):t,((c=s.validate)===null||c===void 0||c)&&Bc(this,u.z(t)))return!1;(t=u.bK(t)).layers=u.bI(t.layers);const y=u.bL(f,t),T=this._getOperationsToPerform(y);if(T.unimplemented.length>0)throw new Error(`Unimplemented: ${T.unimplemented.join(", ")}.`);if(T.operations.length===0)return!1;for(const z of T.operations)z();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const s=[],c=[];for(const f of t)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":s.push(()=>this.addLayer.apply(this,f.args));break;case"removeLayer":s.push(()=>this.removeLayer.apply(this,f.args));break;case"setPaintProperty":s.push(()=>this.setPaintProperty.apply(this,f.args));break;case"setLayoutProperty":s.push(()=>this.setLayoutProperty.apply(this,f.args));break;case"setFilter":s.push(()=>this.setFilter.apply(this,f.args));break;case"addSource":s.push(()=>this.addSource.apply(this,f.args));break;case"removeSource":s.push(()=>this.removeSource.apply(this,f.args));break;case"setLayerZoomRange":s.push(()=>this.setLayerZoomRange.apply(this,f.args));break;case"setLight":s.push(()=>this.setLight.apply(this,f.args));break;case"setGeoJSONSourceData":s.push(()=>this.setGeoJSONSourceData.apply(this,f.args));break;case"setGlyphs":s.push(()=>this.setGlyphs.apply(this,f.args));break;case"setSprite":s.push(()=>this.setSprite.apply(this,f.args));break;case"setTerrain":s.push(()=>this.map.setTerrain.apply(this,f.args));break;case"setSky":s.push(()=>this.setSky.apply(this,f.args));break;case"setProjection":this.setProjection.apply(this,f.args);break;case"setGlobalState":s.push(()=>this.setGlobalState.apply(this,f.args));break;case"setTransition":s.push(()=>{});break;default:c.push(f.command)}return{operations:s,unimplemented:c}}addImage(t,s){if(this.getImage(t))return this.fire(new u.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,s),this._afterImageUpdated(t)}updateImage(t,s){this.imageManager.updateImage(t,s)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new u.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,s,c={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(u.z.source,`sources.${t}`,s,null,c))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const f=this.sourceCaches[t]=new bi(t,s,this.dispatcher);f.style=this,f.setEventedParent(this,()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:t})),f.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===t)return this.fire(new u.k(new Error(`Source "${t}" cannot be removed while layer "${c}" is using it.`)));const s=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],s.fire(new u.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,s){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const c=this.sourceCaches[t].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(s),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,s,c={}){this._checkLoaded();const f=t.id;if(this.getLayer(f))return void this.fire(new u.k(new Error(`Layer "${f}" already exists on this map.`)));let y;if(t.type==="custom"){if(Bc(this,u.bM(t)))return;y=u.bJ(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(f,t.source),t=u.bK(t),t=u.e(t,{source:f})),this._validate(u.z.layer,`layers.${f}`,t,{arrayIndex:-1},c))return;y=u.bJ(t),this._validateLayer(y),y.setEventedParent(this,{layer:{id:f}})}const T=s?this._order.indexOf(s):this._order.length;if(s&&T===-1)this.fire(new u.k(new Error(`Cannot add layer "${f}" before non-existing layer "${s}".`)));else{if(this._order.splice(T,0,f),this._layerOrderChanged=!0,this._layers[f]=y,this._removedLayers[f]&&y.source&&y.type!=="custom"){const z=this._removedLayers[f];delete this._removedLayers[f],z.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(t,s){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new u.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===s)return;const c=this._order.indexOf(t);this._order.splice(c,1);const f=s?this._order.indexOf(s):this._order.length;s&&f===-1?this.fire(new u.k(new Error(`Cannot move layer "${t}" before non-existing layer "${s}".`))):(this._order.splice(f,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const s=this._layers[t];if(!s)return void this.fire(new u.k(new Error(`Cannot remove non-existing layer "${t}".`)));s.setEventedParent(null);const c=this._order.indexOf(t);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=s,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],s.onRemove&&s.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,s,c){this._checkLoaded();const f=this.getLayer(t);f?f.minzoom===s&&f.maxzoom===c||(s!=null&&(f.minzoom=s),c!=null&&(f.maxzoom=c),this._updateLayer(f)):this.fire(new u.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,s,c={}){this._checkLoaded();const f=this.getLayer(t);if(f){if(!u.bH(f.filter,s))return s==null?(f.setFilter(void 0),void this._updateLayer(f)):void(this._validate(u.z.filter,`layers.${f.id}.filter`,s,null,c)||(f.setFilter(u.bK(s)),this._updateLayer(f)))}else this.fire(new u.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return u.bK(this.getLayer(t).filter)}setLayoutProperty(t,s,c,f={}){this._checkLoaded();const y=this.getLayer(t);y?u.bH(y.getLayoutProperty(s),c)||(y.setLayoutProperty(s,c,f),this._updateLayer(y)):this.fire(new u.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,s){const c=this.getLayer(t);if(c)return c.getLayoutProperty(s);this.fire(new u.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,s,c,f={}){this._checkLoaded();const y=this.getLayer(t);y?u.bH(y.getPaintProperty(s),c)||(y.setPaintProperty(s,c,f)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[t]=!0,this._serializedLayers=null):this.fire(new u.k(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,s){return this.getLayer(t).getPaintProperty(s)}setFeatureState(t,s){this._checkLoaded();const c=t.source,f=t.sourceLayer,y=this.sourceCaches[c];if(y===void 0)return void this.fire(new u.k(new Error(`The source '${c}' does not exist in the map's style.`)));const T=y.getSource().type;T==="geojson"&&f?this.fire(new u.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):T!=="vector"||f?(t.id===void 0&&this.fire(new u.k(new Error("The feature id parameter must be provided."))),y.setFeatureState(f,t.id,s)):this.fire(new u.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,s){this._checkLoaded();const c=t.source,f=this.sourceCaches[c];if(f===void 0)return void this.fire(new u.k(new Error(`The source '${c}' does not exist in the map's style.`)));const y=f.getSource().type,T=y==="vector"?t.sourceLayer:void 0;y!=="vector"||T?s&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new u.k(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(T,t.id,s):this.fire(new u.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const s=t.source,c=t.sourceLayer,f=this.sourceCaches[s];if(f!==void 0)return f.getSource().type!=="vector"||c?(t.id===void 0&&this.fire(new u.k(new Error("The feature id parameter must be provided."))),f.getFeatureState(c,t.id)):void this.fire(new u.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.k(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return u.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=u.bN(this.sourceCaches,y=>y.serialize()),s=this._serializeByIds(this._order,!0),c=this.map.getTerrain()||void 0,f=this.stylesheet;return u.bO({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,projection:f.projection,sources:t,layers:s,terrain:c},y=>y!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const s=T=>this._layers[T].type==="fill-extrusion",c={},f=[];for(let T=this._order.length-1;T>=0;T--){const z=this._order[T];if(s(z)){c[z]=T;for(const D of t){const O=D[z];if(O)for(const j of O)f.push(j)}}}f.sort((T,z)=>z.intersectionZ-T.intersectionZ);const y=[];for(let T=this._order.length-1;T>=0;T--){const z=this._order[T];if(s(z))for(let D=f.length-1;D>=0;D--){const O=f[D].feature;if(c[O.layer.id]<T)break;y.push(O),f.pop()}else for(const D of t){const O=D[z];if(O)for(const j of O)y.push(j.feature)}}return y}queryRenderedFeatures(t,s,c){s&&s.filter&&this._validate(u.z.filter,"queryRenderedFeatures.filter",s.filter,null,s);const f={};if(s&&s.layers){if(!(Array.isArray(s.layers)||s.layers instanceof Set))return this.fire(new u.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const O of s.layers){const j=this._layers[O];if(!j)return this.fire(new u.k(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];f[j.source]=!0}}const y=[];s.availableImages=this._availableImages;const T=this._serializedAllLayers(),z=s.layers instanceof Set?s.layers:Array.isArray(s.layers)?new Set(s.layers):null,D=Object.assign(Object.assign({},s),{layers:z});for(const O in this.sourceCaches)s.layers&&!f[O]||y.push(rr(this.sourceCaches[O],this._layers,T,t,D,c,this.map.terrain?(j,Z,U)=>this.map.terrain.getElevation(j,Z,U):void 0));return this.placement&&y.push(function(O,j,Z,U,$,J,ct){const ot={},ut=J.queryRenderedSymbols(U),pt=[];for(const vt of Object.keys(ut).map(Number))pt.push(ct[vt]);pt.sort(da);for(const vt of pt){const mt=vt.featureIndex.lookupSymbolFeatures(ut[vt.bucketInstanceId],j,vt.bucketIndex,vt.sourceLayerIndex,$.filter,$.layers,$.availableImages,O);for(const bt in mt){const At=ot[bt]=ot[bt]||[],gt=mt[bt];gt.sort((Lt,Gt)=>{const Ot=vt.featureSortOrder;if(Ot){const Nt=Ot.indexOf(Lt.featureIndex);return Ot.indexOf(Gt.featureIndex)-Nt}return Gt.featureIndex-Lt.featureIndex});for(const Lt of gt)At.push(Lt)}}return function(vt,mt,bt){for(const At in vt)for(const gt of vt[At])Ws(gt,bt[mt[At].source]);return vt}(ot,O,Z)}(this._layers,T,this.sourceCaches,t,D,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(t,s){s&&s.filter&&this._validate(u.z.filter,"querySourceFeatures.filter",s.filter,null,s);const c=this.sourceCaches[t];return c?function(f,y){const T=f.getRenderableIds().map(O=>f.getTileByID(O)),z=[],D={};for(let O=0;O<T.length;O++){const j=T[O],Z=j.tileID.canonical.key;D[Z]||(D[Z]=!0,j.querySourceFeatures(z,y))}return z}(c,s):[]}getLight(){return this.light.getLight()}setLight(t,s={}){this._checkLoaded();const c=this.light.getLight();let f=!1;for(const T in t)if(!u.bH(t[T],c[T])){f=!0;break}if(!f)return;const y={now:ht.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,s),this.light.updateTransitions(y)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,s={}){this._checkLoaded();const c=this.getSky();let f=!1;if(!t&&!c)return;if(t&&!c)f=!0;else if(!t&&c)f=!0;else for(const T in t)if(!u.bH(t[T],c[T])){f=!0;break}if(!f)return;const y={now:ht.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,s),this.sky.updateTransitions(y)}_setProjectionInternal(t){const s=function(c){if(Array.isArray(c)){const f=new Sr({type:c});return{projection:f,transform:new tc,cameraHelper:new kc(f)}}switch(c){case"mercator":return{projection:new di,transform:new ti,cameraHelper:new _n};case"globe":{const f=new Sr({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:f,transform:new tc,cameraHelper:new kc(f)}}case"vertical-perspective":return{projection:new Mi,transform:new Xo,cameraHelper:new Mr};default:return u.w(`Unknown projection name: ${c}. Falling back to mercator projection.`),{projection:new di,transform:new ti,cameraHelper:new _n}}}(t);this.projection=s.projection,this.map.migrateProjection(s.transform,s.cameraHelper);for(const c in this.sourceCaches)this.sourceCaches[c].reload()}_validate(t,s,c,f,y={}){return(!y||y.validate!==!1)&&Bc(this,t.call(u.z,u.e({key:s,style:this.serialize(),value:c,styleSpec:u.v},f)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Vn().off(Go,this._rtlPluginLoaded);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this.sourceCaches){const c=this.sourceCaches[s];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const s in this.sourceCaches)this.sourceCaches[s].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,s,c,f,y=!1){let T=!1,z=!1;const D={};for(const O of this._order){const j=this._layers[O];if(j.type!=="symbol")continue;if(!D[j.source]){const U=this.sourceCaches[j.source];D[j.source]=U.getRenderableIds(!0).map($=>U.getTileByID($)).sort(($,J)=>J.tileID.overscaledZ-$.tileID.overscaledZ||($.tileID.isLessThan(J.tileID)?-1:1))}const Z=this.crossTileSymbolIndex.addLayer(j,D[j.source],t.center.lng);T=T||Z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ht.now(),t.zoom))&&(this.pauseablePlacement=new Rr(t,this.map.terrain,this._order,y,s,c,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,D),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(ht.now()),z=!0),T&&this.pauseablePlacement.placement.setStale()),z||T)for(const O of this._order){const j=this._layers[O];j.type==="symbol"&&this.placement.updateLayerOpacities(j,D[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ht.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,s){return u._(this,void 0,void 0,function*(){const c=yield this.imageManager.getImages(s.icons);this._updateTilesForChangedImages();const f=this.sourceCaches[s.source];return f&&f.setDependencies(s.tileID.key,s.type,s.icons),c})}getGlyphs(t,s){return u._(this,void 0,void 0,function*(){const c=yield this.glyphManager.getGlyphs(s.stacks),f=this.sourceCaches[s.source];return f&&f.setDependencies(s.tileID.key,s.type,[""]),c})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,s={}){this._checkLoaded(),t&&this._validate(u.z.glyphs,"glyphs",t,null,s)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,s,c={},f){this._checkLoaded();const y=[{id:t,url:s}],T=[...Ve(this.stylesheet.sprite),...y];this._validate(u.z.sprite,"sprite",T,null,c)||(this.stylesheet.sprite=T,this._loadSprite(y,!0,f))}removeSprite(t){this._checkLoaded();const s=Ve(this.stylesheet.sprite);if(s.find(c=>c.id===t)){if(this._spritesImagesIds[t])for(const c of this._spritesImagesIds[t])this.imageManager.removeImage(c),this._changedImages[c]=!0;s.splice(s.findIndex(c=>c.id===t),1),this.stylesheet.sprite=s.length>0?s:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"}))}else this.fire(new u.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return Ve(this.stylesheet.sprite)}setSprite(t,s={},c){this._checkLoaded(),t&&this._validate(u.z.sprite,"sprite",t,null,s)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,c):(this._unloadSprite(),c&&c(null)))}}var Rh=u.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Yu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,s,c,f,y,T,z,D,O){this.context=t;let j=this.boundPaintVertexBuffers.length!==f.length;for(let Z=0;!j&&Z<f.length;Z++)this.boundPaintVertexBuffers[Z]!==f[Z]&&(j=!0);!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==c||j||this.boundIndexBuffer!==y||this.boundVertexOffset!==T||this.boundDynamicVertexBuffer!==z||this.boundDynamicVertexBuffer2!==D||this.boundDynamicVertexBuffer3!==O?this.freshBind(s,c,f,y,T,z,D,O):(t.bindVertexArray.set(this.vao),z&&z.bind(),y&&y.dynamicDraw&&y.bind(),D&&D.bind(),O&&O.bind())}freshBind(t,s,c,f,y,T,z,D){const O=t.numAttributes,j=this.context,Z=j.gl;this.vao&&this.destroy(),this.vao=j.createVertexArray(),j.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=f,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=T,this.boundDynamicVertexBuffer2=z,this.boundDynamicVertexBuffer3=D,s.enableAttributes(Z,t);for(const U of c)U.enableAttributes(Z,t);T&&T.enableAttributes(Z,t),z&&z.enableAttributes(Z,t),D&&D.enableAttributes(Z,t),s.bind(),s.setVertexAttribPointers(Z,t,y);for(const U of c)U.bind(),U.setVertexAttribPointers(Z,t,y);T&&(T.bind(),T.setVertexAttribPointers(Z,t,y)),f&&f.bind(),z&&(z.bind(),z.setVertexAttribPointers(Z,t,y)),D&&(D.bind(),D.setVertexAttribPointers(Z,t,y)),j.currentNumAttributes=O}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const ic=(g,t,s,c,f)=>({u_texture:0,u_ele_delta:g,u_fog_matrix:t,u_fog_color:s?s.properties.get("fog-color"):u.bf.white,u_fog_ground_blend:s?s.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:f?0:s?s.calculateFogBlendOpacity(c):0,u_horizon_color:s?s.properties.get("horizon-color"):u.bf.white,u_horizon_fog_blend:s?s.properties.get("horizon-fog-blend"):1,u_is_globe_mode:f?1:0}),vl={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function ws(g){const t=[];for(let s=0;s<g.length;s++){if(g[s]===null)continue;const c=g[s].split(" ");t.push(c.pop())}return t}class _u{constructor(t,s,c,f,y,T,z,D,O=[]){const j=t.gl;this.program=j.createProgram();const Z=ws(s.staticAttributes),U=c?c.getBinderAttributes():[],$=Z.concat(U),J=Ur.prelude.staticUniforms?ws(Ur.prelude.staticUniforms):[],ct=z.staticUniforms?ws(z.staticUniforms):[],ot=s.staticUniforms?ws(s.staticUniforms):[],ut=c?c.getBinderUniforms():[],pt=J.concat(ct).concat(ot).concat(ut),vt=[];for(const Ot of pt)vt.indexOf(Ot)<0&&vt.push(Ot);const mt=c?c.defines():[];kr(j)&&mt.unshift("#version 300 es"),y&&mt.push("#define OVERDRAW_INSPECTOR;"),T&&mt.push("#define TERRAIN3D;"),D&&mt.push(D),O&&mt.push(...O);let bt=mt.concat(Ur.prelude.fragmentSource,z.fragmentSource,s.fragmentSource).join(`
`),At=mt.concat(Ur.prelude.vertexSource,z.vertexSource,s.vertexSource).join(`
`);kr(j)||(bt=function(Ot){return Ot.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(bt),At=function(Ot){return Ot.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(At));const gt=j.createShader(j.FRAGMENT_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource(gt,bt),j.compileShader(gt),!j.getShaderParameter(gt,j.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${j.getShaderInfoLog(gt)}`);j.attachShader(this.program,gt);const Lt=j.createShader(j.VERTEX_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource(Lt,At),j.compileShader(Lt),!j.getShaderParameter(Lt,j.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${j.getShaderInfoLog(Lt)}`);j.attachShader(this.program,Lt),this.attributes={};const Gt={};this.numAttributes=$.length;for(let Ot=0;Ot<this.numAttributes;Ot++)$[Ot]&&(j.bindAttribLocation(this.program,Ot,$[Ot]),this.attributes[$[Ot]]=Ot);if(j.linkProgram(this.program),!j.getProgramParameter(this.program,j.LINK_STATUS))throw new Error(`Program failed to link: ${j.getProgramInfoLog(this.program)}`);j.deleteShader(Lt),j.deleteShader(gt);for(let Ot=0;Ot<vt.length;Ot++){const Nt=vt[Ot];if(Nt&&!Gt[Nt]){const Ut=j.getUniformLocation(this.program,Nt);Ut&&(Gt[Nt]=Ut)}}this.fixedUniforms=f(t,Gt),this.terrainUniforms=((Ot,Nt)=>({u_depth:new u.bP(Ot,Nt.u_depth),u_terrain:new u.bP(Ot,Nt.u_terrain),u_terrain_dim:new u.bg(Ot,Nt.u_terrain_dim),u_terrain_matrix:new u.bR(Ot,Nt.u_terrain_matrix),u_terrain_unpack:new u.bS(Ot,Nt.u_terrain_unpack),u_terrain_exaggeration:new u.bg(Ot,Nt.u_terrain_exaggeration)}))(t,Gt),this.projectionUniforms=((Ot,Nt)=>({u_projection_matrix:new u.bR(Ot,Nt.u_projection_matrix),u_projection_tile_mercator_coords:new u.bS(Ot,Nt.u_projection_tile_mercator_coords),u_projection_clipping_plane:new u.bS(Ot,Nt.u_projection_clipping_plane),u_projection_transition:new u.bg(Ot,Nt.u_projection_transition),u_projection_fallback_matrix:new u.bR(Ot,Nt.u_projection_fallback_matrix)}))(t,Gt),this.binderUniforms=c?c.getUniforms(t,Gt):[]}draw(t,s,c,f,y,T,z,D,O,j,Z,U,$,J,ct,ot,ut,pt,vt){const mt=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(c),t.setStencilMode(f),t.setColorMode(y),t.setCullFace(T),D){t.activeTexture.set(mt.TEXTURE2),mt.bindTexture(mt.TEXTURE_2D,D.depthTexture),t.activeTexture.set(mt.TEXTURE3),mt.bindTexture(mt.TEXTURE_2D,D.texture);for(const At in this.terrainUniforms)this.terrainUniforms[At].set(D[At])}if(O)for(const At in O)this.projectionUniforms[vl[At]].set(O[At]);if(z)for(const At in this.fixedUniforms)this.fixedUniforms[At].set(z[At]);ot&&ot.setUniforms(t,this.binderUniforms,J,{zoom:ct});let bt=0;switch(s){case mt.LINES:bt=2;break;case mt.TRIANGLES:bt=3;break;case mt.LINE_STRIP:bt=1}for(const At of $.get()){const gt=At.vaos||(At.vaos={});(gt[j]||(gt[j]=new Yu)).bind(t,this,Z,ot?ot.getPaintVertexBuffers():[],U,At.vertexOffset,ut,pt,vt),mt.drawElements(s,At.primitiveLength*bt,mt.UNSIGNED_SHORT,At.primitiveOffset*bt*2)}}}function wa(g,t,s){const c=1/u.aC(s,1,t.transform.tileZoom),f=Math.pow(2,s.tileID.overscaledZ),y=s.tileSize*Math.pow(2,t.transform.tileZoom)/f,T=y*(s.tileID.canonical.x+s.tileID.wrap*f),z=y*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[c,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[T>>16,z>>16],u_pixel_coord_lower:[65535&T,65535&z]}}const ln=(g,t,s,c)=>{const f=g.style.light,y=f.properties.get("position"),T=[y.x,y.y,y.z],z=u.bV();f.properties.get("anchor")==="viewport"&&u.bW(z,g.transform.bearingInRadians),u.bX(T,T,z);const D=g.transform.transformLightDirection(T),O=f.properties.get("color");return{u_lightpos:T,u_lightpos_globe:D,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[O.r,O.g,O.b],u_vertical_gradient:+t,u_opacity:s,u_fill_translate:c}},Wu=(g,t,s,c,f,y,T)=>u.e(ln(g,t,s,c),wa(y,g,T),{u_height_factor:-Math.pow(2,f.overscaledZ)/T.tileSize/8}),xl=(g,t,s,c)=>u.e(wa(t,g,s),{u_fill_translate:c}),bl=(g,t)=>({u_world:g,u_fill_translate:t}),Eo=(g,t,s,c,f)=>u.e(xl(g,t,s,f),{u_world:c}),Oc=(g,t,s,c,f)=>{const y=g.transform;let T,z,D=0;if(s.paint.get("circle-pitch-alignment")==="map"){const O=u.aC(t,1,y.zoom);T=!0,z=[O,O],D=O/(u.$*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*f}else T=!1,z=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(s.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+T,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:z,u_globe_extrude_scale:D,u_translate:c}},nc=g=>({u_pixel_extrude_scale:[1/g.width,1/g.height]}),wl=g=>({u_viewport_size:[g.width,g.height]}),zo=(g,t=1)=>({u_color:g,u_overlay:0,u_overlay_scale:t}),Ku=(g,t,s,c)=>{const f=u.aC(g,1,t)/(u.$*Math.pow(2,g.tileID.overscaledZ))*2*Math.PI*c;return{u_extrude_scale:u.aC(g,1,t),u_intensity:s,u_globe_extrude_scale:f}},Ts=(g,t,s,c)=>{const f=u.L();u.bY(f,0,g.width,g.height,0,0,1);const y=g.context.gl;return{u_matrix:f,u_world:[y.drawingBufferWidth,y.drawingBufferHeight],u_image:s,u_color_ramp:c,u_opacity:t.paint.get("heatmap-opacity")}},Yo=(g,t,s)=>{const c=s.paint.get("hillshade-accent-color");let f;switch(s.paint.get("hillshade-method")){case"basic":f=4;break;case"combined":f=1;break;case"igor":f=2;break;case"multidirectional":f=3;break;default:f=0}const y=s.getIlluminationProperties();for(let T=0;T<y.directionRadians.length;T++)s.paint.get("hillshade-illumination-anchor")==="viewport"&&(y.directionRadians[T]+=g.transform.bearingInRadians);return{u_image:0,u_latrange:Zr(0,t.tileID),u_exaggeration:s.paint.get("hillshade-exaggeration"),u_altitudes:y.altitudeRadians,u_azimuths:y.directionRadians,u_accent:c,u_method:f,u_highlights:y.highlightColor,u_shadows:y.shadowColor}},gu=(g,t)=>{const s=t.stride,c=u.L();return u.bY(c,0,u.$,-u.$,0,0,1),u.M(c,c,[0,-u.$,0]),{u_matrix:c,u_image:1,u_dimension:[s,s],u_zoom:g.overscaledZ,u_unpack:t.getUnpackVector()}};function Zr(g,t){const s=Math.pow(2,t.canonical.z),c=t.canonical.y;return[new u.a1(0,c/s).toLngLat().lat,new u.a1(0,(c+1)/s).toLngLat().lat]}const Tl=(g,t,s=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:s,u_opacity:g.paint.get("color-relief-opacity")}),Ka=(g,t,s,c)=>{const f=g.transform;return{u_translation:sc(g,t,s),u_ratio:c/u.aC(t,1,f.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},rc=(g,t,s,c,f)=>u.e(Ka(g,t,s,c),{u_image:0,u_image_height:f}),Wo=(g,t,s,c,f)=>{const y=g.transform,T=Do(t,y);return{u_translation:sc(g,t,s),u_texsize:t.imageAtlasTexture.size,u_ratio:c/u.aC(t,1,y.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[T,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Qa=(g,t,s,c,f,y)=>{const T=g.lineAtlas,z=Do(t,g.transform),D=s.layout.get("line-cap")==="round",O=T.getDash(f.from,D),j=T.getDash(f.to,D),Z=O.width*y.fromScale,U=j.width*y.toScale;return u.e(Ka(g,t,s,c),{u_patternscale_a:[z/Z,-O.height/2],u_patternscale_b:[z/U,-j.height/2],u_sdfgamma:T.width/(256*Math.min(Z,U)*g.pixelRatio)/2,u_image:0,u_tex_y_a:O.y,u_tex_y_b:j.y,u_mix:y.t})};function Do(g,t){return 1/u.aC(g,1,t.tileZoom)}function sc(g,t,s){return u.aD(g.transform,t,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const Ss=(g,t,s,c,f)=>{return{u_tl_parent:g,u_scale_parent:t,u_buffer_scale:1,u_fade_t:s.mix,u_opacity:s.opacity*c.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:c.paint.get("raster-brightness-min"),u_brightness_high:c.paint.get("raster-brightness-max"),u_saturation_factor:(T=c.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(y=c.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:ac(c.paint.get("raster-hue-rotate")),u_coords_top:[f[0].x,f[0].y,f[1].x,f[1].y],u_coords_bottom:[f[3].x,f[3].y,f[2].x,f[2].y]};var y,T};function ac(g){g*=Math.PI/180;const t=Math.sin(g),s=Math.cos(g);return[(2*s+1)/3,(-Math.sqrt(3)*t-s+1)/3,(Math.sqrt(3)*t-s+1)/3]}const Sl=(g,t,s,c,f,y,T,z,D,O,j,Z,U)=>{const $=T.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:$.cameraToCenterDistance,u_pitch:$.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:$.width/$.height,u_fade_change:T.options.fadeDuration?T.symbolFadeChange:1,u_label_plane_matrix:z,u_coord_matrix:D,u_is_text:+j,u_pitch_with_map:+c,u_is_along_line:f,u_is_variable_anchor:y,u_texsize:Z,u_texture:0,u_translation:O,u_pitched_scale:U}},Nc=(g,t,s,c,f,y,T,z,D,O,j,Z,U,$)=>{const J=T.transform;return u.e(Sl(g,t,s,c,f,y,T,z,D,O,j,Z,$),{u_gamma_scale:c?Math.cos(J.pitch*Math.PI/180)*J.cameraToCenterDistance:1,u_device_pixel_ratio:T.pixelRatio,u_is_halo:1})},kh=(g,t,s,c,f,y,T,z,D,O,j,Z,U)=>u.e(Nc(g,t,s,c,f,y,T,z,D,O,!0,j,0,U),{u_texsize_icon:Z,u_texture_icon:1}),Ta=(g,t)=>({u_opacity:g,u_color:t}),Qu=(g,t,s,c,f)=>u.e(function(y,T,z,D){const O=z.imageManager.getPattern(y.from.toString()),j=z.imageManager.getPattern(y.to.toString()),{width:Z,height:U}=z.imageManager.getPixelSize(),$=Math.pow(2,D.tileID.overscaledZ),J=D.tileSize*Math.pow(2,z.transform.tileZoom)/$,ct=J*(D.tileID.canonical.x+D.tileID.wrap*$),ot=J*D.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:O.tl,u_pattern_br_a:O.br,u_pattern_tl_b:j.tl,u_pattern_br_b:j.br,u_texsize:[Z,U],u_mix:T.t,u_pattern_size_a:O.displaySize,u_pattern_size_b:j.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/u.aC(D,1,z.transform.tileZoom),u_pixel_coord_upper:[ct>>16,ot>>16],u_pixel_coord_lower:[65535&ct,65535&ot]}}(s,f,t,c),{u_opacity:g}),Lo=(g,t)=>{},Gr={fillExtrusion:(g,t)=>({u_lightpos:new u.bT(g,t.u_lightpos),u_lightpos_globe:new u.bT(g,t.u_lightpos_globe),u_lightintensity:new u.bg(g,t.u_lightintensity),u_lightcolor:new u.bT(g,t.u_lightcolor),u_vertical_gradient:new u.bg(g,t.u_vertical_gradient),u_opacity:new u.bg(g,t.u_opacity),u_fill_translate:new u.bU(g,t.u_fill_translate)}),fillExtrusionPattern:(g,t)=>({u_lightpos:new u.bT(g,t.u_lightpos),u_lightpos_globe:new u.bT(g,t.u_lightpos_globe),u_lightintensity:new u.bg(g,t.u_lightintensity),u_lightcolor:new u.bT(g,t.u_lightcolor),u_vertical_gradient:new u.bg(g,t.u_vertical_gradient),u_height_factor:new u.bg(g,t.u_height_factor),u_opacity:new u.bg(g,t.u_opacity),u_fill_translate:new u.bU(g,t.u_fill_translate),u_image:new u.bP(g,t.u_image),u_texsize:new u.bU(g,t.u_texsize),u_pixel_coord_upper:new u.bU(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new u.bU(g,t.u_pixel_coord_lower),u_scale:new u.bT(g,t.u_scale),u_fade:new u.bg(g,t.u_fade)}),fill:(g,t)=>({u_fill_translate:new u.bU(g,t.u_fill_translate)}),fillPattern:(g,t)=>({u_image:new u.bP(g,t.u_image),u_texsize:new u.bU(g,t.u_texsize),u_pixel_coord_upper:new u.bU(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new u.bU(g,t.u_pixel_coord_lower),u_scale:new u.bT(g,t.u_scale),u_fade:new u.bg(g,t.u_fade),u_fill_translate:new u.bU(g,t.u_fill_translate)}),fillOutline:(g,t)=>({u_world:new u.bU(g,t.u_world),u_fill_translate:new u.bU(g,t.u_fill_translate)}),fillOutlinePattern:(g,t)=>({u_world:new u.bU(g,t.u_world),u_image:new u.bP(g,t.u_image),u_texsize:new u.bU(g,t.u_texsize),u_pixel_coord_upper:new u.bU(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new u.bU(g,t.u_pixel_coord_lower),u_scale:new u.bT(g,t.u_scale),u_fade:new u.bg(g,t.u_fade),u_fill_translate:new u.bU(g,t.u_fill_translate)}),circle:(g,t)=>({u_camera_to_center_distance:new u.bg(g,t.u_camera_to_center_distance),u_scale_with_map:new u.bP(g,t.u_scale_with_map),u_pitch_with_map:new u.bP(g,t.u_pitch_with_map),u_extrude_scale:new u.bU(g,t.u_extrude_scale),u_device_pixel_ratio:new u.bg(g,t.u_device_pixel_ratio),u_globe_extrude_scale:new u.bg(g,t.u_globe_extrude_scale),u_translate:new u.bU(g,t.u_translate)}),collisionBox:(g,t)=>({u_pixel_extrude_scale:new u.bU(g,t.u_pixel_extrude_scale)}),collisionCircle:(g,t)=>({u_viewport_size:new u.bU(g,t.u_viewport_size)}),debug:(g,t)=>({u_color:new u.bQ(g,t.u_color),u_overlay:new u.bP(g,t.u_overlay),u_overlay_scale:new u.bg(g,t.u_overlay_scale)}),depth:Lo,clippingMask:Lo,heatmap:(g,t)=>({u_extrude_scale:new u.bg(g,t.u_extrude_scale),u_intensity:new u.bg(g,t.u_intensity),u_globe_extrude_scale:new u.bg(g,t.u_globe_extrude_scale)}),heatmapTexture:(g,t)=>({u_matrix:new u.bR(g,t.u_matrix),u_world:new u.bU(g,t.u_world),u_image:new u.bP(g,t.u_image),u_color_ramp:new u.bP(g,t.u_color_ramp),u_opacity:new u.bg(g,t.u_opacity)}),hillshade:(g,t)=>({u_image:new u.bP(g,t.u_image),u_latrange:new u.bU(g,t.u_latrange),u_exaggeration:new u.bg(g,t.u_exaggeration),u_altitudes:new u.b_(g,t.u_altitudes),u_azimuths:new u.b_(g,t.u_azimuths),u_accent:new u.bQ(g,t.u_accent),u_method:new u.bP(g,t.u_method),u_shadows:new u.bZ(g,t.u_shadows),u_highlights:new u.bZ(g,t.u_highlights)}),hillshadePrepare:(g,t)=>({u_matrix:new u.bR(g,t.u_matrix),u_image:new u.bP(g,t.u_image),u_dimension:new u.bU(g,t.u_dimension),u_zoom:new u.bg(g,t.u_zoom),u_unpack:new u.bS(g,t.u_unpack)}),colorRelief:(g,t)=>({u_image:new u.bP(g,t.u_image),u_unpack:new u.bS(g,t.u_unpack),u_dimension:new u.bU(g,t.u_dimension),u_elevation_stops:new u.bP(g,t.u_elevation_stops),u_color_stops:new u.bP(g,t.u_color_stops),u_color_ramp_size:new u.bP(g,t.u_color_ramp_size),u_opacity:new u.bg(g,t.u_opacity)}),line:(g,t)=>({u_translation:new u.bU(g,t.u_translation),u_ratio:new u.bg(g,t.u_ratio),u_device_pixel_ratio:new u.bg(g,t.u_device_pixel_ratio),u_units_to_pixels:new u.bU(g,t.u_units_to_pixels)}),lineGradient:(g,t)=>({u_translation:new u.bU(g,t.u_translation),u_ratio:new u.bg(g,t.u_ratio),u_device_pixel_ratio:new u.bg(g,t.u_device_pixel_ratio),u_units_to_pixels:new u.bU(g,t.u_units_to_pixels),u_image:new u.bP(g,t.u_image),u_image_height:new u.bg(g,t.u_image_height)}),linePattern:(g,t)=>({u_translation:new u.bU(g,t.u_translation),u_texsize:new u.bU(g,t.u_texsize),u_ratio:new u.bg(g,t.u_ratio),u_device_pixel_ratio:new u.bg(g,t.u_device_pixel_ratio),u_image:new u.bP(g,t.u_image),u_units_to_pixels:new u.bU(g,t.u_units_to_pixels),u_scale:new u.bT(g,t.u_scale),u_fade:new u.bg(g,t.u_fade)}),lineSDF:(g,t)=>({u_translation:new u.bU(g,t.u_translation),u_ratio:new u.bg(g,t.u_ratio),u_device_pixel_ratio:new u.bg(g,t.u_device_pixel_ratio),u_units_to_pixels:new u.bU(g,t.u_units_to_pixels),u_patternscale_a:new u.bU(g,t.u_patternscale_a),u_patternscale_b:new u.bU(g,t.u_patternscale_b),u_sdfgamma:new u.bg(g,t.u_sdfgamma),u_image:new u.bP(g,t.u_image),u_tex_y_a:new u.bg(g,t.u_tex_y_a),u_tex_y_b:new u.bg(g,t.u_tex_y_b),u_mix:new u.bg(g,t.u_mix)}),raster:(g,t)=>({u_tl_parent:new u.bU(g,t.u_tl_parent),u_scale_parent:new u.bg(g,t.u_scale_parent),u_buffer_scale:new u.bg(g,t.u_buffer_scale),u_fade_t:new u.bg(g,t.u_fade_t),u_opacity:new u.bg(g,t.u_opacity),u_image0:new u.bP(g,t.u_image0),u_image1:new u.bP(g,t.u_image1),u_brightness_low:new u.bg(g,t.u_brightness_low),u_brightness_high:new u.bg(g,t.u_brightness_high),u_saturation_factor:new u.bg(g,t.u_saturation_factor),u_contrast_factor:new u.bg(g,t.u_contrast_factor),u_spin_weights:new u.bT(g,t.u_spin_weights),u_coords_top:new u.bS(g,t.u_coords_top),u_coords_bottom:new u.bS(g,t.u_coords_bottom)}),symbolIcon:(g,t)=>({u_is_size_zoom_constant:new u.bP(g,t.u_is_size_zoom_constant),u_is_size_feature_constant:new u.bP(g,t.u_is_size_feature_constant),u_size_t:new u.bg(g,t.u_size_t),u_size:new u.bg(g,t.u_size),u_camera_to_center_distance:new u.bg(g,t.u_camera_to_center_distance),u_pitch:new u.bg(g,t.u_pitch),u_rotate_symbol:new u.bP(g,t.u_rotate_symbol),u_aspect_ratio:new u.bg(g,t.u_aspect_ratio),u_fade_change:new u.bg(g,t.u_fade_change),u_label_plane_matrix:new u.bR(g,t.u_label_plane_matrix),u_coord_matrix:new u.bR(g,t.u_coord_matrix),u_is_text:new u.bP(g,t.u_is_text),u_pitch_with_map:new u.bP(g,t.u_pitch_with_map),u_is_along_line:new u.bP(g,t.u_is_along_line),u_is_variable_anchor:new u.bP(g,t.u_is_variable_anchor),u_texsize:new u.bU(g,t.u_texsize),u_texture:new u.bP(g,t.u_texture),u_translation:new u.bU(g,t.u_translation),u_pitched_scale:new u.bg(g,t.u_pitched_scale)}),symbolSDF:(g,t)=>({u_is_size_zoom_constant:new u.bP(g,t.u_is_size_zoom_constant),u_is_size_feature_constant:new u.bP(g,t.u_is_size_feature_constant),u_size_t:new u.bg(g,t.u_size_t),u_size:new u.bg(g,t.u_size),u_camera_to_center_distance:new u.bg(g,t.u_camera_to_center_distance),u_pitch:new u.bg(g,t.u_pitch),u_rotate_symbol:new u.bP(g,t.u_rotate_symbol),u_aspect_ratio:new u.bg(g,t.u_aspect_ratio),u_fade_change:new u.bg(g,t.u_fade_change),u_label_plane_matrix:new u.bR(g,t.u_label_plane_matrix),u_coord_matrix:new u.bR(g,t.u_coord_matrix),u_is_text:new u.bP(g,t.u_is_text),u_pitch_with_map:new u.bP(g,t.u_pitch_with_map),u_is_along_line:new u.bP(g,t.u_is_along_line),u_is_variable_anchor:new u.bP(g,t.u_is_variable_anchor),u_texsize:new u.bU(g,t.u_texsize),u_texture:new u.bP(g,t.u_texture),u_gamma_scale:new u.bg(g,t.u_gamma_scale),u_device_pixel_ratio:new u.bg(g,t.u_device_pixel_ratio),u_is_halo:new u.bP(g,t.u_is_halo),u_translation:new u.bU(g,t.u_translation),u_pitched_scale:new u.bg(g,t.u_pitched_scale)}),symbolTextAndIcon:(g,t)=>({u_is_size_zoom_constant:new u.bP(g,t.u_is_size_zoom_constant),u_is_size_feature_constant:new u.bP(g,t.u_is_size_feature_constant),u_size_t:new u.bg(g,t.u_size_t),u_size:new u.bg(g,t.u_size),u_camera_to_center_distance:new u.bg(g,t.u_camera_to_center_distance),u_pitch:new u.bg(g,t.u_pitch),u_rotate_symbol:new u.bP(g,t.u_rotate_symbol),u_aspect_ratio:new u.bg(g,t.u_aspect_ratio),u_fade_change:new u.bg(g,t.u_fade_change),u_label_plane_matrix:new u.bR(g,t.u_label_plane_matrix),u_coord_matrix:new u.bR(g,t.u_coord_matrix),u_is_text:new u.bP(g,t.u_is_text),u_pitch_with_map:new u.bP(g,t.u_pitch_with_map),u_is_along_line:new u.bP(g,t.u_is_along_line),u_is_variable_anchor:new u.bP(g,t.u_is_variable_anchor),u_texsize:new u.bU(g,t.u_texsize),u_texsize_icon:new u.bU(g,t.u_texsize_icon),u_texture:new u.bP(g,t.u_texture),u_texture_icon:new u.bP(g,t.u_texture_icon),u_gamma_scale:new u.bg(g,t.u_gamma_scale),u_device_pixel_ratio:new u.bg(g,t.u_device_pixel_ratio),u_is_halo:new u.bP(g,t.u_is_halo),u_translation:new u.bU(g,t.u_translation),u_pitched_scale:new u.bg(g,t.u_pitched_scale)}),background:(g,t)=>({u_opacity:new u.bg(g,t.u_opacity),u_color:new u.bQ(g,t.u_color)}),backgroundPattern:(g,t)=>({u_opacity:new u.bg(g,t.u_opacity),u_image:new u.bP(g,t.u_image),u_pattern_tl_a:new u.bU(g,t.u_pattern_tl_a),u_pattern_br_a:new u.bU(g,t.u_pattern_br_a),u_pattern_tl_b:new u.bU(g,t.u_pattern_tl_b),u_pattern_br_b:new u.bU(g,t.u_pattern_br_b),u_texsize:new u.bU(g,t.u_texsize),u_mix:new u.bg(g,t.u_mix),u_pattern_size_a:new u.bU(g,t.u_pattern_size_a),u_pattern_size_b:new u.bU(g,t.u_pattern_size_b),u_scale_a:new u.bg(g,t.u_scale_a),u_scale_b:new u.bg(g,t.u_scale_b),u_pixel_coord_upper:new u.bU(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new u.bU(g,t.u_pixel_coord_lower),u_tile_units_to_pixels:new u.bg(g,t.u_tile_units_to_pixels)}),terrain:(g,t)=>({u_texture:new u.bP(g,t.u_texture),u_ele_delta:new u.bg(g,t.u_ele_delta),u_fog_matrix:new u.bR(g,t.u_fog_matrix),u_fog_color:new u.bQ(g,t.u_fog_color),u_fog_ground_blend:new u.bg(g,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new u.bg(g,t.u_fog_ground_blend_opacity),u_horizon_color:new u.bQ(g,t.u_horizon_color),u_horizon_fog_blend:new u.bg(g,t.u_horizon_fog_blend),u_is_globe_mode:new u.bg(g,t.u_is_globe_mode)}),terrainDepth:(g,t)=>({u_ele_delta:new u.bg(g,t.u_ele_delta)}),terrainCoords:(g,t)=>({u_texture:new u.bP(g,t.u_texture),u_terrain_coords_id:new u.bg(g,t.u_terrain_coords_id),u_ele_delta:new u.bg(g,t.u_ele_delta)}),projectionErrorMeasurement:(g,t)=>({u_input:new u.bg(g,t.u_input),u_output_expected:new u.bg(g,t.u_output_expected)}),atmosphere:(g,t)=>({u_sun_pos:new u.bT(g,t.u_sun_pos),u_atmosphere_blend:new u.bg(g,t.u_atmosphere_blend),u_globe_position:new u.bT(g,t.u_globe_position),u_globe_radius:new u.bg(g,t.u_globe_radius),u_inv_proj_matrix:new u.bR(g,t.u_inv_proj_matrix)}),sky:(g,t)=>({u_sky_color:new u.bQ(g,t.u_sky_color),u_horizon_color:new u.bQ(g,t.u_horizon_color),u_horizon:new u.bU(g,t.u_horizon),u_horizon_normal:new u.bU(g,t.u_horizon_normal),u_sky_horizon_blend:new u.bg(g,t.u_sky_horizon_blend),u_sky_blend:new u.bg(g,t.u_sky_blend)})};class os{constructor(t,s,c){this.context=t;const f=t.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Io={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class aa{constructor(t,s,c,f){this.length=s.length,this.attributes=c,this.itemSize=s.bytesPerElement,this.dynamicDraw=f,this.context=t;const y=t.gl;this.buffer=y.createBuffer(),t.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,s){for(let c=0;c<this.attributes.length;c++){const f=s.attributes[this.attributes[c].name];f!==void 0&&t.enableVertexAttribArray(f)}}setVertexAttribPointers(t,s,c){for(let f=0;f<this.attributes.length;f++){const y=this.attributes[f],T=s.attributes[y.name];T!==void 0&&t.vertexAttribPointer(T,y.components,t[Io[y.type]],!1,this.itemSize,y.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Li{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ko extends Li{getDefault(){return u.bf.transparent}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Qo extends Li{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class oc extends Li{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Ms extends Li{getDefault(){return[!0,!0,!0,!0]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Zs extends Li{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Ja extends Li{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class jc extends Li{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const s=this.current;(t.func!==s.func||t.ref!==s.ref||t.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Ju extends Li{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Sa extends Li{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=t,this.dirty=!1}}class Ml extends Li{getDefault(){return[0,1]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class lc extends Li{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=t,this.dirty=!1}}class th extends Li{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class to extends Li{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.BLEND):s.disable(s.BLEND),this.current=t,this.dirty=!1}}class cc extends Li{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class ls extends Li{getDefault(){return u.bf.transparent}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Ro extends Li{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class yu extends Li{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=t,this.dirty=!1}}class Ma extends Li{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class uc extends Li{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class ko extends Li{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class Ps extends Li{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Bo extends Li{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Gs extends Li{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class eo extends Li{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class cr extends Li{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Br extends Li{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class io extends Li{getDefault(){return null}set(t){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Hr extends Li{getDefault(){return null}set(t){var s;if(t===this.current&&!this.dirty)return;const c=this.gl;kr(c)?c.bindVertexArray(t):(s=c.getExtension("OES_vertex_array_object"))===null||s===void 0||s.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class Oo extends Li{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Pl extends Li{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Hs extends Li{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class As extends Li{constructor(t,s){super(t),this.context=t,this.parent=s}getDefault(){return null}}class Al extends As{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Pa extends As{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class fi extends As{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const Cl="Framebuffer is not complete";class Cs{constructor(t,s,c,f,y){this.context=t,this.width=s,this.height=c;const T=t.gl,z=this.framebuffer=T.createFramebuffer();if(this.colorAttachment=new Al(t,z),f)this.depthAttachment=y?new fi(t,z):new Pa(t,z);else if(y)throw new Error("Stencil cannot be set without depth");if(T.checkFramebufferStatus(T.FRAMEBUFFER)!==T.FRAMEBUFFER_COMPLETE)throw new Error(Cl)}destroy(){const t=this.context.gl,s=this.colorAttachment.get();if(s&&t.deleteTexture(s),this.depthAttachment){const c=this.depthAttachment.get();c&&t.deleteRenderbuffer(c)}t.deleteFramebuffer(this.framebuffer)}}class hc{constructor(t){var s,c;if(this.gl=t,this.clearColor=new Ko(this),this.clearDepth=new Qo(this),this.clearStencil=new oc(this),this.colorMask=new Ms(this),this.depthMask=new Zs(this),this.stencilMask=new Ja(this),this.stencilFunc=new jc(this),this.stencilOp=new Ju(this),this.stencilTest=new Sa(this),this.depthRange=new Ml(this),this.depthTest=new lc(this),this.depthFunc=new th(this),this.blend=new to(this),this.blendFunc=new cc(this),this.blendColor=new ls(this),this.blendEquation=new Ro(this),this.cullFace=new yu(this),this.cullFaceSide=new Ma(this),this.frontFace=new uc(this),this.program=new ko(this),this.activeTexture=new Ps(this),this.viewport=new Bo(this),this.bindFramebuffer=new Gs(this),this.bindRenderbuffer=new eo(this),this.bindTexture=new cr(this),this.bindVertexBuffer=new Br(this),this.bindElementBuffer=new io(this),this.bindVertexArray=new Hr(this),this.pixelStoreUnpack=new Oo(this),this.pixelStoreUnpackPremultiplyAlpha=new Pl(this),this.pixelStoreUnpackFlipY=new Hs(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),kr(t)){this.HALF_FLOAT=t.HALF_FLOAT;const f=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(s=t.RGBA16F)!==null&&s!==void 0?s:f?.RGBA16F_EXT,this.RGB16F=(c=t.RGB16F)!==null&&c!==void 0?c:f?.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const f=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=f?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,s){return new os(this,t,s)}createVertexBuffer(t,s,c){return new aa(this,t,s,c)}createRenderbuffer(t,s,c){const f=this.gl,y=f.createRenderbuffer();return this.bindRenderbuffer.set(y),f.renderbufferStorage(f.RENDERBUFFER,t,s,c),this.bindRenderbuffer.set(null),y}createFramebuffer(t,s,c,f){return new Cs(this,t,s,c,f)}clear({color:t,depth:s,stencil:c}){const f=this.gl;let y=0;t&&(y|=f.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(y|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),c!==void 0&&(y|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),f.clear(y)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){u.bH(t.blendFunction,Ri.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return kr(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var s;return kr(this.gl)?this.gl.deleteVertexArray(t):(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let Pr;function Fc(g,t,s,c,f){const y=g.context,T=g.transform,z=y.gl,D=g.useProgram("collisionBox"),O=[];let j=0,Z=0;for(let ut=0;ut<c.length;ut++){const pt=c[ut],vt=t.getTile(pt).getBucket(s);if(!vt)continue;const mt=f?vt.textCollisionBox:vt.iconCollisionBox,bt=vt.collisionCircleArray;bt.length>0&&(O.push({circleArray:bt,circleOffset:Z,coord:pt}),j+=bt.length/4,Z=j),mt&&D.draw(y,z.LINES,je.disabled,Ai.disabled,g.colorModeForRenderPass(),Ye.disabled,nc(g.transform),g.style.map.terrain&&g.style.map.terrain.getTerrainData(pt),T.getProjectionData({overscaledTileID:pt,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),s.id,mt.layoutVertexBuffer,mt.indexBuffer,mt.segments,null,g.transform.zoom,null,null,mt.collisionVertexBuffer)}if(!f||!O.length)return;const U=g.useProgram("collisionCircle"),$=new u.b$;$.resize(4*j),$._trim();let J=0;for(const ut of O)for(let pt=0;pt<ut.circleArray.length/4;pt++){const vt=4*pt,mt=ut.circleArray[vt+0],bt=ut.circleArray[vt+1],At=ut.circleArray[vt+2],gt=ut.circleArray[vt+3];$.emplace(J++,mt,bt,At,gt,0),$.emplace(J++,mt,bt,At,gt,1),$.emplace(J++,mt,bt,At,gt,2),$.emplace(J++,mt,bt,At,gt,3)}(!Pr||Pr.length<2*j)&&(Pr=function(ut){const pt=2*ut,vt=new u.c1;vt.resize(pt),vt._trim();for(let mt=0;mt<pt;mt++){const bt=6*mt;vt.uint16[bt+0]=4*mt+0,vt.uint16[bt+1]=4*mt+1,vt.uint16[bt+2]=4*mt+2,vt.uint16[bt+3]=4*mt+2,vt.uint16[bt+4]=4*mt+3,vt.uint16[bt+5]=4*mt+0}return vt}(j));const ct=y.createIndexBuffer(Pr,!0),ot=y.createVertexBuffer($,u.c0.members,!0);for(const ut of O){const pt=wl(g.transform);U.draw(y,z.TRIANGLES,je.disabled,Ai.disabled,g.colorModeForRenderPass(),Ye.disabled,pt,g.style.map.terrain&&g.style.map.terrain.getTerrainData(ut.coord),null,s.id,ot,ct,u.aM.simpleSegment(0,2*ut.circleOffset,ut.circleArray.length,ut.circleArray.length/2),null,g.transform.zoom,null,null,null)}ot.destroy(),ct.destroy()}const dc=u.ag(new Float32Array(16));function no(g,t,s,c,f,y){const{horizontalAlign:T,verticalAlign:z}=u.aH(g);return new u.P((-(T-.5)*t/f+c[0])*y,(-(z-.5)*s/f+c[1])*y)}function vu(g,t,s,c,f,y){const T=t.tileAnchorPoint.add(new u.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let z=c.mult(y);s||(z=z.rotate(-f));const D=T.add(z);return fn(D.x,D.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(s){const z=an(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(g),D=Math.atan(z.y/z.x)+(z.x<0?Math.PI:0);return g.add(c.rotate(D))}return g.add(c)}function El(g,t,s,c,f,y,T,z,D,O,j,Z){const U=g.text.placedSymbolArray,$=g.text.dynamicLayoutVertexArray,J=g.icon.dynamicLayoutVertexArray,ct={};$.clear();for(let ot=0;ot<U.length;ot++){const ut=U.get(ot),pt=ut.hidden||!ut.crossTileID||g.allowVerticalPlacement&&!ut.placedOrientation?null:c[ut.crossTileID];if(pt){const vt=new u.P(ut.anchorX,ut.anchorY),mt={getElevation:Z,width:f.width,height:f.height,pitchedLabelPlaneMatrix:y,pitchWithMap:s,transform:f,tileAnchorPoint:vt,translation:O,unwrappedTileID:j},bt=s?pn(vt.x,vt.y,mt):an(vt.x,vt.y,mt),At=ue(f.cameraToCenterDistance,bt.signedDistanceFromCamera);let gt=u.ap(g.textSizeData,z,ut)*At/u.aB;s&&(gt*=g.tilePixelRatio/T);const{width:Lt,height:Gt,anchor:Ot,textOffset:Nt,textBoxScale:Ut}=pt,_e=no(Ot,Lt,Gt,Nt,Ut,gt),ve=f.getPitchedTextCorrection(vt.x+O[0],vt.y+O[1],j),re=vu(bt.point,mt,t,_e,-f.bearingInRadians,ve),Oe=g.allowVerticalPlacement&&ut.placedOrientation===u.ao.vertical?Math.PI/2:0;for(let yi=0;yi<ut.numGlyphs;yi++)u.av($,re,Oe);D&&ut.associatedIconIndex>=0&&(ct[ut.associatedIconIndex]={shiftedAnchor:re,angle:Oe})}else _a(ut.numGlyphs,$)}if(D){J.clear();const ot=g.icon.placedSymbolArray;for(let ut=0;ut<ot.length;ut++){const pt=ot.get(ut);if(pt.hidden)_a(pt.numGlyphs,J);else{const vt=ct[ut];if(vt)for(let mt=0;mt<pt.numGlyphs;mt++)u.av(J,vt.shiftedAnchor,vt.angle);else _a(pt.numGlyphs,J)}}g.icon.dynamicLayoutVertexBuffer.updateData(J)}g.text.dynamicLayoutVertexBuffer.updateData($)}function Aa(g,t,s){return s.iconsInText&&t?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function Ca(g,t,s,c,f,y,T,z,D,O,j,Z,U){const $=g.context,J=$.gl,ct=g.transform,ot=z==="map",ut=D==="map",pt=z!=="viewport"&&s.layout.get("symbol-placement")!=="point",vt=ot&&!ut&&!pt,mt=!s.layout.get("symbol-sort-key").isConstant();let bt=!1;const At=g.getDepthModeForSublayer(0,je.ReadOnly),gt=s._unevaluatedLayout.hasValue("text-variable-anchor")||s._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Lt=[],Gt=ct.getCircleRadiusCorrection();for(const Ot of c){const Nt=t.getTile(Ot),Ut=Nt.getBucket(s);if(!Ut)continue;const _e=f?Ut.text:Ut.icon;if(!_e||!_e.segments.get().length||!_e.hasVisibleVertices)continue;const ve=_e.programConfigurations.get(s.id),re=f||Ut.sdfIcons,Oe=f?Ut.textSizeData:Ut.iconSizeData,yi=ut||ct.pitch!==0,Ni=g.useProgram(Aa(re,f,Ut),ve),Yi=u.an(Oe,ct.zoom),Gi=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Ot);let On,Dn,mi,Wi,Wn=[0,0],yr=null;if(f)Dn=Nt.glyphAtlasTexture,mi=J.LINEAR,On=Nt.glyphAtlasTexture.size,Ut.iconsInText&&(Wn=Nt.imageAtlasTexture.size,yr=Nt.imageAtlasTexture,Wi=yi||g.options.rotating||g.options.zooming||Oe.kind==="composite"||Oe.kind==="camera"?J.LINEAR:J.NEAREST);else{const Ln=s.layout.get("icon-size").constantOr(0)!==1||Ut.iconsNeedLinear;Dn=Nt.imageAtlasTexture,mi=re||g.options.rotating||g.options.zooming||Ln||yi?J.LINEAR:J.NEAREST,On=Nt.imageAtlasTexture.size}const Er=u.aC(Nt,1,g.transform.zoom),Ds=$i(ot,g.transform,Er),lo=u.L();u.aq(lo,Ds);const al=ii(ut,ot,g.transform,Er),Ia=u.aD(ct,Nt,y,T),Ol=ct.getProjectionData({overscaledTileID:Ot,applyGlobeMatrix:!U,applyTerrainMatrix:!0}),ol=gt&&Ut.hasTextData(),Nl=s.layout.get("icon-text-fit")!=="none"&&ol&&Ut.hasIconData();if(pt){const Ln=g.style.map.terrain?(Ls,Nn)=>g.style.map.terrain.getElevation(Ot,Ls,Nn):null,Gn=s.layout.get("text-rotation-alignment")==="map";vn(Ut,g,f,Ds,lo,ut,O,Gn,Ot.toUnwrapped(),ct.width,ct.height,Ia,Ln)}const jl=f&&gt||Nl,qr=pt||jl?dc:ut?Ds:g.transform.clipSpaceToPixelsMatrix,Ra=re&&s.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let fs;fs=re?Ut.iconsInText?kh(Oe.kind,Yi,vt,ut,pt,jl,g,qr,al,Ia,On,Wn,Gt):Nc(Oe.kind,Yi,vt,ut,pt,jl,g,qr,al,Ia,f,On,0,Gt):Sl(Oe.kind,Yi,vt,ut,pt,jl,g,qr,al,Ia,f,On,Gt);const Fl={program:Ni,buffers:_e,uniformValues:fs,projectionData:Ol,atlasTexture:Dn,atlasTextureIcon:yr,atlasInterpolation:mi,atlasInterpolationIcon:Wi,isSDF:re,hasHalo:Ra};if(mt&&Ut.canOverlap){bt=!0;const Ln=_e.segments.get();for(const Gn of Ln)Lt.push({segments:new u.aM([Gn]),sortKey:Gn.sortKey,state:Fl,terrainData:Gi})}else Lt.push({segments:_e.segments,sortKey:0,state:Fl,terrainData:Gi})}bt&&Lt.sort((Ot,Nt)=>Ot.sortKey-Nt.sortKey);for(const Ot of Lt){const Nt=Ot.state;if($.activeTexture.set(J.TEXTURE0),Nt.atlasTexture.bind(Nt.atlasInterpolation,J.CLAMP_TO_EDGE),Nt.atlasTextureIcon&&($.activeTexture.set(J.TEXTURE1),Nt.atlasTextureIcon&&Nt.atlasTextureIcon.bind(Nt.atlasInterpolationIcon,J.CLAMP_TO_EDGE)),Nt.isSDF){const Ut=Nt.uniformValues;Nt.hasHalo&&(Ut.u_is_halo=1,o(Nt.buffers,Ot.segments,s,g,Nt.program,At,j,Z,Ut,Nt.projectionData,Ot.terrainData)),Ut.u_is_halo=0}o(Nt.buffers,Ot.segments,s,g,Nt.program,At,j,Z,Nt.uniformValues,Nt.projectionData,Ot.terrainData)}}function o(g,t,s,c,f,y,T,z,D,O,j){const Z=c.context;f.draw(Z,Z.gl.TRIANGLES,y,T,z,Ye.backCCW,D,j,O,s.id,g.layoutVertexBuffer,g.indexBuffer,t,s.paint,c.transform.zoom,g.programConfigurations.get(s.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function _(g,t,s,c,f){const y=g.context,T=y.gl,z=Ai.disabled,D=new Ri([T.ONE,T.ONE],u.bf.transparent,[!0,!0,!0,!0]),O=t.getBucket(s);if(!O)return;const j=c.key;let Z=s.heatmapFbos.get(j);Z||(Z=B(y,t.tileSize,t.tileSize),s.heatmapFbos.set(j,Z)),y.bindFramebuffer.set(Z.framebuffer),y.viewport.set([0,0,t.tileSize,t.tileSize]),y.clear({color:u.bf.transparent});const U=O.programConfigurations.get(s.id),$=g.useProgram("heatmap",U,!f),J=g.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ct=g.style.map.terrain.getTerrainData(c);$.draw(y,T.TRIANGLES,je.disabled,z,D,Ye.disabled,Ku(t,g.transform.zoom,s.paint.get("heatmap-intensity"),1),ct,J,s.id,O.layoutVertexBuffer,O.indexBuffer,O.segments,s.paint,g.transform.zoom,U)}function A(g,t,s,c,f){const y=g.context,T=y.gl,z=g.transform;y.setColorMode(g.colorModeForRenderPass());const D=G(y,t),O=s.key,j=t.heatmapFbos.get(O);if(!j)return;y.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,j.colorAttachment.get()),y.activeTexture.set(T.TEXTURE1),D.bind(T.LINEAR,T.CLAMP_TO_EDGE);const Z=z.getProjectionData({overscaledTileID:s,applyTerrainMatrix:f,applyGlobeMatrix:!c});g.useProgram("heatmapTexture").draw(y,T.TRIANGLES,je.disabled,Ai.disabled,g.colorModeForRenderPass(),Ye.disabled,Ts(g,t,0,1),null,Z,t.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments,t.paint,z.zoom),j.destroy(),t.heatmapFbos.delete(O)}function B(g,t,s){var c,f;const y=g.gl,T=y.createTexture();y.bindTexture(y.TEXTURE_2D,T),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR);const z=(c=g.HALF_FLOAT)!==null&&c!==void 0?c:y.UNSIGNED_BYTE,D=(f=g.RGBA16F)!==null&&f!==void 0?f:y.RGBA;y.texImage2D(y.TEXTURE_2D,0,D,t,s,0,y.RGBA,z,null);const O=g.createFramebuffer(t,s,!1,!1);return O.colorAttachment.set(T),O}function G(g,t){return t.colorRampTexture||(t.colorRampTexture=new u.T(g,t.colorRamp,g.gl.RGBA)),t.colorRampTexture}function nt(g,t,s,c,f){if(!s||!c||!c.imageAtlas)return;const y=c.imageAtlas.patternPositions;let T=y[s.to.toString()],z=y[s.from.toString()];if(!T&&z&&(T=z),!z&&T&&(z=T),!T||!z){const D=f.getPaintProperty(t);T=y[D],z=y[D]}T&&z&&g.setConstantPatternPositions(T,z)}function wt(g,t,s,c,f,y,T,z){const D=g.context.gl,O="fill-pattern",j=s.paint.get(O),Z=j&&j.constantOr(1),U=s.getCrossfadeParameters();let $,J,ct,ot,ut;const pt=g.transform,vt=s.paint.get("fill-translate"),mt=s.paint.get("fill-translate-anchor");T?(J=Z&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=D.LINES):(J=Z?"fillPattern":"fill",$=D.TRIANGLES);const bt=j.constantOr(null);for(const At of c){const gt=t.getTile(At);if(Z&&!gt.patternsLoaded())continue;const Lt=gt.getBucket(s);if(!Lt)continue;const Gt=Lt.programConfigurations.get(s.id),Ot=g.useProgram(J,Gt),Nt=g.style.map.terrain&&g.style.map.terrain.getTerrainData(At);Z&&(g.context.activeTexture.set(D.TEXTURE0),gt.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),Gt.updatePaintBuffers(U)),nt(Gt,O,bt,gt,s);const Ut=pt.getProjectionData({overscaledTileID:At,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),_e=u.aD(pt,gt,vt,mt);if(T){ot=Lt.indexBuffer2,ut=Lt.segments2;const re=[D.drawingBufferWidth,D.drawingBufferHeight];ct=J==="fillOutlinePattern"&&Z?Eo(g,U,gt,re,_e):bl(re,_e)}else ot=Lt.indexBuffer,ut=Lt.segments,ct=Z?xl(g,U,gt,_e):{u_fill_translate:_e};const ve=g.stencilModeForClipping(At);Ot.draw(g.context,$,f,ve,y,Ye.backCCW,ct,Nt,Ut,s.id,Lt.layoutVertexBuffer,ot,ut,s.paint,g.transform.zoom,Gt)}}function Bt(g,t,s,c,f,y,T,z){const D=g.context,O=D.gl,j="fill-extrusion-pattern",Z=s.paint.get(j),U=Z.constantOr(1),$=s.getCrossfadeParameters(),J=s.paint.get("fill-extrusion-opacity"),ct=Z.constantOr(null),ot=g.transform;for(const ut of c){const pt=t.getTile(ut),vt=pt.getBucket(s);if(!vt)continue;const mt=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ut),bt=vt.programConfigurations.get(s.id),At=g.useProgram(U?"fillExtrusionPattern":"fillExtrusion",bt);U&&(g.context.activeTexture.set(O.TEXTURE0),pt.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),bt.updatePaintBuffers($));const gt=ot.getProjectionData({overscaledTileID:ut,applyGlobeMatrix:!z,applyTerrainMatrix:!0});nt(bt,j,ct,pt,s);const Lt=u.aD(ot,pt,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),Gt=s.paint.get("fill-extrusion-vertical-gradient"),Ot=U?Wu(g,Gt,J,Lt,ut,$,pt):ln(g,Gt,J,Lt);At.draw(D,D.gl.TRIANGLES,f,y,T,Ye.backCCW,Ot,mt,gt,s.id,vt.layoutVertexBuffer,vt.indexBuffer,vt.segments,s.paint,g.transform.zoom,bt,g.style.map.terrain&&vt.centroidVertexBuffer)}}function qt(g,t,s,c,f,y,T,z,D){var O;const j=g.style.projection,Z=g.context,U=g.transform,$=Z.gl,J=[`#define NUM_ILLUMINATION_SOURCES ${s.paint.get("hillshade-highlight-color").values.length}`],ct=g.useProgram("hillshade",null,!1,J),ot=!g.options.moving;for(const ut of c){const pt=t.getTile(ut),vt=pt.fbo;if(!vt)continue;const mt=j.getMeshFromTileID(Z,ut.canonical,z,!0,"raster"),bt=(O=g.style.map.terrain)===null||O===void 0?void 0:O.getTerrainData(ut);Z.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,vt.colorAttachment.get());const At=U.getProjectionData({overscaledTileID:ut,aligned:ot,applyGlobeMatrix:!D,applyTerrainMatrix:!0});ct.draw(Z,$.TRIANGLES,y,f[ut.overscaledZ],T,Ye.backCCW,Yo(g,pt,s),bt,At,s.id,mt.vertexBuffer,mt.indexBuffer,mt.segments)}}function he(g,t,s,c,f,y,T,z,D){var O;const j=g.style.projection,Z=g.context,U=g.transform,$=Z.gl,J=g.useProgram("colorRelief"),ct=!g.options.moving;let ot=!0,ut=0;for(const pt of c){const vt=t.getTile(pt),mt=vt.dem;if(ot){const Ot=$.getParameter($.MAX_TEXTURE_SIZE),{elevationTexture:Nt,colorTexture:Ut}=s.getColorRampTextures(Z,Ot,mt.getUnpackVector());Z.activeTexture.set($.TEXTURE1),Nt.bind($.NEAREST,$.CLAMP_TO_EDGE),Z.activeTexture.set($.TEXTURE4),Ut.bind($.LINEAR,$.CLAMP_TO_EDGE),ot=!1,ut=Nt.size[0]}if(!mt||!mt.data)continue;const bt=mt.stride,At=mt.getPixels();if(Z.activeTexture.set($.TEXTURE0),Z.pixelStoreUnpackPremultiplyAlpha.set(!1),vt.demTexture=vt.demTexture||g.getTileTexture(bt),vt.demTexture){const Ot=vt.demTexture;Ot.update(At,{premultiply:!1}),Ot.bind($.LINEAR,$.CLAMP_TO_EDGE)}else vt.demTexture=new u.T(Z,At,$.RGBA,{premultiply:!1}),vt.demTexture.bind($.LINEAR,$.CLAMP_TO_EDGE);const gt=j.getMeshFromTileID(Z,pt.canonical,z,!0,"raster"),Lt=(O=g.style.map.terrain)===null||O===void 0?void 0:O.getTerrainData(pt),Gt=U.getProjectionData({overscaledTileID:pt,aligned:ct,applyGlobeMatrix:!D,applyTerrainMatrix:!0});J.draw(Z,$.TRIANGLES,y,f[pt.overscaledZ],T,Ye.backCCW,Tl(s,vt.dem,ut),Lt,Gt,s.id,gt.vertexBuffer,gt.indexBuffer,gt.segments)}}const De=[new u.P(0,0),new u.P(u.$,0),new u.P(u.$,u.$),new u.P(0,u.$)];function ke(g,t,s,c,f,y,T,z,D=!1,O=!1){const j=c[c.length-1].overscaledZ,Z=g.context,U=Z.gl,$=g.useProgram("raster"),J=g.transform,ct=g.style.projection,ot=g.colorModeForRenderPass(),ut=!g.options.moving;for(const pt of c){const vt=g.getDepthModeForSublayer(pt.overscaledZ-j,s.paint.get("raster-opacity")===1?je.ReadWrite:je.ReadOnly,U.LESS),mt=t.getTile(pt);mt.registerFadeDuration(s.paint.get("raster-fade-duration"));const bt=t.findLoadedParent(pt,0),At=t.findLoadedSibling(pt),gt=$e(mt,bt||At||null,t,s,g.transform,g.style.map.terrain);let Lt,Gt;const Ot=s.paint.get("raster-resampling")==="nearest"?U.NEAREST:U.LINEAR;Z.activeTexture.set(U.TEXTURE0),mt.texture.bind(Ot,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),Z.activeTexture.set(U.TEXTURE1),bt?(bt.texture.bind(Ot,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),Lt=Math.pow(2,bt.tileID.overscaledZ-mt.tileID.overscaledZ),Gt=[mt.tileID.canonical.x*Lt%1,mt.tileID.canonical.y*Lt%1]):mt.texture.bind(Ot,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST),mt.texture.useMipmap&&Z.extTextureFilterAnisotropic&&g.transform.pitch>20&&U.texParameterf(U.TEXTURE_2D,Z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Z.extTextureFilterAnisotropicMax);const Nt=g.style.map.terrain&&g.style.map.terrain.getTerrainData(pt),Ut=J.getProjectionData({overscaledTileID:pt,aligned:ut,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),_e=Ss(Gt||[0,0],Lt||1,gt,s,z),ve=ct.getMeshFromTileID(Z,pt.canonical,y,T,"raster");$.draw(Z,U.TRIANGLES,vt,f?f[pt.overscaledZ]:Ai.disabled,ot,D?Ye.frontCCW:Ye.backCCW,_e,Nt,Ut,s.id,ve.vertexBuffer,ve.indexBuffer,ve.segments)}}function $e(g,t,s,c,f,y){const T=c.paint.get("raster-fade-duration");if(!y&&T>0){const z=ht.now(),D=(z-g.timeAdded)/T,O=t?(z-t.timeAdded)/T:-1,j=s.getSource(),Z=Le(f,{tileSize:j.tileSize,roundZoom:j.roundZoom}),U=!t||Math.abs(t.tileID.overscaledZ-Z)>Math.abs(g.tileID.overscaledZ-Z),$=U&&g.refreshedUponExpiration?1:u.ah(U?D:1-O,0,1);return g.refreshedUponExpiration&&D>=1&&(g.refreshedUponExpiration=!1),t?{opacity:1,mix:1-$}:{opacity:$,mix:0}}return{opacity:1,mix:0}}const pi=new u.bf(1,0,0,1),gn=new u.bf(0,1,0,1),xn=new u.bf(0,0,1,1),_r=new u.bf(1,0,1,1),qs=new u.bf(0,1,1,1);function Vc(g,t,s,c){cs(g,0,t+s/2,g.transform.width,s,c)}function bn(g,t,s,c){cs(g,t-s/2,0,s,g.transform.height,c)}function cs(g,t,s,c,f,y){const T=g.context,z=T.gl;z.enable(z.SCISSOR_TEST),z.scissor(t*g.pixelRatio,s*g.pixelRatio,c*g.pixelRatio,f*g.pixelRatio),T.clear({color:y}),z.disable(z.SCISSOR_TEST)}function Ar(g,t,s){const c=g.context,f=c.gl,y=g.useProgram("debug"),T=je.disabled,z=Ai.disabled,D=g.colorModeForRenderPass(),O="$debug",j=g.style.map.terrain&&g.style.map.terrain.getTerrainData(s);c.activeTexture.set(f.TEXTURE0);const Z=t.getTileByID(s.key).latestRawTileData,U=Math.floor((Z&&Z.byteLength||0)/1024),$=t.getTile(s).tileSize,J=512/Math.min($,512)*(s.overscaledZ/g.transform.zoom)*.5;let ct=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(ct+=` => ${s.overscaledZ}`),function(ut,pt){ut.initDebugOverlayCanvas();const vt=ut.debugOverlayCanvas,mt=ut.context.gl,bt=ut.debugOverlayCanvas.getContext("2d");bt.clearRect(0,0,vt.width,vt.height),bt.shadowColor="white",bt.shadowBlur=2,bt.lineWidth=1.5,bt.strokeStyle="white",bt.textBaseline="top",bt.font="bold 36px Open Sans, sans-serif",bt.fillText(pt,5,5),bt.strokeText(pt,5,5),ut.debugOverlayTexture.update(vt),ut.debugOverlayTexture.bind(mt.LINEAR,mt.CLAMP_TO_EDGE)}(g,`${ct} ${U}kB`);const ot=g.transform.getProjectionData({overscaledTileID:s,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(c,f.TRIANGLES,T,z,Ri.alphaBlended,Ye.disabled,zo(u.bf.transparent,J),null,ot,O,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),y.draw(c,f.LINE_STRIP,T,z,D,Ye.disabled,zo(u.bf.red),j,ot,O,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function fc(g,t,s,c){const{isRenderingGlobe:f}=c,y=g.context,T=y.gl,z=g.transform,D=g.colorModeForRenderPass(),O=g.getDepthModeFor3D(),j=g.useProgram("terrain");y.bindFramebuffer.set(null),y.viewport.set([0,0,g.width,g.height]);for(const Z of s){const U=t.getTerrainMesh(Z.tileID),$=g.renderToTexture.getTexture(Z),J=t.getTerrainData(Z.tileID);y.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,$.texture);const ct=t.getMeshFrameDelta(z.zoom),ot=z.calculateFogMatrix(Z.tileID.toUnwrapped()),ut=ic(ct,ot,g.style.sky,z.pitch,f),pt=z.getProjectionData({overscaledTileID:Z.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});j.draw(y,T.TRIANGLES,O,Ai.disabled,D,Ye.backCCW,ut,J,pt,"terrain",U.vertexBuffer,U.indexBuffer,U.segments)}}function Ea(g,t){if(!t.mesh){const s=new u.aL;s.emplaceBack(-1,-1),s.emplaceBack(1,-1),s.emplaceBack(1,1),s.emplaceBack(-1,1);const c=new u.aN;c.emplaceBack(0,1,2),c.emplaceBack(0,2,3),t.mesh=new Ns(g.createVertexBuffer(s,js.members),g.createIndexBuffer(c),u.aM.simpleSegment(0,0,s.length,c.length))}return t.mesh}class En{constructor(t,s){this.context=new hc(t),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=bi.maxUnderzooming+bi.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new bs}resize(t,s,c){if(this.width=Math.floor(t*c),this.height=Math.floor(s*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const t=this.context,s=new u.aL;s.emplaceBack(0,0),s.emplaceBack(u.$,0),s.emplaceBack(0,u.$),s.emplaceBack(u.$,u.$),this.tileExtentBuffer=t.createVertexBuffer(s,js.members),this.tileExtentSegments=u.aM.simpleSegment(0,0,4,2);const c=new u.aL;c.emplaceBack(0,0),c.emplaceBack(u.$,0),c.emplaceBack(0,u.$),c.emplaceBack(u.$,u.$),this.debugBuffer=t.createVertexBuffer(c,js.members),this.debugSegments=u.aM.simpleSegment(0,0,4,5);const f=new u.c6;f.emplaceBack(0,0,0,0),f.emplaceBack(u.$,0,u.$,0),f.emplaceBack(0,u.$,0,u.$),f.emplaceBack(u.$,u.$,u.$,u.$),this.rasterBoundsBuffer=t.createVertexBuffer(f,Rh.members),this.rasterBoundsSegments=u.aM.simpleSegment(0,0,4,2);const y=new u.aL;y.emplaceBack(0,0),y.emplaceBack(u.$,0),y.emplaceBack(0,u.$),y.emplaceBack(u.$,u.$),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(y,js.members),this.rasterBoundsSegmentsPosOnly=u.aM.simpleSegment(0,0,4,5);const T=new u.aL;T.emplaceBack(0,0),T.emplaceBack(1,0),T.emplaceBack(0,1),T.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(T,js.members),this.viewportSegments=u.aM.simpleSegment(0,0,4,2);const z=new u.c7;z.emplaceBack(0),z.emplaceBack(1),z.emplaceBack(3),z.emplaceBack(2),z.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(z);const D=new u.aN;D.emplaceBack(1,0,2),D.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(D);const O=this.context.gl;this.stencilClearMode=new Ai({func:O.ALWAYS,mask:0},0,255,O.ZERO,O.ZERO,O.ZERO),this.tileExtentMesh=new Ns(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,s=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=u.L();u.bY(c,0,this.width,this.height,0,0,1),u.N(c,c,[s.drawingBufferWidth,s.drawingBufferHeight,0]);const f={mainMatrix:c,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:c};this.useProgram("clippingMask",null,!0).draw(t,s.TRIANGLES,je.disabled,this.stencilClearMode,Ri.disabled,Ye.disabled,null,null,f,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,s,c){if(this.currentStencilSource===t.source||!t.isTileClipped()||!s||!s.length)return;this.currentStencilSource=t.source,this.nextStencilID+s.length>256&&this.clearStencil();const f=this.context;f.setColorMode(Ri.disabled),f.setDepthMode(je.disabled);const y={};for(const T of s)y[T.key]=this.nextStencilID++;this._renderTileMasks(y,s,c,!0),this._renderTileMasks(y,s,c,!1),this._tileClippingMaskIDs=y}_renderTileMasks(t,s,c,f){const y=this.context,T=y.gl,z=this.style.projection,D=this.transform,O=this.useProgram("clippingMask");for(const j of s){const Z=t[j.key],U=this.style.map.terrain&&this.style.map.terrain.getTerrainData(j),$=z.getMeshFromTileID(this.context,j.canonical,f,!0,"stencil"),J=D.getProjectionData({overscaledTileID:j,applyGlobeMatrix:!c,applyTerrainMatrix:!0});O.draw(y,T.TRIANGLES,je.disabled,new Ai({func:T.ALWAYS,mask:0},Z,255,T.KEEP,T.KEEP,T.REPLACE),Ri.disabled,c?Ye.disabled:Ye.backCCW,null,U,J,"$clipping",$.vertexBuffer,$.indexBuffer,$.segments)}}_renderTilesDepthBuffer(){const t=this.context,s=t.gl,c=this.style.projection,f=this.transform,y=this.useProgram("depth"),T=this.getDepthModeFor3D(),z=It(f,{tileSize:f.tileSize});for(const D of z){const O=this.style.map.terrain&&this.style.map.terrain.getTerrainData(D),j=c.getMeshFromTileID(this.context,D.canonical,!0,!0,"raster"),Z=f.getProjectionData({overscaledTileID:D,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(t,s.TRIANGLES,T,Ai.disabled,Ri.disabled,Ye.backCCW,null,O,Z,"$clipping",j.vertexBuffer,j.indexBuffer,j.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,s=this.context.gl;return new Ai({func:s.NOTEQUAL,mask:255},t,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(t){const s=this.context.gl;return new Ai({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,s.KEEP,s.KEEP,s.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const s=this.context.gl,c=t.sort((T,z)=>z.overscaledZ-T.overscaledZ),f=c[c.length-1].overscaledZ,y=c[0].overscaledZ-f+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const T={};for(let z=0;z<y;z++)T[z+f]=new Ai({func:s.GEQUAL,mask:255},z+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=y,[T,c]}return[{[f]:Ai.disabled},c]}stencilConfigForOverlapTwoPass(t){const s=this.context.gl,c=t.sort((T,z)=>z.overscaledZ-T.overscaledZ),f=c[c.length-1].overscaledZ,y=c[0].overscaledZ-f+1;if(this.clearStencil(),y>1){const T={},z={};for(let D=0;D<y;D++)T[D+f]=new Ai({func:s.GREATER,mask:255},y+1+D,255,s.KEEP,s.KEEP,s.REPLACE),z[D+f]=new Ai({func:s.GREATER,mask:255},1+D,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID=2*y+1,[T,z,c]}return this.nextStencilID=3,[{[f]:new Ai({func:s.GREATER,mask:255},2,255,s.KEEP,s.KEEP,s.REPLACE)},{[f]:new Ai({func:s.GREATER,mask:255},1,255,s.KEEP,s.KEEP,s.REPLACE)},c]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Ri([t.CONSTANT_COLOR,t.ONE],new u.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ri.unblended:Ri.alphaBlended}getDepthModeForSublayer(t,s,c){if(!this.opaquePassEnabledForLayer())return je.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new je(c||this.context.gl.LEQUAL,s,[f,f])}getDepthModeFor3D(){return new je(this.context.gl.LEQUAL,je.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,s){var c,f;this.style=t,this.options=s,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(ht.now()),this.imageManager.beginFrame();const y=this.style._order,T=this.style.sourceCaches,z={},D={},O={},j={isRenderingToTexture:!1,isRenderingGlobe:((c=t.projection)===null||c===void 0?void 0:c.transitionState)>0};for(const U in T){const $=T[U];$.used&&$.prepare(this.context),z[U]=$.getVisibleCoordinates(!1),D[U]=z[U].slice().reverse(),O[U]=$.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let U=0;U<y.length;U++)if(this.style._layers[y[U]].is3D()){this.opaquePassCutoff=U;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const U of y){const $=this.style._layers[U];if(!$.hasOffscreenPass()||$.isHidden(this.transform.zoom))continue;const J=D[$.source];($.type==="custom"||J.length)&&this.renderLayer(this,T[$.source],$,J,j)}if((f=this.style.projection)===null||f===void 0||f.updateGPUdependent({context:this.context,useProgram:U=>this.useProgram(U)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?u.bf.black:u.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(U,$){const J=U.context,ct=J.gl,ot=((At,gt,Lt)=>{const Gt=Math.cos(gt.rollInRadians),Ot=Math.sin(gt.rollInRadians),Nt=Pt(gt),Ut=gt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:At.properties.get("sky-color"),u_horizon_color:At.properties.get("horizon-color"),u_horizon:[(gt.width/2-Nt*Ot)*Lt,(gt.height/2+Nt*Gt)*Lt],u_horizon_normal:[-Ot,Gt],u_sky_horizon_blend:At.properties.get("sky-horizon-blend")*gt.height/2*Lt,u_sky_blend:Ut}})($,U.style.map.transform,U.pixelRatio),ut=new je(ct.LEQUAL,je.ReadWrite,[0,1]),pt=Ai.disabled,vt=U.colorModeForRenderPass(),mt=U.useProgram("sky"),bt=Ea(J,$);mt.draw(J,ct.TRIANGLES,ut,pt,vt,Ye.disabled,ot,null,void 0,"sky",bt.vertexBuffer,bt.indexBuffer,bt.segments)}(this,this.style.sky),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const U=this.style._layers[y[this.currentLayer]],$=T[U.source],J=z[U.source];this._renderTileClippingMasks(U,J,!1),this.renderLayer(this,$,U,J,j)}this.renderPass="translucent";let Z=!1;for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const U=this.style._layers[y[this.currentLayer]],$=T[U.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(U,j))continue;this.opaquePassEnabledForLayer()||Z||(Z=!0,j.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const J=(U.type==="symbol"?O:D)[U.source];this._renderTileClippingMasks(U,z[U.source],!!this.renderToTexture),this.renderLayer(this,$,U,J,j)}if(j.isRenderingGlobe&&function(U,$,J){const ct=U.context,ot=ct.gl,ut=U.useProgram("atmosphere"),pt=new je(ot.LEQUAL,je.ReadOnly,[0,1]),vt=U.transform,mt=function(Ut,_e){const ve=Ut.properties.get("position"),re=[-ve.x,-ve.y,-ve.z],Oe=u.ag(new Float64Array(16));return Ut.properties.get("anchor")==="map"&&(u.b6(Oe,Oe,_e.rollInRadians),u.b7(Oe,Oe,-_e.pitchInRadians),u.b6(Oe,Oe,_e.bearingInRadians),u.b7(Oe,Oe,_e.center.lat*Math.PI/180),u.bz(Oe,Oe,-_e.center.lng*Math.PI/180)),u.c5(re,re,Oe),re}(J,U.transform),bt=vt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),At=$.properties.get("atmosphere-blend")*bt.projectionTransition;if(At===0)return;const gt=Po(vt.worldSize,vt.center.lat),Lt=vt.inverseProjectionMatrix,Gt=new Float64Array(4);Gt[3]=1,u.aw(Gt,Gt,vt.modelViewProjectionMatrix),Gt[0]/=Gt[3],Gt[1]/=Gt[3],Gt[2]/=Gt[3],Gt[3]=1,u.aw(Gt,Gt,Lt),Gt[0]/=Gt[3],Gt[1]/=Gt[3],Gt[2]/=Gt[3],Gt[3]=1;const Ot=((Ut,_e,ve,re,Oe)=>({u_sun_pos:Ut,u_atmosphere_blend:_e,u_globe_position:ve,u_globe_radius:re,u_inv_proj_matrix:Oe}))(mt,At,[Gt[0],Gt[1],Gt[2]],gt,Lt),Nt=Ea(ct,$);ut.draw(ct,ot.TRIANGLES,pt,Ai.disabled,Ri.alphaBlended,Ye.disabled,Ot,null,null,"atmosphere",Nt.vertexBuffer,Nt.indexBuffer,Nt.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const U=function($,J){let ct=null;const ot=Object.values($._layers).flatMap(mt=>mt.source&&!mt.isHidden(J)?[$.sourceCaches[mt.source]]:[]),ut=ot.filter(mt=>mt.getSource().type==="vector"),pt=ot.filter(mt=>mt.getSource().type!=="vector"),vt=mt=>{(!ct||ct.getSource().maxzoom<mt.getSource().maxzoom)&&(ct=mt)};return ut.forEach(mt=>vt(mt)),ct||pt.forEach(mt=>vt(mt)),ct}(this.style,this.transform.zoom);U&&function($,J,ct){for(let ot=0;ot<ct.length;ot++)Ar($,J,ct[ot])}(this,U,U.getVisibleCoordinates())}this.options.showPadding&&function(U){const $=U.transform.padding;Vc(U,U.transform.height-($.top||0),3,pi),Vc(U,$.bottom||0,3,gn),bn(U,$.left||0,3,xn),bn(U,U.transform.width-($.right||0),3,_r);const J=U.transform.centerPoint;(function(ct,ot,ut,pt){cs(ct,ot-1,ut-10,2,20,pt),cs(ct,ot-10,ut-1,20,2,pt)})(U,J.x,U.transform.height-J.y,qs)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const s=this.terrainFacilitator.matrix,c=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=t?!u.c8(s,c):!u.c9(s,c)),f||(f=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),f&&(u.ca(s,c),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(y,T){const z=y.context,D=z.gl,O=y.transform,j=Ri.unblended,Z=new je(D.LEQUAL,je.ReadWrite,[0,1]),U=T.sourceCache.getRenderableTiles(),$=y.useProgram("terrainDepth");z.bindFramebuffer.set(T.getFramebuffer("depth").framebuffer),z.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),z.clear({color:u.bf.transparent,depth:1});for(const J of U){const ct=T.getTerrainMesh(J.tileID),ot=T.getTerrainData(J.tileID),ut=O.getProjectionData({overscaledTileID:J.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),pt={u_ele_delta:T.getMeshFrameDelta(O.zoom)};$.draw(z,D.TRIANGLES,Z,Ai.disabled,j,Ye.backCCW,pt,ot,ut,"terrain",ct.vertexBuffer,ct.indexBuffer,ct.segments)}z.bindFramebuffer.set(null),z.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain),function(y,T){const z=y.context,D=z.gl,O=y.transform,j=Ri.unblended,Z=new je(D.LEQUAL,je.ReadWrite,[0,1]),U=T.getCoordsTexture(),$=T.sourceCache.getRenderableTiles(),J=y.useProgram("terrainCoords");z.bindFramebuffer.set(T.getFramebuffer("coords").framebuffer),z.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),z.clear({color:u.bf.transparent,depth:1}),T.coordsIndex=[];for(const ct of $){const ot=T.getTerrainMesh(ct.tileID),ut=T.getTerrainData(ct.tileID);z.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,U.texture);const pt={u_terrain_coords_id:(255-T.coordsIndex.length)/255,u_texture:0,u_ele_delta:T.getMeshFrameDelta(O.zoom)},vt=O.getProjectionData({overscaledTileID:ct.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});J.draw(z,D.TRIANGLES,Z,Ai.disabled,j,Ye.backCCW,pt,ut,vt,"terrain",ot.vertexBuffer,ot.indexBuffer,ot.segments),T.coordsIndex.push(ct.tileID.key)}z.bindFramebuffer.set(null),z.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain))}renderLayer(t,s,c,f,y){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(f||[]).length)&&(this.id=c.id,u.cb(c)?function(T,z,D,O,j,Z){if(T.renderPass!=="translucent")return;const{isRenderingToTexture:U}=Z,$=Ai.disabled,J=T.colorModeForRenderPass();(D._unevaluatedLayout.hasValue("text-variable-anchor")||D._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ct,ot,ut,pt,vt,mt,bt,At,gt){const Lt=ot.transform,Gt=ot.style.map.terrain,Ot=vt==="map",Nt=mt==="map";for(const Ut of ct){const _e=pt.getTile(Ut),ve=_e.getBucket(ut);if(!ve||!ve.text||!ve.text.segments.get().length)continue;const re=u.an(ve.textSizeData,Lt.zoom),Oe=u.aC(_e,1,ot.transform.zoom),yi=$i(Ot,ot.transform,Oe),Ni=ut.layout.get("icon-text-fit")!=="none"&&ve.hasIconData();if(re){const Yi=Math.pow(2,Lt.zoom-_e.tileID.overscaledZ),Gi=Gt?(On,Dn)=>Gt.getElevation(Ut,On,Dn):null;El(ve,Ot,Nt,gt,Lt,yi,Yi,re,Ni,u.aD(Lt,_e,bt,At),Ut.toUnwrapped(),Gi)}}}(O,T,D,z,D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),j),D.paint.get("icon-opacity").constantOr(1)!==0&&Ca(T,z,D,O,!1,D.paint.get("icon-translate"),D.paint.get("icon-translate-anchor"),D.layout.get("icon-rotation-alignment"),D.layout.get("icon-pitch-alignment"),D.layout.get("icon-keep-upright"),$,J,U),D.paint.get("text-opacity").constantOr(1)!==0&&Ca(T,z,D,O,!0,D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.layout.get("text-keep-upright"),$,J,U),z.map.showCollisionBoxes&&(Fc(T,z,D,O,!0),Fc(T,z,D,O,!1))}(t,s,c,f,this.style.placement.variableOffsets,y):u.cc(c)?function(T,z,D,O,j){if(T.renderPass!=="translucent")return;const{isRenderingToTexture:Z}=j,U=D.paint.get("circle-opacity"),$=D.paint.get("circle-stroke-width"),J=D.paint.get("circle-stroke-opacity"),ct=!D.layout.get("circle-sort-key").isConstant();if(U.constantOr(1)===0&&($.constantOr(1)===0||J.constantOr(1)===0))return;const ot=T.context,ut=ot.gl,pt=T.transform,vt=T.getDepthModeForSublayer(0,je.ReadOnly),mt=Ai.disabled,bt=T.colorModeForRenderPass(),At=[],gt=pt.getCircleRadiusCorrection();for(let Lt=0;Lt<O.length;Lt++){const Gt=O[Lt],Ot=z.getTile(Gt),Nt=Ot.getBucket(D);if(!Nt)continue;const Ut=D.paint.get("circle-translate"),_e=D.paint.get("circle-translate-anchor"),ve=u.aD(pt,Ot,Ut,_e),re=Nt.programConfigurations.get(D.id),Oe=T.useProgram("circle",re),yi=Nt.layoutVertexBuffer,Ni=Nt.indexBuffer,Yi=T.style.map.terrain&&T.style.map.terrain.getTerrainData(Gt),Gi={programConfiguration:re,program:Oe,layoutVertexBuffer:yi,indexBuffer:Ni,uniformValues:Oc(T,Ot,D,ve,gt),terrainData:Yi,projectionData:pt.getProjectionData({overscaledTileID:Gt,applyGlobeMatrix:!Z,applyTerrainMatrix:!0})};if(ct){const On=Nt.segments.get();for(const Dn of On)At.push({segments:new u.aM([Dn]),sortKey:Dn.sortKey,state:Gi})}else At.push({segments:Nt.segments,sortKey:0,state:Gi})}ct&&At.sort((Lt,Gt)=>Lt.sortKey-Gt.sortKey);for(const Lt of At){const{programConfiguration:Gt,program:Ot,layoutVertexBuffer:Nt,indexBuffer:Ut,uniformValues:_e,terrainData:ve,projectionData:re}=Lt.state;Ot.draw(ot,ut.TRIANGLES,vt,mt,bt,Ye.backCCW,_e,ve,re,D.id,Nt,Ut,Lt.segments,D.paint,T.transform.zoom,Gt)}}(t,s,c,f,y):u.cd(c)?function(T,z,D,O,j){if(D.paint.get("heatmap-opacity")===0)return;const Z=T.context,{isRenderingToTexture:U,isRenderingGlobe:$}=j;if(T.style.map.terrain){for(const J of O){const ct=z.getTile(J);z.hasRenderableParent(J)||(T.renderPass==="offscreen"?_(T,ct,D,J,$):T.renderPass==="translucent"&&A(T,D,J,U,$))}Z.viewport.set([0,0,T.width,T.height])}else T.renderPass==="offscreen"?function(J,ct,ot,ut){const pt=J.context,vt=pt.gl,mt=J.transform,bt=Ai.disabled,At=new Ri([vt.ONE,vt.ONE],u.bf.transparent,[!0,!0,!0,!0]);(function(gt,Lt,Gt){const Ot=gt.gl;gt.activeTexture.set(Ot.TEXTURE1),gt.viewport.set([0,0,Lt.width/4,Lt.height/4]);let Nt=Gt.heatmapFbos.get(u.c2);Nt?(Ot.bindTexture(Ot.TEXTURE_2D,Nt.colorAttachment.get()),gt.bindFramebuffer.set(Nt.framebuffer)):(Nt=B(gt,Lt.width/4,Lt.height/4),Gt.heatmapFbos.set(u.c2,Nt))})(pt,J,ot),pt.clear({color:u.bf.transparent});for(let gt=0;gt<ut.length;gt++){const Lt=ut[gt];if(ct.hasRenderableParent(Lt))continue;const Gt=ct.getTile(Lt),Ot=Gt.getBucket(ot);if(!Ot)continue;const Nt=Ot.programConfigurations.get(ot.id),Ut=J.useProgram("heatmap",Nt),_e=mt.getProjectionData({overscaledTileID:Lt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),ve=mt.getCircleRadiusCorrection();Ut.draw(pt,vt.TRIANGLES,je.disabled,bt,At,Ye.backCCW,Ku(Gt,mt.zoom,ot.paint.get("heatmap-intensity"),ve),null,_e,ot.id,Ot.layoutVertexBuffer,Ot.indexBuffer,Ot.segments,ot.paint,mt.zoom,Nt)}pt.viewport.set([0,0,J.width,J.height])}(T,z,D,O):T.renderPass==="translucent"&&function(J,ct){const ot=J.context,ut=ot.gl;ot.setColorMode(J.colorModeForRenderPass());const pt=ct.heatmapFbos.get(u.c2);pt&&(ot.activeTexture.set(ut.TEXTURE0),ut.bindTexture(ut.TEXTURE_2D,pt.colorAttachment.get()),ot.activeTexture.set(ut.TEXTURE1),G(ot,ct).bind(ut.LINEAR,ut.CLAMP_TO_EDGE),J.useProgram("heatmapTexture").draw(ot,ut.TRIANGLES,je.disabled,Ai.disabled,J.colorModeForRenderPass(),Ye.disabled,Ts(J,ct,0,1),null,null,ct.id,J.viewportBuffer,J.quadTriangleIndexBuffer,J.viewportSegments,ct.paint,J.transform.zoom))}(T,D)}(t,s,c,f,y):u.ce(c)?function(T,z,D,O,j){if(T.renderPass!=="translucent")return;const{isRenderingToTexture:Z}=j,U=D.paint.get("line-opacity"),$=D.paint.get("line-width");if(U.constantOr(1)===0||$.constantOr(1)===0)return;const J=T.getDepthModeForSublayer(0,je.ReadOnly),ct=T.colorModeForRenderPass(),ot=D.paint.get("line-dasharray"),ut=D.paint.get("line-pattern"),pt=ut.constantOr(1),vt=D.paint.get("line-gradient"),mt=D.getCrossfadeParameters(),bt=pt?"linePattern":ot?"lineSDF":vt?"lineGradient":"line",At=T.context,gt=At.gl,Lt=T.transform;let Gt=!0;for(const Ot of O){const Nt=z.getTile(Ot);if(pt&&!Nt.patternsLoaded())continue;const Ut=Nt.getBucket(D);if(!Ut)continue;const _e=Ut.programConfigurations.get(D.id),ve=T.context.program.get(),re=T.useProgram(bt,_e),Oe=Gt||re.program!==ve,yi=T.style.map.terrain&&T.style.map.terrain.getTerrainData(Ot),Ni=ut.constantOr(null);if(Ni&&Nt.imageAtlas){const mi=Nt.imageAtlas,Wi=mi.patternPositions[Ni.to.toString()],Wn=mi.patternPositions[Ni.from.toString()];Wi&&Wn&&_e.setConstantPatternPositions(Wi,Wn)}const Yi=Lt.getProjectionData({overscaledTileID:Ot,applyGlobeMatrix:!Z,applyTerrainMatrix:!0}),Gi=Lt.getPixelScale(),On=pt?Wo(T,Nt,D,Gi,mt):ot?Qa(T,Nt,D,Gi,ot,mt):vt?rc(T,Nt,D,Gi,Ut.lineClipsArray.length):Ka(T,Nt,D,Gi);if(pt)At.activeTexture.set(gt.TEXTURE0),Nt.imageAtlasTexture.bind(gt.LINEAR,gt.CLAMP_TO_EDGE),_e.updatePaintBuffers(mt);else if(ot&&(Oe||T.lineAtlas.dirty))At.activeTexture.set(gt.TEXTURE0),T.lineAtlas.bind(At);else if(vt){const mi=Ut.gradients[D.id];let Wi=mi.texture;if(D.gradientVersion!==mi.version){let Wn=256;if(D.stepInterpolant){const yr=z.getSource().maxzoom,Er=Ot.canonical.z===yr?Math.ceil(1<<T.transform.maxZoom-Ot.canonical.z):1;Wn=u.ah(u.c3(Ut.maxLineLength/u.$*1024*Er),256,At.maxTextureSize)}mi.gradient=u.c4({expression:D.gradientExpression(),evaluationKey:"lineProgress",resolution:Wn,image:mi.gradient||void 0,clips:Ut.lineClipsArray}),mi.texture?mi.texture.update(mi.gradient):mi.texture=new u.T(At,mi.gradient,gt.RGBA),mi.version=D.gradientVersion,Wi=mi.texture}At.activeTexture.set(gt.TEXTURE0),Wi.bind(D.stepInterpolant?gt.NEAREST:gt.LINEAR,gt.CLAMP_TO_EDGE)}const Dn=T.stencilModeForClipping(Ot);re.draw(At,gt.TRIANGLES,J,Dn,ct,Ye.disabled,On,yi,Yi,D.id,Ut.layoutVertexBuffer,Ut.indexBuffer,Ut.segments,D.paint,T.transform.zoom,_e,Ut.layoutVertexBuffer2),Gt=!1}}(t,s,c,f,y):u.cf(c)?function(T,z,D,O,j){const Z=D.paint.get("fill-color"),U=D.paint.get("fill-opacity");if(U.constantOr(1)===0)return;const{isRenderingToTexture:$}=j,J=T.colorModeForRenderPass(),ct=D.paint.get("fill-pattern"),ot=T.opaquePassEnabledForLayer()&&!ct.constantOr(1)&&Z.constantOr(u.bf.transparent).a===1&&U.constantOr(0)===1?"opaque":"translucent";if(T.renderPass===ot){const ut=T.getDepthModeForSublayer(1,T.renderPass==="opaque"?je.ReadWrite:je.ReadOnly);wt(T,z,D,O,ut,J,!1,$)}if(T.renderPass==="translucent"&&D.paint.get("fill-antialias")){const ut=T.getDepthModeForSublayer(D.getPaintProperty("fill-outline-color")?2:0,je.ReadOnly);wt(T,z,D,O,ut,J,!0,$)}}(t,s,c,f,y):u.cg(c)?function(T,z,D,O,j){const Z=D.paint.get("fill-extrusion-opacity");if(Z===0)return;const{isRenderingToTexture:U}=j;if(T.renderPass==="translucent"){const $=new je(T.context.gl.LEQUAL,je.ReadWrite,T.depthRangeFor3D);if(Z!==1||D.paint.get("fill-extrusion-pattern").constantOr(1))Bt(T,z,D,O,$,Ai.disabled,Ri.disabled,U),Bt(T,z,D,O,$,T.stencilModeFor3D(),T.colorModeForRenderPass(),U);else{const J=T.colorModeForRenderPass();Bt(T,z,D,O,$,Ai.disabled,J,U)}}}(t,s,c,f,y):u.ch(c)?function(T,z,D,O,j){if(T.renderPass!=="offscreen"&&T.renderPass!=="translucent")return;const{isRenderingToTexture:Z}=j,U=T.context,$=T.style.projection.useSubdivision,J=T.getDepthModeForSublayer(0,je.ReadOnly),ct=T.colorModeForRenderPass();if(T.renderPass==="offscreen")(function(ot,ut,pt,vt,mt,bt,At){const gt=ot.context,Lt=gt.gl;for(const Gt of pt){const Ot=ut.getTile(Gt),Nt=Ot.dem;if(!Nt||!Nt.data||!Ot.needsHillshadePrepare)continue;const Ut=Nt.dim,_e=Nt.stride,ve=Nt.getPixels();if(gt.activeTexture.set(Lt.TEXTURE1),gt.pixelStoreUnpackPremultiplyAlpha.set(!1),Ot.demTexture=Ot.demTexture||ot.getTileTexture(_e),Ot.demTexture){const Oe=Ot.demTexture;Oe.update(ve,{premultiply:!1}),Oe.bind(Lt.NEAREST,Lt.CLAMP_TO_EDGE)}else Ot.demTexture=new u.T(gt,ve,Lt.RGBA,{premultiply:!1}),Ot.demTexture.bind(Lt.NEAREST,Lt.CLAMP_TO_EDGE);gt.activeTexture.set(Lt.TEXTURE0);let re=Ot.fbo;if(!re){const Oe=new u.T(gt,{width:Ut,height:Ut,data:null},Lt.RGBA);Oe.bind(Lt.LINEAR,Lt.CLAMP_TO_EDGE),re=Ot.fbo=gt.createFramebuffer(Ut,Ut,!0,!1),re.colorAttachment.set(Oe.texture)}gt.bindFramebuffer.set(re.framebuffer),gt.viewport.set([0,0,Ut,Ut]),ot.useProgram("hillshadePrepare").draw(gt,Lt.TRIANGLES,mt,bt,At,Ye.disabled,gu(Ot.tileID,Nt),null,null,vt.id,ot.rasterBoundsBuffer,ot.quadTriangleIndexBuffer,ot.rasterBoundsSegments),Ot.needsHillshadePrepare=!1}})(T,z,O,D,J,Ai.disabled,ct),U.viewport.set([0,0,T.width,T.height]);else if(T.renderPass==="translucent")if($){const[ot,ut,pt]=T.stencilConfigForOverlapTwoPass(O);qt(T,z,D,pt,ot,J,ct,!1,Z),qt(T,z,D,pt,ut,J,ct,!0,Z)}else{const[ot,ut]=T.getStencilConfigForOverlapAndUpdateStencilID(O);qt(T,z,D,ut,ot,J,ct,!1,Z)}}(t,s,c,f,y):u.ci(c)?function(T,z,D,O,j){if(T.renderPass!=="translucent"||!O.length)return;const{isRenderingToTexture:Z}=j,U=T.style.projection.useSubdivision,$=T.getDepthModeForSublayer(0,je.ReadOnly),J=T.colorModeForRenderPass();if(U){const[ct,ot,ut]=T.stencilConfigForOverlapTwoPass(O);he(T,z,D,ut,ct,$,J,!1,Z),he(T,z,D,ut,ot,$,J,!0,Z)}else{const[ct,ot]=T.getStencilConfigForOverlapAndUpdateStencilID(O);he(T,z,D,ot,ct,$,J,!1,Z)}}(t,s,c,f,y):u.cj(c)?function(T,z,D,O,j){if(T.renderPass!=="translucent"||D.paint.get("raster-opacity")===0||!O.length)return;const{isRenderingToTexture:Z}=j,U=z.getSource(),$=T.style.projection.useSubdivision;if(U instanceof Qs)ke(T,z,D,O,null,!1,!1,U.tileCoords,U.flippedWindingOrder,Z);else if($){const[J,ct,ot]=T.stencilConfigForOverlapTwoPass(O);ke(T,z,D,ot,J,!1,!0,De,!1,Z),ke(T,z,D,ot,ct,!0,!0,De,!1,Z)}else{const[J,ct]=T.getStencilConfigForOverlapAndUpdateStencilID(O);ke(T,z,D,ct,J,!1,!0,De,!1,Z)}}(t,s,c,f,y):u.ck(c)?function(T,z,D,O,j){const Z=D.paint.get("background-color"),U=D.paint.get("background-opacity");if(U===0)return;const{isRenderingToTexture:$}=j,J=T.context,ct=J.gl,ot=T.style.projection,ut=T.transform,pt=ut.tileSize,vt=D.paint.get("background-pattern");if(T.isPatternMissing(vt))return;const mt=!vt&&Z.a===1&&U===1&&T.opaquePassEnabledForLayer()?"opaque":"translucent";if(T.renderPass!==mt)return;const bt=Ai.disabled,At=T.getDepthModeForSublayer(0,mt==="opaque"?je.ReadWrite:je.ReadOnly),gt=T.colorModeForRenderPass(),Lt=T.useProgram(vt?"backgroundPattern":"background"),Gt=O||It(ut,{tileSize:pt,terrain:T.style.map.terrain});vt&&(J.activeTexture.set(ct.TEXTURE0),T.imageManager.bind(T.context));const Ot=D.getCrossfadeParameters();for(const Nt of Gt){const Ut=ut.getProjectionData({overscaledTileID:Nt,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),_e=vt?Qu(U,T,vt,{tileID:Nt,tileSize:pt},Ot):Ta(U,Z),ve=T.style.map.terrain&&T.style.map.terrain.getTerrainData(Nt),re=ot.getMeshFromTileID(J,Nt.canonical,!1,!0,"raster");Lt.draw(J,ct.TRIANGLES,At,bt,gt,Ye.backCCW,_e,ve,Ut,D.id,re.vertexBuffer,re.indexBuffer,re.segments)}}(t,0,c,f,y):u.cl(c)&&function(T,z,D,O){const{isRenderingGlobe:j}=O,Z=T.context,U=D.implementation,$=T.style.projection,J=T.transform,ct=J.getProjectionDataForCustomLayer(j),ot={farZ:J.farZ,nearZ:J.nearZ,fov:J.fov*Math.PI/180,modelViewProjectionMatrix:J.modelViewProjectionMatrix,projectionMatrix:J.projectionMatrix,shaderData:{variantName:$.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${$.shaderPreludeCode.vertexSource}`,define:$.shaderDefine},defaultProjectionData:ct},ut=U.renderingMode?U.renderingMode:"2d";if(T.renderPass==="offscreen"){const pt=U.prerender;pt&&(T.setCustomLayerDefaults(),Z.setColorMode(T.colorModeForRenderPass()),pt.call(U,Z.gl,ot),Z.setDirty(),T.setBaseState())}else if(T.renderPass==="translucent"){T.setCustomLayerDefaults(),Z.setColorMode(T.colorModeForRenderPass()),Z.setStencilMode(Ai.disabled);const pt=ut==="3d"?T.getDepthModeFor3D():T.getDepthModeForSublayer(0,je.ReadOnly);Z.setDepthMode(pt),U.render(Z.gl,ot),Z.setDirty(),T.setBaseState(),Z.bindFramebuffer.set(null)}}(t,0,c,y))}saveTileTexture(t){const s=this._tileTextures[t.size[0]];s?s.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const s=this._tileTextures[t];return s&&s.length>0?s.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const s=this.imageManager.getPattern(t.from.toString()),c=this.imageManager.getPattern(t.to.toString());return!s||!c}useProgram(t,s,c=!1,f=[]){this.cache=this.cache||{};const y=!!this.style.map.terrain,T=this.style.projection,z=c?Ur.projectionMercator:T.shaderPreludeCode,D=c?ea:T.shaderDefine,O=t+(s?s.cacheKey:"")+`/${c?va:T.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(y?"/terrain":"")+(f?`/${f.join("/")}`:"");return this.cache[O]||(this.cache[O]=new _u(this.context,Ur[t],s,Gr[t],this._showOverdrawInspector,y,z,D,f)),this.cache[O]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new u.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:s}=this.context.gl;return this.width!==t||this.height!==s}}function Or(g,t){let s,c=!1,f=null,y=null;const T=()=>{f=null,c&&(g.apply(y,s),f=setTimeout(T,t),c=!1)};return(...z)=>(c=!0,y=this,s=z,f||T(),f)}class $s{constructor(t){this._getCurrentHash=()=>{const s=window.location.hash.replace("#","");if(this._hashName){let c;return s.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(c=f)}),(c&&c[1]||"").split("/")}return s.split("/")},this._onHashChange=()=>{const s=this._getCurrentHash();if(!this._isValidHash(s))return!1;const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:c,pitch:+(s[4]||0)}),!0},this._updateHashUnthrottled=()=>{const s=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,s)},this._removeHash=()=>{const s=this._getCurrentHash();if(s.length===0)return;const c=s.join("/");let f=c;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${c}`);let y=window.location.hash.replace(f,"");y.startsWith("#&")?y=y.slice(0,1)+y.slice(2):y==="#"&&(y="");let T=window.location.href.replace(/(#.+)?$/,y);T=T.replace("&&","&"),window.history.replaceState(window.history.state,null,T)},this._updateHash=Or(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const s=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,f=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,f),T=Math.round(s.lng*y)/y,z=Math.round(s.lat*y)/y,D=this._map.getBearing(),O=this._map.getPitch();let j="";if(j+=t?`/${T}/${z}/${c}`:`${c}/${z}/${T}`,(D||O)&&(j+="/"+Math.round(10*D)/10),O&&(j+=`/${Math.round(O)}`),this._hashName){const Z=this._hashName;let U=!1;const $=window.location.hash.slice(1).split("&").map(J=>{const ct=J.split("=")[0];return ct===Z?(U=!0,`${ct}=${j}`):J}).filter(J=>J);return U||$.push(`${Z}=${j}`),`#${$.join("&")}`}return`#${j}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new u.S(+t[2],+t[1])}catch{return!1}const s=+t[0],c=+(t[3]||0),f=+(t[4]||0);return s>=this._map.getMinZoom()&&s<=this._map.getMaxZoom()&&c>=-180&&c<=180&&f>=this._map.getMinPitch()&&f<=this._map.getMaxPitch()}}const Nr={linearity:.3,easing:u.cm(0,0,.3,1)},oa=u.e({deceleration:2500,maxSpeed:1400},Nr),zl=u.e({deceleration:20,maxSpeed:1400},Nr),pc=u.e({deceleration:1e3,maxSpeed:360},Nr),Dl=u.e({deceleration:1e3,maxSpeed:90},Nr),xu=u.e({deceleration:1e3,maxSpeed:360},Nr);class Ll{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:ht.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,s=ht.now();for(;t.length>0&&s-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,roll:0,pan:new u.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)s.zoom+=y.zoomDelta||0,s.bearing+=y.bearingDelta||0,s.pitch+=y.pitchDelta||0,s.roll+=y.rollDelta||0,y.panDelta&&s.pan._add(y.panDelta),y.around&&(s.around=y.around),y.pinchAround&&(s.pinchAround=y.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(s.pan.mag()){const y=Jo(s.pan.mag(),c,u.e({},oa,t||{})),T=s.pan.mult(y.amount/s.pan.mag()),z=this._map.cameraHelper.handlePanInertia(T,this._map.transform);f.center=z.easingCenter,f.offset=z.easingOffset,wn(f,y)}if(s.zoom){const y=Jo(s.zoom,c,zl);f.zoom=this._map.transform.zoom+y.amount,wn(f,y)}if(s.bearing){const y=Jo(s.bearing,c,pc);f.bearing=this._map.transform.bearing+u.ah(y.amount,-179,179),wn(f,y)}if(s.pitch){const y=Jo(s.pitch,c,Dl);f.pitch=this._map.transform.pitch+y.amount,wn(f,y)}if(s.roll){const y=Jo(s.roll,c,xu);f.roll=this._map.transform.roll+u.ah(y.amount,-179,179),wn(f,y)}if(f.zoom||f.bearing){const y=s.pinchAround===void 0?s.around:s.pinchAround;f.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),u.e(f,{noMoveStart:!0})}}function wn(g,t){(!g.duration||g.duration<t.duration)&&(g.duration=t.duration,g.easing=t.easing)}function Jo(g,t,s){const{maxSpeed:c,linearity:f,deceleration:y}=s,T=u.ah(g*f/(t/1e3),-c,c),z=Math.abs(T)/(y*f);return{easing:s.easing,duration:1e3*z,amount:T*(z/2)}}class Es extends u.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,s,c,f={}){c=c instanceof MouseEvent?c:new MouseEvent(t,c);const y=lt.mousePos(s.getCanvas(),c),T=s.unproject(y);super(t,u.e({point:y,lngLat:T,originalEvent:c},f)),this._defaultPrevented=!1,this.target=s}}class Uc extends u.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,s,c){const f=t==="touchend"?c.changedTouches:c.touches,y=lt.touchPos(s.getCanvasContainer(),f),T=y.map(D=>s.unproject(D)),z=y.reduce((D,O,j,Z)=>D.add(O.div(Z.length)),new u.P(0,0));super(t,{points:y,point:z,lngLats:T,lngLat:s.unproject(z),originalEvent:c}),this._defaultPrevented=!1}}class Bh extends u.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,s,c){super(t,{originalEvent:c}),this._defaultPrevented=!1}}class Cd{constructor(t,s){this._map=t,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Bh(t.type,this._map,t))}mousedown(t,s){return this._mousedownPos=s,this._firePreventable(new Es(t.type,this._map,t))}mouseup(t){this._map.fire(new Es(t.type,this._map,t))}click(t,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Es(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Es(t.type,this._map,t))}mouseover(t){this._map.fire(new Es(t.type,this._map,t))}mouseout(t){this._map.fire(new Es(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Uc(t.type,this._map,t))}touchmove(t){this._map.fire(new Uc(t.type,this._map,t))}touchend(t){this._map.fire(new Uc(t.type,this._map,t))}touchcancel(t){this._map.fire(new Uc(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class gr{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Es(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Es("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Es(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Il{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(u.P.convert(t),this._map.terrain)}}class mc{constructor(t,s){this._map=t,this._tr=new Il(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,s){this.isEnabled()&&t.shiftKey&&t.button===0&&(lt.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(t,s){if(!this._active)return;const c=s;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=c,this._box||(this._box=lt.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const y=Math.min(f.x,c.x),T=Math.max(f.x,c.x),z=Math.min(f.y,c.y),D=Math.max(f.y,c.y);lt.setTransform(this._box,`translate(${y}px,${z}px)`),this._box.style.width=T-y+"px",this._box.style.height=D-z+"px"}mouseupWindow(t,s){if(!this._active||t.button!==0)return;const c=this._startPos,f=s;if(this.reset(),lt.suppressClick(),c.x!==f.x||c.y!==f.y)return this._map.fire(new u.l("boxzoomend",{originalEvent:t})),{cameraAnimation:y=>y.fitScreenCoordinates(c,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(lt.remove(this._box),this._box=null),lt.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,s){return this._map.fire(new u.l(t,{originalEvent:s}))}}function No(g,t){if(g.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${t.length}`);const s={};for(let c=0;c<g.length;c++)s[g[c].identifier]=t[c];return s}class eh{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,s,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),c.length===this.numTouches&&(this.centroid=function(f){const y=new u.P(0,0);for(const T of f)y._add(T);return y.div(f.length)}(s),this.touches=No(c,s)))}touchmove(t,s,c){if(this.aborted||!this.centroid)return;const f=No(c,s);for(const y in this.touches){const T=f[y];(!T||T.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(t,s,c){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class Cr{constructor(t){this.singleTap=new eh(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,s,c){this.singleTap.touchstart(t,s,c)}touchmove(t,s,c){this.singleTap.touchmove(t,s,c)}touchend(t,s,c){const f=this.singleTap.touchend(t,s,c);if(f){const y=t.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(f)<30;if(y&&T||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class us{constructor(t){this._tr=new Il(t),this._zoomIn=new Cr({numTouches:1,numTaps:2}),this._zoomOut=new Cr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,s,c){this._zoomIn.touchstart(t,s,c),this._zoomOut.touchstart(t,s,c)}touchmove(t,s,c){this._zoomIn.touchmove(t,s,c),this._zoomOut.touchmove(t,s,c)}touchend(t,s,c){const f=this._zoomIn.touchend(t,s,c),y=this._zoomOut.touchend(t,s,c),T=this._tr;return f?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:T.zoom+1,around:T.unproject(f)},{originalEvent:t})}):y?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:T.zoom-1,around:T.unproject(y)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zc{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const s=this._moveFunction(...t);if(s.bearingDelta||s.pitchDelta||s.rollDelta||s.around||s.panDelta)return this._active=!0,s}dragStart(t,s){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(s)?s[0]:s,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,s){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const f=Array.isArray(s)?s[0]:s;return!this._moved&&f.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(c,f))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&lt.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const za=0,Gc=2,Ed={[za]:1,[Gc]:2};class ro{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const s=lt.mouseButton(t);this._eventButton=s}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(s,c){const f=Ed[c];return s.buttons===void 0||(s.buttons&f)!==f}(t,this._eventButton)}isValidEndEvent(t){return lt.mouseButton(t)===this._eventButton}}class Oh{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class ih{constructor(t=new ro({checkCorrectEvent:()=>!0}),s=new Oh){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=s}_executeRelevantHandler(t,s,c){return t instanceof MouseEvent?s(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?c(t):void 0}startMove(t){this._executeRelevantHandler(t,s=>this.mouseMoveStateManager.startMove(s),s=>this.oneFingerTouchMoveStateManager.startMove(s))}endMove(t){this._executeRelevantHandler(t,s=>this.mouseMoveStateManager.endMove(s),s=>this.oneFingerTouchMoveStateManager.endMove(s))}isValidStartEvent(t){return this._executeRelevantHandler(t,s=>this.mouseMoveStateManager.isValidStartEvent(s),s=>this.oneFingerTouchMoveStateManager.isValidStartEvent(s))}isValidMoveEvent(t){return this._executeRelevantHandler(t,s=>this.mouseMoveStateManager.isValidMoveEvent(s),s=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(s))}isValidEndEvent(t){return this._executeRelevantHandler(t,s=>this.mouseMoveStateManager.isValidEndEvent(s),s=>this.oneFingerTouchMoveStateManager.isValidEndEvent(s))}}const Hc=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=t=>{t.preventDefault()}};class tl{constructor(t,s){this._clickTolerance=t.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,s,c){return this._calculateTransform(t,s,c)}touchmove(t,s,c){if(this._active){if(!this._shouldBePrevented(c.length))return t.preventDefault(),this._calculateTransform(t,s,c);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,s,c){this._calculateTransform(t,s,c),this._active&&this._shouldBePrevented(c.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,s,c){c.length>0&&(this._active=!0);const f=No(c,s),y=new u.P(0,0),T=new u.P(0,0);let z=0;for(const O in f){const j=f[O],Z=this._touches[O];Z&&(y._add(j),T._add(j.sub(Z)),z++,f[O]=j)}if(this._touches=f,this._shouldBePrevented(z)||!T.mag())return;const D=T.div(z);return this._sum._add(D),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(z),panDelta:D}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Da{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,s,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([s[0],s[1]]))}touchmove(t,s,c){if(!this._firstTwoTouches)return;t.preventDefault();const[f,y]=this._firstTwoTouches,T=Ee(c,s,f),z=Ee(c,s,y);if(!T||!z)return;const D=this._aroundCenter?null:T.add(z).div(2);return this._move([T,z],D,t)}touchend(t,s,c){if(!this._firstTwoTouches)return;const[f,y]=this._firstTwoTouches,T=Ee(c,s,f),z=Ee(c,s,y);T&&z||(this._active&&lt.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Ee(g,t,s){for(let c=0;c<g.length;c++)if(g[c].identifier===s)return t[c]}function bu(g,t){return Math.log(g/t)/Math.LN2}class wu extends Da{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,s){const c=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(bu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:bu(this._distance,c),pinchAround:s}}}function qc(g,t){return 180*g.angleWith(t)/Math.PI}class _c extends Da{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,s,c){const f=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:qc(this._vector,f),pinchAround:s}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const s=25/(Math.PI*this._minDiameter)*360,c=qc(t,this._startVector);return Math.abs(c)<s}}function so(g){return Math.abs(g.y)>Math.abs(g.x)}class Tu extends Da{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,s,c){super.touchstart(t,s,c),this._currentTouchCount=c.length}_start(t){this._lastPoints=t,so(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,s,c){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=t[0].sub(this._lastPoints[0]),y=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,y,c.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(f.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(t,s,c){if(this._valid!==void 0)return this._valid;const f=t.mag()>=2,y=s.mag()>=2;if(!f&&!y)return;if(!f||!y)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const T=t.y>0==s.y>0;return so(t)&&so(s)&&T}}const Di={panStep:100,bearingStep:15,pitchStep:10};class ao{constructor(t){this._tr=new Il(t);const s=Di;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let s=0,c=0,f=0,y=0,T=0;switch(t.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:t.shiftKey?c=-1:(t.preventDefault(),y=-1);break;case 39:t.shiftKey?c=1:(t.preventDefault(),y=1);break;case 38:t.shiftKey?f=1:(t.preventDefault(),T=-1);break;case 40:t.shiftKey?f=-1:(t.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(c=0,f=0),{cameraAnimation:z=>{const D=this._tr;z.easeTo({duration:300,easeId:"keyboardHandler",easing:Nh,zoom:s?Math.round(D.zoom)+s*(t.shiftKey?2:1):D.zoom,bearing:D.bearing+c*this._bearingStep,pitch:D.pitch+f*this._pitchStep,offset:[-y*this._panStep,-T*this._panStep],center:D.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Nh(g){return g*(2-g)}const $c=4.000244140625,Rl=1/450;class el{constructor(t,s){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=t,this._tr=new Il(t),this._triggerRenderFrame=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Rl}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let s=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const c=ht.now(),f=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,s!==0&&s%$c==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(f*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),t.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=t,this._delta-=s,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=lt.mousePos(this._map.getCanvas(),t),c=this._tr;this._aroundPoint=this._aroundCenter?c.transform.locationToScreenPoint(u.S.convert(c.center)):s,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const z=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=z),typeof this._targetZoom=="number"&&(this._targetZoom+=z)}if(this._delta!==0){const z=this._type==="wheel"&&Math.abs(this._delta)>$c?this._wheelZoomRate:this._defaultZoomRate;let D=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&D!==0&&(D=1/D);const O=typeof this._targetZoom!="number"?t.scale:u.af(this._targetZoom);this._targetZoom=t.getConstrained(t.getCameraLngLat(),u.ak(O*D)).zoom,this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,c=this._startZoom,f=this._easing;let y,T=!1;if(this._type==="wheel"&&c&&f){const z=ht.now()-this._lastWheelEventTime,D=Math.min((z+5)/200,1),O=f(D);y=u.C.number(c,s,O),D<1?this._frameId||(this._frameId=!0):T=!0}else y=s,T=!0;return this._active=!0,T&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=y,{noInertia:!0,needsRenderFrame:!T,zoomDelta:y-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let s=u.co;if(this._prevEase){const c=this._prevEase,f=(ht.now()-c.start)/c.duration,y=c.easing(f+.01)-c.easing(f),T=.27/Math.sqrt(y*y+1e-4)*.01,z=Math.sqrt(.0729-T*T);s=u.cm(T,z,.25,1)}return this._prevEase={start:ht.now(),duration:t,easing:s},s}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class gc{constructor(t,s){this._clickZoom=t,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Su{constructor(t){this._tr=new Il(t),this.reset()}reset(){this._active=!1}dblclick(t,s){return t.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(s)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nh{constructor(){this._tap=new Cr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,s,c){if(!this._swipePoint)if(this._tapTime){const f=s[0],y=t.timeStamp-this._tapTime<500,T=this._tapPoint.dist(f)<30;y&&T?c.length>0&&(this._swipePoint=f,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(t,s,c)}touchmove(t,s,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const f=s[0],y=f.y-this._swipePoint.y;return this._swipePoint=f,t.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(t,s,c)}touchend(t,s,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const f=this._tap.touchend(t,s,c);f&&(this._tapTime=t.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xc{constructor(t,s,c){this._el=t,this._mousePan=s,this._touchPan=c}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class yc{constructor(t,s,c,f){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=s,this._mousePitch=c,this._mouseRoll=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class jh{constructor(t,s,c,f){this._el=t,this._touchZoom=s,this._touchRotate=c,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Fh{constructor(t,s){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=s,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=lt.create("div","maplibregl-cooperative-gesture-screen",t);let s=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(s=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const c=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=s,this._container.appendChild(f);const y=document.createElement("div");y.className="maplibregl-mobile-message",y.textContent=c,this._container.appendChild(y),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(lt.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,s){this._enabled&&(this._map.fire(new u.l("cooperativegestureprevented",{gestureType:t,originalEvent:s})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const hs=g=>g.zoom||g.drag||g.roll||g.pitch||g.rotate;class cn extends u.l{}function vc(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta||g.rollDelta}class Mu{constructor(t,s){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,y)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const T=f.type==="renderFrame"?void 0:f,z={needsRenderFrame:!1},D={},O={};for(const{handlerName:U,handler:$,allowed:J}of this._handlers){if(!$.isEnabled())continue;let ct;if(this._blockedByActive(O,J,U))$.reset();else if($[y||f.type]){if(u.cp(f,y||f.type)){const ot=lt.mousePos(this._map.getCanvas(),f);ct=$[y||f.type](f,ot)}else if(u.cq(f,y||f.type)){const ot=this._getMapTouches(f.touches),ut=lt.touchPos(this._map.getCanvas(),ot);ct=$[y||f.type](f,ut,ot)}else u.cr(y||f.type)||(ct=$[y||f.type](f));this.mergeHandlerResult(z,D,ct,U,T),ct&&ct.needsRenderFrame&&this._triggerRenderFrame()}(ct||$.isActive())&&(O[U]=$)}const j={};for(const U in this._previousActiveHandlers)O[U]||(j[U]=T);this._previousActiveHandlers=O,(Object.keys(j).length||vc(z))&&(this._changes.push([z,D,j]),this._triggerRenderFrame()),(Object.keys(O).length||vc(z))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=z;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ll(t),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,y,T]of this._listeners)lt.addEventListener(f,y,f===document?this.handleWindowEvent:this.handleEvent,T)}destroy(){for(const[t,s,c]of this._listeners)lt.removeEventListener(t,s,t===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(t){const s=this._map,c=s.getCanvasContainer();this._add("mapEvent",new Cd(s,t));const f=s.boxZoom=new mc(s,t);this._add("boxZoom",f),t.interactive&&t.boxZoom&&f.enable();const y=s.cooperativeGestures=new Fh(s,t.cooperativeGestures);this._add("cooperativeGestures",y),t.cooperativeGestures&&y.enable();const T=new us(s),z=new Su(s);s.doubleClickZoom=new gc(z,T),this._add("tapZoom",T),this._add("clickZoom",z),t.interactive&&t.doubleClickZoom&&s.doubleClickZoom.enable();const D=new nh;this._add("tapDragZoom",D);const O=s.touchPitch=new Tu(s);this._add("touchPitch",O),t.interactive&&t.touchPitch&&s.touchPitch.enable(t.touchPitch);const j=()=>s.project(s.getCenter()),Z=function({enable:mt,clickTolerance:bt,aroundCenter:At=!0,minPixelCenterThreshold:gt=100,rotateDegreesPerPixelMoved:Lt=.8},Gt){const Ot=new ro({checkCorrectEvent:Nt=>lt.mouseButton(Nt)===0&&Nt.ctrlKey||lt.mouseButton(Nt)===2&&!Nt.ctrlKey});return new Zc({clickTolerance:bt,move:(Nt,Ut)=>{const _e=Gt();if(At&&Math.abs(_e.y-Nt.y)>gt)return{bearingDelta:u.cn(new u.P(Nt.x,Ut.y),Ut,_e)};let ve=(Ut.x-Nt.x)*Lt;return At&&Ut.y<_e.y&&(ve=-ve),{bearingDelta:ve}},moveStateManager:Ot,enable:mt,assignEvents:Hc})}(t,j),U=function({enable:mt,clickTolerance:bt,pitchDegreesPerPixelMoved:At=-.5}){const gt=new ro({checkCorrectEvent:Lt=>lt.mouseButton(Lt)===0&&Lt.ctrlKey||lt.mouseButton(Lt)===2});return new Zc({clickTolerance:bt,move:(Lt,Gt)=>({pitchDelta:(Gt.y-Lt.y)*At}),moveStateManager:gt,enable:mt,assignEvents:Hc})}(t),$=function({enable:mt,clickTolerance:bt,rollDegreesPerPixelMoved:At=.3},gt){const Lt=new ro({checkCorrectEvent:Gt=>lt.mouseButton(Gt)===2&&Gt.ctrlKey});return new Zc({clickTolerance:bt,move:(Gt,Ot)=>{const Nt=gt();let Ut=(Ot.x-Gt.x)*At;return Ot.y<Nt.y&&(Ut=-Ut),{rollDelta:Ut}},moveStateManager:Lt,enable:mt,assignEvents:Hc})}(t,j);s.dragRotate=new yc(t,Z,U,$),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",U,["mouseRotate","mouseRoll"]),this._add("mouseRoll",$,["mousePitch"]),t.interactive&&t.dragRotate&&s.dragRotate.enable();const J=function({enable:mt,clickTolerance:bt}){const At=new ro({checkCorrectEvent:gt=>lt.mouseButton(gt)===0&&!gt.ctrlKey});return new Zc({clickTolerance:bt,move:(gt,Lt)=>({around:Lt,panDelta:Lt.sub(gt)}),activateOnStart:!0,moveStateManager:At,enable:mt,assignEvents:Hc})}(t),ct=new tl(t,s);s.dragPan=new Xc(c,J,ct),this._add("mousePan",J),this._add("touchPan",ct,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&s.dragPan.enable(t.dragPan);const ot=new _c,ut=new wu;s.touchZoomRotate=new jh(c,ut,ot,D),this._add("touchRotate",ot,["touchPan","touchZoom"]),this._add("touchZoom",ut,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&s.touchZoomRotate.enable(t.touchZoomRotate);const pt=s.scrollZoom=new el(s,()=>this._triggerRenderFrame());this._add("scrollZoom",pt,["mousePan"]),t.interactive&&t.scrollZoom&&s.scrollZoom.enable(t.scrollZoom);const vt=s.keyboard=new ao(s);this._add("keyboard",vt),t.interactive&&t.keyboard&&s.keyboard.enable(),this._add("blockableMapEvent",new gr(s))}_add(t,s,c){this._handlers.push({handlerName:t,handler:s,allowed:c}),this._handlersById[t]=s}stop(t){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!hs(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,s,c){for(const f in t)if(f!==c&&(!s||s.indexOf(f)<0))return!0;return!1}_getMapTouches(t){const s=[];for(const c of t)this._el.contains(c.target)&&s.push(c);return s}mergeHandlerResult(t,s,c,f,y){if(!c)return;u.e(t,c);const T={handlerName:f,originalEvent:c.originalEvent||y};c.zoomDelta!==void 0&&(s.zoom=T),c.panDelta!==void 0&&(s.drag=T),c.rollDelta!==void 0&&(s.roll=T),c.pitchDelta!==void 0&&(s.pitch=T),c.bearingDelta!==void 0&&(s.rotate=T)}_applyChanges(){const t={},s={},c={};for(const[f,y,T]of this._changes)f.panDelta&&(t.panDelta=(t.panDelta||new u.P(0,0))._add(f.panDelta)),f.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+f.pitchDelta),f.rollDelta&&(t.rollDelta=(t.rollDelta||0)+f.rollDelta),f.around!==void 0&&(t.around=f.around),f.pinchAround!==void 0&&(t.pinchAround=f.pinchAround),f.noInertia&&(t.noInertia=f.noInertia),u.e(s,y),u.e(c,T);this._updateMapTransform(t,s,c),this._changes=[]}_updateMapTransform(t,s,c){const f=this._map,y=f._getTransformForUpdate(),T=f.terrain;if(!(vc(t)||T&&this._terrainMovement))return this._fireEvents(s,c,!0);f._stop(!0);let{panDelta:z,zoomDelta:D,bearingDelta:O,pitchDelta:j,rollDelta:Z,around:U,pinchAround:$}=t;$!==void 0&&(U=$),U=U||f.transform.centerPoint,T&&!y.isPointOnMapSurface(U)&&(U=y.centerPoint);const J={panDelta:z,zoomDelta:D,rollDelta:Z,pitchDelta:j,bearingDelta:O,around:U};this._map.cameraHelper.useGlobeControls&&!y.isPointOnMapSurface(U)&&(U=y.centerPoint);const ct=U.distSqr(y.centerPoint)<.01?y.center:y.screenPointToLocation(z?U.sub(z):U);T?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(J,y),this._terrainMovement||!s.drag&&!s.zoom?s.drag&&this._terrainMovement?y.setCenter(y.screenPointToLocation(y.centerPoint.sub(z))):this._map.cameraHelper.handleMapControlsPan(J,y,ct):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(J,y,ct))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(J,y),this._map.cameraHelper.handleMapControlsPan(J,y,ct)),f._applyUpdatedTransform(y),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(s,c,!0)}_fireEvents(t,s,c){const f=hs(this._eventsInProgress),y=hs(t),T={};for(const Z in t){const{originalEvent:U}=t[Z];this._eventsInProgress[Z]||(T[`${Z}start`]=U),this._eventsInProgress[Z]=t[Z]}!f&&y&&this._fireEvent("movestart",y.originalEvent);for(const Z in T)this._fireEvent(Z,T[Z]);y&&this._fireEvent("move",y.originalEvent);for(const Z in t){const{originalEvent:U}=t[Z];this._fireEvent(Z,U)}const z={};let D;for(const Z in this._eventsInProgress){const{handlerName:U,originalEvent:$}=this._eventsInProgress[Z];this._handlersById[U].isActive()||(delete this._eventsInProgress[Z],D=s[U]||$,z[`${Z}end`]=D)}for(const Z in z)this._fireEvent(Z,z[Z]);const O=hs(this._eventsInProgress),j=(f||y)&&!O;if(j&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Z=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Z.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Z)}if(c&&j){this._updatingCamera=!0;const Z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),U=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;!Z||!Z.essential&&ht.prefersReducedMotion?(this._map.fire(new u.l("moveend",{originalEvent:D})),U(this._map.getBearing())&&this._map.resetNorth()):(U(Z.bearing||this._map.getBearing())&&(Z.bearing=0),Z.freezeElevation=!0,this._map.easeTo(Z,{originalEvent:D})),this._updatingCamera=!1}}_fireEvent(t,s){this._map.fire(new u.l(t,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new cn("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class rh extends u.E{constructor(t,s,c){super(),this._renderFrameCallback=()=>{const f=Math.min((ht.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=c.bearingSnap,this.cameraHelper=s,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(t,s){t.apply(this.transform),this.transform=t,this.cameraHelper=s}getCenter(){return new u.S(this.transform.center.lng,this.transform.center.lat)}setCenter(t,s){return this.jumpTo({center:t},s)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,s){return this.jumpTo({elevation:t},s),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,s,c){return t=u.P.convert(t).mult(-1),this.panTo(this.transform.center,u.e({offset:t},s),c)}panTo(t,s,c){return this.easeTo(u.e({center:t},s),c)}getZoom(){return this.transform.zoom}setZoom(t,s){return this.jumpTo({zoom:t},s),this}zoomTo(t,s,c){return this.easeTo(u.e({zoom:t},s),c)}zoomIn(t,s){return this.zoomTo(this.getZoom()+1,t,s),this}zoomOut(t,s){return this.zoomTo(this.getZoom()-1,t,s),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,s){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new u.l("movestart",s)).fire(new u.l("move",s)).fire(new u.l("moveend",s))),this}getBearing(){return this.transform.bearing}setBearing(t,s){return this.jumpTo({bearing:t},s),this}getPadding(){return this.transform.padding}setPadding(t,s){return this.jumpTo({padding:t},s),this}rotateTo(t,s,c){return this.easeTo(u.e({bearing:t},s),c)}resetNorth(t,s){return this.rotateTo(0,u.e({duration:1e3},t),s),this}resetNorthPitch(t,s){return this.easeTo(u.e({bearing:0,pitch:0,roll:0,duration:1e3},t),s),this}snapToNorth(t,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,s):this}getPitch(){return this.transform.pitch}setPitch(t,s){return this.jumpTo({pitch:t},s),this}getRoll(){return this.transform.roll}setRoll(t,s){return this.jumpTo({roll:t},s),this}cameraForBounds(t,s){t=sn.convert(t).adjustAntiMeridian();const c=s&&s.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),c,s)}_cameraForBoxAndBearing(t,s,c,f){const y={top:0,bottom:0,right:0,left:0};if(typeof(f=u.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const O=f.padding;f.padding={top:O,bottom:O,right:O,left:O}}const T=u.e(y,f.padding);f.padding=T;const z=this.transform,D=new sn(t,s);return this.cameraHelper.cameraForBoxAndBearing(f,T,D,c,z)}fitBounds(t,s,c){return this._fitInternal(this.cameraForBounds(t,s),s,c)}fitScreenCoordinates(t,s,c,f,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(u.P.convert(t)),this.transform.screenPointToLocation(u.P.convert(s)),c,f),f,y)}_fitInternal(t,s,c){return t?(delete(s=u.e(t,s)).padding,s.linear?this.easeTo(s,c):this.flyTo(s,c)):this}jumpTo(t,s){this.stop();const c=this._getTransformForUpdate();let f=!1,y=!1,T=!1;const z=c.zoom;this.cameraHelper.handleJumpToCenterZoom(c,t);const D=c.zoom!==z;return"elevation"in t&&c.elevation!==+t.elevation&&c.setElevation(+t.elevation),"bearing"in t&&c.bearing!==+t.bearing&&(f=!0,c.setBearing(+t.bearing)),"pitch"in t&&c.pitch!==+t.pitch&&(y=!0,c.setPitch(+t.pitch)),"roll"in t&&c.roll!==+t.roll&&(T=!0,c.setRoll(+t.roll)),t.padding==null||c.isPaddingEqual(t.padding)||c.setPadding(t.padding),this._applyUpdatedTransform(c),this.fire(new u.l("movestart",s)).fire(new u.l("move",s)),D&&this.fire(new u.l("zoomstart",s)).fire(new u.l("zoom",s)).fire(new u.l("zoomend",s)),f&&this.fire(new u.l("rotatestart",s)).fire(new u.l("rotate",s)).fire(new u.l("rotateend",s)),y&&this.fire(new u.l("pitchstart",s)).fire(new u.l("pitch",s)).fire(new u.l("pitchend",s)),T&&this.fire(new u.l("rollstart",s)).fire(new u.l("roll",s)).fire(new u.l("rollend",s)),this.fire(new u.l("moveend",s))}calculateCameraOptionsFromTo(t,s,c,f=0){const y=u.a1.fromLngLat(t,s),T=u.a1.fromLngLat(c,f),z=T.x-y.x,D=T.y-y.y,O=T.z-y.z,j=Math.hypot(z,D,O);if(j===0)throw new Error("Can't calculate camera options with same From and To");const Z=Math.hypot(z,D),U=u.ak(this.transform.cameraToCenterDistance/j/this.transform.tileSize),$=180*Math.atan2(z,-D)/Math.PI;let J=180*Math.acos(Z/j)/Math.PI;return J=O<0?90-J:90+J,{center:T.toLngLat(),elevation:f,zoom:U,pitch:J,bearing:$}}calculateCameraOptionsFromCameraLngLatAltRotation(t,s,c,f,y){const T=this.transform.calculateCenterFromCameraLngLatAlt(t,s,c,f);return{center:T.center,elevation:T.elevation,zoom:T.zoom,bearing:c,pitch:f,roll:y}}easeTo(t,s){this._stop(!1,t.easeId),((t=u.e({offset:[0,0],duration:500,easing:u.co},t)).animate===!1||!t.essential&&ht.prefersReducedMotion)&&(t.duration=0);const c=this._getTransformForUpdate(),f=this.getBearing(),y=c.pitch,T=c.roll,z="bearing"in t?this._normalizeBearing(t.bearing,f):f,D="pitch"in t?+t.pitch:y,O="roll"in t?this._normalizeBearing(t.roll,T):T,j="padding"in t?t.padding:c.padding,Z=u.P.convert(t.offset);let U,$;t.around&&(U=u.S.convert(t.around),$=c.locationToScreenPoint(U));const J={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ct=this.cameraHelper.handleEaseTo(c,{bearing:z,pitch:D,roll:O,padding:j,around:U,aroundPoint:$,offsetAsPoint:Z,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||f!==z,this._pitching=this._pitching||D!==y,this._rolling=this._rolling||O!==T,this._padding=!c.isPaddingEqual(j),this._zooming=this._zooming||ct.isZooming,this._easeId=t.easeId,this._prepareEase(s,t.noMoveStart,J),this.terrain&&this._prepareElevation(ct.elevationCenter),this._ease(ot=>{ct.easeFunc(ot),this.terrain&&!t.freezeElevation&&this._updateElevation(ot),this._applyUpdatedTransform(c),this._fireMoveEvents(s)},ot=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(s,ot)},t),this}_prepareEase(t,s,c={}){this._moving=!0,s||c.moving||this.fire(new u.l("movestart",t)),this._zooming&&!c.zooming&&this.fire(new u.l("zoomstart",t)),this._rotating&&!c.rotating&&this.fire(new u.l("rotatestart",t)),this._pitching&&!c.pitching&&this.fire(new u.l("pitchstart",t)),this._rolling&&!c.rolling&&this.fire(new u.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const s=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&s!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(c-(s-(c*t+this._elevationStart))/(1-t)),this._elevationTarget=s}this.transform.setElevation(u.C.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const s=t.getCameraLngLat(),c=t.getCameraAltitude(),f=this.terrain?this.terrain.getElevationForLngLatZoom(s,t.zoom):0;if(c<f){const y=this.calculateCameraOptionsFromTo(s,f,t.center,t.elevation);return{pitch:y.pitch,zoom:y.zoom}}return{}}_applyUpdatedTransform(t){const s=[];if(s.push(f=>this._elevateCameraIfInsideTerrain(f)),this.transformCameraUpdate&&s.push(f=>this.transformCameraUpdate(f)),!s.length)return;const c=t.clone();for(const f of s){const y=c.clone(),{center:T,zoom:z,roll:D,pitch:O,bearing:j,elevation:Z}=f(y);T&&y.setCenter(T),Z!==void 0&&y.setElevation(Z),z!==void 0&&y.setZoom(z),D!==void 0&&y.setRoll(D),O!==void 0&&y.setPitch(O),j!==void 0&&y.setBearing(j),c.apply(y)}this.transform.apply(c)}_fireMoveEvents(t){this.fire(new u.l("move",t)),this._zooming&&this.fire(new u.l("zoom",t)),this._rotating&&this.fire(new u.l("rotate",t)),this._pitching&&this.fire(new u.l("pitch",t)),this._rolling&&this.fire(new u.l("roll",t))}_afterEase(t,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId;const c=this._zooming,f=this._rotating,y=this._pitching,T=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,c&&this.fire(new u.l("zoomend",t)),f&&this.fire(new u.l("rotateend",t)),y&&this.fire(new u.l("pitchend",t)),T&&this.fire(new u.l("rollend",t)),this.fire(new u.l("moveend",t))}flyTo(t,s){if(!t.essential&&ht.prefersReducedMotion){const Ut=u.Q(t,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Ut,s)}this.stop(),t=u.e({offset:[0,0],speed:1.2,curve:1.42,easing:u.co},t);const c=this._getTransformForUpdate(),f=c.bearing,y=c.pitch,T=c.roll,z=c.padding,D="bearing"in t?this._normalizeBearing(t.bearing,f):f,O="pitch"in t?+t.pitch:y,j="roll"in t?this._normalizeBearing(t.roll,T):T,Z="padding"in t?t.padding:c.padding,U=u.P.convert(t.offset);let $=c.centerPoint.add(U);const J=c.screenPointToLocation($),ct=this.cameraHelper.handleFlyTo(c,{bearing:D,pitch:O,roll:j,padding:Z,locationAtOffset:J,offsetAsPoint:U,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let ot=t.curve;const ut=Math.max(c.width,c.height),pt=ut/ct.scaleOfZoom,vt=ct.pixelPathLength;typeof ct.scaleOfMinZoom=="number"&&(ot=Math.sqrt(ut/ct.scaleOfMinZoom/vt*2));const mt=ot*ot;function bt(Ut){const _e=(pt*pt-ut*ut+(Ut?-1:1)*mt*mt*vt*vt)/(2*(Ut?pt:ut)*mt*vt);return Math.log(Math.sqrt(_e*_e+1)-_e)}function At(Ut){return(Math.exp(Ut)-Math.exp(-Ut))/2}function gt(Ut){return(Math.exp(Ut)+Math.exp(-Ut))/2}const Lt=bt(!1);let Gt=function(Ut){return gt(Lt)/gt(Lt+ot*Ut)},Ot=function(Ut){return ut*((gt(Lt)*(At(_e=Lt+ot*Ut)/gt(_e))-At(Lt))/mt)/vt;var _e},Nt=(bt(!0)-Lt)/ot;if(Math.abs(vt)<2e-6||!isFinite(Nt)){if(Math.abs(ut-pt)<1e-6)return this.easeTo(t,s);const Ut=pt<ut?-1:1;Nt=Math.abs(Math.log(pt/ut))/ot,Ot=()=>0,Gt=_e=>Math.exp(Ut*ot*_e)}return t.duration="duration"in t?+t.duration:1e3*Nt/("screenSpeed"in t?+t.screenSpeed/ot:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=f!==D,this._pitching=O!==y,this._rolling=j!==T,this._padding=!c.isPaddingEqual(Z),this._prepareEase(s,!1),this.terrain&&this._prepareElevation(ct.targetCenter),this._ease(Ut=>{const _e=Ut*Nt,ve=1/Gt(_e),re=Ot(_e);this._rotating&&c.setBearing(u.C.number(f,D,Ut)),this._pitching&&c.setPitch(u.C.number(y,O,Ut)),this._rolling&&c.setRoll(u.C.number(T,j,Ut)),this._padding&&(c.interpolatePadding(z,Z,Ut),$=c.centerPoint.add(U)),ct.easeFunc(Ut,ve,re,$),this.terrain&&!t.freezeElevation&&this._updateElevation(Ut),this._applyUpdatedTransform(c),this._fireMoveEvents(s)},()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(s)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,s){var c;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,s)}return t||(c=this.handlers)===null||c===void 0||c.stop(!1),this}_ease(t,s,c){c.animate===!1||c.duration===0?(t(1),s()):(this._easeStart=ht.now(),this._easeOptions=c,this._onEaseFrame=t,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,s){t=u.aO(t,-180,180);const c=Math.abs(t-s);return Math.abs(t-360-s)<c&&(t-=360),Math.abs(t+360-s)<c&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(u.S.convert(t),this.transform.tileZoom):null}}const jo={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Ci{constructor(t=jo){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=s=>{!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"&&s.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=lt.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=lt.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=lt.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){lt.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,s){const c=this._map._getUIString(`AttributionControl.${s}`);t.title=c,t.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(f=>typeof f!="string"?"":f)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const s=this._map.style.sourceCaches;for(const f in s){const y=s[f];if(y.used||y.usedForTerrain){const T=y.getSource();T.attribution&&t.indexOf(T.attribution)<0&&t.push(T.attribution)}}t=t.filter(f=>String(f).trim()),t.sort((f,y)=>f.length-y.length),t=t.filter((f,y)=>{for(let T=y+1;T<t.length;T++)if(t[T].indexOf(f)>=0)return!1;return!0});const c=t.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,t.length?(this._innerContainer.innerHTML=lt.sanitize(c),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class tn{constructor(t={}){this._updateCompact=()=>{const s=this._container.children;if(s.length){const c=s[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=lt.create("div","maplibregl-ctrl");const s=lt.create("a","maplibregl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){lt.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class en{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const s=++this._id;return this._queue.push({callback:t,id:s,cancelled:!1}),s}remove(t){const s=this._currentlyRunning,c=s?this._queue.concat(s):this._queue;for(const f of c)if(f.id===t)return void(f.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const c of s)if(!c.cancelled&&(c.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var xc=u.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Re extends u.E{constructor(t){super(),this._lastTilesetChange=ht.now(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,s){this.sourceCache.update(t,s),this._renderableTilesKeys=[];const c={};for(const f of It(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))c[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.terrainRttPosMatrix32f=new Float64Array(16),u.bY(f.terrainRttPosMatrix32f,0,u.$,u.$,0,0,1),this._tiles[f.key]=new es(f,this.tileSize),this._lastTilesetChange=ht.now());for(const f in this._tiles)c[f]||delete this._tiles[f]}freeRtt(t){for(const s in this._tiles){const c=this._tiles[s];(!t||c.tileID.equals(t)||c.tileID.isChildOf(t)||t.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,s){return s?this._getTerrainCoordsForTileRanges(t,s):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const s={};for(const c of this._renderableTilesKeys){const f=this._tiles[c].tileID,y=t.clone(),T=u.ba();if(f.canonical.equals(t.canonical))u.bY(T,0,u.$,u.$,0,0,1);else if(f.canonical.isChildOf(t.canonical)){const z=f.canonical.z-t.canonical.z,D=f.canonical.x-(f.canonical.x>>z<<z),O=f.canonical.y-(f.canonical.y>>z<<z),j=u.$>>z;u.bY(T,0,j,j,0,0,1),u.M(T,T,[-D*j,-O*j,0])}else{if(!t.canonical.isChildOf(f.canonical))continue;{const z=t.canonical.z-f.canonical.z,D=t.canonical.x-(t.canonical.x>>z<<z),O=t.canonical.y-(t.canonical.y>>z<<z),j=u.$>>z;u.bY(T,0,u.$,u.$,0,0,1),u.M(T,T,[D*j,O*j,0]),u.N(T,T,[1/2**z,1/2**z,0])}}y.terrainRttPosMatrix32f=new Float32Array(T),s[c]=y}return s}_getTerrainCoordsForTileRanges(t,s){const c={};for(const f of this._renderableTilesKeys){const y=this._tiles[f].tileID;if(!this._isWithinTileRanges(y,s))continue;const T=t.clone(),z=u.ba();if(y.canonical.z===t.canonical.z){const D=t.canonical.x-y.canonical.x,O=t.canonical.y-y.canonical.y;u.bY(z,0,u.$,u.$,0,0,1),u.M(z,z,[D*u.$,O*u.$,0])}else if(y.canonical.z>t.canonical.z){const D=y.canonical.z-t.canonical.z,O=y.canonical.x-(y.canonical.x>>D<<D),j=y.canonical.y-(y.canonical.y>>D<<D),Z=t.canonical.x-(y.canonical.x>>D),U=t.canonical.y-(y.canonical.y>>D),$=u.$>>D;u.bY(z,0,$,$,0,0,1),u.M(z,z,[-O*$+Z*u.$,-j*$+U*u.$,0])}else{const D=t.canonical.z-y.canonical.z,O=t.canonical.x-(t.canonical.x>>D<<D),j=t.canonical.y-(t.canonical.y>>D<<D),Z=(t.canonical.x>>D)-y.canonical.x,U=(t.canonical.y>>D)-y.canonical.y,$=u.$<<D;u.bY(z,0,$,$,0,0,1),u.M(z,z,[O*u.$+Z*$,j*u.$+U*$,0])}T.terrainRttPosMatrix32f=new Float32Array(z),c[f]=T}return c}getSourceTile(t,s){const c=this.sourceCache._source;let f=t.overscaledZ-this.deltaZoom;if(f>c.maxzoom&&(f=c.maxzoom),f<c.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(f).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!y||!y.dem)&&s)for(;f>=c.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(t.scaledTo(f--).key);return y}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,s){return s[t.canonical.z]&&t.canonical.x>=s[t.canonical.z].minTileX&&t.canonical.x<=s[t.canonical.z].maxTileX&&t.canonical.y>=s[t.canonical.z].minTileY&&t.canonical.y<=s[t.canonical.z].maxTileY}}class Xe{constructor(t,s,c){this._meshCache={},this.painter=t,this.sourceCache=new Re(s),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,s,c,f=u.$){var y;if(!(s>=0&&s<f&&c>=0&&c<f))return 0;const T=this.getTerrainData(t),z=(y=T.tile)===null||y===void 0?void 0:y.dem;if(!z)return 0;const D=u.cs([],[s/f*u.$,c/f*u.$],T.u_terrain_matrix),O=[D[0]*z.dim,D[1]*z.dim],j=Math.floor(O[0]),Z=Math.floor(O[1]),U=O[0]-j,$=O[1]-Z;return z.get(j,Z)*(1-U)*(1-$)+z.get(j+1,Z)*U*(1-$)+z.get(j,Z+1)*(1-U)*$+z.get(j+1,Z+1)*U*$}getElevationForLngLatZoom(t,s){if(!u.ct(s,t.wrap()))return 0;const{tileID:c,mercatorX:f,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(t,s);return this.getElevation(c,f%u.$,y%u.$,u.$)}getElevation(t,s,c,f=u.$){return this.getDEMElevation(t,s,c,f)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const f=this.painter.context,y=new u.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new u.T(f,y,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new u.T(f,new u.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.ag([])}const s=this.sourceCache.getSourceTile(t,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const f=this.painter.context;s.demTexture=this.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new u.T(f,s.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),s.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const c=s&&s+s.tileID.key+t.key;if(c&&!this._demMatrixCache[c]){const f=this.sourceCache.sourceCache._source.maxzoom;let y=t.canonical.z-s.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=f?y=t.canonical.z-f:u.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const T=t.canonical.x-(t.canonical.x>>y<<y),z=t.canonical.y-(t.canonical.y>>y<<y),D=u.cu(new Float64Array(16),[1/(u.$<<y),1/(u.$<<y),0]);u.M(D,D,[T*u.$,z*u.$,0]),this._demMatrixCache[t.key]={matrix:D,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getFramebuffer(t){const s=this.painter,c=s.width/devicePixelRatio,f=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new u.T(s.context,{width:c,height:f,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new u.T(s.context,{width:c,height:f,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(c,f,!0,!1),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,c,f))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,T=0;y<this._coordsTextureSize;y++)for(let z=0;z<this._coordsTextureSize;z++,T+=4)s[T+0]=255&z,s[T+1]=255&y,s[T+2]=z>>8<<4|y>>8,s[T+3]=0;const c=new u.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),f=new u.T(t,c,t.gl.RGBA,{premultiply:!1});return f.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const s=new Uint8Array(4),c=this.painter.context,f=c.gl,y=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),T=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),z=Math.round(this.painter.height/devicePixelRatio);c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(y,z-T-1,1,1,f.RGBA,f.UNSIGNED_BYTE,s),c.bindFramebuffer.set(null);const D=s[0]+(s[2]>>4<<8),O=s[1]+((15&s[2])<<8),j=this.coordsIndex[255-s[3]],Z=j&&this.sourceCache.getTileByID(j);if(!Z)return null;const U=this._coordsTextureSize,$=(1<<Z.tileID.canonical.z)*U;return new u.a1((Z.tileID.canonical.x*U+D)/$+Z.tileID.wrap,(Z.tileID.canonical.y*U+O)/$,this.getElevation(Z.tileID,D,O,U))}depthAtPoint(t){const s=new Uint8Array(4),c=this.painter.context,f=c.gl;return c.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,s),c.bindFramebuffer.set(null),(s[0]/16777216+s[1]/65536+s[2]/256+s[3])/256}getTerrainMesh(t){var s;const c=((s=this.painter.style.projection)===null||s===void 0?void 0:s.transitionState)>0,f=c&&t.canonical.y===0,y=c&&t.canonical.y===(1<<t.canonical.z)-1,T=`m_${f?"n":""}_${y?"s":""}`;if(this._meshCache[T])return this._meshCache[T];const z=this.painter.context,D=new u.cv,O=new u.aN,j=this.meshSize,Z=u.$/j,U=j*j;for(let gt=0;gt<=j;gt++)for(let Lt=0;Lt<=j;Lt++)D.emplaceBack(Lt*Z,gt*Z,0);for(let gt=0;gt<U;gt+=j+1)for(let Lt=0;Lt<j;Lt++)O.emplaceBack(Lt+gt,j+Lt+gt+1,j+Lt+gt+2),O.emplaceBack(Lt+gt,j+Lt+gt+2,Lt+gt+1);const $=D.length,J=$+(j+1),ct=(j+1)*j,ot=f?u.bh:0,ut=f?0:1,pt=y?u.bi:u.$,vt=y?0:1;for(let gt=0;gt<=j;gt++)D.emplaceBack(gt*Z,ot,ut);for(let gt=0;gt<=j;gt++)D.emplaceBack(gt*Z,pt,vt);for(let gt=0;gt<j;gt++)O.emplaceBack(ct+gt,J+gt,J+gt+1),O.emplaceBack(ct+gt,J+gt+1,ct+gt+1),O.emplaceBack(0+gt,$+gt+1,$+gt),O.emplaceBack(0+gt,0+gt+1,$+gt+1);const mt=D.length,bt=mt+2*(j+1);for(const gt of[0,1])for(let Lt=0;Lt<=j;Lt++)for(const Gt of[0,1])D.emplaceBack(gt*u.$,Lt*Z,Gt);for(let gt=0;gt<2*j;gt+=2)O.emplaceBack(mt+gt,mt+gt+1,mt+gt+3),O.emplaceBack(mt+gt,mt+gt+3,mt+gt+2),O.emplaceBack(bt+gt,bt+gt+3,bt+gt+1),O.emplaceBack(bt+gt,bt+gt+2,bt+gt+3);const At=new Ns(z.createVertexBuffer(D,xc.members),z.createIndexBuffer(O),u.aM.simpleSegment(0,0,D.length,O.length));return this._meshCache[T]=At,At}getMeshFrameDelta(t){return 2*Math.PI*u.bu/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,s){var c;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(t,s);return(c=this.getMinMaxElevation(f).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(t){const s=this.getTerrainData(t).tile,c={minElevation:null,maxElevation:null};return s&&s.dem&&(c.minElevation=s.dem.min*this.exaggeration,c.maxElevation=s.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(t,s){const c=u.a1.fromLngLat(t.wrap()),f=(1<<s)*u.$,y=c.x*f,T=c.y*f,z=Math.floor(y/u.$),D=Math.floor(T/u.$);return{tileID:new u.Z(s,0,s,z,D),mercatorX:y,mercatorY:T}}}class bc{constructor(t,s,c){this._context=t,this._size=s,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const s=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new u.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),s.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),s.colorAttachment.set(c.texture),{id:t,fbo:s,texture:c,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(s=>t.id!==s),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const s of this._recentlyUsed)if(!this._objects[s].inUse)return this._objects[s];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const La={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class il{constructor(t,s){this.painter=t,this.terrain=s,this.pool=new bc(t.context,30,s.sourceCache.tileSize*s.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,s){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(c=>!t._layers[c].isHidden(s)),this._coordsAscending={};for(const c in t.sourceCaches){this._coordsAscending[c]={};const f=t.sourceCaches[c].getVisibleCoordinates(),y=t.sourceCaches[c].getSource(),T=y instanceof Qs?y.terrainTileRanges:null;for(const z of f){const D=this.terrain.sourceCache.getTerrainCoords(z,T);for(const O in D)this._coordsAscending[c][O]||(this._coordsAscending[c][O]=[]),this._coordsAscending[c][O].push(D[O])}}this._coordsAscendingStr={};for(const c of t._order){const f=t._layers[c],y=f.source;if(La[f.type]&&!this._coordsAscendingStr[y]){this._coordsAscendingStr[y]={};for(const T in this._coordsAscending[y])this._coordsAscendingStr[y][T]=this._coordsAscending[y][T].map(z=>z.key).sort().join()}}for(const c of this._renderableTiles)for(const f in this._coordsAscendingStr){const y=this._coordsAscendingStr[f][c.tileID.key];y&&y!==c.rttCoords[f]&&(c.rtt=[])}}renderLayer(t,s){if(t.isHidden(this.painter.transform.zoom))return!1;const c=Object.assign(Object.assign({},s),{isRenderingToTexture:!0}),f=t.type,y=this.painter,T=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(La[f]&&(this._prevType&&La[this._prevType]||this._stacks.push([]),this._prevType=f,this._stacks[this._stacks.length-1].push(t.id),!T))return!0;if(La[this._prevType]||La[f]&&T){this._prevType=f;const z=this._stacks.length-1,D=this._stacks[z]||[];for(const O of this._renderableTiles){if(this.pool.isFull()&&(fc(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(O),O.rtt[z]){const Z=this.pool.getObjectForId(O.rtt[z].id);if(Z.stamp===O.rtt[z].stamp){this.pool.useObject(Z);continue}}const j=this.pool.getOrCreateFreeObject();this.pool.useObject(j),this.pool.stampObject(j),O.rtt[z]={id:j.id,stamp:j.stamp},y.context.bindFramebuffer.set(j.fbo.framebuffer),y.context.clear({color:u.bf.transparent,stencil:0}),y.currentStencilSource=void 0;for(let Z=0;Z<D.length;Z++){const U=y.style._layers[D[Z]],$=U.source?this._coordsAscending[U.source][O.tileID.key]:[O.tileID];y.context.viewport.set([0,0,j.fbo.width,j.fbo.height]),y._renderTileClippingMasks(U,$,!0),y.renderLayer(y,y.style.sourceCaches[U.source],U,$,c),U.source&&(O.rttCoords[U.source]=this._coordsAscendingStr[U.source][O.tileID.key])}}return fc(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects(),La[f]}return!1}}const zs={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Xn=H,Xs={hash:!1,interactive:!0,bearingSnap:7,attributionControl:jo,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:u.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Vh={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Yc{constructor(t,s,c=!1){this.mousedown=y=>{this.startMove(y,lt.mousePos(this.element,y)),lt.addEventListener(window,"mousemove",this.mousemove),lt.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=y=>{this.move(y,lt.mousePos(this.element,y))},this.mouseup=y=>{this._rotatePitchHandler.dragEnd(y),this.offTemp()},this.touchstart=y=>{y.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=lt.touchPos(this.element,y.targetTouches)[0],this.startMove(y,this._startPos),lt.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),lt.addEventListener(window,"touchend",this.touchend))},this.touchmove=y=>{y.targetTouches.length!==1?this.reset():(this._lastPos=lt.touchPos(this.element,y.targetTouches)[0],this.move(y,this._lastPos))},this.touchend=y=>{y.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=s;const f=new ih;this._rotatePitchHandler=new Zc({clickTolerance:3,move:(y,T)=>{const z=s.getBoundingClientRect(),D=new u.P((z.bottom-z.top)/2,(z.right-z.left)/2);return{bearingDelta:u.cn(new u.P(y.x,T.y),T,D),pitchDelta:c?-.5*(T.y-y.y):void 0}},moveStateManager:f,enable:!0,assignEvents:()=>{}}),this.map=t,lt.addEventListener(s,"mousedown",this.mousedown),lt.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),lt.addEventListener(s,"touchcancel",this.reset)}startMove(t,s){this._rotatePitchHandler.dragStart(t,s),lt.disableDrag()}move(t,s){const c=this.map,{bearingDelta:f,pitchDelta:y}=this._rotatePitchHandler.dragMove(t,s)||{};f&&c.setBearing(c.getBearing()+f),y&&c.setPitch(c.getPitch()+y)}off(){const t=this.element;lt.removeEventListener(t,"mousedown",this.mousedown),lt.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),lt.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),lt.removeEventListener(window,"touchend",this.touchend),lt.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){lt.enableDrag(),lt.removeEventListener(window,"mousemove",this.mousemove),lt.removeEventListener(window,"mouseup",this.mouseup),lt.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),lt.removeEventListener(window,"touchend",this.touchend)}}let Xi;function Yn(g,t,s,c=!1){if(c||!s.getCoveringTilesDetailsProvider().allowWorldCopies())return g?.wrap();const f=new u.S(g.lng,g.lat);if(g=new u.S(g.lng,g.lat),t){const y=new u.S(g.lng-360,g.lat),T=new u.S(g.lng+360,g.lat),z=s.locationToScreenPoint(g).distSqr(t);s.locationToScreenPoint(y).distSqr(t)<z?g=y:s.locationToScreenPoint(T).distSqr(t)<z&&(g=T)}for(;Math.abs(g.lng-s.center.lng)>180;){const y=s.locationToScreenPoint(g);if(y.x>=0&&y.y>=0&&y.x<=s.width&&y.y<=s.height)break;g.lng>s.center.lng?g.lng-=360:g.lng+=360}return g.lng!==f.lng&&s.isPointOnMapSurface(s.locationToScreenPoint(g))?g:f}const Wc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function kl(g,t,s){const c=g.classList;for(const f in Wc)c.remove(`maplibregl-${s}-anchor-${f}`);c.add(`maplibregl-${s}-anchor-${t}`)}class Bl extends u.E{constructor(t){if(super(),this._onKeyPress=s=>{const c=s.code,f=s.charCode||s.keyCode;c!=="Space"&&c!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=s=>{const c=s.originalEvent.target,f=this._element;this._popup&&(c===f||f.contains(c))&&this.togglePopup()},this._update=s=>{if(!this._map)return;const c=this._map.loaded()&&!this._map.isMoving();(s?.type==="terrain"||s?.type==="render"&&!c)&&this._map.once("render",this._update),this._lngLat=Yn(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||s&&s.type!=="moveend"||(this._pos=this._pos.round()),lt.setTransform(this._element,`${Wc[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${f}`),ht.frameAsync(new AbortController).then(()=>{this._updateOpacity(s&&s.type==="moveend")}).catch(()=>{})},this._onMove=s=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=s.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=s.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.l("dragstart"))),this.fire(new u.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.l("dragend")),this._state="inactive"},this._addDragHandler=s=>{this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(this._pos).add(this._offset),this._pointerdownPos=s.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t?.opacity,t?.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=u.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=lt.create("div");const s=lt.createNS("http://www.w3.org/2000/svg","svg"),c=41,f=27;s.setAttributeNS(null,"display","block"),s.setAttributeNS(null,"height",`${c}px`),s.setAttributeNS(null,"width",`${f}px`),s.setAttributeNS(null,"viewBox",`0 0 ${f} ${c}`);const y=lt.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const T=lt.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"fill-rule","nonzero");const z=lt.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(3.0, 29.0)"),z.setAttributeNS(null,"fill","#000000");const D=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ut of D){const pt=lt.createNS("http://www.w3.org/2000/svg","ellipse");pt.setAttributeNS(null,"opacity","0.04"),pt.setAttributeNS(null,"cx","10.5"),pt.setAttributeNS(null,"cy","5.80029008"),pt.setAttributeNS(null,"rx",ut.rx),pt.setAttributeNS(null,"ry",ut.ry),z.appendChild(pt)}const O=lt.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"fill",this._color);const j=lt.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),O.appendChild(j);const Z=lt.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"opacity","0.25"),Z.setAttributeNS(null,"fill","#000000");const U=lt.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Z.appendChild(U);const $=lt.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(6.0, 7.0)"),$.setAttributeNS(null,"fill","#FFFFFF");const J=lt.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ct=lt.createNS("http://www.w3.org/2000/svg","circle");ct.setAttributeNS(null,"fill","#000000"),ct.setAttributeNS(null,"opacity","0.25"),ct.setAttributeNS(null,"cx","5.5"),ct.setAttributeNS(null,"cy","5.5"),ct.setAttributeNS(null,"r","5.4999962");const ot=lt.createNS("http://www.w3.org/2000/svg","circle");ot.setAttributeNS(null,"fill","#FFFFFF"),ot.setAttributeNS(null,"cx","5.5"),ot.setAttributeNS(null,"cy","5.5"),ot.setAttributeNS(null,"r","5.4999962"),J.appendChild(ct),J.appendChild(ot),T.appendChild(z),T.appendChild(O),T.appendChild(Z),T.appendChild($),T.appendChild(J),s.appendChild(T),s.setAttributeNS(null,"height",c*this._scale+"px"),s.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(s),this._offset=u.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",s=>{s.preventDefault()}),this._element.addEventListener("mousedown",s=>{s.preventDefault()}),kl(this._element,this._anchor,"marker"),t&&t.className)for(const s of t.className.split(" "))this._element.classList.add(s);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),lt.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=u.S.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const f=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var s,c;const f=(s=this._map)===null||s===void 0?void 0:s.terrain,y=this._map.transform.isLocationOccluded(this._lngLat);if(!f||y){const $=y?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==$&&(this._element.style.opacity=$))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const T=this._map,z=T.terrain.depthAtPoint(this._pos),D=T.terrain.getElevationForLngLatZoom(this._lngLat,T.transform.tileZoom);if(T.transform.lngLatToCameraDepth(this._lngLat,D)-z<.006)return void(this._element.style.opacity=this._opacity);const O=-this._offset.y/T.transform.pixelsPerMeter,j=Math.sin(T.getPitch()*Math.PI/180)*O,Z=T.terrain.depthAtPoint(new u.P(this._pos.x,this._pos.y-this._offset.y)),U=T.transform.lngLatToCameraDepth(this._lngLat,D+j)-Z>.006;!((c=this._popup)===null||c===void 0)&&c.isOpen()&&U&&this._popup.remove(),this._element.style.opacity=U?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=u.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,s){return(this._opacity===void 0||t===void 0&&s===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),s!==void 0&&(this._opacityWhenCovered=s),this._map&&this._updateOpacity(!0),this}}const ds={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let zn=0,nl=!1;const rl={maxWidth:100,unit:"metric"};function wc(g,t,s){const c=s&&s.maxWidth||100,f=g._container.clientHeight/2,y=g._container.clientWidth/2,T=g.unproject([y-c/2,f]),z=g.unproject([y+c/2,f]),D=Math.round(g.project(z).x-g.project(T).x),O=Math.min(c,D,g._container.clientWidth),j=T.distanceTo(z);if(s&&s.unit==="imperial"){const Z=3.2808*j;Z>5280?sl(t,O,Z/5280,g._getUIString("ScaleControl.Miles")):sl(t,O,Z,g._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?sl(t,O,j/1852,g._getUIString("ScaleControl.NauticalMiles")):j>=1e3?sl(t,O,j/1e3,g._getUIString("ScaleControl.Kilometers")):sl(t,O,j,g._getUIString("ScaleControl.Meters"))}function sl(g,t,s,c){const f=function(y){const T=Math.pow(10,`${Math.floor(y)}`.length-1);let z=y/T;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:function(D){const O=Math.pow(10,Math.ceil(-Math.log(D)/Math.LN10));return Math.round(D*O)/O}(z),T*z}(s);g.style.width=t*(f/s)+"px",g.innerHTML=`${f}&nbsp;${c}`}const oo={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Kc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Qc(g){if(g){if(typeof g=="number"){const t=Math.round(Math.abs(g)/Math.SQRT2);return{center:new u.P(0,0),top:new u.P(0,g),"top-left":new u.P(t,t),"top-right":new u.P(-t,t),bottom:new u.P(0,-g),"bottom-left":new u.P(t,-t),"bottom-right":new u.P(-t,-t),left:new u.P(g,0),right:new u.P(-g,0)}}if(g instanceof u.P||Array.isArray(g)){const t=u.P.convert(g);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:u.P.convert(g.center||[0,0]),top:u.P.convert(g.top||[0,0]),"top-left":u.P.convert(g["top-left"]||[0,0]),"top-right":u.P.convert(g["top-right"]||[0,0]),bottom:u.P.convert(g.bottom||[0,0]),"bottom-left":u.P.convert(g["bottom-left"]||[0,0]),"bottom-right":u.P.convert(g["bottom-right"]||[0,0]),left:u.P.convert(g.left||[0,0]),right:u.P.convert(g.right||[0,0])}}return Qc(new u.P(0,0))}const Pu=H;P.AJAXError=u.cz,P.Event=u.l,P.Evented=u.E,P.LngLat=u.S,P.MercatorCoordinate=u.a1,P.Point=u.P,P.addProtocol=u.cA,P.config=u.a,P.removeProtocol=u.cB,P.AttributionControl=Ci,P.BoxZoomHandler=mc,P.CanvasSource=vs,P.CooperativeGesturesHandler=Fh,P.DoubleClickZoomHandler=gc,P.DragPanHandler=Xc,P.DragRotateHandler=yc,P.EdgeInsets=ia,P.FullscreenControl=class extends u.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var t;let s=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=s?.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)s=s.shadowRoot.fullscreenElement;s===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:u.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=lt.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){lt.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=lt.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);lt.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new u.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new u.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},P.GeoJSONSource=ys,P.GeolocateControl=class extends u.E{constructor(g){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new u.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new u.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const s=new u.S(t.coords.longitude,t.coords.latitude),c=t.coords.accuracy,f=this._map.getBearing(),y=u.e({bearing:f},this.options.fitBoundsOptions),T=sn.fromLngLat(s,c);this._map.fitBounds(T,y,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const s=new u.S(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&nl)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new u.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=lt.create("button","maplibregl-ctrl-geolocate",this._container),lt.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){u.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=lt.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Bl({element:this._dotElement}),this._circleElement=lt.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Bl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{const c=s?.[0]instanceof ResizeObserverEntry;s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new u.l("trackuserlocationend")),this.fire(new u.l("userlocationlostfocus")))})}},this.options=u.e({},ds,g)}onAdd(g){return this._map=g,this._container=lt.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return u._(this,arguments,void 0,function*(t=!1){if(Xi!==void 0&&!t)return Xi;if(window.navigator.permissions===void 0)return Xi=!!window.navigator.geolocation,Xi;try{Xi=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Xi=!!window.navigator.geolocation}return Xi})}().then(t=>this._finishSetupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),lt.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,zn=0,nl=!1}_isOutOfMapMaxBounds(g){const t=this._map.getMaxBounds(),s=g.coords;return t&&(s.longitude<t.getWest()||s.longitude>t.getEast()||s.latitude<t.getSouth()||s.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const g=this._map.getBounds(),t=g.getSouthEast(),s=g.getNorthEast(),c=t.distanceTo(s),f=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return u.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":zn--,nl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new u.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.l("trackuserlocationstart")),this.fire(new u.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),zn++,zn>1?(g={maximumAge:6e5,timeout:0},nl=!0):(g=this.options.positionOptions,nl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},P.GlobeControl=class{constructor(){this._toggleProjection=()=>{var g;const t=(g=this._map.getProjection())===null||g===void 0?void 0:g.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var g;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((g=this._map.getProjection())===null||g===void 0?void 0:g.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(g){return this._map=g,this._container=lt.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=lt.create("button","maplibregl-ctrl-globe",this._container),lt.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){lt.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},P.Hash=$s,P.ImageSource=Qs,P.KeyboardHandler=ao,P.LngLatBounds=sn,P.LogoControl=tn,P.Map=class extends rh{constructor(g){var t,s;u.cw.mark(u.cx.create);const c=Object.assign(Object.assign(Object.assign({},Xs),g),{canvasContextAttributes:Object.assign(Object.assign({},Xs.canvasContextAttributes),g.canvasContextAttributes)});if(c.minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const f=new ti,y=new _n;if(c.minZoom!==void 0&&f.setMinZoom(c.minZoom),c.maxZoom!==void 0&&f.setMaxZoom(c.maxZoom),c.minPitch!==void 0&&f.setMinPitch(c.minPitch),c.maxPitch!==void 0&&f.setMaxPitch(c.maxPitch),c.renderWorldCopies!==void 0&&f.setRenderWorldCopies(c.renderWorldCopies),super(f,y,{bearingSnap:c.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new en,this._controls=[],this._mapId=u.a7(),this._contextLost=z=>{z.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new u.l("webglcontextlost",{originalEvent:z}))},this._contextRestored=z=>{this._setupPainter(),this.resize(),this._update(),this.fire(new u.l("webglcontextrestored",{originalEvent:z}))},this._onMapScroll=z=>{if(z.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._maxTileCacheZoomLevels=c.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},c.canvasContextAttributes),this._trackResize=c.trackResize===!0,this._bearingSnap=c.bearingSnap,this._centerClampedToGround=c.centerClampedToGround,this._refreshExpiredTiles=c.refreshExpiredTiles===!0,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions===!0,this._collectResourceTiming=c.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},zs),c.locale),this._clickTolerance=c.clickTolerance,this._overridePixelRatio=c.pixelRatio,this._maxCanvasSize=c.maxCanvasSize,this.transformCameraUpdate=c.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=c.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Ne.addThrottleControl(()=>this.isMoving()),this._requestManager=new we(c.transformRequest),typeof c.container=="string"){if(this._container=document.getElementById(c.container),!this._container)throw new Error(`Container '${c.container}' not found.`)}else{if(!(c.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let z=!1;const D=Or(O=>{this._trackResize&&!this._removed&&(this.resize(O),this.redraw())},50);this._resizeObserver=new ResizeObserver(O=>{z?D(O):z=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Mu(this,c),this._hash=c.hash&&new $s(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,elevation:c.elevation,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,roll:c.roll}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,u.e({},c.fitBoundsOptions,{duration:0}))));const T=typeof c.style=="string"||((s=(t=c.style)===null||t===void 0?void 0:t.projection)===null||s===void 0?void 0:s.type)!=="globe";this.resize(null,T),this._localIdeographFontFamily=c.localIdeographFontFamily,this._validateStyle=c.validateStyle,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new Ci(typeof c.attributionControl=="boolean"?void 0:c.attributionControl)),c.maplibreLogo&&this.addControl(new tn,c.logoPosition),this.on("style.load",()=>{if(T||this._resizeTransform(),this.transform.unmodified){const z=u.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(z)}}),this.on("data",z=>{this._update(z.dataType==="style"),this.fire(new u.l(`${z.dataType}data`,z))}),this.on("dataloading",z=>{this.fire(new u.l(`${z.dataType}dataloading`,z))}),this.on("dataabort",z=>{this.fire(new u.l("sourcedataabort",z))})}_getMapId(){return this._mapId}setGlobalStateProperty(g,t){return this.style.setGlobalStateProperty(g,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(g,t){if(t===void 0&&(t=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new u.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=g.onAdd(this);this._controls.push(g);const c=this._controlPositions[t];return t.indexOf("bottom")!==-1?c.insertBefore(s,c.firstChild):c.appendChild(s),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new u.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(g);return t>-1&&this._controls.splice(t,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}calculateCameraOptionsFromTo(g,t,s,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,t,s,c)}resize(g,t=!0){const[s,c]=this._containerDimensions(),f=this._getClampedPixelRatio(s,c);if(this._resizeCanvas(s,c,f),this.painter.resize(s,c,f),this.painter.overLimit()){const T=this.painter.context.gl;this._maxCanvasSize=[T.drawingBufferWidth,T.drawingBufferHeight];const z=this._getClampedPixelRatio(s,c);this._resizeCanvas(s,c,z),this.painter.resize(s,c,z)}this._resizeTransform(t);const y=!this._moving;return y&&(this.stop(),this.fire(new u.l("movestart",g)).fire(new u.l("move",g))),this.fire(new u.l("resize",g)),y&&this.fire(new u.l("moveend",g)),this}_resizeTransform(g=!0){var t;const[s,c]=this._containerDimensions();this.transform.resize(s,c,g),(t=this._requestedCameraState)===null||t===void 0||t.resize(s,c,g)}_getClampedPixelRatio(g,t){const{0:s,1:c}=this._maxCanvasSize,f=this.getPixelRatio(),y=g*f,T=t*f;return Math.min(y>s?s/y:1,T>c?c/T:1)*f}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(sn.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.setMinZoom(g),this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.setMaxZoom(g),this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.setMinPitch(g),this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(g>=this.transform.minPitch)return this.transform.setMaxPitch(g),this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.setRenderWorldCopies(g),this._update()}project(g){return this.transform.locationToScreenPoint(u.S.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.screenPointToLocation(u.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,t,s){if(g==="mouseenter"||g==="mouseover"){let c=!1;return{layers:t,listener:s,delegates:{mousemove:y=>{const T=t.filter(D=>this.getLayer(D)),z=T.length!==0?this.queryRenderedFeatures(y.point,{layers:T}):[];z.length?c||(c=!0,s.call(this,new Es(g,this,y.originalEvent,{features:z}))):c=!1},mouseout:()=>{c=!1}}}}if(g==="mouseleave"||g==="mouseout"){let c=!1;return{layers:t,listener:s,delegates:{mousemove:T=>{const z=t.filter(D=>this.getLayer(D));(z.length!==0?this.queryRenderedFeatures(T.point,{layers:z}):[]).length?c=!0:c&&(c=!1,s.call(this,new Es(g,this,T.originalEvent)))},mouseout:T=>{c&&(c=!1,s.call(this,new Es(g,this,T.originalEvent)))}}}}{const c=f=>{const y=t.filter(z=>this.getLayer(z)),T=y.length!==0?this.queryRenderedFeatures(f.point,{layers:y}):[];T.length&&(f.features=T,s.call(this,f),delete f.features)};return{layers:t,listener:s,delegates:{[g]:c}}}}_saveDelegatedListener(g,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(t)}_removeDelegatedListener(g,t,s){if(!this._delegatedListeners||!this._delegatedListeners[g])return;const c=this._delegatedListeners[g];for(let f=0;f<c.length;f++){const y=c[f];if(y.listener===s&&y.layers.length===t.length&&y.layers.every(T=>t.includes(T))){for(const T in y.delegates)this.off(T,y.delegates[T]);return void c.splice(f,1)}}}on(g,t,s){if(s===void 0)return super.on(g,t);const c=typeof t=="string"?[t]:t,f=this._createDelegatedListener(g,c,s);this._saveDelegatedListener(g,f);for(const y in f.delegates)this.on(y,f.delegates[y]);return{unsubscribe:()=>{this._removeDelegatedListener(g,c,s)}}}once(g,t,s){if(s===void 0)return super.once(g,t);const c=typeof t=="string"?[t]:t,f=this._createDelegatedListener(g,c,s);for(const y in f.delegates){const T=f.delegates[y];f.delegates[y]=(...z)=>{this._removeDelegatedListener(g,c,s),T(...z)}}this._saveDelegatedListener(g,f);for(const y in f.delegates)this.once(y,f.delegates[y]);return this}off(g,t,s){return s===void 0?super.off(g,t):(this._removeDelegatedListener(g,typeof t=="string"?[t]:t,s),this)}queryRenderedFeatures(g,t){if(!this.style)return[];let s;const c=g instanceof u.P||Array.isArray(g),f=c?g:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(c?{}:g)||{},f instanceof u.P||typeof f[0]=="number")s=[u.P.convert(f)];else{const y=u.P.convert(f[0]),T=u.P.convert(f[1]);s=[y,new u.P(T.x,y.y),T,new u.P(y.x,T.y),y]}return this.style.queryRenderedFeatures(s,t,this.transform)}querySourceFeatures(g,t){return this.style.querySourceFeatures(g,t)}setStyle(g,t){return(t=u.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(g,t))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const t=this._locale[g];if(t==null)throw new Error(`Missing UI string '${g}'`);return t}_updateStyle(g,t){var s,c;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(g,t));const f=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new ec(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,t,f):this.style.loadJSON(g,t,f),this):((c=(s=this.style)===null||s===void 0?void 0:s.projection)===null||c===void 0||c.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ec(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,t){if(typeof g=="string"){const s=this._requestManager.transformRequest(g,"Style");u.j(s,new AbortController).then(c=>{this._updateDiff(c.data,t)}).catch(c=>{c&&this.fire(new u.k(c))})}else typeof g=="object"&&this._updateDiff(g,t)}_updateDiff(g,t){try{this.style.setState(g,t)&&this._update(!0)}catch(s){u.w(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(g,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.w("There is no style added to the map.")}addSource(g,t){return this._lazyInitEmptyStyle(),this.style.addSource(g,t),this._update(!0)}isSourceLoaded(g){const t=this.style&&this.style.sourceCaches[g];if(t!==void 0)return t.loaded();this.fire(new u.k(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const t=this.style.sourceCaches[g.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&t.reload();for(const s in this.style._layers){const c=this.style._layers[s];c.type==="hillshade"&&c.source===g.source&&u.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),c.type==="color-relief"&&c.source===g.source&&u.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Xe(this.painter,t,g),this.painter.renderToTexture=new il(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=s=>{var c;s.dataType==="style"?this.terrain.sourceCache.freeRtt():s.dataType==="source"&&s.tile&&(s.sourceId!==g.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((c=s.source)===null||c===void 0?void 0:c.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(s.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new u.l("terrain",{terrain:g})),this}getTerrain(){var g,t;return(t=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const t in g){const s=g[t]._tiles;for(const c in s){const f=s[c];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}setSourceTileLodParams(g,t,s){if(s){const c=this.getSource(s);if(!c)throw new Error(`There is no source with ID "${s}", cannot set LOD parameters`);c.calculateTileZoom=oe(Math.max(1,g),Math.max(1,t))}else for(const c in this.style.sourceCaches)this.style.sourceCaches[c].getSource().calculateTileZoom=oe(Math.max(1,g),Math.max(1,t));return this._update(!0),this}refreshTiles(g,t){const s=this.style.sourceCaches[g];if(!s)throw new Error(`There is no source cache with ID "${g}", cannot refresh tile`);t===void 0?s.reload(!0):s.refreshTiles(t.map(c=>new u.a4(c.z,c.x,c.y)))}addImage(g,t,s={}){const{pixelRatio:c=1,sdf:f=!1,stretchX:y,stretchY:T,content:z,textFitWidth:D,textFitHeight:O}=s;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||u.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new u.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:j,height:Z,data:U}=t,$=t;return this.style.addImage(g,{data:new u.R({width:j,height:Z},new Uint8Array(U)),pixelRatio:c,stretchX:y,stretchY:T,content:z,textFitWidth:D,textFitHeight:O,sdf:f,version:0,userImage:$}),$.onAdd&&$.onAdd(this,g),this}}{const{width:j,height:Z,data:U}=ht.getImageData(t);this.style.addImage(g,{data:new u.R({width:j,height:Z},U),pixelRatio:c,stretchX:y,stretchY:T,content:z,textFitWidth:D,textFitHeight:O,sdf:f,version:0})}}updateImage(g,t){const s=this.style.getImage(g);if(!s)return this.fire(new u.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=t instanceof HTMLImageElement||u.b(t)?ht.getImageData(t):t,{width:f,height:y,data:T}=c;if(f===void 0||y===void 0)return this.fire(new u.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==s.data.width||y!==s.data.height)return this.fire(new u.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const z=!(t instanceof HTMLImageElement||u.b(t));return s.data.replace(T,z),this.style.updateImage(g,s),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new u.k(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return Ne.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,t){return this._lazyInitEmptyStyle(),this.style.addLayer(g,t),this._update(!0)}moveLayer(g,t){return this.style.moveLayer(g,t),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,t,s){return this.style.setLayerZoomRange(g,t,s),this._update(!0)}setFilter(g,t,s={}){return this.style.setFilter(g,t,s),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,t,s,c={}){return this.style.setPaintProperty(g,t,s,c),this._update(!0)}getPaintProperty(g,t){return this.style.getPaintProperty(g,t)}setLayoutProperty(g,t,s,c={}){return this.style.setLayoutProperty(g,t,s,c),this._update(!0)}getLayoutProperty(g,t){return this.style.getLayoutProperty(g,t)}setGlyphs(g,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,t,s={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,t,s,c=>{c||this._update(!0)}),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,t,s=>{s||this._update(!0)}),this}setLight(g,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(g,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(g,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(g,t){return this.style.setFeatureState(g,t),this._update()}removeFeatureState(g,t){return this.style.removeFeatureState(g,t),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,t=0;return this._container&&(g=this._container.clientWidth||400,t=this._container.clientHeight||300),[g,t]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const t=this._canvasContainer=lt.create("div","maplibregl-canvas-container",g);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=lt.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const s=this._containerDimensions(),c=this._getClampedPixelRatio(s[0],s[1]);this._resizeCanvas(s[0],s[1],c);const f=this._controlContainer=lt.create("div","maplibregl-control-container",g),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(T=>{y[T]=lt.create("div",`maplibregl-ctrl-${T} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,t,s){this._canvas.width=Math.floor(s*g),this._canvas.height=Math.floor(s*t),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const g=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",c=>{t={requestedAttributes:g},c&&(t.statusMessage=c.statusMessage,t.type=c.type)},{once:!0});let s=null;if(s=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,g):this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g),!s){const c="Failed to initialize WebGL";throw t?(t.message=c,new Error(JSON.stringify(t))):new Error(c)}this.painter=new En(s,this.transform),Yt.testSupport(s)}migrateProjection(g,t){super.migrateProjection(g,t),this.painter.transform=g,this.fire(new u.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){var t,s,c,f,y;const T=this._idleTriggered?this._fadeDuration:0,z=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let D=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Z=this.transform.zoom,U=ht.now();this.style.zoomHistory.update(Z,U);const $=new u.F(Z,{now:U,fadeDuration:T,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),J=$.crossFadingFactor();J===1&&J===this._crossFadingFactor||(D=!0,this._crossFadingFactor=J),this.style.update($)}const O=((s=this.style.projection)===null||s===void 0?void 0:s.transitionState)>0!==z;(c=this.style.projection)===null||c===void 0||c.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((f=this.style.projection)===null||f===void 0?void 0:f.transitionState,(y=this.style.projection)===null||y===void 0?void 0:y.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||O)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,T,this._crossSourceCollisions,O),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:T,showPadding:this.showPadding}),this.fire(new u.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.cw.mark(u.cx.load),this.fire(new u.l("load"))),this.style&&(this.style.hasTransitions()||D)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const j=this._sourcesDirty||this._styleDirty||this._placementDirty;return j||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.l("idle")),!this._loaded||this._fullyLoaded||j||(this._fullyLoaded=!0,u.cw.mark(u.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Ne.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t?.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),lt.remove(this._canvasContainer),lt.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),u.cw.clearMetrics(),this._removed=!0,this.fire(new u.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ht.frame(this._frameRequest,g=>{u.cw.frame(g),this._frameRequest=null;try{this._render(g)}catch(t){if(!u.cy(t)&&!function(s){return s.message===Cl}(t))throw t}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return Xn}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(g){return this._lazyInitEmptyStyle(),this.style.setProjection(g),this._update(!0)}},P.MapMouseEvent=Es,P.MapTouchEvent=Uc,P.MapWheelEvent=Bh,P.Marker=Bl,P.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const t=this._map.getZoom(),s=t===this._map.getMaxZoom(),c=t===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,s)=>{const c=this._map._getUIString(`NavigationControl.${s}`);t.title=c,t.setAttribute("aria-label",c)},this.options=u.e({},Vh,g),this._container=lt.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),lt.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),lt.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=lt.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Yc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){lt.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,t){const s=lt.create("button",g,this._container);return s.type="button",s.addEventListener("click",t),s}},P.Popup=class extends u.E{constructor(g){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&lt.remove(this._content),this._container&&(lt.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new u.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=lt.create("div","maplibregl-popup",this._map.getContainer()),this._tip=lt.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const T of this.options.className.split(" "))this._container.classList.add(T);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Yn(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const s=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let c=this.options.anchor;const f=Qc(this.options.offset);if(!c){const T=this._container.offsetWidth,z=this._container.offsetHeight;let D;D=s.y+f.bottom.y<z?["top"]:s.y>this._map.transform.height-z?["bottom"]:[],s.x<T/2?D.push("left"):s.x>this._map.transform.width-T/2&&D.push("right"),c=D.length===0?"bottom":D.join("-")}let y=s.add(f[c]);this.options.subpixelPositioning||(y=y.round()),lt.setTransform(this._container,`${Wc[c]} translate(${y.x}px,${y.y}px)`),kl(this._container,c,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=u.e(Object.create(oo),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new u.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=u.S.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const t=document.createDocumentFragment(),s=document.createElement("body");let c;for(s.innerHTML=g;c=s.firstChild,c;)t.appendChild(c);return this.setDOMContent(t)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=lt.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=lt.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(Kc);g&&g.focus()}},P.RasterDEMTileSource=dr,P.RasterTileSource=Ks,P.ScaleControl=class{constructor(g){this._onMove=()=>{wc(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,wc(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},rl),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=lt.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){lt.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},P.ScrollZoomHandler=el,P.Style=ec,P.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=lt.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=lt.create("button","maplibregl-ctrl-terrain",this._container),lt.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){lt.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},P.TwoFingersTouchPitchHandler=Tu,P.TwoFingersTouchRotateHandler=_c,P.TwoFingersTouchZoomHandler=wu,P.TwoFingersTouchZoomRotateHandler=jh,P.VectorTileSource=Os,P.VideoSource=vo,P.addSourceType=(g,t)=>u._(void 0,void 0,void 0,function*(){if(fa(g))throw new Error(`A source type called "${g}" already exists.`);((s,c)=>{Ha[s]=c})(g,t)}),P.clearPrewarmedResources=function(){const g=xe;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(yt),xe=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},P.createTileMesh=pu,P.getMaxParallelImageRequests=function(){return u.a.MAX_PARALLEL_IMAGE_REQUESTS},P.getRTLTextPluginStatus=function(){return Vn().getRTLTextPluginStatus()},P.getVersion=function(){return Pu},P.getWorkerCount=function(){return Wt.workerCount},P.getWorkerUrl=function(){return u.a.WORKER_URL},P.importScriptInWorkers=function(g){return rn().broadcast("IS",g)},P.prewarm=function(){Fe().acquire(yt)},P.setMaxParallelImageRequests=function(g){u.a.MAX_PARALLEL_IMAGE_REQUESTS=g},P.setRTLTextPlugin=function(g,t){return Vn().setRTLTextPlugin(g,t)},P.setWorkerCount=function(g){Wt.workerCount=g},P.setWorkerUrl=function(g){u.a.WORKER_URL=g}});var F=w;return F})}(Om)),Om.exports}var M9=Bm.exports,T0;function P9(){return T0||(T0=1,function(p,m){(function(w,M){p.exports=M(rg(),S9())})(typeof globalThis<"u"?globalThis:M9||self,function(w,M){w.MaplibreGL=w.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},initialize:function(I){w.setOptions(this,I),this._throttledUpdate=w.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(I){this._container||this._initContainer();var F=this.getPaneName();I.getPane(F).appendChild(this._container),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),I.options.zoomAnimation&&w.DomEvent.on(I._proxy,w.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(I){this._map._proxy&&this._map.options.zoomAnimation&&w.DomEvent.off(this._map._proxy,w.DomUtil.TRANSITION_END,this._transitionEnd,this);var F=this.getPaneName();I.getPane(F).removeChild(this._container),this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getAttribution:function(){if(this.options.attributionControl)return this.options.attributionControl.customAttribution;var I=this._glMap;if(I&&this.options.attributionControl!==!1){var F=I.getStyle();if(F&&F.sources)return Object.keys(F.sources).map(function(P){var u=I.getSource(P);return u&&typeof u.attribution=="string"?u.attribution.trim():null}).filter(Boolean).join(", ")}return""},getMaplibreMap:function(){return this._glMap},getCanvas:function(){return this._glMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getBounds:function(){var I=this.getSize().multiplyBy(.5),F=this._map.latLngToContainerPoint(this._map.getCenter());return w.latLngBounds(this._map.containerPointToLatLng(F.subtract(I)),this._map.containerPointToLatLng(F.add(I)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},_roundPoint:function(I){return{x:Math.round(I.x),y:Math.round(I.y)}},_initContainer:function(){var I=this._container=w.DomUtil.create("div","leaflet-gl-layer");this._resizeContainer();var F=this._map.getSize().multiplyBy(this.options.padding),P=this._map.containerPointToLayerPoint([0,0]).subtract(F);w.DomUtil.setPosition(I,this._roundPoint(P))},_resizeContainer:function(){var I=this.getSize();this._container.style.width=I.x+"px",this._container.style.height=I.y+"px"},_initGL:function(){var I=this._map.getCenter(),F=w.extend({},this.options,{container:this._container,center:[I.lng,I.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new M.Map(F);var P=this._map,u=this.getAttribution(),H=this.getAttribution.bind(this);this._glMap.on("load",function(){P&&P.attributionControl&&(P.attributionControl.removeAttribution(u),P.attributionControl.addAttribution(H()))});var X=Object.getPrototypeOf(this._glMap.transform),Q=Object.getOwnPropertyDescriptor(X,"latRange");(!Q||Q.set||Q.writable)&&(this._glMap.transform.latRange=null);var dt=Object.getOwnPropertyDescriptor(X,"maxValidLatitude");(!dt||dt.set||dt.writable)&&(this._glMap.transform.maxValidLatitude=1/0),this._glMap.transform._helper&&this._glMap.transform._helper._latRange&&(this._glMap.transform._helper._latRange=[-1/0,1/0]),this._transformGL(this._glMap),this._glMap._canvas.canvas?this._glMap._actualCanvas=this._glMap._canvas.canvas:this._glMap._actualCanvas=this._glMap._canvas;var ht=this._glMap._actualCanvas;w.DomUtil.addClass(ht,"leaflet-image-layer"),w.DomUtil.addClass(ht,"leaflet-zoom-animated"),this.options.interactive&&w.DomUtil.addClass(ht,"leaflet-interactive"),this.options.className&&w.DomUtil.addClass(ht,this.options.className)},_update:function(I){if(this._map&&(this._offset=this._map.containerPointToLayerPoint([0,0]),!this._zooming)){var F=this._container,P=this._glMap,u=this._map.getSize().multiplyBy(this.options.padding),H=this._map.containerPointToLayerPoint([0,0]).subtract(u);w.DomUtil.setPosition(F,this._roundPoint(H)),this._transformGL(P)}},_transformGL:function(I){var F=this._map.getCenter(),P=I._getTransformForUpdate();P.setCenter?(P.setCenter(M.LngLat.convert([F.lng,F.lat])),P.setZoom(this._map.getZoom()-1),I.transform.apply(P)):(P=I.transform,P.center=M.LngLat.convert([F.lng,F.lat]),P.zoom=this._map.getZoom()-1),I._fireMoveEvents()},_pinchZoom:function(I){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(I){var F=this._map.getZoomScale(I.zoom),P=this._map.getSize().multiplyBy(this.options.padding*F),u=this.getSize()._divideBy(2),H=this._map.project(I.center,I.zoom)._subtract(u)._add(this._map._getMapPanePos().add(P))._round(),X=this._map.project(this._map.getBounds().getNorthWest(),I.zoom)._subtract(H);w.DomUtil.setTransform(this._glMap._actualCanvas,X.subtract(this._offset),F)},_zoomStart:function(I){this._zooming=!0},_zoomEnd:function(){var I=this._map.getZoomScale(this._map.getZoom());w.DomUtil.setTransform(this._glMap._actualCanvas,null,I),this._zooming=!1,this._update()},_transitionEnd:function(I){w.Util.requestAnimFrame(function(){var F=this._map.getZoom(),P=this._map.getCenter(),u=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());this._resizeContainer(),w.DomUtil.setTransform(this._glMap._actualCanvas,u,1),this._glMap.once("moveend",w.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:P,zoom:F-1})},this)},_resize:function(I){this._transitionEnd(I)}}),w.maplibreGL=function(I){return new w.MaplibreGL(I)}})}(Bm)),Bm.exports}P9();function A9(){const p=bf();return ce.useEffect(()=>{const m=go.maplibreGL({style:"https://tiles.openfreemap.org/styles/bright",attributionControl:!1});return m.addTo(p),()=>{p.removeLayer(m)}},[p]),null}/*!
Copyright (c) 2016 Dominik Moritz

This file is part of the leaflet locate control. It is licensed under the MIT license.
You can find the project at: https://github.com/domoritz/leaflet-locatecontrol
*/const xd=(p,m)=>{m.split(" ").forEach(w=>{p.classList.add(w)})},bd=(p,m)=>{m.split(" ").forEach(w=>{p.classList.remove(w)})},m3=qi.Marker.extend({initialize(p,m){qi.setOptions(this,m),this._latlng=p,this.createIcon()},createIcon(){const p=this.options,m=[["stroke",p.color],["stroke-width",p.weight],["fill",p.fillColor],["fill-opacity",p.fillOpacity],["opacity",p.opacity]].filter(([M,I])=>I!==void 0).map(([M,I])=>`${M}="${I}"`).join(" "),w=this._getIconSVG(p,m);this._locationIcon=qi.divIcon({className:w.className,html:w.svg,iconSize:[w.w,w.h]}),this.setIcon(this._locationIcon)},_getIconSVG(p,m){const w=p.radius,M=p.weight,I=w+M,F=I*2;return{className:"leaflet-control-locate-location",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="${F}" height="${F}" version="1.1" viewBox="-${I} -${I} ${F} ${F}"><circle r="${w}" ${m} /></svg>`,w:F,h:F}},setStyle(p){qi.setOptions(this,p),this.createIcon()}}),C9=m3.extend({initialize(p,m,w){qi.setOptions(this,w),this._latlng=p,this._heading=m,this.createIcon()},setHeading(p){this._heading=p},_getIconSVG(p,m){const w=p.radius,M=w+p.weight+p.depth,I=M*2,F=this._arrowPoints(w,p.width,p.depth,this._heading);return{className:"leaflet-control-locate-heading",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="${I}" height="${I}" version="1.1" viewBox="-${M} -${M} ${I} ${I}"><path d="${F}" ${m} /></svg>`,w:I,h:I}},_arrowPoints(p,m,w,M){const I=(M-90)*Math.PI/180,F=Math.cos(I),P=Math.sin(I),u=-Math.sin(I),H=Math.cos(I),X=m/2,Q=p*F,dt=p*P,ht=Q+X*u,lt=dt+X*H,Yt=Q-X*u,Jt=dt-X*H,pe=Q+w*F,ge=dt+w*P;return`M ${ht},${lt} L ${Yt},${Jt} L ${pe},${ge} Z`}}),E9=qi.Control.extend({options:{position:"topleft",layer:void 0,setView:"untilPanOrZoom",keepCurrentZoomLevel:!1,initialZoomLevel:!1,getLocationBounds(p){return p.bounds},flyTo:!1,clickBehavior:{inView:"stop",outOfView:"setView",inViewNotFollowing:"inView"},returnToPrevBounds:!1,cacheLocation:!0,drawCircle:!0,drawMarker:!0,showCompass:!0,markerClass:m3,compassClass:C9,circleStyle:{className:"leaflet-control-locate-circle",color:"#136AEC",fillColor:"#136AEC",fillOpacity:.15,weight:0},markerStyle:{className:"leaflet-control-locate-marker",color:"#fff",fillColor:"#2A93EE",fillOpacity:1,weight:3,opacity:1,radius:9},compassStyle:{fillColor:"#2A93EE",fillOpacity:1,weight:0,color:"#fff",opacity:1,radius:9,width:9,depth:6},followCircleStyle:{},followMarkerStyle:{},followCompassStyle:{},icon:"leaflet-control-locate-location-arrow",iconLoading:"leaflet-control-locate-spinner",iconElementTag:"span",textElementTag:"small",circlePadding:[0,0],metric:!0,createButtonCallback(p,m){const w=qi.DomUtil.create("a","leaflet-bar-part leaflet-bar-part-single",p);w.title=m.strings.title,w.href="#",w.setAttribute("role","button");const M=qi.DomUtil.create(m.iconElementTag,m.icon,w);if(m.strings.text!==void 0){const I=qi.DomUtil.create(m.textElementTag,"leaflet-locate-text",w);I.textContent=m.strings.text,w.classList.add("leaflet-locate-text-active"),w.parentNode.style.display="flex",m.icon.length>0&&M.classList.add("leaflet-locate-icon")}return{link:w,icon:M}},onLocationError(p,m){alert(p.message)},onLocationOutsideMapBounds(p){p.stop(),alert(p.options.strings.outsideMapBoundsMsg)},showPopup:!0,strings:{title:"Show me where I am",metersUnit:"meters",feetUnit:"feet",popup:"You are within {distance} {unit} from this point",outsideMapBoundsMsg:"You seem located outside the boundaries of the map"},locateOptions:{maxZoom:1/0,watch:!0,setView:!1}},initialize(p){for(const m in p)typeof this.options[m]=="object"?qi.extend(this.options[m],p[m]):this.options[m]=p[m];this.options.followMarkerStyle=qi.extend({},this.options.markerStyle,this.options.followMarkerStyle),this.options.followCircleStyle=qi.extend({},this.options.circleStyle,this.options.followCircleStyle),this.options.followCompassStyle=qi.extend({},this.options.compassStyle,this.options.followCompassStyle)},onAdd(p){const m=qi.DomUtil.create("div","leaflet-control-locate leaflet-bar leaflet-control");this._container=m,this._map=p,this._layer=this.options.layer||new qi.LayerGroup,this._layer.addTo(p),this._event=void 0,this._compassHeading=null,this._prevBounds=null;const w=this.options.createButtonCallback(m,this.options);return this._link=w.link,this._icon=w.icon,qi.DomEvent.on(this._link,"click",function(M){qi.DomEvent.stopPropagation(M),qi.DomEvent.preventDefault(M),this._onClick()},this).on(this._link,"dblclick",qi.DomEvent.stopPropagation),this._resetVariables(),this._map.on("unload",this._unload,this),m},_onClick(){this._justClicked=!0;const p=this._isFollowing();if(this._userPanned=!1,this._userZoomed=!1,this._active&&!this._event)this.stop();else if(this._active){const m=this.options.clickBehavior;let w=m.outOfView;switch(this._map.getBounds().contains(this._event.latlng)&&(w=p?m.inView:m.inViewNotFollowing),m[w]&&(w=m[w]),w){case"setView":this.setView();break;case"stop":this.stop(),this.options.returnToPrevBounds&&(this.options.flyTo?this._map.flyToBounds:this._map.fitBounds).bind(this._map)(this._prevBounds);break}}else this.options.returnToPrevBounds&&(this._prevBounds=this._map.getBounds()),this.start();this._updateContainerStyle()},start(){this._activate(),this._event&&(this._drawMarker(this._map),this.options.setView&&this.setView()),this._updateContainerStyle()},stop(){this._deactivate(),this._cleanClasses(),this._resetVariables(),this._removeMarker()},stopFollowing(){this._userPanned=!0,this._updateContainerStyle(),this._drawMarker()},_activate(){if(!(this._active||!this._map)&&(this._map.locate(this.options.locateOptions),this._map.fire("locateactivate",this),this._active=!0,this._map.on("locationfound",this._onLocationFound,this),this._map.on("locationerror",this._onLocationError,this),this._map.on("dragstart",this._onDrag,this),this._map.on("zoomstart",this._onZoom,this),this._map.on("zoomend",this._onZoomEnd,this),this.options.showCompass)){const p="ondeviceorientationabsolute"in window;if(p||"ondeviceorientation"in window){const m=this,w=function(){qi.DomEvent.on(window,p?"deviceorientationabsolute":"deviceorientation",m._onDeviceOrientation,m)};DeviceOrientationEvent&&typeof DeviceOrientationEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(function(M){M==="granted"&&w()}):w()}}},_deactivate(){!this._active||!this._map||(this._map.stopLocate(),this._map.fire("locatedeactivate",this),this._active=!1,this.options.cacheLocation||(this._event=void 0),this._map.off("locationfound",this._onLocationFound,this),this._map.off("locationerror",this._onLocationError,this),this._map.off("dragstart",this._onDrag,this),this._map.off("zoomstart",this._onZoom,this),this._map.off("zoomend",this._onZoomEnd,this),this.options.showCompass&&(this._compassHeading=null,"ondeviceorientationabsolute"in window?qi.DomEvent.off(window,"deviceorientationabsolute",this._onDeviceOrientation,this):"ondeviceorientation"in window&&qi.DomEvent.off(window,"deviceorientation",this._onDeviceOrientation,this)))},setView(){if(this._drawMarker(),this._isOutsideMapBounds())this._event=void 0,this.options.onLocationOutsideMapBounds(this);else if(this._justClicked&&this.options.initialZoomLevel!==!1)(this.options.flyTo?this._map.flyTo:this._map.setView).bind(this._map)([this._event.latitude,this._event.longitude],this.options.initialZoomLevel);else if(this.options.keepCurrentZoomLevel)(this.options.flyTo?this._map.flyTo:this._map.panTo).bind(this._map)([this._event.latitude,this._event.longitude]);else{let p=this.options.flyTo?this._map.flyToBounds:this._map.fitBounds;this._ignoreEvent=!0,p.bind(this._map)(this.options.getLocationBounds(this._event),{padding:this.options.circlePadding,maxZoom:this.options.initialZoomLevel||this.options.locateOptions.maxZoom}),qi.Util.requestAnimFrame(function(){this._ignoreEvent=!1},this)}},_drawCompass(){if(!this._event)return;const p=this._event.latlng;if(this.options.showCompass&&p&&this._compassHeading!==null){const m=this._isFollowing()?this.options.followCompassStyle:this.options.compassStyle;this._compass?(this._compass.setLatLng(p),this._compass.setHeading(this._compassHeading),this._compass.setStyle&&this._compass.setStyle(m)):this._compass=new this.options.compassClass(p,this._compassHeading,m).addTo(this._layer)}this._compass&&(!this.options.showCompass||this._compassHeading===null)&&(this._compass.removeFrom(this._layer),this._compass=null)},_drawMarker(){this._event.accuracy===void 0&&(this._event.accuracy=0);const p=this._event.accuracy,m=this._event.latlng;if(this.options.drawCircle){const P=this._isFollowing()?this.options.followCircleStyle:this.options.circleStyle;this._circle?this._circle.setLatLng(m).setRadius(p).setStyle(P):this._circle=qi.circle(m,p,P).addTo(this._layer)}let w,M;if(this.options.metric?(w=p.toFixed(0),M=this.options.strings.metersUnit):(w=(p*3.2808399).toFixed(0),M=this.options.strings.feetUnit),this.options.drawMarker){const P=this._isFollowing()?this.options.followMarkerStyle:this.options.markerStyle;this._marker?(this._marker.setLatLng(m),this._marker.setStyle&&this._marker.setStyle(P)):this._marker=new this.options.markerClass(m,P).addTo(this._layer)}this._drawCompass();const I=this.options.strings.popup;function F(){return typeof I=="string"?qi.Util.template(I,{distance:w,unit:M}):typeof I=="function"?I({distance:w,unit:M}):I}this.options.showPopup&&I&&this._marker&&this._marker.bindPopup(F())._popup.setLatLng(m),this.options.showPopup&&I&&this._compass&&this._compass.bindPopup(F())._popup.setLatLng(m)},_removeMarker(){this._layer.clearLayers(),this._marker=void 0,this._circle=void 0},_unload(){this.stop(),this._map&&this._map.off("unload",this._unload,this)},_setCompassHeading(p){!isNaN(parseFloat(p))&&isFinite(p)?(p=Math.round(p),this._compassHeading=p,qi.Util.requestAnimFrame(this._drawCompass,this)):this._compassHeading=null},_onCompassNeedsCalibration(){this._setCompassHeading()},_onDeviceOrientation(p){this._active&&(p.webkitCompassHeading?this._setCompassHeading(p.webkitCompassHeading):p.absolute&&p.alpha&&this._setCompassHeading(360-p.alpha))},_onLocationError(p){p.code==3&&this.options.locateOptions.watch||(this.stop(),this.options.onLocationError(p,this))},_onLocationFound(p){if(!(this._event&&this._event.latlng.lat===p.latlng.lat&&this._event.latlng.lng===p.latlng.lng&&this._event.accuracy===p.accuracy)&&this._active){switch(this._event=p,this._drawMarker(),this._updateContainerStyle(),this.options.setView){case"once":this._justClicked&&this.setView();break;case"untilPan":this._userPanned||this.setView();break;case"untilPanOrZoom":!this._userPanned&&!this._userZoomed&&this.setView();break;case"always":this.setView();break}this._justClicked=!1}},_onDrag(){this._event&&!this._ignoreEvent&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_onZoom(){this._event&&!this._ignoreEvent&&(this._userZoomed=!0,this._updateContainerStyle(),this._drawMarker())},_onZoomEnd(){this._event&&this._drawCompass(),this._event&&!this._ignoreEvent&&this._marker&&!this._map.getBounds().pad(-.3).contains(this._marker.getLatLng())&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_isFollowing(){if(!this._active)return!1;if(this.options.setView==="always")return!0;if(this.options.setView==="untilPan")return!this._userPanned;if(this.options.setView==="untilPanOrZoom")return!this._userPanned&&!this._userZoomed},_isOutsideMapBounds(){return this._event===void 0?!1:this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng)},_updateContainerStyle(){this._container&&(this._active&&!this._event?this._setClasses("requesting"):this._isFollowing()?this._setClasses("following"):this._active?this._setClasses("active"):this._cleanClasses())},_setClasses(p){p=="requesting"?(bd(this._container,"active following"),xd(this._container,"requesting"),bd(this._icon,this.options.icon),xd(this._icon,this.options.iconLoading)):p=="active"?(bd(this._container,"requesting following"),xd(this._container,"active"),bd(this._icon,this.options.iconLoading),xd(this._icon,this.options.icon)):p=="following"&&(bd(this._container,"requesting"),xd(this._container,"active following"),bd(this._icon,this.options.iconLoading),xd(this._icon,this.options.icon))},_cleanClasses(){qi.DomUtil.removeClass(this._container,"requesting"),qi.DomUtil.removeClass(this._container,"active"),qi.DomUtil.removeClass(this._container,"following"),bd(this._icon,this.options.iconLoading),xd(this._icon,this.options.icon)},_resetVariables(){this._active=!1,this._justClicked=!1,this._userPanned=!1,this._userZoomed=!1}});function z9(){const p=bf();return ce.useEffect(()=>{const m=new E9({flyTo:!0,showCompass:!0,markerClass:qi.circleMarker,markerStyle:{radius:8,weight:2},enableHighAccuracy:!0}).addTo(p);return()=>{p.removeControl(m)}},[p]),null}function D9(){const p=[31.3114517,-89.3176855],m=[[31.2114517,-89.4176855],[31.4114517,-89.2176855]],w="https://bus-tracker-backend-nc6f.onrender.com",[M,I]=ce.useState(null),F=ce.useRef(null);Tv(w,I,F);const P=ce.useRef(go.layerGroup());return Tt.jsx(Tt.Fragment,{children:Tt.jsx("div",{className:"map-container",children:Tt.jsxs(U3,{maxBounds:m,minZoom:11,maxZoom:18,center:p,zoom:11.5,style:{height:"100%",width:"100%"},attributionControl:!1,children:[Tt.jsx(A9,{}),Tt.jsx(z9,{}),Tt.jsx(Cv,{searchLayers:P}),M&&Tt.jsx(Sv,{data:M,searchLayers:P}),Tt.jsx(w9,{busData:M,searchLayers:P}),Tt.jsx(F3,{position:"topright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"></path><path fill="#FFD500" d="M0 4h12v3H0z"></path><path fill="#E0BC00" d="M0 7h12v1H0z"></path></svg> Leaflet</a> <span aria-hidden="true">|</span> <a href="https://openfreemap.org" target="_blank">OpenFreeMap</a> <br> <a href="https://www.openmaptiles.org/" target="_blank"> OpenMapTiles</a> Data from <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>'})]})})})}function L9(){return Tt.jsx("div",{className:"app-container",children:Tt.jsx(D9,{})})}S3.createRoot(document.getElementById("root")).render(Tt.jsx(L9,{}));
